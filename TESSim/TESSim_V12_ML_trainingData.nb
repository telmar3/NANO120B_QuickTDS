(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[    765398,      17087]
NotebookOptionsPosition[    735922,      16657]
NotebookOutlinePosition[    736780,      16685]
CellTagsIndexPosition[    736737,      16682]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"Needs", "[", "\"\<PlotLegends`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Off", "[", 
  RowBox[{"InterpolatingFunction", "::", "\"\<dmval\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Off", "[", 
  RowBox[{"General", "::", "\"\<unfl\>\""}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.504612967621949*^9, 3.504612991560521*^9}, {
  3.569298655576071*^9, 3.5692986558860703`*^9}},
 CellLabel->
  "In[695]:=",ExpressionUUID->"166d26df-a065-4536-b717-2c251a7ef3fc"],

Cell[BoxData[
 RowBox[{"On", "[", "Assert", "]"}]], "Input",
 CellChangeTimes->{{3.633348263961432*^9, 
  3.6333482700765533`*^9}},ExpressionUUID->"f24d2158-8d12-44ba-ba18-\
2025e525c683"],

Cell[CellGroupData[{

Cell["Input parameters", "Section",
 CellChangeTimes->{{3.49672584936255*^9, 
  3.496725852721495*^9}},ExpressionUUID->"e90d64f2-f1d3-40bf-8d70-\
d22907319647"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"InputParam", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pVERBOSE", "\[Rule]", "3"}], ",", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Global", " ", "verbose", " ", "flag", " ", "0"}], " ", "=", 
       " ", 
       RowBox[{"off", " ", ">", " ", 
        RowBox[{"0", " ", "different", " ", "levels"}]}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"pTgtThick", "\[Rule]", "100*^-6"}], ",", 
     RowBox[{"(*", 
      RowBox[{"sample", " ", "thickness", " ", "in", " ", "m"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"pImplThickness", "\[Rule]", "2*^-6"}], ",", 
     RowBox[{"(*", 
      RowBox[{
      "thickness", " ", "subrange", " ", "to", " ", "simulate", " ", "during",
        " ", "implantation"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"prohW", " ", "\[Rule]", "6.2*^28"}], ",", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Density", " ", "of", " ", "W", " ", "in", " ", "m"}], "-", 
       RowBox[{"^", "3"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"pTraceDiffParam", "\[Rule]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pD0", " ", "\[Rule]", " ", 
         FractionBox["4.1*^-7", 
          SqrtBox["2"]]}], ",", " ", 
        RowBox[{"(*", 
         RowBox[{"Frauenfelder", " ", 
          RowBox[{
           RowBox[{"m", "^", "2"}], "/", "s"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"pED", " ", "->", "0.39"}]}], 
       RowBox[{"(*", 
        RowBox[{"Frauenfelder", " ", "eV"}], "*)"}], "\[IndentingNewLine]", 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"pTempFuncParam", "\[Rule]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pT0", "\[Rule]", "473"}], ",", 
        RowBox[{"(*", 
         RowBox[{"Constant", " ", "temperature"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"pRamp", " ", "\[Rule]", "1"}], ",", 
        RowBox[{"(*", 
         RowBox[{"Ramp", " ", "rate", " ", 
          RowBox[{"K", "/", "s"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"pTMax", " ", "\[Rule]", "1200"}], ",", 
        RowBox[{"(*", 
         RowBox[{"Max", " ", "temperature"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"pTemperatureList", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "300"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"750", ",", "1200"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"800", ",", "1200"}], "}"}]}], "}"}]}]}], 
       RowBox[{"(*", 
        RowBox[{"List", " ", "of", " ", "time", " ", 
         RowBox[{"(", "s", ")"}], " ", "temperature", " ", 
         RowBox[{"(", "K", ")"}], " ", "pairs", " ", "that", " ", "define", 
         " ", "the", " ", "temperature", " ", "evolution"}], "*)"}], 
       "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"pTrapModelParam", "\[Rule]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pTrapModel", "\[Rule]", "TrappRate"}], 
        RowBox[{"(*", 
         RowBox[{"How", " ", "trapping", " ", "generally", " ", "works"}], 
         "*)"}], ",", "\[IndentingNewLine]", 
        RowBox[{"pTraps", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"pETS", "\[Rule]", "0.85"}], ",", 
             RowBox[{"pnu0", "\[Rule]", "1.0*^11"}], ",", 
             RowBox[{"pEST", "\[Rule]", "0.5"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"pETS", "\[Rule]", "1.45"}], ",", 
             RowBox[{"pnu0", "\[Rule]", "1.0*^11"}], ",", 
             RowBox[{"pEST", "\[Rule]", "0.5"}]}], "}"}]}], "}"}]}], ",", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"(", "De", ")"}], "Trapping", " ", "paramters"}], ",", " ", 
          RowBox[{
          "the", " ", "length", " ", "of", " ", "this", " ", "array", " ", 
           "sets", " ", "the", " ", "number", " ", "of", " ", "traps"}]}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"pTrapProfFunc", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"(*", 
           RowBox[{
           "How", " ", "the", " ", "traps", " ", "are", " ", "distributed", 
            " ", "in", " ", "depth"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"pFunc", "->", "concindeptrapprof"}], ",", 
             RowBox[{"(*", 
              RowBox[{"Basic", " ", "functional", " ", "dependence"}], "*)"}],
              "\[IndentingNewLine]", 
             RowBox[{"pFuncPars", "->", 
              RowBox[{"{", 
               RowBox[{"(*", 
                RowBox[{"Paramters", " ", "for", " ", "pFunc"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"pLeft", "\[Rule]", "1*^-3"}], ",", 
                RowBox[{"pPos", "\[Rule]", "2000*^-9"}], ",", 
                RowBox[{"pRight", "\[Rule]", "1*^-5"}], ",", " ", 
                RowBox[{"pSteepness", "\[Rule]", "1*^-1"}]}], 
               "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "}"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"pFunc", "->", "concindeptrapprof"}], ",", 
             RowBox[{"(*", 
              RowBox[{"Basic", " ", "functional", " ", "dependence"}], "*)"}],
              "\[IndentingNewLine]", 
             RowBox[{"pFuncPars", "->", 
              RowBox[{"{", 
               RowBox[{"(*", 
                RowBox[{"Paramters", " ", "for", " ", "pFunc"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"pLeft", "\[Rule]", "1*^-4"}], ",", 
                RowBox[{"pPos", "\[Rule]", "2000*^-9"}], ",", 
                RowBox[{"pRight", "\[Rule]", "1*^-5"}], ",", " ", 
                RowBox[{"pSteepness", "\[Rule]", "1*^-1"}]}], 
               "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "}"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"pFunc", "\[Rule]", "mstepconcindeptrapprof"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"pFuncPars", "->", 
              RowBox[{"{", 
               RowBox[{"(*", 
                RowBox[{"Paramters", " ", "for", " ", "pFunc"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"pSteps", "\[Rule]", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"pLeft", "\[Rule]", "1*^-4"}], ",", 
                    RowBox[{"pRight", "\[Rule]", "1*^-6"}], ",", 
                    RowBox[{"pPos", "\[Rule]", "200*^-9"}], ",", " ", 
                    RowBox[{"pSteepness", "\[Rule]", "1*^-3"}]}], 
                   "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"pLeft", "\[Rule]", "1*^-1"}], ",", 
                    RowBox[{"pRight", "\[Rule]", "1*^-12"}], ",", 
                    RowBox[{"pPos", "\[Rule]", "10*^-9"}], ",", " ", 
                    RowBox[{"pSteepness", "\[Rule]", "1*^-3"}]}], 
                   "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"pLeft", "\[Rule]", "1*^-5"}], ",", 
                    RowBox[{"pRight", "\[Rule]", "1*^-6"}], ",", 
                    RowBox[{"pPos", "\[Rule]", "2000*^-9"}], ",", " ", 
                    RowBox[{"pSteepness", "\[Rule]", "1*^-3"}]}], 
                   "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
                 "}"}]}], "\[IndentingNewLine]", "}"}]}]}], 
            "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "}"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"pTrapProfSteepness", "\[Rule]", "1*^-1"}], ",", 
        RowBox[{"(*", 
         RowBox[{"Global", " ", "default"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"pxref", "->", "0.2*^-6"}], ",", 
        RowBox[{"(*", 
         RowBox[{
         "depth", " ", "of", " ", "reference", " ", "concentration", " ", 
          "used", " ", "for", " ", "time", " ", "evolution", " ", "of", " ", 
          "trap", " ", "profiles", " ", "due", " ", "to", " ", "local", " ", 
          "oversaturation", " ", "at", " ", "location", " ", "pxref"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"pNumInterstit", "\[Rule]", "1"}]}], " ", 
       RowBox[{"(*", 
        RowBox[{
        "Number", " ", "of", " ", "solute", " ", "interstitial", " ", "sites",
          " ", "in", " ", "W", " ", "per", " ", "W", " ", "atom"}], "*)"}], 
       "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"pImplParam", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"(*", 
        RowBox[{"How", " ", "Implantation", " ", "works"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pImplModel", "->", "ImplRateSurf"}], ",", 
        RowBox[{"(*", 
         RowBox[{"Implantation", " ", "source", " ", "function"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"pImplRng", " ", "->", " ", "1*^-9"}], " ", ",", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Implantation", " ", "range", " ", "in", " ", "m"}], ",", 
          " ", 
          RowBox[{
          "allways", " ", "provide", " ", "this", " ", "since", " ", "they", 
           " ", "are", " ", "used", " ", "to", " ", "plot", " ", "the", " ", 
           "source", " ", "distribution"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"pImplStrgl", " ", "->", " ", "2*^-9"}], ",", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Implantation", " ", "straggle", " ", "in", " ", "m"}], ",",
           " ", 
          RowBox[{
          "allways", " ", "provide", " ", "this", " ", "since", " ", "they", 
           " ", "are", " ", "used", " ", "to", " ", "plot", " ", "the", " ", 
           "source", " ", "distribution"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"pImplFlux", "\[Rule]", "1*^20"}], ",", 
        RowBox[{"(*", 
         RowBox[{"Implantation", " ", "flux", " ", 
          RowBox[{"#", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"m", "^", "2"}], " ", "s"}], ")"}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"pImplAngle", "\[Rule]", "0"}], ",", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Impact", " ", "angle", " ", "0", "\[Degree]"}], "=", 
          RowBox[{"Perpendicular", " ", "to", " ", "surface"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"pImplBias", "\[Rule]", "300"}], ",", 
        RowBox[{"(*", 
         RowBox[{
         "Target", " ", "bias", " ", "relative", " ", "to", " ", "ground"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"pPlasmaPot", "\[Rule]", 
         RowBox[{"-", "10"}]}], ",", 
        RowBox[{"(*", 
         RowBox[{
         "Plasma", " ", "potential", " ", "relative", " ", "to", " ", 
          "ground"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"pD1Fraction", "\[Rule]", "0"}], ",", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Fraction", " ", "of", " ", "D"}], "+"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"pD2Fraction", "\[Rule]", "0"}], ",", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Fraction", " ", "of", " ", "D2"}], "+"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"pImplOffTime", "\[Rule]", "5"}], ",", 
        RowBox[{"(*", 
         RowBox[{"Implantation", " ", "end", " ", "time"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"pImplOffScale", "\[Rule]", "10"}], ",", 
        RowBox[{"(*", 
         RowBox[{
         "How", " ", 
          "\"\<Fast to turn off implantation at pImplOffTime in supporting \
source functions\>\""}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"pImplOnTime", "\[Rule]", "5"}], ",", 
        RowBox[{"(*", 
         RowBox[{
         "Turn", " ", "flux", " ", "on", " ", "at", " ", "this", " ", 
          "time"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"pImplOnScale", "\[Rule]", "10"}], ",", 
        RowBox[{"(*", 
         RowBox[{
         "How", " ", 
          "\"\<Fast to turn on implantation at pImplOnTime in supporting \
source functions\>\""}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"pImplStepSteepnes", "\[Rule]", "1*^-5"}]}], 
       "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"pSolModelParam", "\[Rule]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pSoluteModel", "->", "SoluteDiffRate"}], ",", 
        RowBox[{"(*", 
         RowBox[{"How", " ", "the", " ", "solute", " ", "diffuses"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"pStressFuncOfCSol", "->", "SigOfCLin"}], ",", 
        RowBox[{"(*", 
         RowBox[{
         "Calculates", " ", "stress", " ", "as", " ", "function", " ", "of", 
          " ", "local", " ", "solute", " ", "conc", " ", 
          RowBox[{"Pa", "/", 
           RowBox[{"m", "^", "2"}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"pStressFuncParam", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"pPropFac", "\[Rule]", "0.1"}], ",", 
           RowBox[{"pHVol", "\[Rule]", "0.1"}]}], "}"}]}]}], 
       RowBox[{"(*", 
        RowBox[{"Parameters", " ", "for", " ", "pStressFuncOfCSol"}], "*)"}], 
       "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"pSolBndCond", "\[Rule]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pLeft", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"pModel", "->", "SurfModExBoundCond"}], ",", 
           RowBox[{"(*", 
            RowBox[{"Influx", " ", "surface"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"pParam", "->", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"pLHParam", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"(*", 
                 RowBox[{"Langmuir", "\[Dash]", 
                  RowBox[{"Hinshelwood", " ", "paramters"}]}], "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"pFrac", "\[Rule]", "1"}], ",", 
                   RowBox[{"pNuRec", "\[Rule]", "1*^-6"}], ",", 
                   RowBox[{"pERec", "->", "1.42"}], ",", 
                   RowBox[{"pNuBulk", "\[Rule]", "1*^13"}], ",", " ", 
                   RowBox[{"pEBulk", "\[Rule]", "1.0"}]}], " ", "}"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"pFrac", "\[Rule]", "1"}], ",", 
                   RowBox[{"pNuRec", "\[Rule]", "1*^-6"}], ",", 
                   RowBox[{"pERec", "->", "1.0"}], ",", 
                   RowBox[{"pNuBulk", "\[Rule]", "1*^13"}], ",", " ", 
                   RowBox[{"pEBulk", "\[Rule]", "1.0"}]}], "}"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"pFrac", "\[Rule]", "1"}], ",", 
                   RowBox[{"pNuRec", "\[Rule]", "1*^-6"}], ",", 
                   RowBox[{"pERec", "\[Rule]", "0.6"}], ",", 
                   RowBox[{"pNuBulk", "\[Rule]", "1*^13"}], ",", " ", 
                   RowBox[{"pEBulk", "\[Rule]", "1.0"}]}], "}"}]}], 
                "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"pRefl", "\[Rule]", "0.96"}], ",", 
              RowBox[{"(*", 
               RowBox[{
               "Thermal", " ", "atom", " ", "reflection", " ", "yield"}], 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{"pERParam", "\[Rule]", "1*^-20"}], " ", ",", 
              RowBox[{"(*", 
               RowBox[{"Eley", "\[Dash]", 
                RowBox[{
                "Rideal", " ", "abstraction", " ", "cross", " ", "section", 
                 " ", 
                 RowBox[{"m", "^", "2"}]}]}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"pAtomFlux", "\[Rule]", "1*^19"}], " ", ",", 
              RowBox[{"(*", 
               RowBox[{"Atom", " ", "flux"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"pSolSel", "\[Rule]", "1"}], 
              RowBox[{"(*", 
               RowBox[{
               "Index", " ", "of", " ", "solution", " ", "in", " ", 
                "quadrature", " ", "that", " ", "yields", " ", "positive", 
                " ", "concentrations", " ", "depends", " ", "on", " ", 
                "mathematica", " ", "version"}], "*)"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"pCS0PLOTMAX", "\[Rule]", "0.0001"}], ",", 
              RowBox[{"(*", 
               RowBox[{
               "Maximum", " ", "solute", " ", "concentration", " ", "in", " ",
                 "the", " ", "plot", " ", "CAi", " ", "vs", " ", "CSol"}], 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{"pTURNONAT", "\[Rule]", "1"}], ",", " ", 
              RowBox[{"(*", 
               RowBox[{
               "When", " ", "to", " ", "turn", " ", "on", " ", "the", " ", 
                "boundary", " ", "condition"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"pTURNONSCALE", "\[Rule]", "10"}]}], 
             RowBox[{"(*", 
              RowBox[{
              "How", " ", "fast", " ", "to", " ", "turn", " ", "on", " ", 
               "the", " ", "boundary", " ", "condition"}], "*)"}], 
             "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "}"}]}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"pRight", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", " ", 
          RowBox[{
           RowBox[{"pModel", "->", "SolFluxBndCond"}], " ", ",", 
           RowBox[{"(*", 
            RowBox[{"Rear", " ", "surfcae"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"pParam", "->", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"CONSTCONC", "\[Rule]", "0"}], ",", 
              RowBox[{"FLUXVAL", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
              RowBox[{"palpha", "\[Rule]", "1*^35"}], ",", 
              RowBox[{"pER", "\[Rule]", "0.05"}]}], "\[IndentingNewLine]", 
             "}"}]}]}], "\[IndentingNewLine]", "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"pSolBndCondPlotTime", "\[Rule]", "100"}]}], 
       "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CaseID", "=", "\"\<ExtSurfMod\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.4967258579708233`*^9, 3.496725901824584*^9}, {
   3.4967261569794197`*^9, 3.496726272511505*^9}, {3.496726315834084*^9, 
   3.496726327645072*^9}, {3.4967273286575513`*^9, 3.4967273609034233`*^9}, 
   3.496727503947611*^9, {3.4967349772862463`*^9, 3.496734979239171*^9}, {
   3.4967398902049866`*^9, 3.4967399190770297`*^9}, {3.497168317967003*^9, 
   3.4971684106229315`*^9}, {3.497173074848899*^9, 3.4971731487679358`*^9}, {
   3.4971733480102844`*^9, 3.4971733508070517`*^9}, {3.497177847134386*^9, 
   3.497177851915453*^9}, {3.4971781908399377`*^9, 3.497178221291893*^9}, {
   3.4971782703212605`*^9, 3.497178272821164*^9}, {3.497178675008845*^9, 
   3.4971786885083265`*^9}, {3.497179264017476*^9, 3.49717930870326*^9}, 
   3.497265000503561*^9, 3.497265040111415*^9, {3.498372345664067*^9, 
   3.498372345914062*^9}, {3.4983767430640097`*^9, 3.4983767473920517`*^9}, 
   3.4983787519316893`*^9, 3.4983788035244484`*^9, 3.4983788585546417`*^9, 
   3.4983819217927017`*^9, {3.4983826777156878`*^9, 3.498382679887521*^9}, 
   3.498382945054304*^9, {3.4983830124905095`*^9, 3.4983830129280014`*^9}, {
   3.4983831697843647`*^9, 3.498383170065609*^9}, 3.498388352919222*^9, {
   3.4984500316924586`*^9, 3.4984500572705836`*^9}, {3.4984589578540554`*^9, 
   3.4984589615259304`*^9}, {3.498459018494316*^9, 3.4984590224786654`*^9}, {
   3.498459415559302*^9, 3.4984594327316165`*^9}, 3.498459594126601*^9, {
   3.498459671207193*^9, 3.498459671347822*^9}, {3.4984740439126267`*^9, 
   3.4984740487402573`*^9}, {3.5012380692807617`*^9, 3.501238085062113*^9}, {
   3.5012389833491116`*^9, 3.5012389836772385`*^9}, 3.501239032677552*^9, {
   3.502013678012684*^9, 3.502013687247059*^9}, {3.502013741372059*^9, 
   3.502013752699817*^9}, {3.5020139303591843`*^9, 3.50201395818535*^9}, {
   3.5020141976283445`*^9, 3.502014301688181*^9}, {3.502014409733485*^9, 
   3.502014476764306*^9}, {3.502014788106064*^9, 3.5020148164808817`*^9}, {
   3.5020150331831684`*^9, 3.5020150392769184`*^9}, {3.5020161721058025`*^9, 
   3.5020161736527667`*^9}, {3.5045998433782654`*^9, 
   3.5045998472846904`*^9}, {3.504600831740556*^9, 3.504600832146457*^9}, {
   3.504601496465143*^9, 3.5046015369154205`*^9}, {3.504606094595301*^9, 
   3.504606118752633*^9}, {3.504606190537099*^9, 3.504606191396513*^9}, 
   3.504606244211379*^9, {3.504606285650735*^9, 3.5046063107299833`*^9}, {
   3.504608691899155*^9, 3.5046086923523006`*^9}, 3.504609481825167*^9, 
   3.504612195243598*^9, {3.5048623729812803`*^9, 3.5048623743086147`*^9}, {
   3.5048627512934284`*^9, 3.504862751857931*^9}, {3.5048646893273907`*^9, 
   3.504864689639882*^9}, {3.504868656708065*^9, 3.504868656911185*^9}, {
   3.5048721167826147`*^9, 3.5048721339395237`*^9}, 3.504872950216098*^9, {
   3.504873645974921*^9, 3.5048736816957283`*^9}, {3.5048739934196997`*^9, 
   3.504873997122635*^9}, {3.5049377613647213`*^9, 3.5049377617709293`*^9}, {
   3.5049489331052823`*^9, 3.5049489343397207`*^9}, {3.504952365374756*^9, 
   3.504952367359232*^9}, {3.5049580733549614`*^9, 3.5049580958404875`*^9}, {
   3.504959414517375*^9, 3.504959417283142*^9}, {3.504959619324736*^9, 
   3.504959619777884*^9}, {3.504959697063091*^9, 3.5049596974224844`*^9}, {
   3.5049600575815487`*^9, 3.504960059003496*^9}, {3.5049604662587214`*^9, 
   3.50496046846196*^9}, {3.5049630394529624`*^9, 3.504963039656098*^9}, {
   3.504963158802823*^9, 3.5049631592090936`*^9}, {3.5049633716887217`*^9, 
   3.504963373470063*^9}, {3.504963819477273*^9, 3.5049638198679175`*^9}, 
   3.505023468498477*^9, {3.505032880824113*^9, 3.5050330345819855`*^9}, {
   3.505034458920532*^9, 3.5050344641239243`*^9}, {3.5050375910554857`*^9, 
   3.5050375939149885`*^9}, {3.505038808211196*^9, 3.5050388124614134`*^9}, {
   3.5050408996307707`*^9, 3.505040905209182*^9}, {3.50504351263955*^9, 
   3.50504352845286*^9}, 3.5050437661525292`*^9, {3.5050454948972864`*^9, 
   3.5050455089292545`*^9}, {3.5050457318625436`*^9, 3.5050457336595106`*^9}, 
   3.5050461844325886`*^9, {3.505047093057233*^9, 3.5050471000888433`*^9}, {
   3.5050477405903854`*^9, 3.5050477494970913`*^9}, {3.5050483896392393`*^9, 
   3.505048393623819*^9}, {3.5050489352140465`*^9, 3.5050489352921753`*^9}, {
   3.5050491157857914`*^9, 3.5050491182234163`*^9}, 3.505049581231496*^9, {
   3.505104907367685*^9, 3.505104912492947*^9}, 3.505122867487691*^9, 
   3.505123466096463*^9, 3.5051237551425114`*^9, {3.505128937345327*^9, 
   3.505128937579714*^9}, {3.5051298330943117`*^9, 3.5051298351881695`*^9}, {
   3.50520712683182*^9, 3.5052071412856855`*^9}, {3.5052071778188057`*^9, 
   3.5052072604324102`*^9}, {3.50520783263358*^9, 3.505207833055477*^9}, {
   3.505208638174822*^9, 3.505208638456086*^9}, 3.5052089833956213`*^9, {
   3.505210679138689*^9, 3.5052106922956123`*^9}, {3.5052113926127167`*^9, 
   3.5052113926595945`*^9}, {3.505213177875993*^9, 3.505213184579461*^9}, {
   3.5052135144244733`*^9, 3.505213515533905*^9}, {3.5052142120851917`*^9, 
   3.5052142126633463`*^9}, {3.5054635078265676`*^9, 
   3.5054635464222937`*^9}, {3.5054639869448476`*^9, 3.5054640003830357`*^9}, 
   3.507355585988786*^9, {3.5073593466031947`*^9, 3.5073593470094657`*^9}, {
   3.507365034410021*^9, 3.507365035238188*^9}, {3.507366484687396*^9, 
   3.5073664849061575`*^9}, 3.50736876213212*^9, {3.507368845183247*^9, 
   3.5073688496209745`*^9}, {3.5073719091248727`*^9, 3.507371911265388*^9}, {
   3.507372200348492*^9, 3.507372203629805*^9}, 3.5073745712220297`*^9, {
   3.507437628032694*^9, 3.5074376326420097`*^9}, {3.5074381081697965`*^9, 
   3.507438109482355*^9}, {3.5074384372635975`*^9, 3.5074384388574295`*^9}, {
   3.507438900959213*^9, 3.5074389041156244`*^9}, {3.507439018121461*^9, 
   3.507439021746647*^9}, {3.507439272681369*^9, 3.5074392773378572`*^9}, {
   3.5074397210636997`*^9, 3.5074397233606925`*^9}, {3.5074398965726857`*^9, 
   3.507439898182143*^9}, {3.507440700129451*^9, 3.5074407022545595`*^9}, {
   3.507441983898301*^9, 3.507441985617139*^9}, {3.5074441762605443`*^9, 
   3.5074441972928715`*^9}, {3.5074444122882533`*^9, 3.507444418491696*^9}, {
   3.5074445015897007`*^9, 3.507444502339739*^9}, 3.5074447263512077`*^9, {
   3.507445673399694*^9, 3.507445678806221*^9}, {3.507445787421157*^9, 
   3.507445792249529*^9}, 3.507446267726997*^9, {3.5074485419528065`*^9, 
   3.507448542452832*^9}, {3.5074579985307083`*^9, 3.507458002327778*^9}, {
   3.5074582750136137`*^9, 3.507458278248154*^9}, {3.5074585197136416`*^9, 
   3.507458522151266*^9}, {3.507458648673369*^9, 3.5074586501890717`*^9}, {
   3.5074587524130554`*^9, 3.507458755241325*^9}, {3.5074588684971237`*^9, 
   3.5074588706847353`*^9}, {3.507461267619952*^9, 3.5074612706513577`*^9}, {
   3.5075173973164206`*^9, 3.507517400082187*^9}, 3.5075196141642923`*^9, {
   3.507519817784092*^9, 3.507519819221666*^9}, {3.507520990140989*^9, 
   3.507520990281621*^9}, {3.507521849216221*^9, 3.5075218524663877`*^9}, {
   3.5075222341109266`*^9, 3.507522234407817*^9}, 3.50752288215973*^9, {
   3.507526888599224*^9, 3.5075269048188047`*^9}, {3.507527198646348*^9, 
   3.5075271989276123`*^9}, {3.507539087630113*^9, 3.5075390880207577`*^9}, {
   3.5075391444298964`*^9, 3.5075391476956882`*^9}, {3.5076288885716677`*^9, 
   3.5076288889154353`*^9}, {3.507629346767001*^9, 3.507629347220149*^9}, {
   3.507630124931841*^9, 3.5076301257443824`*^9}, {3.507636170585995*^9, 
   3.5076361710391407`*^9}, 3.5080368262916703`*^9, {3.511493096167528*^9, 
   3.5114930964800425`*^9}, 3.511493770369606*^9, 3.5115027872110424`*^9, {
   3.512890254395123*^9, 3.5128902632234173`*^9}, {3.5128911820691843`*^9, 
   3.51289118341296*^9}, {3.5128914788717575`*^9, 3.5128915344040737`*^9}, 
   3.5128916772193155`*^9, 3.51289211860279*^9, 3.512906663502847*^9, {
   3.5129088426734047`*^9, 3.5129088448140707`*^9}, {3.5129630235693045`*^9, 
   3.512963035882908*^9}, 3.512977439133815*^9, 3.512979569857662*^9, {
   3.512995772417301*^9, 3.512995772869707*^9}, {3.5164145292954683`*^9, 
   3.5164145336082163`*^9}, {3.5164145705165925`*^9, 3.51641460459668*^9}, {
   3.516414744807881*^9, 3.516414748558097*^9}, 3.516415270900682*^9, {
   3.5164183274986067`*^9, 3.5164183275767365`*^9}, 3.5164186893319473`*^9, {
   3.516418852216329*^9, 3.5164188535914083`*^9}, {3.516419111246873*^9, 
   3.5164191167315645`*^9}, 3.5164194144987144`*^9, 3.5164195330524178`*^9, 
   3.5164196242607965`*^9, 3.5164199192465363`*^9, {3.5164255294438305`*^9, 
   3.5164255368070774`*^9}, 3.516425643620962*^9, 3.5164347806508102`*^9, {
   3.516435847127626*^9, 3.5164358526812973`*^9}, 3.5164381087618213`*^9, {
   3.5164403768092833`*^9, 3.5164403824253187`*^9}, 3.5164404522045665`*^9, {
   3.516447335100524*^9, 3.5164473355373716`*^9}, {3.5164486680107126`*^9, 
   3.516448674245446*^9}, 3.5164487092474623`*^9, {3.5164488293168783`*^9, 
   3.5164488316451373`*^9}, {3.5164498765021925`*^9, 3.516449880939948*^9}, {
   3.516449928520814*^9, 3.5164499298021374`*^9}, {3.5164500357457395`*^9, 
   3.5164500368708043`*^9}, {3.5164542755885525`*^9, 3.516454297130707*^9}, {
   3.516499159617788*^9, 3.516499163673814*^9}, {3.5164997534511943`*^9, 
   3.516499770595704*^9}, {3.5166177367429037`*^9, 3.5166177375542493`*^9}, {
   3.5166185857211413`*^9, 3.516618588482182*^9}, 3.516618621396283*^9, {
   3.516622088833391*^9, 3.5166221070262103`*^9}, {3.517133229852909*^9, 
   3.517133230024807*^9}, {3.517133341680436*^9, 3.517133388452347*^9}, {
   3.517136839914963*^9, 3.5171368454813786`*^9}, {3.5172086548152018`*^9, 
   3.5172086748655043`*^9}, {3.517208792372142*^9, 3.517208792887453*^9}, 
   3.5172088502119536`*^9, {3.517208963377482*^9, 3.5172089642675657`*^9}, 
   3.5172090355523233`*^9, 3.5172091593676224`*^9, {3.517209261133836*^9, 
   3.5172092614929924`*^9}, 3.5172093333399076`*^9, {3.5172094036252737`*^9, 
   3.517209404640281*^9}, 3.5172094675551305`*^9, {3.517209545117319*^9, 
   3.517209546257251*^9}, 3.518493607791706*^9, {3.518493639181327*^9, 
   3.5184936403687887`*^9}, {3.518507420478995*^9, 3.518507455275202*^9}, {
   3.5185079020947475`*^9, 3.51850790376659*^9}, {3.518508992745682*^9, 
   3.518508996214365*^9}, 3.518687901296875*^9, {3.5188653428554125`*^9, 
   3.5188653718571105`*^9}, 3.5189264424284363`*^9, {3.5189424602859745`*^9, 
   3.518942463955805*^9}, {3.51894378401726*^9, 3.518943785938065*^9}, {
   3.5189439289677567`*^9, 3.5189439446309056`*^9}, 3.5189439976794767`*^9, {
   3.5189444649972544`*^9, 3.5189444794267154`*^9}, {3.519377003181552*^9, 
   3.5193770077597647`*^9}, {3.5226398543416705`*^9, 3.522639854966502*^9}, {
   3.5226699653708253`*^9, 3.5226700167775617`*^9}, 3.522670116138926*^9, {
   3.5227428944782686`*^9, 3.522742907254038*^9}, {3.5287165124663653`*^9, 
   3.528716581714593*^9}, 3.528716683040124*^9, 3.5287167349137955`*^9, {
   3.528767074742944*^9, 3.52876707505544*^9}, {3.530259505614252*^9, 
   3.5302595060204315`*^9}, 3.530259547075836*^9, {3.5302596533872833`*^9, 
   3.5302596536997395`*^9}, {3.530414637324869*^9, 3.530414641246493*^9}, {
   3.530414780175101*^9, 3.5304148098919487`*^9}, {3.530415014331989*^9, 
   3.530415015785021*^9}, 3.5304152726592045`*^9, 3.530415353544653*^9, 
   3.5304155666403885`*^9, {3.5305263643319635`*^9, 3.530526416003916*^9}, {
   3.530526462458688*^9, 3.5305264709092703`*^9}, {3.5305265297665606`*^9, 
   3.5305265348275375`*^9}, {3.530526567005356*^9, 3.5305266505427203`*^9}, {
   3.5305269941737003`*^9, 3.5305270224464426`*^9}, {3.5305270624500313`*^9, 
   3.530527063871478*^9}, {3.5363029848283834`*^9, 3.5363030346571465`*^9}, {
   3.540524201058673*^9, 3.5405243525606127`*^9}, {3.5405243866391735`*^9, 
   3.5405244143270283`*^9}, {3.540527461718779*^9, 3.54052748600034*^9}, {
   3.5405281804467287`*^9, 3.5405281811967382`*^9}, {3.540528321776663*^9, 
   3.5405284081683936`*^9}, {3.5405289082529197`*^9, 3.540528908362296*^9}, 
   3.540528949065942*^9, {3.544502404109375*^9, 3.544502417171875*^9}, {
   3.544502466640625*^9, 3.5445025213125*^9}, {3.544502562609375*^9, 
   3.544502568921875*^9}, {3.544502634515625*^9, 3.544502642390625*^9}, 
   3.544508141109375*^9, {3.545548755671875*^9, 3.545548761390625*^9}, {
   3.555132541027319*^9, 3.555132549183047*^9}, {3.555132655973087*^9, 
   3.555132690049031*^9}, {3.555133109725295*^9, 3.5551331181310067`*^9}, {
   3.555410643558531*^9, 3.5554106610034556`*^9}, {3.555410713121138*^9, 
   3.5554107490654373`*^9}, {3.555411155638049*^9, 3.555411158650296*^9}, {
   3.555411643343541*^9, 3.555411643858906*^9}, {3.5554117395667367`*^9, 
   3.5554117573116245`*^9}, {3.555411814795065*^9, 3.555411819590558*^9}, {
   3.557559947200613*^9, 3.5575599526217246`*^9}, {3.5575600199091244`*^9, 
   3.55756004678034*^9}, {3.5575601246287527`*^9, 3.557560142782446*^9}, {
   3.5575602420965858`*^9, 3.5575603097901783`*^9}, {3.557560353737115*^9, 
   3.5575604316167727`*^9}, {3.5575612016958303`*^9, 
   3.5575612029144087`*^9}, {3.5575624062412367`*^9, 3.557562419684843*^9}, {
   3.557562486637127*^9, 3.5575624890288386`*^9}, {3.557563024219446*^9, 
   3.5575630348597307`*^9}, {3.557563091764159*^9, 3.5575631079667664`*^9}, {
   3.5575633338005514`*^9, 3.557563394577133*^9}, 3.5575634341678424`*^9, {
   3.557568059185954*^9, 3.55756806054519*^9}, {3.5575691348570437`*^9, 
   3.557569189648308*^9}, {3.5575692798890657`*^9, 3.5575692802171574`*^9}, {
   3.5575693929868584`*^9, 3.5575693985800357`*^9}, {3.557569900731735*^9, 
   3.557569961616125*^9}, {3.5575701023673353`*^9, 3.557570115537862*^9}, {
   3.557571248781181*^9, 3.55757125015604*^9}, {3.55757134238097*^9, 
   3.5575713425059576`*^9}, {3.5575719154316587`*^9, 
   3.5575719168221416`*^9}, {3.5575721401273975`*^9, 3.5575721421896863`*^9}, 
   3.55757220933906*^9, {3.5575724774209805`*^9, 3.5575725008717036`*^9}, {
   3.557626691055966*^9, 3.5576267176804547`*^9}, {3.557626969331873*^9, 
   3.557626973659915*^9}, {3.557627042299222*^9, 3.5576270447210503`*^9}, {
   3.557627109719803*^9, 3.5576271148759537`*^9}, 3.5576271578282537`*^9, {
   3.557627273341661*^9, 3.557627280372776*^9}, {3.557630518951219*^9, 
   3.5576305216386676`*^9}, {3.5576321777805147`*^9, 3.557632225604949*^9}, {
   3.5576323217197056`*^9, 3.5576323571599274`*^9}, {3.5576323881623077`*^9, 
   3.5576324217117596`*^9}, {3.5576324742157917`*^9, 
   3.5576325046400027`*^9}, {3.5576326902893953`*^9, 3.557632720899162*^9}, {
   3.5576337630626626`*^9, 3.5576337693750415`*^9}, {3.557633888669626*^9, 
   3.5576338918883142`*^9}, {3.5576340539164534`*^9, 3.557634056885146*^9}, {
   3.5576341362742467`*^9, 3.5576341395554338`*^9}, {3.557634196101223*^9, 
   3.557634198241807*^9}, {3.557634322239426*^9, 3.557634325004998*^9}, 
   3.5576343597699556`*^9, {3.55763447125219*^9, 3.557634481189499*^9}, {
   3.557634555219328*^9, 3.557634564625397*^9}, {3.557635005945049*^9, 
   3.5576350066481605`*^9}, {3.557635138270633*^9, 3.5576351461611066`*^9}, {
   3.5576359743639545`*^9, 3.557635978035759*^9}, {3.557636048003166*^9, 
   3.5576360593310733`*^9}, {3.5576361445794363`*^9, 
   3.5576361469075165`*^9}, {3.5576362568272815`*^9, 3.5576362716707463`*^9}, 
   3.557636672788045*^9, {3.5576367388336515`*^9, 3.5576367439585533`*^9}, {
   3.557637123951257*^9, 3.557637126169965*^9}, {3.5576375437713213`*^9, 
   3.557637546240024*^9}, {3.5576377318927097`*^9, 3.557637734111417*^9}, {
   3.5576465357649145`*^9, 3.557646539212537*^9}, 3.5576507033155284`*^9, {
   3.557650744330366*^9, 3.5576507671736774`*^9}, {3.5576508465471535`*^9, 
   3.557650857765688*^9}, 3.5576511140888915`*^9, {3.5576525258117857`*^9, 
   3.557652526155529*^9}, {3.557714566827818*^9, 3.557714577872618*^9}, {
   3.5577146201174183`*^9, 3.557714632223018*^9}, {3.5577147425774183`*^9, 
   3.5577147451202183`*^9}, {3.557714890621418*^9, 3.557714891214218*^9}, {
   3.5577180876443863`*^9, 3.5577180886287737`*^9}, {3.5605886052435617`*^9, 
   3.560588606212262*^9}, {3.5679313217857804`*^9, 3.5679313484057803`*^9}, {
   3.5679314600557804`*^9, 3.5679314776757803`*^9}, {3.5703543984570627`*^9, 
   3.5703544181872597`*^9}, {3.570354729810376*^9, 3.570354752360602*^9}, {
   3.570354836111439*^9, 3.570354839511473*^9}, 3.570354976112839*^9, {
   3.570355214365222*^9, 3.5703552483755617`*^9}, {3.5703552877059555`*^9, 
   3.570355291575994*^9}, 3.570355514808226*^9, {3.570428960869588*^9, 
   3.5704289640695877`*^9}, {3.570448290980173*^9, 3.570448295750221*^9}, {
   3.575954474241739*^9, 3.575954474366539*^9}, {3.5762138646971397`*^9, 
   3.57621386563314*^9}, {3.5840786440271935`*^9, 3.584078648187152*^9}, {
   3.6126037369873247`*^9, 3.612603737330536*^9}, {3.612604553468014*^9, 
   3.612604555386777*^9}, {3.6126048115592585`*^9, 3.612604864026722*^9}, {
   3.622356840828437*^9, 3.622356889017313*^9}, {3.622357002867224*^9, 
   3.6223570166733847`*^9}, 3.6223573785969534`*^9, 3.6223574908556147`*^9, {
   3.622357656232837*^9, 3.622357676341442*^9}, 3.622357832717369*^9, {
   3.6223578816706505`*^9, 3.622357883199463*^9}, {3.6223579453036723`*^9, 
   3.622357947440893*^9}, 3.6225203612143326`*^9, {3.6225214598727646`*^9, 
   3.622521461849013*^9}, 3.622522043247192*^9, 3.6225220965350823`*^9, {
   3.6225224802876587`*^9, 3.622522481087761*^9}, {3.6230447105073595`*^9, 
   3.6230447107569656`*^9}, {3.62357911916355*^9, 3.623579119522352*^9}, 
   3.62357924163935*^9, 3.623644486686559*^9, {3.6236677996223793`*^9, 
   3.6236678742839794`*^9}, 3.6236685463563905`*^9, {3.623670174327193*^9, 
   3.623670202251193*^9}, {3.623670257771593*^9, 3.623670260532793*^9}, {
   3.6236703323863926`*^9, 3.623670334336393*^9}, 3.623670632842393*^9, {
   3.623673063601593*^9, 3.6236730638355927`*^9}, {3.6236731815063925`*^9, 
   3.6236731850007925`*^9}, {3.623673243095193*^9, 3.6236732449359927`*^9}, 
   3.6236732784291925`*^9, {3.623673338847993*^9, 3.623673340969593*^9}, {
   3.6237383982657175`*^9, 3.623738408702184*^9}, {3.623745235420784*^9, 
   3.6237452415048227`*^9}, {3.623745304872429*^9, 3.6237453059020357`*^9}, 
   3.623750607863533*^9, 3.623995848391819*^9, {3.623996969889862*^9, 
   3.623996975115896*^9}, {3.624017686419666*^9, 3.6240177146090465`*^9}, {
   3.62409977824151*^9, 3.6240997856671576`*^9}, {3.6240998311258492`*^9, 
   3.6240998340742683`*^9}, {3.624099886163002*^9, 3.624099887582611*^9}, {
   3.6241044277541976`*^9, 3.624104429095806*^9}, {3.6266696504897857`*^9, 
   3.6266696755281973`*^9}, {3.6271178546922235`*^9, 3.6271178583270473`*^9}, 
   3.627118098552987*^9, {3.633342128387889*^9, 3.633342333851183*^9}, {
   3.6333424354341044`*^9, 3.6333425338940363`*^9}, {3.6333425711955595`*^9, 
   3.6333427201930695`*^9}, {3.6333428607976723`*^9, 3.6333428610940757`*^9}, 
   3.6333430499788885`*^9, {3.6333456955168905`*^9, 3.6333457036599865`*^9}, 
   3.633345756824105*^9, {3.6333460283294277`*^9, 3.6333460287350225`*^9}, {
   3.633349289360135*^9, 3.633349348483592*^9}, {3.6334083972007313`*^9, 
   3.6334085894838657`*^9}, {3.633408620449469*^9, 3.6334086935969315`*^9}, {
   3.633409691716938*^9, 3.6334096921693325`*^9}, 3.633409777890233*^9, {
   3.633409810259818*^9, 3.633409819728897*^9}, 3.6334100567990575`*^9, {
   3.633413750519538*^9, 3.633413783856311*^9}, {3.6334139024647985`*^9, 
   3.6334139037439823`*^9}, {3.6334152270403466`*^9, 3.633415273287453*^9}, 
   3.6334158101950235`*^9, 3.633415898959423*^9, 3.6334169880716333`*^9, 
   3.633417928770773*^9, 3.633418717909867*^9, 3.633419181899639*^9, 
   3.6334307836883607`*^9, {3.6334309401543546`*^9, 3.6334309513238115`*^9}, {
   3.6334309974056206`*^9, 3.6334310052055206`*^9}, {3.6337543117488484`*^9, 
   3.633754312279248*^9}, 3.753905661797028*^9, 3.754519613597295*^9, 
   3.757519818553207*^9, 3.7576893662807503`*^9, 3.784991427694787*^9, 
   3.841277471661981*^9, {3.8735676511985188`*^9, 
   3.8735676513379*^9}},ExpressionUUID->"233769b9-a04a-4b26-958f-\
78fda9491e0f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Code section", "Title",
 CellChangeTimes->{{3.522743861579023*^9, 
  3.5227438651399956`*^9}},ExpressionUUID->"4c9465e2-421e-4a32-ad95-\
16433b225dae"],

Cell[CellGroupData[{

Cell["Version dependent code ", "Section",
 CellChangeTimes->{{3.594548299931346*^9, 
  3.5945483034471574`*^9}},ExpressionUUID->"311cfcb9-312f-4203-ad32-\
f621a8f54336"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DoNothing", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<Version \>\"", ",", "$VersionNumber", ",", 
       "\"\<->Doing Nothing\>\""}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BroadCast", " ", "=", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"$VersionNumber", ">", "7"}], ",", "DistributeDefinitions", ",", 
     "DoNothing"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TableParallel", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"$VersionNumber", ">", "7"}], ",", "ParallelTable", ",", 
     "Table"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapParallel", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"$VersionNumber", ">", "7"}], ",", "ParallelMap", ",", "Map"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SumParallel", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"$VersionNumber", ">", "7"}], ",", "ParallelSum", ",", "Sum"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AddLegend", "[", "leg_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"expr", ",", "\[IndentingNewLine]", 
      RowBox[{"verb", " ", "=", " ", 
       RowBox[{"pVERBOSE", "/.", "InputParam"}]}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"expr", " ", "=", " ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"TrueQ", "[", 
         RowBox[{"$VersionNumber", ">", "8"}], "]"}], ",", 
        RowBox[{
         RowBox[{"PrintForm", "[", "\"\<Version 8+, PlotLegends\>\"", "]"}], 
         ";", 
         RowBox[{"{", 
          RowBox[{"PlotLegends", "\[Rule]", "leg"}], "}"}]}], ",", 
        RowBox[{
         RowBox[{
         "PrintForm", "[", 
          "\"\<Version <= 8, PlotLegend, LegendPosition, LegendShadow\>\"", 
          "]"}], ";", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"PlotLegend", "\[Rule]", "leg"}], ",", 
           RowBox[{"LegendPosition", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"1.1", ",", 
              RowBox[{"-", "0.4"}]}], "}"}]}], ",", 
           RowBox[{"LegendShadow", "\[Rule]", "False"}]}], "}"}]}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "[", 
        RowBox[{"verb", " ", ">", "2"}], "]"}], ",", 
       RowBox[{"Print", "[", "expr", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Sequence", "@@", "expr"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5945483139477053`*^9, 3.5945483679192705`*^9}, {
   3.5945483996709275`*^9, 3.594548433672702*^9}, {3.594548560148593*^9, 
   3.594548572414858*^9}, {3.594548620495488*^9, 3.5945486344805975`*^9}, 
   3.5945487185318527`*^9, {3.5945488135211864`*^9, 3.5945488141305943`*^9}, {
   3.6271995461245556`*^9, 3.6271995463897552`*^9}, {3.627199716859366*^9, 
   3.627199727997837*^9}, {3.6271999522112837`*^9, 3.6272000173573017`*^9}, {
   3.6334299766352997`*^9, 3.633430011407254*^9}, {3.63386826070063*^9, 
   3.633868261026699*^9}, {3.633924078629795*^9, 3.633924110450659*^9}},
 CellLabel->
  "In[698]:=",ExpressionUUID->"e8f0d03e-dca1-4443-b6ae-21d6048623a4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Handy functions Constants", "Section",
 CellChangeTimes->{{3.497172418639724*^9, 3.497172423530161*^9}, {
  3.5575630167509346`*^9, 
  3.557563021563281*^9}},ExpressionUUID->"588498bc-edff-4eac-a123-\
ad4bcd3e0e40"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"KBoltz", " ", "=", " ", "8.6183395755305871*^-5"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Boltzmann", " ", 
    RowBox[{"eV", "/", "K"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tolenscale", "=", "1*^6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e0", "=", "1.602*^-19"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PStandard", " ", "=", " ", "1.0"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.589529468893495*^9, 3.589529489222925*^9}, {
  3.5895378203684235`*^9, 3.5895378276873703`*^9}},
 CellLabel->
  "In[704]:=",ExpressionUUID->"8c7d260b-a2cb-4fb9-badb-cab86184867d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BMFunc", "[", 
    RowBox[{
    "x_", ",", "StepPos_", ",", "Steepnes_", ",", "LeftConc_", ",", 
     "RightConc_"}], "]"}], ":=", 
   RowBox[{"RightConc", "+", 
    FractionBox[
     RowBox[{"LeftConc", "-", "RightConc"}], 
     RowBox[{"1", "+", 
      RowBox[{"Exp", "[", 
       FractionBox[
        RowBox[{"x", "-", "StepPos"}], "Steepnes"], "]"}]}]]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BMFuncTanh", "[", 
   RowBox[{
   "x_", ",", "StepPos_", ",", "Steepnes_", ",", "LeftConc_", ",", 
    "RightConc_"}], "]"}], ":=", 
  RowBox[{"LeftConc", "+", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"RightConc", "-", "LeftConc"}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"1", "/", "2"}], "+", 
      RowBox[{
       RowBox[{"1", "/", "2"}], "*", 
       RowBox[{"(", 
        RowBox[{"Tanh", "[", 
         RowBox[{"Steepnes", "*", 
          RowBox[{"(", 
           RowBox[{"x", "-", "StepPos"}], ")"}]}], "]"}], ")"}]}]}], 
     ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ArrFunc", "[", 
    RowBox[{"Temp_", ",", "nu_", ",", "EAct_"}], "]"}], ":=", 
   RowBox[{"nu", "*", 
    RowBox[{"Exp", "[", 
     FractionBox[
      RowBox[{"-", "EAct"}], 
      RowBox[{"KBoltz", "*", "Temp"}]], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CutOff", "[", 
    RowBox[{"x_", ",", "x0_", ",", "alpha_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "2"}], "-", 
    RowBox[{
     RowBox[{"1", "/", "2"}], "*", 
     RowBox[{"(", 
      RowBox[{"Tanh", "[", 
       RowBox[{"alpha", "*", 
        RowBox[{"(", 
         RowBox[{"x", "-", "x0"}], ")"}]}], "]"}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TurnOn", "[", 
    RowBox[{"x_", ",", "x0_", ",", "alpha_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "2"}], "+", 
    RowBox[{
     RowBox[{"1", "/", "2"}], "*", 
     RowBox[{"(", 
      RowBox[{"Tanh", "[", 
       RowBox[{"alpha", "*", 
        RowBox[{"(", 
         RowBox[{"x", "-", "x0"}], ")"}]}], "]"}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GaussFunc", "[", 
   RowBox[{"x_", ",", "Center_", ",", "Width_", ",", "MaxConc_"}], "]"}], ":=", 
  RowBox[{"MaxConc", "*", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x", "-", "Center"}], ")"}], "2"], 
      SuperscriptBox["Width", "2"]]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalizedGauss", "[", 
    RowBox[{"x_", ",", "center_", ",", "width_", ",", "area_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["area", 
     RowBox[{"width", 
      SqrtBox[
       RowBox[{"2", "*", "\[Pi]"}]]}]], "*", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox[
         RowBox[{"x", "-", "center"}], "width"], ")"}], "2"]}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpSat", "[", 
   RowBox[{"aa_", ",", "bb_", ",", "tvar_"}], "]"}], ":=", 
  RowBox[{"aa", "*", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "bb"}], "*", "tvar"}], "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConstFuncofx", "[", "Val_", "]"}], ":=", 
   RowBox[{"Return", "[", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "x", "}"}], ",", "Val"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SinFuncofx", "[", "Val_", "]"}], ":=", 
   RowBox[{"Return", "[", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "x", "}"}], ",", 
      RowBox[{"Val", "*", 
       RowBox[{"Sin", "[", 
        RowBox[{"Pi", "*", 
         RowBox[{"x", "/", "10"}]}], "]"}]}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConstFuncofxandt", "[", "Val_", "]"}], ":=", 
   RowBox[{"Return", "[", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "t"}], "}"}], ",", "Val"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ShowStatus", "[", "status_", "]"}], ":=", 
   RowBox[{"LinkWrite", "[", 
    RowBox[{"$ParentLink", ",", 
     RowBox[{"SetNotebookStatusLine", "[", 
      RowBox[{
       RowBox[{"FrontEnd`EvaluationNotebook", "[", "]"}], ",", 
       RowBox[{"ToString", "[", "status", "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"Init", ",", "tau"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExpDecFunc", "[", "t_", "]"}], ":=", 
   RowBox[{"base", "+", 
    RowBox[{"Init", "*", 
     RowBox[{"Exp", "[", 
      FractionBox[
       RowBox[{"-", "t"}], "tau"], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LinearRamp", "[", 
    RowBox[{"t_", ",", "T0_", ",", "Ramp_"}], "]"}], ":=", 
   RowBox[{"T0", "+", 
    RowBox[{"Ramp", "*", "t"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ListIntegrate", "[", "list_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"xvec", ",", "\[IndentingNewLine]", "yvec"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"xvec", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"list", ",", "i", ",", "1"}], "]"}], "-", 
         RowBox[{"Part", "[", 
          RowBox[{"list", ",", 
           RowBox[{"i", "-", "1"}], ",", "1"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", 
          RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"yvec", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"list", ",", "i", ",", "2"}], "]"}], "+", 
         RowBox[{"Part", "[", 
          RowBox[{"list", ",", 
           RowBox[{"i", "-", "1"}], ",", "2"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", 
          RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"0.5", "*", 
      RowBox[{"Total", "[", 
       RowBox[{"xvec", "*", "yvec"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LintM", "[", "data_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", "xval", "\[IndentingNewLine]", "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xval", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"First", "[", "#", "]"}], "&"}], ",", "data"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{"data", ",", 
           RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "x", 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"Min", "[", "xval", "]"}], ",", 
          RowBox[{"Max", "[", "xval", "]"}]}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Interpolation2D", "[", "xytable_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "maxx", ",", "\[IndentingNewLine]", "minx", ",", "\[IndentingNewLine]", 
      "intfunc"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxx", ",", "minx"}], "}"}], "=", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xdata", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", "xytable"}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Max", "[", "xdata", "]"}], ",", 
          RowBox[{"Min", "[", "xdata", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"intfunc", "=", 
      RowBox[{"Interpolation", "[", "xytable", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"x", ",", "_Real"}], "}"}], "}"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x", "\[GreaterEqual]", "minx"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"x", "\[LessEqual]", " ", "maxx"}], ")"}]}], ",", 
          RowBox[{"intfunc", "[", "x", "]"}], ",", "0"}], "]"}]}], "]"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x", "\[GreaterEqual]", "minx"}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{"x", "\[LessEqual]", " ", "maxx"}], ")"}]}], ",", 
         RowBox[{"intfunc", "[", "x", "]"}], ",", "0"}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MBarToPa", "[", "Pmbar_", "]"}], ":=", 
  RowBox[{"Pmbar", "*", "1*^2"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PressureToFlux", "[", 
   RowBox[{"PressPa_", ",", "TinK_", ",", "MassAmu_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"AMU", " ", "=", " ", "1.66053*^-27"}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    FractionBox["PressPa", 
     SqrtBox[
      RowBox[{
      "2", "*", "\[Pi]", "*", "MassAmu", "*", "AMU", "*", "e0", "*", "KBoltz",
        "*", "TinK"}]]]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "GetParameter", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"DEFAULT", "\[Rule]", "1.0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetParameter", "[", 
   RowBox[{"Parname_", ",", "RepRule_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "repres", ",", "\[IndentingNewLine]", "result", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"def", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "DEFAULT", "]"}]}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Clear", "[", "Parname", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"repres", " ", "=", 
      RowBox[{"Evaluate", "[", " ", 
       RowBox[{"Parname", "/.", "RepRule"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"TrueQ", "[", 
         RowBox[{"repres", " ", "\[Equal]", " ", "Parname"}], "]"}], ",", " ",
         "def", ",", "repres"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "result", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ChangeInputPar", "[", 
   RowBox[{"parname_", ",", "newvalue_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"idx", " ", "=", 
       RowBox[{"First", "[", 
        RowBox[{"Position", "[", 
         RowBox[{"InputParam", ",", "parname"}], "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", "curvalue"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"curvalue", " ", "=", 
      RowBox[{"Part", "[", 
       RowBox[{"InputParam", ",", 
        RowBox[{"idx", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Dimensions", "[", "curvalue", "]"}], "\[NotEqual]", " ", 
        RowBox[{"Dimensions", "[", "newvalue", "]"}]}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<ChangeInputPar->(@\>\"", ",", 
         RowBox[{"SymbolName", "[", "parname", "]"}], ",", 
         "\"\<) Warning new parameter (\>\"", ",", "newvalue", ",", 
         "\"\<) has different dimensions than old parameter(\>\"", ",", 
         "curvalue", ",", "\"\<)\>\""}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Part", "[", 
       RowBox[{"InputParam", ",", 
        RowBox[{"idx", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "=", 
      RowBox[{"parname", "->", "newvalue"}]}], ";"}]}], "\[IndentingNewLine]",
    "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4972487781421485`*^9, 3.4972487783765144`*^9}, {
   3.4983839876280365`*^9, 3.4983840316115675`*^9}, 3.4983841049851584`*^9, 
   3.4983841366408005`*^9, {3.5045923083375854`*^9, 3.504592308946988*^9}, {
   3.504602332523282*^9, 3.504602338382882*^9}, {3.504602377259375*^9, 
   3.504602398291433*^9}, {3.5046134794730043`*^9, 3.5046134950362015`*^9}, {
   3.5048640343935204`*^9, 3.50486403462817*^9}, {3.5048640766773605`*^9, 
   3.50486408127649*^9}, {3.5048645662367916`*^9, 3.504864568674229*^9}, {
   3.5048795902456646`*^9, 3.5048795905738087`*^9}, {3.5073675385225997`*^9, 
   3.5073675529764643`*^9}, {3.5226695247662024`*^9, 
   3.5226695605837793`*^9}, {3.54026970979179*^9, 3.540269710357314*^9}, {
   3.540529715966383*^9, 3.540529732060339*^9}, {3.5575615792989063`*^9, 
   3.557561615090741*^9}, {3.5575621381060863`*^9, 3.5575622531315937`*^9}, {
   3.5575623086649265`*^9, 3.5575623141415863`*^9}, {3.5575630257662716`*^9, 
   3.5575630265006227`*^9}, {3.56793112141578*^9, 3.5679311216757803`*^9}, {
   3.570355107964158*^9, 3.570355111084189*^9}, {3.584089574734699*^9, 
   3.5840895978442097`*^9}, {3.622450534361451*^9, 3.6224505355003047`*^9}, 
   3.6235682399179773`*^9, {3.623568539771576*^9, 3.623568540065605*^9}, {
   3.6240156261192846`*^9, 3.6240156443651094`*^9}, {3.62401738756855*^9, 
   3.624017392404581*^9}, {3.624017465132247*^9, 3.624017492541623*^9}, 
   3.624017649837431*^9, {3.6246888443264093`*^9, 3.624688848195234*^9}, 
   3.6247046152418504`*^9, {3.6271180281341352`*^9, 3.6271180295849447`*^9}, {
   3.6307470364321103`*^9, 3.6307470518610306`*^9}, {3.6337541009616485`*^9, 
   3.6337541330508485`*^9}, {3.7539072604968653`*^9, 3.753907279310553*^9}, {
   3.7542558034340153`*^9, 3.754255806132545*^9}, 3.808674534979554*^9, {
   3.840826310174951*^9, 3.840826360035049*^9}, {3.840826392717626*^9, 
   3.8408264092584867`*^9}, {3.84082649376486*^9, 3.8408264982405043`*^9}, {
   3.8408265786095133`*^9, 3.840826579003151*^9}},
 CellLabel->
  "In[708]:=",ExpressionUUID->"c5780e2e-bd38-4cf6-b22f-b486d36eeceb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Temperature functions", "Section",
 CellChangeTimes->{{3.4967397354239626`*^9, 3.496739740173476*^9}, {
  3.5020143875148773`*^9, 
  3.5020143896867385`*^9}},ExpressionUUID->"f88c44b5-2796-4aeb-a19d-\
e2f6fc7ea113"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "LoadTempRampOfTime", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"NumDrop", "\[Rule]", "2"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LoadTempRampOfTime", "[", 
   RowBox[{"fname_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"B", "\[IndentingNewLine]", "dummydata"}], " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "300"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"750", ",", "1200"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"800", ",", "1200"}], "}"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ndrop", "=", 
       RowBox[{"OptionValue", "[", "NumDrop", "]"}]}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<LoadTempRampOfTime()->Dropping \>\"", ",", " ", "ndrop", ",", " ", 
       "\"\< header entries\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "[", "fname", "]"}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<File found loading from \>\"", ",", "fname"}], "]"}], 
        ";", 
        RowBox[{"Drop", "[", 
         RowBox[{
          RowBox[{"Import", "[", 
           RowBox[{"fname", ",", "\"\<Table\>\""}], "]"}], ",", "ndrop"}], 
         "]"}]}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<File NOT found using dummy data\>\"", "]"}], ";", 
        "\[IndentingNewLine]", "dummydata"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4967397947147655`*^9, 3.496739826195917*^9}, {
   3.496739875581484*^9, 3.4967398759564457`*^9}, {3.4967399287947845`*^9, 
   3.496740019613609*^9}, {3.4967401704106655`*^9, 3.4967402149998493`*^9}, {
   3.4971674081468353`*^9, 3.497167419490731*^9}, {3.5020148285276794`*^9, 
   3.5020149288239126`*^9}, {3.5020149613550434`*^9, 3.5020150101675434`*^9}, 
   3.5020150664175434`*^9, {3.5020151428550434`*^9, 3.5020151755581684`*^9}, {
   3.5020152068394184`*^9, 3.5020152094019184`*^9}, {3.5048636426240034`*^9, 
   3.5048636600360394`*^9}, {3.504863748334341*^9, 3.5048637684577026`*^9}, {
   3.504863872047353*^9, 3.504863951937686*^9}, {3.5048640225515423`*^9, 
   3.50486409823094*^9}, {3.504864573611603*^9, 3.5048646105794067`*^9}, {
   3.507527284306984*^9, 3.507527308026948*^9}, {3.507527371014548*^9, 
   3.5075273752960167`*^9}, {3.523259527589142*^9, 3.523259528057325*^9}, 
   3.5232611232018995`*^9, {3.5232612039063435`*^9, 3.523261204437502*^9}, {
   3.529749504685154*^9, 3.529749600949547*^9}, {3.529749640620914*^9, 
   3.5297496413709044`*^9}, 3.529749827868517*^9, {3.570355101664095*^9, 
   3.5703551430345087`*^9}, {3.622868709386141*^9, 3.622868808080838*^9}, {
   3.622868845708471*^9, 3.6228689462360697`*^9}, {3.6228690218969364`*^9, 
   3.6228690650001955`*^9}, {3.6228691231427565`*^9, 
   3.6228691518464427`*^9}, {3.622869966028557*^9, 3.622869982970354*^9}, {
   3.622870063139676*^9, 3.6228701288788395`*^9}, {3.6228702180026593`*^9, 
   3.6228702190790715`*^9}, {3.6228703363144236`*^9, 3.622870373240048*^9}, {
   3.6228726241433344`*^9, 3.6228727846847444`*^9}, {3.623037228374938*^9, 
   3.6230372408706217`*^9}, {3.6230416049133987`*^9, 3.623041645785982*^9}, {
   3.6333428025153246`*^9, 3.6333430177804885`*^9}, {3.6333431734527426`*^9, 
   3.633343211251058*^9}, {3.6333432516701393`*^9, 3.6333432545717025`*^9}, {
   3.63334329765835*^9, 3.6333433078606195`*^9}, {3.633343344379751*^9, 
   3.633343355159213*^9}, 3.633344498754565*^9, 3.783194447947098*^9},
 CellLabel->
  "In[731]:=",ExpressionUUID->"3f55507c-594e-4213-b3d9-e4f323c65fed"],

Cell["\<\
pTempFuncParam -> {
  pT0 -> 473,(*Constant temperature*)
  pRamp -> 1,(*Ramp rate K/s*)
  pTMax -> 1200(*Max temperature*)
  }\
\>", "Program",
 CellChangeTimes->{{3.6333445205805035`*^9, 
  3.633344528225043*^9}},ExpressionUUID->"a76bc807-bd11-403f-9d52-\
f81c42140b15"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RampTempFuncOfTime", "[", 
   RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"tempfunc", ",", "\[IndentingNewLine]", 
      RowBox[{"TempFuncParam", " ", "=", " ", 
       RowBox[{"pTempFuncParam", "/.", "InputParam"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"verb", " ", "=", " ", 
       RowBox[{"pVERBOSE", "/.", "InputParam"}]}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"tempfunc", "=", 
       RowBox[{
        RowBox[{"LinearRamp", "[", 
         RowBox[{"t", ",", "pT0", ",", "pRamp"}], "]"}], "/.", 
        "TempFuncParam"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verb", "\[GreaterEqual]", " ", "3"}], ",", 
        RowBox[{"Print", "[", "\[IndentingNewLine]", 
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"RecLimEffBndCond", "\[IndentingNewLine]", "tmax"}], 
              " ", "=", " ", 
              RowBox[{"pTMax", "/.", "TempFuncParam"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"t0", " ", "=", " ", 
              RowBox[{"pT0", "/.", "TempFuncParam"}]}]}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Plot", "[", 
            RowBox[{"tempfunc", ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", "t0", ",", "tmax"}], "}"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "t"}], "}"}], ",", "tempfunc"}], "]"}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"pT0", "+", 
       RowBox[{"pRamp", "*", "t"}]}], ")"}], "/.", 
     RowBox[{"(", 
      RowBox[{"pTempFuncParam", "/.", "InputParam"}], ")"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ManualTempTDS", "[", 
   RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TempFuncParam", " ", "=", " ", 
       RowBox[{"pTempFuncParam", "/.", "InputParam"}]}], ",", 
      "\[IndentingNewLine]", "step1", ",", "\[IndentingNewLine]", "step2", 
      ",", "\[IndentingNewLine]", "step3", ",", "\[IndentingNewLine]", 
      "step4", ",", "\[IndentingNewLine]", "step5", ",", 
      "\[IndentingNewLine]", "step6", ",", "\[IndentingNewLine]", "step7", 
      ",", "\[IndentingNewLine]", "step8", ",", "\[IndentingNewLine]", 
      "pexp"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pexp", "=", 
      RowBox[{"pExp", "/.", "TempFuncParam"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"step1", "=", 
      RowBox[{"pInter", "/.", "TempFuncParam"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"step2", "=", 
      RowBox[{"pexp", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"step3", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"pexp", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}], "+", 
        RowBox[{"0.3", "*", 
         RowBox[{"(", 
          RowBox[{"t", "-", 
           RowBox[{"pexp", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], "-", "3000"}], 
          ")"}]}]}], ")"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Piecewise", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"step1", "[", "t", "]"}], "+", "273"}], ",", 
           RowBox[{"0", "\[LessEqual]", "t", "<", 
            RowBox[{"pexp", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"step2", "+", "273"}], ",", 
           RowBox[{
            RowBox[{"pexp", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], "\[LessEqual]", 
            "t", "<", 
            RowBox[{
             RowBox[{"pexp", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], "+", 
             "3000"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"step3", "+", "273"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"pexp", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], "+", "3000"}], 
            "\[LessEqual]", "t"}]}], "}"}]}], "}"}], "]"}], "/.", 
      "TempFuncParam"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ManualTempTDSPlasmaAnneal", "[", 
   RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TempFuncParam", " ", "=", " ", 
       RowBox[{"pTempFuncParam", "/.", "InputParam"}]}], ",", 
      "\[IndentingNewLine]", "step1", ",", "\[IndentingNewLine]", "step2", 
      ",", "\[IndentingNewLine]", "step3", ",", "\[IndentingNewLine]", 
      "step4", ",", "\[IndentingNewLine]", "step5", ",", 
      "\[IndentingNewLine]", "step6", ",", "\[IndentingNewLine]", "step7", 
      ",", "\[IndentingNewLine]", "step8", ",", "\[IndentingNewLine]", 
      "step9", ",", "\[IndentingNewLine]", "step10"}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"step1", "=", 
      RowBox[{"383", "/.", "TempFuncParam"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"step2", "=", 
      RowBox[{"383", "+", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"473", "-", "383"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"12", "*", "60"}], ")"}]}], "*", 
        RowBox[{"(", 
         RowBox[{"t", "-", "9000"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"step3", "=", "473"}], ";", "\[IndentingNewLine]", 
     RowBox[{"step4", "=", 
      RowBox[{
       RowBox[{"473", "-", 
        RowBox[{"1", "*", 
         RowBox[{"(", 
          RowBox[{"t", "-", 
           RowBox[{"(", 
            RowBox[{"9000", "+", 
             RowBox[{"12", "*", "60"}], "+", "3600"}], ")"}]}], ")"}]}]}], "/.",
        "TempFuncParam"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"step5", "=", 
      RowBox[{"300", "/.", "TempFuncParam"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"step6", "=", 
      RowBox[{
       RowBox[{"300", "+", 
        RowBox[{"0.5", "*", 
         RowBox[{"(", 
          RowBox[{"t", "-", 
           RowBox[{"(", 
            RowBox[{"9000", "+", 
             RowBox[{"12", "*", "60"}], "+", "3600", "+", "173", "+", "300"}],
             ")"}]}], ")"}]}]}], "/.", "TempFuncParam"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"step7", "=", 
      RowBox[{"383", "/.", "TempFuncParam"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"step8", "=", 
      RowBox[{
       RowBox[{"383", "-", 
        RowBox[{"0.5", "*", 
         RowBox[{"(", 
          RowBox[{"t", "-", 
           RowBox[{"(", 
            RowBox[{"9000", "+", 
             RowBox[{"12", "*", "60"}], "+", "3600", "+", "173", "+", "300", 
             "+", "166", "+", "18480"}], ")"}]}], ")"}]}]}], "/.", 
       "TempFuncParam"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"step9", "=", 
      RowBox[{"300", "/.", "TempFuncParam"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"step10", "=", 
      RowBox[{
       RowBox[{"300", "+", 
        RowBox[{"0.05", "*", 
         RowBox[{"(", 
          RowBox[{"t", "-", 
           RowBox[{"(", 
            RowBox[{"9000", "+", 
             RowBox[{"12", "*", "60"}], "+", "3600", "+", "173", "+", "300", 
             "+", "166", "+", "18480", "+", "166", "+", "300"}], ")"}]}], 
          ")"}]}]}], "/.", "TempFuncParam"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Piecewise", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"step1", ",", 
           RowBox[{"0", "\[LessEqual]", "t", "<", "9000"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"step2", ",", 
           RowBox[{"9000", "\[LessEqual]", "t", "<", 
            RowBox[{"9000", "+", 
             RowBox[{"12", "*", "60"}]}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"step3", ",", 
           RowBox[{
            RowBox[{"9000", "+", 
             RowBox[{"12", "*", "60"}]}], "\[LessEqual]", "t", "<", 
            RowBox[{"9000", "+", 
             RowBox[{"12", "*", "60"}], "+", "3600"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"step4", ",", 
           RowBox[{
            RowBox[{"9000", "+", 
             RowBox[{"12", "*", "60"}], "+", "3600"}], "\[LessEqual]", "t", 
            "<", 
            RowBox[{"9000", "+", 
             RowBox[{"12", "*", "60"}], "+", "3600", "+", "173"}]}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"step5", ",", 
           RowBox[{
            RowBox[{"9000", "+", 
             RowBox[{"12", "*", "60"}], "+", "3600", "+", "173"}], 
            "\[LessEqual]", "t", "<", 
            RowBox[{"9000", "+", 
             RowBox[{"12", "*", "60"}], "+", "3600", "+", "173", "+", 
             "300"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"step6", ",", 
           RowBox[{
            RowBox[{"9000", "+", 
             RowBox[{"12", "*", "60"}], "+", "3600", "+", "173", "+", "300"}],
             "\[LessEqual]", "t", "<", 
            RowBox[{"9000", "+", 
             RowBox[{"12", "*", "60"}], "+", "3600", "+", "173", "+", "300", 
             "+", "166"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"step7", ",", 
           RowBox[{
            RowBox[{"9000", "+", 
             RowBox[{"12", "*", "60"}], "+", "3600", "+", "173", "+", "300", 
             "+", "166"}], "\[LessEqual]", "t", "<", 
            RowBox[{"9000", "+", 
             RowBox[{"12", "*", "60"}], "+", "3600", "+", "173", "+", "300", 
             "+", "166", "+", "18480"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"step8", ",", 
           RowBox[{
            RowBox[{"9000", "+", 
             RowBox[{"12", "*", "60"}], "+", "3600", "+", "173", "+", "300", 
             "+", "166", "+", "18480"}], "\[LessEqual]", "t", "<", 
            RowBox[{"9000", "+", 
             RowBox[{"12", "*", "60"}], "+", "3600", "+", "173", "+", "300", 
             "+", "166", "+", "18480", "+", "166"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"step9", ",", 
           RowBox[{
            RowBox[{"9000", "+", 
             RowBox[{"12", "*", "60"}], "+", "3600", "+", "173", "+", "300", 
             "+", "166", "+", "18480", "+", "166"}], "\[LessEqual]", "t", "<", 
            RowBox[{"9000", "+", 
             RowBox[{"12", "*", "60"}], "+", "3600", "+", "173", "+", "300", 
             "+", "166", "+", "18480", "+", "166", "+", "300"}]}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"step10", ",", 
           RowBox[{
            RowBox[{"9000", "+", 
             RowBox[{"12", "*", "60"}], "+", "3600", "+", "173", "+", "300", 
             "+", "166", "+", "18480", "+", "166", "+", "300"}], 
            "\[LessEqual]", "t"}]}], "}"}]}], "}"}], "]"}], "/.", 
      "TempFuncParam"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ManualTempLIDS", "[", 
   RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TempFuncParam", " ", "=", " ", 
       RowBox[{"pTempFuncParam", "/.", "InputParam"}]}], ",", 
      "\[IndentingNewLine]", "step1", ",", "\[IndentingNewLine]", "step2", 
      ",", "\[IndentingNewLine]", "step3"}], "\[IndentingNewLine]", "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"step1", "=", 
      RowBox[{"300", "/.", "TempFuncParam"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"step2", "=", 
      RowBox[{
       RowBox[{"300", "+", 
        RowBox[{"688.424", "*", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"t", "-", "1.1"}], "]"}]}]}], "/.", "TempFuncParam"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"step3", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"300", "+", 
          RowBox[{"688.424", "*", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"2.08", "-", "1.1"}], "]"}]}]}], ")"}], "-", 
        RowBox[{"433.024", "*", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"t", "-", "2.08"}], "]"}]}]}], "/.", "TempFuncParam"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Piecewise", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"step1", ",", 
           RowBox[{"0", "\[LessEqual]", "t", "<", "1.1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"step2", ",", 
           RowBox[{"1.1", "\[LessEqual]", "t", "<", "2.08"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"step3", ",", 
           RowBox[{"2.08", "\[LessEqual]", "t"}]}], "}"}]}], "}"}], "]"}], "/.",
       "TempFuncParam"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ManualTemp", "[", 
   RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TempFuncParam", " ", "=", " ", 
       RowBox[{"pTempFuncParam", "/.", "InputParam"}]}], ",", 
      "\[IndentingNewLine]", "step1", ",", "\[IndentingNewLine]", "step2", 
      ",", "\[IndentingNewLine]", "step3", ",", "\[IndentingNewLine]", 
      "step4"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"step1", "=", 
      RowBox[{"pT1", "/.", "TempFuncParam"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"step2", "=", 
      RowBox[{
       RowBox[{"pT1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"pT0", "-", "pT1"}], ")"}], "/", "pt2"}], "*", 
         RowBox[{"(", 
          RowBox[{"t", "-", "pt1"}], ")"}]}]}], "/.", "TempFuncParam"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"step3", "=", 
      RowBox[{
       RowBox[{"pT0", "+", 
        RowBox[{"pRamp", "*", 
         RowBox[{"(", 
          RowBox[{"t", "-", "pt1", "-", "pt2"}], ")"}]}]}], "/.", 
       "TempFuncParam"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Piecewise", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"step1", ",", 
           RowBox[{"0", "\[LessEqual]", "t", "<", "pt1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"step2", ",", 
           RowBox[{"pt1", "\[LessEqual]", "t", "<", 
            RowBox[{"pt1", "+", "pt2"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"step3", ",", 
           RowBox[{
            RowBox[{"pt1", "+", "pt2"}], "\[LessEqual]", "t"}]}], "}"}]}], 
        "}"}], "]"}], "/.", "TempFuncParam"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"step1", "=", 
      RowBox[{
       RowBox[{"pT0", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"pT1", "-", "pT0"}], ")"}], "/", "pt1"}], "*", "t"}]}], "/.",
        "TempFuncParam"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"step2", "=", 
      RowBox[{"pT1", "/.", "TempFuncParam"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"step3", "=", 
      RowBox[{
       RowBox[{"pT1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"pT0", "-", "pT1"}], ")"}], "/", "pt2"}], "*", 
         RowBox[{"(", 
          RowBox[{"t", "-", "pt1", "-", "pt2"}], ")"}]}]}], "/.", 
       "TempFuncParam"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"step4", "=", 
      RowBox[{
       RowBox[{"pT0", "+", 
        RowBox[{"pRamp", "*", 
         RowBox[{"(", 
          RowBox[{"t", "-", "pt1", "-", "pt2", "-", "pt3"}], ")"}]}]}], "/.", 
       "TempFuncParam"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Piecewise", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"step1", ",", 
           RowBox[{"0", "\[LessEqual]", "t", "<", "pt1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"step2", ",", 
           RowBox[{"pt1", "\[LessEqual]", "t", "<", 
            RowBox[{"pt1", "+", "pt2"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"step3", ",", 
           RowBox[{
            RowBox[{"pt1", "+", "pt2"}], "\[LessEqual]", "t", "<", 
            RowBox[{"pt1", "+", "pt2", "+", "pt3"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"step4", ",", 
           RowBox[{
            RowBox[{"pt1", "+", "pt2", "+", "pt3"}], "\[LessEqual]", "t"}]}], 
          "}"}]}], "}"}], "]"}], "/.", "TempFuncParam"}]}], "*)"}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ManualTemp1", "[", 
   RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TempFuncParam", " ", "=", " ", 
       RowBox[{"pTempFuncParam", "/.", "InputParam"}]}], ",", 
      "\[IndentingNewLine]", "step1", ",", "\[IndentingNewLine]", "step2", 
      ",", "\[IndentingNewLine]", "step21", ",", "\[IndentingNewLine]", 
      "step3", ",", "\[IndentingNewLine]", "step31", ",", 
      "\[IndentingNewLine]", "step4", ",", "\[IndentingNewLine]", "step5"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"step1", "=", 
      RowBox[{"pT0", "/.", "TempFuncParam"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"step2", "=", 
      RowBox[{
       RowBox[{"pT0", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"pT1", "-", "pT0"}], ")"}], "/", "pt2"}], "*", 
         RowBox[{"(", 
          RowBox[{"t", "-", "pt1"}], ")"}]}]}], "/.", "TempFuncParam"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"step21", "=", 
      RowBox[{"pT1", "/.", "TempFuncParam"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"step3", "=", 
      RowBox[{
       RowBox[{"pT1", "+", 
        RowBox[{"pRamp", "*", 
         RowBox[{"(", 
          RowBox[{"t", "-", "pt1", "-", "pt2", "-", "pt3"}], ")"}]}]}], "/.", 
       "TempFuncParam"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"step31", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"pt4", "\[NotEqual]", "0"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "pExp"}], "*", 
            RowBox[{"(", 
             RowBox[{"t", "-", "pt1", "-", "pt2", "-", "pt3", "-", "pt4"}], 
             ")"}]}], "]"}], "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"pT21", "-", "pT2"}], ")"}], "*", 
              RowBox[{"Exp", "[", 
               RowBox[{"pExp", "*", "pt41"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"pExp", "*", 
                RowBox[{"(", 
                 RowBox[{
                 "t", "-", "pt1", "-", "pt2", "-", "pt3", "-", "pt4"}], 
                 ")"}]}], "]"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "pT21"}], "+", 
                RowBox[{"pT2", "*", 
                 RowBox[{"Exp", "[", 
                  RowBox[{"pExp", "*", "pt41"}], "]"}]}]}], ")"}]}]}], ")"}], 
           "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"pExp", "*", "pt41"}], "]"}], "-", "1"}], ")"}]}]}], 
         RowBox[{"(*", 
          RowBox[{"pT2", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"pT2", "-", "pT21"}], ")"}], "*", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "pExp"}], "*", 
              RowBox[{"(", 
               RowBox[{"t", "-", "pt1", "-", "pt2", "-", "pt3", "-", "pt4"}], 
               ")"}]}], "]"}]}]}], "*)"}], "/.", "TempFuncParam"}], ",", 
        "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"step4", "=", 
      RowBox[{"pT2", "/.", "TempFuncParam"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"step5", "=", 
      RowBox[{
       RowBox[{"pT2", "+", 
        RowBox[{"pRamp", "*", 
         RowBox[{"(", 
          RowBox[{
          "t", "-", "pt1", "-", "pt2", "-", "pt3", "-", "pt4", "-", "pt41", 
           "-", "pt5"}], ")"}]}]}], "/.", "TempFuncParam"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Piecewise", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"step1", ",", 
           RowBox[{"0", "\[LessEqual]", "t", "<", "pt1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"step2", ",", 
           RowBox[{"pt1", "\[LessEqual]", "t", "<", 
            RowBox[{"pt1", "+", "pt2"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"step21", ",", 
           RowBox[{
            RowBox[{"pt1", "+", "pt2"}], "\[LessEqual]", "t", "<", 
            RowBox[{"pt1", "+", "pt2", "+", "pt3"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"step3", ",", 
           RowBox[{
            RowBox[{"pt1", "+", "pt2", "+", "pt3"}], "\[LessEqual]", "t", "<", 
            RowBox[{"pt1", "+", "pt2", "+", "pt3", "+", "pt4"}]}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"step31", ",", 
           RowBox[{
            RowBox[{"pt1", "+", "pt2", "+", "pt3", "+", "pt4"}], 
            "\[LessEqual]", "t", "<", 
            RowBox[{
            "pt1", "+", "pt2", "+", "pt3", "+", "pt4", "+", "pt41"}]}]}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"step4", ",", 
           RowBox[{
            RowBox[{"pt1", "+", "pt2", "+", "pt3", "+", "pt4", "+", "pt41"}], 
            "\[LessEqual]", "t", "<", 
            RowBox[{
            "pt1", "+", "pt2", "+", "pt3", "+", "pt4", "+", "pt41", "+", 
             "pt5"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"step5", ",", 
           RowBox[{
            RowBox[{
            "pt1", "+", "pt2", "+", "pt3", "+", "pt4", "+", "pt41", "+", 
             "pt5"}], "\[LessEqual]", "t"}]}], "}"}]}], "}"}], "]"}], "/.", 
      "TempFuncParam"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TempFromList", "[", 
   RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TempFuncParam", " ", "=", " ", 
       RowBox[{"pTempFuncParam", "/.", "InputParam"}]}], ",", 
      "\[IndentingNewLine]", "data"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"data", "=", 
      RowBox[{"filedata", "/.", "TempFuncParam"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"data", "[", "t", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4967397947147655`*^9, 3.496739826195917*^9}, {
   3.496739875581484*^9, 3.4967398759564457`*^9}, {3.4967399287947845`*^9, 
   3.496740019613609*^9}, {3.4967401704106655`*^9, 3.4967402149998493`*^9}, {
   3.4971674081468353`*^9, 3.497167419490731*^9}, {3.5020148285276794`*^9, 
   3.5020149288239126`*^9}, {3.5020149613550434`*^9, 3.5020150101675434`*^9}, 
   3.5020150664175434`*^9, {3.5020151428550434`*^9, 3.5020151755581684`*^9}, {
   3.5020152068394184`*^9, 3.5020152094019184`*^9}, {3.5048636426240034`*^9, 
   3.5048636600360394`*^9}, {3.504863748334341*^9, 3.5048637684577026`*^9}, {
   3.504863872047353*^9, 3.504863951937686*^9}, {3.5048640225515423`*^9, 
   3.50486409823094*^9}, {3.504864573611603*^9, 3.5048646105794067`*^9}, {
   3.507527284306984*^9, 3.507527308026948*^9}, {3.507527371014548*^9, 
   3.5075273752960167`*^9}, {3.523259527589142*^9, 3.523259528057325*^9}, 
   3.5232611232018995`*^9, {3.5232612039063435`*^9, 3.523261204437502*^9}, {
   3.529749504685154*^9, 3.529749600949547*^9}, {3.529749640620914*^9, 
   3.5297496413709044`*^9}, 3.529749827868517*^9, {3.570355101664095*^9, 
   3.5703551430345087`*^9}, {3.622868709386141*^9, 3.622868808080838*^9}, {
   3.622868845708471*^9, 3.6228689462360697`*^9}, {3.6228690218969364`*^9, 
   3.6228690650001955`*^9}, {3.6228691231427565`*^9, 
   3.6228691518464427`*^9}, {3.622869966028557*^9, 3.622869982970354*^9}, {
   3.622870063139676*^9, 3.6228701288788395`*^9}, {3.6228702180026593`*^9, 
   3.6228702190790715`*^9}, {3.6228703363144236`*^9, 3.622870373240048*^9}, {
   3.6228726241433344`*^9, 3.6228727846847444`*^9}, {3.623037228374938*^9, 
   3.6230372408706217`*^9}, {3.6230416049133987`*^9, 3.623041645785982*^9}, {
   3.6333428025153246`*^9, 3.6333430177804885`*^9}, {3.6333431734527426`*^9, 
   3.633343211251058*^9}, {3.6333432516701393`*^9, 3.6333432545717025`*^9}, {
   3.63334329765835*^9, 3.6333433078606195`*^9}, {3.633343344379751*^9, 
   3.633343355159213*^9}, {3.633344498754565*^9, 3.6333445042929554`*^9}, {
   3.754252568691867*^9, 3.754252571471779*^9}, 3.7542526603280497`*^9, {
   3.754253168707657*^9, 3.754253174676346*^9}, {3.754253366946869*^9, 
   3.754253376189538*^9}, {3.754253471213735*^9, 3.7542535270096407`*^9}, {
   3.754253799369692*^9, 3.7542538664788437`*^9}, {3.754416952134658*^9, 
   3.75441699381364*^9}, {3.75441754833106*^9, 3.7544175580867853`*^9}, {
   3.754417602161469*^9, 3.754417749178985*^9}, {3.754418075463912*^9, 
   3.754418122954441*^9}, {3.754418179893981*^9, 3.754418190397334*^9}, 
   3.754418654272347*^9, {3.754500484609998*^9, 3.7545005618744173`*^9}, {
   3.754519639635784*^9, 3.7545196723746567`*^9}, {3.754633181046796*^9, 
   3.754633199160026*^9}, {3.754633229508883*^9, 3.754633235539528*^9}, {
   3.754633350767508*^9, 3.7546333532634478`*^9}, {3.755454340100222*^9, 
   3.755454431479231*^9}, {3.755454509833659*^9, 3.755454533029316*^9}, {
   3.75545456968227*^9, 3.755454633033568*^9}, {3.755454747892427*^9, 
   3.755454809499345*^9}, {3.755484985520886*^9, 3.7554852225315723`*^9}, {
   3.755485483738332*^9, 3.7554855076033487`*^9}, {3.755485541207677*^9, 
   3.755485541796273*^9}, 3.755485586795472*^9, {3.755633180819243*^9, 
   3.755633376568591*^9}, {3.755634131577134*^9, 3.7556341321934347`*^9}, {
   3.75596237321276*^9, 3.755962424100878*^9}, {3.755962494915674*^9, 
   3.7559624998318157`*^9}, {3.756660233380114*^9, 3.756660237495078*^9}, {
   3.757519881412839*^9, 3.757519883101767*^9}, {3.7575199265878487`*^9, 
   3.757519929347713*^9}, {3.757520114596937*^9, 3.757520247214175*^9}, {
   3.7575203097162857`*^9, 3.757520352379189*^9}, {3.757522641479743*^9, 
   3.757522665350335*^9}, {3.757522741895565*^9, 3.757522744254498*^9}, {
   3.757522834644083*^9, 3.757522847524643*^9}, {3.757522940122493*^9, 
   3.7575230187754517`*^9}, {3.75752325134656*^9, 3.7575232834271803`*^9}, {
   3.757523317262989*^9, 3.757523340901668*^9}, {3.757528329763771*^9, 
   3.757528346829623*^9}, {3.765742700591441*^9, 3.765742720597952*^9}, {
   3.765742914777049*^9, 3.765742923736068*^9}, 3.765742970931143*^9, {
   3.765743111399747*^9, 3.76574326040969*^9}, {3.765743301729168*^9, 
   3.765743327789751*^9}, {3.76574338558107*^9, 3.765743417126914*^9}, {
   3.7657434673255167`*^9, 3.7657434696433363`*^9}, {3.7657439625425262`*^9, 
   3.7657439650793543`*^9}, {3.765744004416737*^9, 3.765744034204219*^9}, {
   3.765745568633133*^9, 3.765745574300806*^9}, 3.765745605167357*^9, 
   3.765745712228634*^9, {3.765745872087829*^9, 3.765745874659053*^9}, {
   3.7657459208530188`*^9, 3.765745922067737*^9}, {3.7657465235435963`*^9, 
   3.765746529780105*^9}, {3.7657465623734617`*^9, 3.765746565965712*^9}, {
   3.769188189222436*^9, 3.769188242049224*^9}, {3.7691883451302223`*^9, 
   3.769188346188066*^9}, {3.769188846436049*^9, 3.769188861660945*^9}, {
   3.7691889399232597`*^9, 3.7691889659095984`*^9}, {3.7691890285510483`*^9, 
   3.769189069633333*^9}, {3.769189956756947*^9, 3.769189966329973*^9}, {
   3.7691901169174833`*^9, 3.769190118854097*^9}, {3.769190239695745*^9, 
   3.769190241734367*^9}, {3.769190501386484*^9, 3.769190514238627*^9}, 
   3.783706674388317*^9, {3.84080486731425*^9, 3.8408048677722054`*^9}, {
   3.840804985710829*^9, 3.840805043091819*^9}, {3.840919691438943*^9, 
   3.840919702274531*^9}, {3.8409197771004744`*^9, 3.840919905631638*^9}, {
   3.840986608247086*^9, 3.8409866376003027`*^9}, {3.840986910597736*^9, 
   3.8409869107994747`*^9}, {3.8409873608422747`*^9, 3.84098737337531*^9}, {
   3.840987669728651*^9, 3.840987695776195*^9}, {3.842821938386221*^9, 
   3.842821938989455*^9}, {3.842822216736814*^9, 3.842822217500844*^9}, {
   3.842823103840551*^9, 3.842823104546424*^9}, {3.842823748641304*^9, 
   3.84282374883149*^9}, {3.8428788653777733`*^9, 3.842878867088348*^9}, {
   3.8428819142562447`*^9, 3.842881915699606*^9}, {3.843154256449397*^9, 
   3.8431542728213387`*^9}, {3.843159524516347*^9, 3.843159527132957*^9}, {
   3.843247646247489*^9, 3.843247651731316*^9}, {3.84324778907194*^9, 
   3.8432478190554237`*^9}, {3.843247852323773*^9, 3.843247887082259*^9}, {
   3.8432479218959827`*^9, 3.843248092772702*^9}, {3.843248545350815*^9, 
   3.843248774062204*^9}, {3.843248805345014*^9, 3.843248805885777*^9}, {
   3.843248873709276*^9, 3.84324888211307*^9}, {3.84324892663866*^9, 
   3.843248927071509*^9}, {3.873310660840516*^9, 3.873310661430895*^9}, {
   3.873310709788275*^9, 3.873310710179804*^9}, {3.873311055499094*^9, 
   3.87331110175111*^9}, {3.873651333265355*^9, 3.87365133847696*^9}, {
   3.8738948241782637`*^9, 3.873894862125881*^9}, {3.873894906952538*^9, 
   3.8738949442515373`*^9}, {3.87536797746458*^9, 3.87536811268532*^9}, {
   3.875368152109988*^9, 3.875368162145417*^9}, {3.87536824640191*^9, 
   3.875368247199279*^9}, {3.875368307578171*^9, 3.875368307901292*^9}, {
   3.875368347706169*^9, 3.875368381676835*^9}, {3.875368429053656*^9, 
   3.8753684326344976`*^9}, {3.875368470063847*^9, 3.875368470378294*^9}, {
   3.875368504611487*^9, 3.8753685680991163`*^9}, {3.875368652841567*^9, 
   3.875368656637827*^9}, {3.875373907134914*^9, 3.8753739709289923`*^9}, 
   3.875374006059895*^9, {3.8819544779522753`*^9, 3.8819544828501*^9}, {
   3.8819545244299383`*^9, 3.881954648603941*^9}, {3.882022202929975*^9, 
   3.8820222582798977`*^9}, {3.882022404447577*^9, 3.8820224077909393`*^9}, {
   3.882022666201787*^9, 3.882022668817267*^9}, {3.882023558135934*^9, 
   3.882023564747512*^9}, {3.882024212997327*^9, 3.882024215321657*^9}, {
   3.882024601279944*^9, 3.882024682866935*^9}, {3.882024749635635*^9, 
   3.882024766431308*^9}, {3.882025237539813*^9, 3.882025241634201*^9}, {
   3.882025675883936*^9, 3.882025678558323*^9}, {3.882296461342379*^9, 
   3.882296488981051*^9}},
 CellLabel->
  "In[733]:=",ExpressionUUID->"5fe7c176-4635-43ab-ad4a-6541c98a52c5"],

Cell["\<\
pTempFuncParam -> {
  pTemperatureList -> {{0, 300}, {750, 1200}, {800, 1200}}(*List of time (s) \
temperature (K) pairs that define the temperature evolution*)
  }\
\>", "Program",
 CellChangeTimes->{{3.6333445521727314`*^9, 
  3.633344564294786*^9}},ExpressionUUID->"e47c65f6-756a-49a8-bbd3-\
cf5a53737baf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ConstTempFunc", "[", 
    RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{"pT0", "/.", 
     RowBox[{"(", 
      RowBox[{"pTempFuncParam", "/.", "InputParam"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "TableTempFuncOfTime", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"InterpMeth", "\[Rule]", "\"\<Spline\>\""}], ",", 
     RowBox[{"InterOder", "\[Rule]", "1"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TableTempFuncOfTime", "[", 
   RowBox[{"OptionsPattern", "[", "]"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"verb", " ", "=", " ", 
       RowBox[{"pVERBOSE", "/.", "InputParam"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"TempFuncParam", " ", "=", " ", 
       RowBox[{"pTempFuncParam", "/.", "InputParam"}]}], ",", 
      "\[IndentingNewLine]", "interpdata", " ", ",", "\[IndentingNewLine]", 
      "CurInterpMeth", ",", "\[IndentingNewLine]", "CurInterOder", ",", 
      "interp"}], " ", "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CurInterpMeth", "=", 
      RowBox[{"OptionValue", "[", "InterpMeth", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CurInterOder", "=", 
      RowBox[{"OptionValue", "[", "InterOder", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"interpdata", " ", "=", 
      RowBox[{"pTemperatureList", "/.", "TempFuncParam"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"interp", " ", "=", 
      RowBox[{"Interpolation", "[", 
       RowBox[{"interpdata", ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "CurInterOder"}], ",", " ", 
        RowBox[{"Method", "\[Rule]", "CurInterpMeth"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"verb", "\[GreaterEqual]", " ", "3"}], ",", 
       RowBox[{"Print", "[", "\[IndentingNewLine]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"tmax", " ", "=", " ", 
             RowBox[{"pTMax", "/.", "TempFuncParam"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"t0", " ", "=", " ", 
             RowBox[{"pT0", "/.", "TempFuncParam"}]}]}], 
           "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"interp", "[", "t", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "t0", ",", "tmax"}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "t"}], "}"}], ",", 
       RowBox[{"interp", "[", "t", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4967397947147655`*^9, 3.496739826195917*^9}, {
   3.496739875581484*^9, 3.4967398759564457`*^9}, {3.4967399287947845`*^9, 
   3.496740019613609*^9}, {3.4967401704106655`*^9, 3.4967402149998493`*^9}, {
   3.4971674081468353`*^9, 3.497167419490731*^9}, {3.5020148285276794`*^9, 
   3.5020149288239126`*^9}, {3.5020149613550434`*^9, 3.5020150101675434`*^9}, 
   3.5020150664175434`*^9, {3.5020151428550434`*^9, 3.5020151755581684`*^9}, {
   3.5020152068394184`*^9, 3.5020152094019184`*^9}, {3.5048636426240034`*^9, 
   3.5048636600360394`*^9}, {3.504863748334341*^9, 3.5048637684577026`*^9}, {
   3.504863872047353*^9, 3.504863951937686*^9}, {3.5048640225515423`*^9, 
   3.50486409823094*^9}, {3.504864573611603*^9, 3.5048646105794067`*^9}, {
   3.507527284306984*^9, 3.507527308026948*^9}, {3.507527371014548*^9, 
   3.5075273752960167`*^9}, {3.523259527589142*^9, 3.523259528057325*^9}, 
   3.5232611232018995`*^9, {3.5232612039063435`*^9, 3.523261204437502*^9}, {
   3.529749504685154*^9, 3.529749600949547*^9}, {3.529749640620914*^9, 
   3.5297496413709044`*^9}, 3.529749827868517*^9, {3.570355101664095*^9, 
   3.5703551430345087`*^9}, {3.622868709386141*^9, 3.622868808080838*^9}, {
   3.622868845708471*^9, 3.6228689462360697`*^9}, {3.6228690218969364`*^9, 
   3.6228690650001955`*^9}, {3.6228691231427565`*^9, 
   3.6228691518464427`*^9}, {3.622869966028557*^9, 3.622869982970354*^9}, {
   3.622870063139676*^9, 3.6228701288788395`*^9}, {3.6228702180026593`*^9, 
   3.6228702190790715`*^9}, {3.6228703363144236`*^9, 3.622870373240048*^9}, {
   3.6228726241433344`*^9, 3.6228727846847444`*^9}, {3.623037228374938*^9, 
   3.6230372408706217`*^9}, {3.6230416049133987`*^9, 3.623041645785982*^9}, {
   3.6333428025153246`*^9, 3.6333430177804885`*^9}, {3.6333431734527426`*^9, 
   3.633343211251058*^9}, {3.6333432516701393`*^9, 3.6333432545717025`*^9}, {
   3.63334329765835*^9, 3.6333433078606195`*^9}, {3.633343344379751*^9, 
   3.633343355159213*^9}, {3.633344498754565*^9, 3.6333445042929554`*^9}, 
   3.6333445385997744`*^9, {3.7544167337910423`*^9, 3.754416784714674*^9}, {
   3.7544168340836687`*^9, 3.754416835621561*^9}, {3.754416938910138*^9, 
   3.754416950109391*^9}},
 CellLabel->
  "In[740]:=",ExpressionUUID->"2b8df77f-a99f-408a-bdb4-df3f85ce46b4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ExpDecTempFuncOfTime", "[", 
    RowBox[{"T0_", ",", "T1_", ",", "thalf_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", "func", "\[IndentingNewLine]", "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"func", "=", 
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"ExpDecFunc", "[", "t", "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"base", "\[Rule]", "T1"}], ",", 
           RowBox[{"Init", "\[Rule]", 
            RowBox[{"T0", "-", "T1"}]}], ",", 
           RowBox[{"tau", "->", "thalf"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "t"}], "}"}], ",", 
        RowBox[{"func", "[", "t", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Poly3TempFuncOfTime", "[", 
    RowBox[{"A0_", ",", "A1_", ",", "A2_", ",", "A3_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", "func", "\[IndentingNewLine]", "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"func", "=", 
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"ExpDecFunc", "[", "t", "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"base", "\[Rule]", "T1"}], ",", 
           RowBox[{"Init", "\[Rule]", 
            RowBox[{"T0", "-", "T1"}]}], ",", 
           RowBox[{"tau", "->", "thalf"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "t"}], "}"}], ",", 
        RowBox[{"A0", "+", 
         RowBox[{"A1", "*", "t"}], "+", 
         RowBox[{"A2", "*", 
          SuperscriptBox["t", "2"]}], "+", 
         RowBox[{"A3", "*", 
          SuperscriptBox["t", "3"]}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TempFuncFromNDSolve", "[", 
   RowBox[{"sol_", ",", "grd_", ",", "tmax_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Check", " ", "of", " ", "solution", " ", "matches", " ", "grid", " ", 
       "and", " ", "tmax"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
     "xrngmin", ",", "\[IndentingNewLine]", "xrngmax", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"trng", "=", 
       RowBox[{"Part", "[", 
        RowBox[{"sol", ",", "1", ",", "2", ",", "2"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"grdmax", "=", 
       RowBox[{"Max", "[", "grd", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"grdmin", "=", 
       RowBox[{"Min", "[", "grd", "]"}]}], ",", "\[IndentingNewLine]", 
      "func"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"func", "=", 
      RowBox[{"Temp", "/.", "sol"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xrngmin", ",", "xrngmax"}], "}"}], " ", "=", 
      RowBox[{"Part", "[", 
       RowBox[{"func", ",", "1", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"xrngmin", "\[LessEqual]", " ", "grdmin"}], "&&", 
        RowBox[{"xrngmax", ">=", "grdmax"}]}], ",", 
       RowBox[{
       "Print", "[", "\"\<INFO->Temperature function bounds grid\>\"", "]"}], 
       ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<ERROR->Temperature function does not bound grid\>\"", "]"}], 
        ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"trng", "\[GreaterEqual]", "tmax"}], ",", 
       RowBox[{
       "Print", "[", "\"\<INFO->Temperature function bounds tmax\>\"", "]"}], 
       ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<ERROR->Temperature function does not bound tmax\>\"", "]"}], 
        ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "func"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4967397947147655`*^9, 3.496739826195917*^9}, {
   3.496739875581484*^9, 3.4967398759564457`*^9}, {3.4967399287947845`*^9, 
   3.496740019613609*^9}, {3.4967401704106655`*^9, 3.4967402149998493`*^9}, {
   3.4971674081468353`*^9, 3.497167419490731*^9}, {3.5020148285276794`*^9, 
   3.5020149288239126`*^9}, {3.5020149613550434`*^9, 3.5020150101675434`*^9}, 
   3.5020150664175434`*^9, {3.5020151428550434`*^9, 3.5020151755581684`*^9}, {
   3.5020152068394184`*^9, 3.5020152094019184`*^9}, {3.5048636426240034`*^9, 
   3.5048636600360394`*^9}, {3.504863748334341*^9, 3.5048637684577026`*^9}, {
   3.504863872047353*^9, 3.504863951937686*^9}, {3.5048640225515423`*^9, 
   3.50486409823094*^9}, {3.504864573611603*^9, 3.5048646105794067`*^9}, {
   3.507527284306984*^9, 3.507527308026948*^9}, {3.507527371014548*^9, 
   3.5075273752960167`*^9}, {3.523259527589142*^9, 3.523259528057325*^9}, 
   3.5232611232018995`*^9, {3.5232612039063435`*^9, 3.523261204437502*^9}, {
   3.529749504685154*^9, 3.529749600949547*^9}, {3.529749640620914*^9, 
   3.5297496413709044`*^9}, 3.529749827868517*^9, {3.570355101664095*^9, 
   3.5703551430345087`*^9}, {3.622868709386141*^9, 3.622868808080838*^9}, {
   3.622868845708471*^9, 3.6228689462360697`*^9}, {3.6228690218969364`*^9, 
   3.6228690650001955`*^9}, {3.6228691231427565`*^9, 
   3.6228691518464427`*^9}, {3.622869966028557*^9, 3.622869982970354*^9}, {
   3.622870063139676*^9, 3.6228701288788395`*^9}, {3.6228702180026593`*^9, 
   3.6228702190790715`*^9}, {3.6228703363144236`*^9, 3.622870373240048*^9}, {
   3.6228726241433344`*^9, 3.6228727846847444`*^9}, {3.623037228374938*^9, 
   3.6230372408706217`*^9}, {3.6230416049133987`*^9, 3.623041645785982*^9}, {
   3.6333428025153246`*^9, 3.6333430177804885`*^9}, {3.6333431734527426`*^9, 
   3.633343211251058*^9}, {3.6333432516701393`*^9, 3.6333432545717025`*^9}, {
   3.63334329765835*^9, 3.6333433078606195`*^9}, {3.633343344379751*^9, 
   3.633343355159213*^9}, {3.633344498754565*^9, 3.6333445042929554`*^9}, 
   3.6333445385997744`*^9},
 CellLabel->
  "In[743]:=",ExpressionUUID->"76da01f9-6398-48ee-9b38-3190bd2fcdae"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Diffusion rate for the solute hydrogen", "Section",
 CellChangeTimes->{{3.4967254736294003`*^9, 3.4967254847373533`*^9}, {
  3.4971560262042737`*^9, 
  3.497156026532403*^9}},ExpressionUUID->"4fd6228c-3631-4183-9aac-\
0c246839c1cb"],

Cell["Diffusion coefficient as function of temperature", "Text",
 CellChangeTimes->{{3.633344344490888*^9, 
  3.6333443554740624`*^9}},ExpressionUUID->"4edaaef0-6eb6-471c-b4ee-\
8186125924a5"],

Cell[BoxData[
 RowBox[{"pTraceDiffParam", "\[Rule]", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pD0", " ", "\[Rule]", " ", 
     FractionBox["4.1*^-7", 
      SqrtBox["2"]]}], ",", " ", 
    RowBox[{"(*", 
     RowBox[{"Frauenfelder", " ", 
      RowBox[{
       RowBox[{"m", "^", "2"}], "/", "s"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"pED", " ", "->", "0.39"}], ","}], 
   RowBox[{"(*", 
    RowBox[{"Frauenfelder", " ", "eV"}], "*)"}], "\[IndentingNewLine]", 
   "}"}]}]], "Program",
 CellChangeTimes->{
  3.6333445910506725`*^9},ExpressionUUID->"8b26d6b4-b852-4734-adb2-\
31cd04125203"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DofT", "[", 
    RowBox[{"T_", ",", "D0_", ",", "ED_"}], "]"}], ":=", 
   RowBox[{"D0", "*", 
    RowBox[{"Exp", "[", 
     FractionBox[
      RowBox[{"-", "ED"}], 
      RowBox[{"KBoltz", "*", "T"}]], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DofTemp", "[", 
   RowBox[{"Temp_", "?", "NumberQ"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TraceDiffParam", " ", "=", " ", 
       RowBox[{"pTraceDiffParam", "/.", "InputParam"}]}], ",", 
      "\[IndentingNewLine]", "D0", ",", "ED"}], "\[IndentingNewLine]", "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Assert", "[", 
      RowBox[{"NumberQ", "[", "Temp", "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"D0", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"pD0", "/.", "TraceDiffParam"}], ")"}], "*", 
       SuperscriptBox["tolenscale", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ED", " ", "=", " ", 
      RowBox[{"pED", "/.", "TraceDiffParam"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DofT", "[", 
      RowBox[{"Temp", ",", "D0", ",", "ED"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DofTempFunc", "[", "tempfunc_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TraceDiffParam", " ", "=", " ", 
       RowBox[{"pTraceDiffParam", "/.", "InputParam"}]}], ",", 
      "\[IndentingNewLine]", "D0", ",", "ED"}], "\[IndentingNewLine]", "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"D0", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"pD0", "/.", "TraceDiffParam"}], ")"}], "*", 
       SuperscriptBox["tolenscale", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ED", " ", "=", " ", 
      RowBox[{"pED", "/.", "TraceDiffParam"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DofT", "[", 
      RowBox[{
       RowBox[{"tempfunc", "[", 
        RowBox[{"x", ",", "t"}], "]"}], ",", "D0", ",", "ED"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.630667627384078*^9, 3.630667658210271*^9}, {
   3.633343525368631*^9, 3.6333435651793203`*^9}, {3.633345197616188*^9, 
   3.633345218566988*^9}, {3.633345387077156*^9, 3.6333453919599247`*^9}, {
   3.633348154294838*^9, 3.633348209221734*^9}, 3.6333482943654423`*^9},
 CellLabel->
  "In[746]:=",ExpressionUUID->"2ace02eb-4998-4490-8a49-c07bd2e8ce3e"],

Cell["\<\
The diffusion equation takes a Temperature function as parameter which \
describes the time evolution of the temperature and must be a function of \
[t]. \
\>", "Text",
 CellChangeTimes->{{3.6333443779864497`*^9, 
  3.6333443826823807`*^9}},ExpressionUUID->"6627b9f0-9301-41fe-a875-\
c525d1b69d3b"],

Cell["\<\
pSolModelParam -> {
  pSoluteModel -> SoluteDiffRate,(*How the solute diffuses*)
  }\
\>", "Program",
 CellChangeTimes->{{3.6333441722463565`*^9, 
  3.6333441915121093`*^9}},ExpressionUUID->"eba48b54-373d-4485-8ade-\
d3e6a0372f28"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SoluteDiffRate", "[", "TempFunc_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"verb", " ", "=", " ", 
       RowBox[{"pVERBOSE", "/.", "InputParam"}]}], ",", "\[IndentingNewLine]",
       "temp", " ", ",", "diff0", ",", "doft", ",", "\[IndentingNewLine]", 
      RowBox[{"rohw", "=", 
       FractionBox[
        RowBox[{"prohW", "/.", "InputParam"}], 
        SuperscriptBox["tolenscale", "3"]]}], ",", "\[IndentingNewLine]", 
      RowBox[{"TraceDiffParam", " ", "=", " ", 
       RowBox[{"pTraceDiffParam", "/.", "InputParam"}]}], ",", 
      "\[IndentingNewLine]", "D0", ",", "ED"}], "\[IndentingNewLine]", "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"doft", "=", 
      RowBox[{"DofTempFunc", "[", "TempFunc", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"diff0", "=", 
      RowBox[{"doft", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"t", "\[Rule]", "0"}], ",", " ", 
         RowBox[{"x", "\[Rule]", "0"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"verb", "\[GreaterEqual]", " ", "1"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Diffusion coefficient at x = 0, t = 0: \>\"", ",", " ", 
         "diff0"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"doft", "*", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"csol", "[", 
         RowBox[{"x", ",", "t"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "2"}], "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]",
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SoluteDiffRateManualMoL", "[", 
   RowBox[{"TempFunc_", ",", "Grd_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"verb", " ", "=", " ", 
       RowBox[{"pVERBOSE", "/.", "InputParam"}]}], ",", "\[IndentingNewLine]",
       "temp", " ", ",", "diff0", ",", "doft", ",", "\[IndentingNewLine]", 
      RowBox[{"rohw", "=", 
       FractionBox[
        RowBox[{"prohW", "/.", "InputParam"}], 
        SuperscriptBox["tolenscale", "3"]]}], ",", "\[IndentingNewLine]", 
      RowBox[{"TraceDiffParam", " ", "=", " ", 
       RowBox[{"pTraceDiffParam", "/.", "InputParam"}]}], ",", 
      "\[IndentingNewLine]", "D0", ",", "ED", ",", "\[IndentingNewLine]", 
      "hp", ",", "hm"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"doft", "=", 
      RowBox[{"DofTempFunc", "[", "TempFunc", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"diff0", "=", 
      RowBox[{"doft", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"t", "\[Rule]", "0"}], ",", " ", 
         RowBox[{"x", "\[Rule]", "0"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"verb", "\[GreaterEqual]", " ", "1"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Diffusion coefficient at x = 0, t = 0: \>\"", ",", " ", 
         "diff0"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"doft", "*", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"csol", "[", 
          RowBox[{"x", ",", "t"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "2"}], "}"}]}], "]"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"doft", ",", "x"}], "]"}], "*", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"csol", "[", 
           RowBox[{"x", ",", "t"}], "]"}], ",", "x"}], "]"}]}], "+", 
       RowBox[{"doft", "*", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"csol", "[", 
           RowBox[{"x", ",", "t"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "2"}], "}"}]}], "]"}]}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"doft", "*", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"rohw", "*", 
             RowBox[{"csol", "[", 
              RowBox[{"x", ",", "t"}], "]"}]}], ",", "x"}], "]"}]}], ",", 
         "x"}], "]"}], "/", "rohw"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hp", "[", "i_", "]"}], ":=", 
      RowBox[{
       RowBox[{"Grd", "[", 
        RowBox[{"[", 
         RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
       RowBox[{"Grd", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hm", "[", "i_", "]"}], ":=", 
      RowBox[{
       RowBox[{"Grd", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "-", 
       RowBox[{"Grd", "[", 
        RowBox[{"[", 
         RowBox[{"i", "-", "1"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"doft", "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"hm", "[", "i", "]"}], "*", 
            RowBox[{
             RowBox[{"csol", "[", 
              RowBox[{"i", "+", "1"}], "]"}], "[", "t", "]"}]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"hp", "[", "i", "]"}], "+", 
              RowBox[{"hm", "[", "i", "]"}]}], ")"}], "*", 
            RowBox[{
             RowBox[{"csol", "[", "i", "]"}], "[", "t", "]"}]}], "+", 
           RowBox[{
            RowBox[{"hp", "[", "i", "]"}], "*", 
            RowBox[{
             RowBox[{"csol", "[", 
              RowBox[{"i", "-", "1"}], "]"}], "[", "t", "]"}]}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"1", "/", "2"}], "*", 
           RowBox[{"hp", "[", "i", "]"}], "*", 
           RowBox[{"hm", "[", "i", "]"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"hp", "[", "i", "]"}], "+", 
             RowBox[{"hm", "[", "i", "]"}]}], ")"}]}], ")"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{
          RowBox[{"Length", "[", "Grd", "]"}], "-", "1"}]}], "}"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.496726362296886*^9, 3.496726377685541*^9}, {
   3.496726531900174*^9, 3.4967265345717072`*^9}, 3.49672666503938*^9, {
   3.496726790117118*^9, 3.496726793288587*^9}, {3.496727417942996*^9, 
   3.496727644398381*^9}, {3.49672771365514*^9, 3.4967278774622955`*^9}, {
   3.496727943016403*^9, 3.4967279438600454`*^9}, {3.4967376307176313`*^9, 
   3.4967376454348745`*^9}, {3.4967387803498974`*^9, 3.496738781849744*^9}, {
   3.4967388459056835`*^9, 3.4967388934945602`*^9}, {3.4967395914387083`*^9, 
   3.4967396015001783`*^9}, {3.4967404393206263`*^9, 
   3.4967404443357377`*^9}, {3.4967404763949547`*^9, 3.496740476863656*^9}, 
   3.4967405211559954`*^9, {3.49674160493563*^9, 3.496741605373085*^9}, {
   3.497156073204875*^9, 3.497156073439253*^9}, {3.4971672808170805`*^9, 
   3.497167308817439*^9}, {3.497172904496066*^9, 3.4971729304013214`*^9}, {
   3.4971787790517244`*^9, 3.497178780879779*^9}, {3.4971788113629837`*^9, 
   3.497178811628598*^9}, 3.497265010737543*^9, {3.5188665807921677`*^9, 
   3.5188666264265027`*^9}, {3.518866660597593*^9, 3.518866660628828*^9}, {
   3.62286931634079*^9, 3.622869326200061*^9}, {3.633343578017956*^9, 
   3.63334359095019*^9}, {3.633344144541112*^9, 3.633344145679897*^9}, {
   3.6333453483582044`*^9, 3.6333454054694386`*^9}, 3.633348295270231*^9, {
   3.808079700469467*^9, 3.8080797252569637`*^9}, {3.8080800481747627`*^9, 
   3.808080071504608*^9}, {3.808080519311902*^9, 3.8080805243273582`*^9}, {
   3.808080576147101*^9, 3.808080579948704*^9}, {3.808155602870179*^9, 
   3.808155605895227*^9}, {3.808156428617861*^9, 3.8081564421073713`*^9}, {
   3.808156719650764*^9, 3.80815672304282*^9}, {3.808164513399475*^9, 
   3.808164574126253*^9}, 3.8081649614139757`*^9, {3.8081652347994013`*^9, 
   3.808165307819008*^9}, {3.808165343432869*^9, 3.808165369064975*^9}, {
   3.8081655754968567`*^9, 3.808165590259645*^9}, {3.808166790555822*^9, 
   3.808166794500298*^9}, {3.808166893808717*^9, 3.808166898741605*^9}, {
   3.842625651112311*^9, 3.842625704554985*^9}, {3.8426257396309557`*^9, 
   3.8426258041978083`*^9}, {3.889723236150133*^9, 3.8897232503086443`*^9}, {
   3.889723331033244*^9, 3.88972335500019*^9}},
 CellLabel->
  "In[749]:=",ExpressionUUID->"48fb58d6-b005-4b3f-9581-91f2132fe316"],

Cell["Solute diffusion with a stress gradient", "Text",
 CellChangeTimes->{{3.54554479740625*^9, 3.545544806*^9}, {
  3.6333444519824667`*^9, 
  3.6333444603134546`*^9}},ExpressionUUID->"ea82b87f-fec8-4051-991e-\
86447c8a4198"],

Cell["\<\
pSolModelParam -> {
  pSoluteModel -> SoluteDiffRate,(*How the solute diffuses*)
  pStressFuncOfCSol -> SigOfCLin,(*Calculates stress as function of local \
solute conc Pa/m^2*)
  pStressFuncParam -> {pPropFac -> 0.1}(*Parameters for pStressFuncOfCSol*),
  },\
\>", "Program",
 CellChangeTimes->{{3.6333442091086836`*^9, 
  3.6333442311824007`*^9}},ExpressionUUID->"8819b2d4-2f95-4b93-b265-\
48ebe24ae631"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SigOfCLin", "[", "cslol_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SolModelParam", " ", "=", 
       RowBox[{"pSolModelParam", "/.", "InputParam"}]}], ",", 
      "\[IndentingNewLine]", "StressFuncParam", ",", "\[IndentingNewLine]", 
      "res"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"StressFuncParam", "=", 
      RowBox[{"pStressFuncParam", "/.", "InputParam"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"pPropFac", "*", "cslol"}], "/.", "StressFuncParam"}]}], ";", 
     "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"SoluteDiffRateStress", "[", "TempFunc_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"StressFuncOfCSol", "=", 
       RowBox[{"pStressFuncOfCSol", "/.", "InputParam"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"StressFuncParam", "=", 
       RowBox[{"pStressFuncParam", "/.", "InputParam"}]}], ",", 
      "\[IndentingNewLine]", "Vh", ",", "\[IndentingNewLine]", "dsigdc", ",", 
      "d2sigd2c", ",", "\[IndentingNewLine]", "dcsdx", ",", "d2csd2x", ",", 
      "\[IndentingNewLine]", "doft", ",", "diff0", ",", "kbTemp"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"doft", "=", 
      RowBox[{"DofTempFunc", "[", "TempFunc", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"diff0", "=", 
      RowBox[{"doft", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"t", "\[Rule]", "0"}], ",", " ", 
         RowBox[{"x", "\[Rule]", "0"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<Diffusion coefficient at x = 0, t = 0: \>\"", ",", " ", "diff0"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", "csol", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Vh", "=", 
      RowBox[{"pHVol", "/.", "StressFuncParam"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dsigdc", "=", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"StressFuncOfCSol", "[", 
         RowBox[{"csol", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "]"}], ",", 
        RowBox[{"csol", "[", 
         RowBox[{"x", ",", "t"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"d2sigd2c", "=", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"StressFuncOfCSol", "[", 
         RowBox[{"csol", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"csol", "[", 
           RowBox[{"x", ",", "t"}], "]"}], ",", "2"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dcsdx", "=", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"csol", "[", 
         RowBox[{"x", ",", "t"}], "]"}], ",", "x"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"d2csd2x", "=", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"csol", "[", 
         RowBox[{"x", ",", "t"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "2"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"kbTemp", "=", 
      RowBox[{"KBoltz", "*", 
       RowBox[{"TempFunc", "[", "t", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<Vh = \>\"", ",", "Vh", ",", "\"\< dsigdc = \>\"", ",", "dsigdc", 
       ",", " ", "\"\< d2sigd2c = \>\"", ",", " ", "d2sigd2c"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"e0", " ", "kbTemp", " ", 
        SuperscriptBox["tolenscale", "3"]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"d2csd2x", " ", "kbTemp"}], "-", 
        RowBox[{
         SuperscriptBox["dcsdx", "2"], " ", "dsigdc", " ", "Vh"}], "-", 
        RowBox[{"d2sigd2c", " ", 
         SuperscriptBox["dcsdx", "2"], " ", "Vh", " ", 
         RowBox[{"csol", "[", 
          RowBox[{"x", ",", "t"}], "]"}]}], "-", 
        RowBox[{"d2csd2x", " ", "dsigdc", " ", "Vh", " ", 
         RowBox[{"csol", "[", 
          RowBox[{"x", ",", "t"}], "]"}]}]}], ")"}], " ", "*", "doft"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.54450243840625*^9, 3.544502449984375*^9}, {
   3.544502531078125*^9, 3.544502552671875*^9}, {3.544508061609375*^9, 
   3.54450812565625*^9}, {3.622869346963901*^9, 3.6228693641397433`*^9}, {
   3.6333440856050673`*^9, 3.6333440988492975`*^9}, {3.633345237318116*^9, 
   3.6333452642435436`*^9}, {3.633345297408931*^9, 3.6333453297007236`*^9}, 
   3.633348295722625*^9},
 CellLabel->
  "In[751]:=",ExpressionUUID->"1321e18b-ef1d-4a4f-88db-fd95a582ce2b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Boundary condtions for the solute", "Section",
 CellChangeTimes->{{3.555131258390663*^9, 
  3.5551312760926547`*^9}},ExpressionUUID->"4c14e2c7-758d-44c4-8bd9-\
321f5b74f406"],

Cell["\<\
All boundary conditions share the same interface : [ID_, atx_, tempfuc_] where
ID selects either the particle influx  (pLeft) or backside (pRight) into the \
boundary condtions config parameters in \
\[OpenCurlyDoubleQuote]pSolBndCond/.InputParam\[CloseCurlyDoubleQuote]
atx is the x-value where the boundary condtions should be applied
tempfuc is the current temperature function i.e. tempfuc = tempfuc[t]\
\>", "Text",
 CellChangeTimes->{{3.5551329583599825`*^9, 3.5551330742275667`*^9}, 
   3.63334465089506*^9, {3.633344712905855*^9, 
   3.633344763528504*^9}},ExpressionUUID->"999ae13d-9398-456c-844b-\
eb051f5fc264"],

Cell["Diffusion limit Drichlet type boundary condition", "Text",
 CellChangeTimes->{{3.5551312781081505`*^9, 3.5551312813579426`*^9}, {
   3.555131357040599*^9, 3.555131365899407*^9}, 
   3.555131429754695*^9},ExpressionUUID->"95201fee-4c9a-42ce-8a8f-\
f1481e885b81"],

Cell["\<\
pParam -> {
  CONSTCONC -> 0
  }\
\>", "Program",
 CellChangeTimes->{{3.6333449859241877`*^9, 
  3.633344990619788*^9}},ExpressionUUID->"8e8d0842-84de-45c0-989a-\
1e8644f7cb00"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DiffLimBndCond", "[", 
   RowBox[{"ID_", ",", "atx_", ",", "tempfuc_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"verb", " ", "=", " ", 
       RowBox[{"pVERBOSE", "/.", "InputParam"}]}], ",", "\[IndentingNewLine]",
       "SolBndCondParam", ",", "\[IndentingNewLine]", "constconc"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SolBndCondParam", "=", 
      RowBox[{"pParam", "/.", 
       RowBox[{"(", 
        RowBox[{"ID", "/.", 
         RowBox[{"(", 
          RowBox[{"pSolBndCond", "/.", "InputParam"}], ")"}]}], ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"constconc", "=", 
      RowBox[{"CONSTCONC", "/.", "SolBndCondParam"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"verb", "\[GreaterEqual]", " ", "1"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<DiffLimBndCond, ID = \>\"", ",", "ID", ",", "\"\< atx: \>\"", 
         ",", "atx", ",", "\"\< CONSTCONC: \>\"", ",", "constconc"}], "]"}]}],
       "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"csol", "[", 
       RowBox[{"atx", ",", "t"}], "]"}], "\[Equal]", "constconc"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DiffLimBndCondManualMoL", "[", 
   RowBox[{"ID_", ",", "atx_", ",", "tempfuc_", ",", "Grd_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"verb", " ", "=", " ", 
       RowBox[{"pVERBOSE", "/.", "InputParam"}]}], ",", "\[IndentingNewLine]",
       "SolBndCondParam", ",", "\[IndentingNewLine]", "constconc"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SolBndCondParam", "=", 
      RowBox[{"pParam", "/.", 
       RowBox[{"(", 
        RowBox[{"ID", "/.", 
         RowBox[{"(", 
          RowBox[{"pSolBndCond", "/.", "InputParam"}], ")"}]}], ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"constconc", "=", 
      RowBox[{"CONSTCONC", "/.", "SolBndCondParam"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"verb", "\[GreaterEqual]", " ", "1"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<DiffLimBndCond, ID = \>\"", ",", "ID", ",", "\"\< atx: \>\"", 
         ",", "atx", ",", "\"\< CONSTCONC: \>\"", ",", "constconc"}], "]"}]}],
       "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"csol", "[", "atx", "]"}], "[", "t", "]"}], "\[Equal]", 
      "constconc"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.555131382929567*^9, 3.5551314245206547`*^9}, {
   3.555132718515959*^9, 3.555132722500079*^9}, {3.555132847179599*^9, 
   3.5551328487419987`*^9}, {3.555133123661903*^9, 3.555133249903823*^9}, 
   3.555133443266447*^9, {3.633345021960188*^9, 3.633345057543788*^9}, {
   3.6333458252200317`*^9, 3.6333458349387074`*^9}, {3.842625935509922*^9, 
   3.842625935914548*^9}, {3.842628574790889*^9, 3.842628579993453*^9}, {
   3.842632101585431*^9, 3.842632109425405*^9}, 3.842632166710758*^9},
 CellLabel->
  "In[753]:=",ExpressionUUID->"d29bb98b-c8ab-4648-bb21-5eba1f753b36"],

Cell["Von Neumann flux boundary conditions", "Text",
 CellChangeTimes->{{3.5551313414009748`*^9, 3.555131349712943*^9}, 
   3.555131450472119*^9},ExpressionUUID->"f4167892-7b97-4155-a294-\
2fca0944301d"],

Cell["\<\
pParam -> {
  FLUXVAL -> 0
  }\
\>", "Program",
 CellChangeTimes->{{3.6333449973277884`*^9, 
  3.633345004425788*^9}},ExpressionUUID->"10f5d546-b86b-4407-ba8f-\
f8932dda61c7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SolFluxBndCond", "[", 
   RowBox[{"ID_", ",", "atx_", ",", "tempfuc_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"verb", " ", "=", " ", 
       RowBox[{"pVERBOSE", "/.", "InputParam"}]}], ",", "\[IndentingNewLine]",
       "SolBndCondParam", ",", "\[IndentingNewLine]", 
      RowBox[{"rohw", "=", 
       FractionBox[
        RowBox[{"prohW", "/.", "InputParam"}], 
        SuperscriptBox["tolenscale", "3"]]}], ",", "\[IndentingNewLine]", 
      "flux", ",", "\[IndentingNewLine]", "bndcond", ",", "doft"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"doft", "=", 
      RowBox[{"DofTempFunc", "[", "tempfuc", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SolBndCondParam", "=", 
      RowBox[{"pParam", "/.", 
       RowBox[{"(", 
        RowBox[{"ID", "/.", 
         RowBox[{"(", 
          RowBox[{"pSolBndCond", "/.", "InputParam"}], ")"}]}], ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"flux", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"FLUXVAL", "/.", "SolBndCondParam"}], ")"}], "/", 
       SuperscriptBox["tolenscale", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"verb", "\[GreaterEqual]", " ", "1"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<SolFluxBndCond, ID = \>\"", ",", "ID", ",", "\"\< atx: \>\"", 
         ",", "atx", ",", "\"\< FLUXVAL: \>\"", ",", "flux"}], "]"}]}], "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"bndcond", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"csol", "[", 
           RowBox[{"x", ",", "t"}], "]"}], ",", "x"}], "]"}], "==", " ", 
        RowBox[{"-", 
         FractionBox["flux", 
          RowBox[{"doft", "*", "rohw"}]]}]}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Simplify", "[", 
      RowBox[{"bndcond", "/.", 
       RowBox[{"x", "\[Rule]", "atx"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SolFluxBndCondManualMoL", "[", 
   RowBox[{"ID_", ",", "atx_", ",", "tempfuc_", ",", "Grd_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"verb", " ", "=", " ", 
       RowBox[{"pVERBOSE", "/.", "InputParam"}]}], ",", "\[IndentingNewLine]",
       "SolBndCondParam", ",", "\[IndentingNewLine]", 
      RowBox[{"rohw", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"prohW", "/.", "InputParam"}], ")"}], "/", 
        SuperscriptBox["tolenscale", "3"]}]}], ",", "\[IndentingNewLine]", 
      "flux", ",", "\[IndentingNewLine]", "bndcond", ",", "doft"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"doft", "=", 
      RowBox[{"DofTempFunc", "[", "tempfuc", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SolBndCondParam", "=", 
      RowBox[{"pParam", "/.", 
       RowBox[{"(", 
        RowBox[{"ID", "/.", 
         RowBox[{"(", 
          RowBox[{"pSolBndCond", "/.", "InputParam"}], ")"}]}], ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"flux", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"FLUXVAL", "/.", "SolBndCondParam"}], ")"}], "/", 
       SuperscriptBox["tolenscale", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"verb", "\[GreaterEqual]", " ", "1"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<SolFluxBndCond, ID = \>\"", ",", "ID", ",", "\"\< atx: \>\"", 
         ",", "atx", ",", "\"\< FLUXVAL: \>\"", ",", "flux"}], "]"}]}], "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"bndcond", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"csol", "[", 
             RowBox[{"x", ",", "t"}], "]"}], ",", "x"}], "]"}], "==", " ", 
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"flux", "/", 
             RowBox[{"(", 
              RowBox[{"doft", "*", "rohw"}], ")"}]}], ")"}]}]}], ")"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"Simplify", "[", 
        RowBox[{"bndcond", "/.", 
         RowBox[{"x", "\[Rule]", "atx"}]}], "]"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"SameQ", "[", 
        RowBox[{"ID", ",", "pLeft"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"csol", "[", "atx", "]"}], "[", "t", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{
          RowBox[{"csol", "[", 
           RowBox[{"atx", "+", "1"}], "]"}], "[", "t", "]"}], "-", 
         RowBox[{"flux", "*", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Grd", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", 
              RowBox[{"Grd", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", "doft"}], "/", 
           "rohw"}]}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"csol", "[", "atx", "]"}], "[", "t", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{
          RowBox[{"csol", "[", 
           RowBox[{"atx", "-", "1"}], "]"}], "[", "t", "]"}], "-", 
         RowBox[{"flux", "*", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Grd", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}], "-", 
              RowBox[{"Grd", "[", 
               RowBox[{"[", 
                RowBox[{"-", "2"}], "]"}], "]"}]}], ")"}], "/", "doft"}], "/",
            "rohw"}]}]}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.555131656193327*^9, 3.555131770061039*^9}, {
   3.555131932597511*^9, 3.5551319355816946`*^9}, {3.555132732530687*^9, 
   3.5551327438112144`*^9}, {3.555132777090335*^9, 3.555132787386551*^9}, {
   3.555132823103015*^9, 3.555132829993199*^9}, {3.555132869443799*^9, 
   3.555132939486191*^9}, {3.5551331427388067`*^9, 3.5551331430356627`*^9}, {
   3.5551332565752707`*^9, 3.555133268574503*^9}, {3.570448532262586*^9, 
   3.570448557282836*^9}, 3.574072830988188*^9, {3.6228693741238565`*^9, 
   3.622869374389059*^9}, {3.633345117463388*^9, 3.633345121644188*^9}, {
   3.633345426388904*^9, 3.63334546141068*^9}, {3.6333458402894387`*^9, 
   3.633345848838129*^9}, 3.6333482961906185`*^9, {3.842628593943615*^9, 
   3.842628594413796*^9}, {3.842628659803893*^9, 3.842628664692357*^9}, {
   3.84262887200348*^9, 3.8426288846867332`*^9}, {3.842629137773797*^9, 
   3.842629173930835*^9}},
 CellLabel->
  "In[755]:=",ExpressionUUID->"5ef985ee-29da-4b8b-a345-46bbfdfc266b"],

Cell["Simple Recombination limited effusion", "Text",
 CellChangeTimes->{{3.5575519072717457`*^9, 3.5575519264587545`*^9}, {
  3.5575519762699795`*^9, 3.557551993238295*^9}, {3.5575520924388804`*^9, 
  3.5575521135945888`*^9}, {3.5575596853456917`*^9, 3.5575597018435802`*^9}, {
  3.557559820468459*^9, 3.5575598209215207`*^9}, {3.6333447898460417`*^9, 
  3.633344790782054*^9}},ExpressionUUID->"8e0824eb-d886-4186-8da0-\
8e694395ebe6"],

Cell["\<\
pParam -> {
  palpha -> 1*^35,(*Prefactor*)
  pER -> 0.05 (*Arrhenius energy *)
  }\
\>", "Program",
 CellChangeTimes->{{3.6333456115119677`*^9, 
  3.633345658810561*^9}},ExpressionUUID->"a458fd2f-40e0-4eb3-8f1d-\
9f7b1e14364a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RecLimEffBndCond", "[", 
   RowBox[{"ID_", ",", "atx_", ",", "tempfuc_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"verb", " ", "=", " ", 
       RowBox[{"pVERBOSE", "/.", "InputParam"}]}], ",", "\[IndentingNewLine]",
       "SolBndCondParam", ",", "\[IndentingNewLine]", "doft", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"rohw", "=", 
       FractionBox[
        RowBox[{"prohW", "/.", "InputParam"}], 
        SuperscriptBox["tolenscale", "3"]]}], ",", "\[IndentingNewLine]", 
      RowBox[{"alattice", " ", "=", 
       RowBox[{"N", "[", 
        RadicalBox[
         FractionBox[
          RowBox[{"prohW", "/.", "InputParam"}], 
          SuperscriptBox["tolenscale", "3"]], 
         RowBox[{"-", "3"}]], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"plott", "=", 
       RowBox[{"pSolBndCondPlotTime", "/.", 
        RowBox[{"(", 
         RowBox[{"pSolBndCond", "/.", "InputParam"}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", "alpha", ",", "\[IndentingNewLine]", "ER", ",", 
      "\[IndentingNewLine]", "diffroh", ",", "\[IndentingNewLine]", 
      "bndcondexp", ",", "\[IndentingNewLine]", "bndcond", ",", 
      "\[IndentingNewLine]", "sign"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"doft", "=", 
      RowBox[{"DofTempFunc", "[", "tempfuc", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SolBndCondParam", "=", 
      RowBox[{"pParam", "/.", 
       RowBox[{"(", 
        RowBox[{"ID", "/.", 
         RowBox[{"(", 
          RowBox[{"pSolBndCond", "/.", "InputParam"}], ")"}]}], ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"sign", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"ID", ",", "pLeft"}], "]"}], ",", "1", ",", " ", 
        RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"alpha", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"palpha", "/.", "SolBndCondParam"}], ")"}], "/", 
         SuperscriptBox["tolenscale", "2"]}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"alpha", "=", 
      RowBox[{
       RowBox[{"palpha", "*", 
        RowBox[{"tolenscale", "^", "4"}]}], "/.", "SolBndCondParam"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ER", "=", 
      RowBox[{"pER", "/.", "SolBndCondParam"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"diffroh", "=", 
      RowBox[{"doft", "*", "rohw"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"verb", "\[GreaterEqual]", " ", "1"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<RecLimEffBndCond, ID: \>\"", ",", "ID", ",", " ", 
         "\"\< --> \>\"", ",", "sign", ",", " ", "\"\< alpha = \>\"", ",", 
         RowBox[{"alpha", "  ", "\"\< ER = \>\""}], ",", "ER", ",", "  ", 
         "\"\< alattice = \>\"", ",", "alattice", ",", "\"\< diffroh: \>\"", 
         ",", " ", 
         RowBox[{"diffroh", "/.", 
          RowBox[{"t", "->", "plott"}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"bndcondexp", "=", 
        RowBox[{"sign", "*", 
         FractionBox["alpha", "diffroh"], "*", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"csol", "[", 
            RowBox[{"x", ",", "t"}], "]"}], ")"}], "2"], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "ER"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"tempfuc", "[", 
              RowBox[{"x", ",", "t"}], "]"}], "*", "KBoltz"}], ")"}]}], 
          "]"}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"bndcondexp", "=", 
        RowBox[{"2", "*", "sign", "*", 
         RowBox[{"alpha", "/", "doft"}], "*", "rohw", "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"csol", "[", 
            RowBox[{"x", ",", "t"}], "]"}], ")"}], "^", "2"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "ER"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"tempfuc", "[", 
              RowBox[{"x", ",", "t"}], "]"}], "*", "KBoltz"}], ")"}]}], 
          "]"}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"bndcondexp", "=", 
      RowBox[{"sign", "*", 
       RowBox[{
        RowBox[{"alpha", "/", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"tempfuc", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "]"}]}], "/", "doft"}], "*", 
       "rohw", "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"csol", "[", 
          RowBox[{"x", ",", "t"}], "]"}], ")"}], "^", "2"}], "*", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "ER"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"tempfuc", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "*", "KBoltz"}], ")"}]}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"bndcond", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"csol", "[", 
           RowBox[{"x", ",", "t"}], "]"}], ",", "x"}], "]"}], "\[Equal]", 
        "bndcondexp"}], ")"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Simplify", "[", 
      RowBox[{"bndcond", "/.", 
       RowBox[{"x", "\[Rule]", "atx"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RecLimEffBndCondMol", "[", 
   RowBox[{"ID_", ",", "atx_", ",", "tempfuc_", ",", "Grd_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"verb", " ", "=", " ", 
       RowBox[{"pVERBOSE", "/.", "InputParam"}]}], ",", "\[IndentingNewLine]",
       "SolBndCondParam", ",", "\[IndentingNewLine]", "doft", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"rohw", "=", 
       FractionBox[
        RowBox[{"prohW", "/.", "InputParam"}], 
        SuperscriptBox["tolenscale", "3"]]}], ",", "\[IndentingNewLine]", 
      RowBox[{"alattice", " ", "=", 
       RowBox[{"N", "[", 
        RadicalBox[
         FractionBox[
          RowBox[{"prohW", "/.", "InputParam"}], 
          SuperscriptBox["tolenscale", "3"]], 
         RowBox[{"-", "3"}]], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"plott", "=", 
       RowBox[{"pSolBndCondPlotTime", "/.", 
        RowBox[{"(", 
         RowBox[{"pSolBndCond", "/.", "InputParam"}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", "alpha", ",", "\[IndentingNewLine]", "ER", ",", 
      "\[IndentingNewLine]", "diffroh", ",", "\[IndentingNewLine]", 
      "bndcondexp", ",", "\[IndentingNewLine]", "bndcond", ",", 
      "\[IndentingNewLine]", "sign", ",", "\[IndentingNewLine]", "flux"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"doft", "=", 
      RowBox[{"DofTempFunc", "[", "tempfuc", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SolBndCondParam", "=", 
      RowBox[{"pParam", "/.", 
       RowBox[{"(", 
        RowBox[{"ID", "/.", 
         RowBox[{"(", 
          RowBox[{"pSolBndCond", "/.", "InputParam"}], ")"}]}], ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"sign", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"ID", ",", "pLeft"}], "]"}], ",", "1", ",", " ", 
        RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"alpha", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"palpha", "/.", "SolBndCondParam"}], ")"}], "/", 
         SuperscriptBox["tolenscale", "2"]}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"alpha", "=", 
      RowBox[{
       RowBox[{"palpha", "*", 
        RowBox[{"tolenscale", "^", "4"}]}], "/.", "SolBndCondParam"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ER", "=", 
      RowBox[{"pER", "/.", "SolBndCondParam"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"diffroh", "=", 
      RowBox[{"doft", "*", "rohw"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"verb", "\[GreaterEqual]", " ", "1"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<RecLimEffBndCond, ID: \>\"", ",", "ID", ",", " ", 
         "\"\< --> \>\"", ",", "sign", ",", " ", "\"\< alpha = \>\"", ",", 
         RowBox[{"alpha", "  ", "\"\< ER = \>\""}], ",", "ER", ",", "  ", 
         "\"\< alattice = \>\"", ",", "alattice", ",", "\"\< diffroh: \>\"", 
         ",", " ", 
         RowBox[{"diffroh", "/.", 
          RowBox[{"t", "->", "plott"}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"bndcondexp", "=", 
        RowBox[{"sign", "*", 
         FractionBox["alpha", "diffroh"], "*", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"csol", "[", 
            RowBox[{"x", ",", "t"}], "]"}], ")"}], "2"], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "ER"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"tempfuc", "[", 
              RowBox[{"x", ",", "t"}], "]"}], "*", "KBoltz"}], ")"}]}], 
          "]"}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"bndcondexp", "=", 
        RowBox[{"2", "*", "sign", "*", 
         RowBox[{"alpha", "/", "doft"}], "*", "rohw", "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"csol", "[", 
            RowBox[{"x", ",", "t"}], "]"}], ")"}], "^", "2"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "ER"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"tempfuc", "[", 
              RowBox[{"x", ",", "t"}], "]"}], "*", "KBoltz"}], ")"}]}], 
          "]"}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"flux", "=", 
      RowBox[{"sign", "*", 
       RowBox[{
        RowBox[{"alpha", "/", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"tempfuc", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "]"}]}], "/", "doft"}], "*", 
       "rohw", "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"csol", "[", 
          RowBox[{"x", ",", "t"}], "]"}], ")"}], "^", "2"}], "*", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "ER"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"tempfuc", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "*", "KBoltz"}], ")"}]}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"SameQ", "[", 
        RowBox[{"ID", ",", "pLeft"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"csol", "[", "atx", "]"}], "[", "t", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{
          RowBox[{"csol", "[", 
           RowBox[{"atx", "+", "1"}], "]"}], "[", "t", "]"}], "-", 
         RowBox[{
          RowBox[{"alpha", "/", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"tempfuc", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "]"}]}], "*", "rohw", "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"csol", "[", "atx", "]"}], "[", "t", "]"}], ")"}], "^", 
           "2"}], "*", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"-", "ER"}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"tempfuc", "[", 
               RowBox[{"x", ",", "t"}], "]"}], "*", "KBoltz"}], ")"}]}], 
           "]"}], "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Grd", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"Grd", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", "doft"}]}]}]}], 
       ",", 
       RowBox[{
        RowBox[{
         RowBox[{"csol", "[", "atx", "]"}], "[", "t", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{
          RowBox[{"csol", "[", 
           RowBox[{"atx", "-", "1"}], "]"}], "[", "t", "]"}], "-", 
         RowBox[{
          RowBox[{"alpha", "/", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"tempfuc", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "]"}]}], "*", "rohw", "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"csol", "[", "atx", "]"}], "[", "t", "]"}], ")"}], "^", 
           "2"}], "*", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"-", "ER"}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"tempfuc", "[", 
               RowBox[{"x", ",", "t"}], "]"}], "*", "KBoltz"}], ")"}]}], 
           "]"}], "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Grd", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], "-", 
             RowBox[{"Grd", "[", 
              RowBox[{"[", 
               RowBox[{"-", "2"}], "]"}], "]"}]}], ")"}], "/", 
           "doft"}]}]}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.557551961254739*^9, 3.557551966254611*^9}, {
   3.557559512852149*^9, 3.557559578546864*^9}, {3.5575596124956427`*^9, 
   3.5575596701757593`*^9}, {3.557559705499362*^9, 3.5575598148286285`*^9}, {
   3.5576313681849136`*^9, 3.557631519916375*^9}, {3.5576317024128714`*^9, 
   3.5576317516968627`*^9}, {3.557632085976356*^9, 3.557632115686895*^9}, {
   3.5576322997953367`*^9, 3.557632304202687*^9}, 3.5576326690234976`*^9, 
   3.557633294585939*^9, {3.5576333543195496`*^9, 3.5576334893021965`*^9}, {
   3.557633568207029*^9, 3.5576335685195227`*^9}, {3.557633855748383*^9, 
   3.5576338581858363`*^9}, 3.5576341078060436`*^9, 3.5576356076834955`*^9, {
   3.622869386837959*^9, 3.622869390098401*^9}, {3.633345537818513*^9, 
   3.633345560812618*^9}, 3.633345635442061*^9, {3.633345852722479*^9, 
   3.633345863813937*^9}, {3.633345969050188*^9, 3.6333459912175035`*^9}, 
   3.633348296721012*^9, {3.754414724508781*^9, 3.7544147248296757`*^9}, {
   3.7544152444174833`*^9, 3.754415244514297*^9}, {3.754415333006407*^9, 
   3.754415354842863*^9}, {3.754415386709325*^9, 3.75441540757859*^9}, {
   3.754415852674596*^9, 3.7544158741346283`*^9}, {3.75441590881411*^9, 
   3.754415909428186*^9}, {3.7544159474786663`*^9, 3.754415947642809*^9}, {
   3.754420754128516*^9, 3.754420763402914*^9}, {3.7544274013937674`*^9, 
   3.754427412651554*^9}, {3.754430050350367*^9, 3.754430064466666*^9}, {
   3.754432530658807*^9, 3.7544325389950314`*^9}, {3.7545231199152184`*^9, 
   3.7545231520935373`*^9}, {3.7545232297313347`*^9, 3.754523234713649*^9}, {
   3.754523272460478*^9, 3.754523272547632*^9}, {3.754535420342991*^9, 
   3.754535421220881*^9}, {3.754611021719812*^9, 3.754611040643628*^9}, {
   3.7657466348652983`*^9, 3.765746644815359*^9}, {3.7657469671740227`*^9, 
   3.765747010974635*^9}, {3.7849914424860573`*^9, 3.784991450249012*^9}, 
   3.808071211127396*^9, {3.8080775019510813`*^9, 3.80807750839438*^9}, {
   3.808077585428979*^9, 3.808077586769104*^9}, 3.8080778686255093`*^9, {
   3.8081554086203203`*^9, 3.808155414370489*^9}, {3.808155460605351*^9, 
   3.808155461261088*^9}, {3.8081555161730947`*^9, 3.808155516334425*^9}, {
   3.808165729069373*^9, 3.808165742395987*^9}, {3.808166537904372*^9, 
   3.808166538847817*^9}, {3.808166654828932*^9, 3.8081666598558617`*^9}, 
   3.808167232400729*^9, {3.882296674434985*^9, 3.8822966908030167`*^9}, {
   3.882296727361339*^9, 3.882296728952847*^9}, {3.8822969053034277`*^9, 
   3.882296920430045*^9}, {3.882296954977315*^9, 3.8822969612351427`*^9}, {
   3.882296999074317*^9, 3.88229701018657*^9}, 3.882297089177376*^9, {
   3.882297481434523*^9, 3.882297511867708*^9}, 3.882297549968871*^9, {
   3.88229771057036*^9, 3.882297720584072*^9}, {3.882297791194195*^9, 
   3.882297792459457*^9}},
 CellLabel->
  "In[757]:=",ExpressionUUID->"e3a74bea-d02e-4a69-a4ec-547fe06cd17f"],

Cell[TextData[{
 StyleBox["Surface model including solubility, recombination ",
  FontWeight->"Bold"],
 "\nAtoms recombine from the surface\nAdsorbed atoms on the surface enter the \
bulk by jumping over the solubility barrier\nAtoms jump from bulk to the \
surface based on a jump rate given by Einsteins relation for a jump over one \
crystal lattice length / 2.\nThe top most surface site is fed/depleted by \
gradient driven diffusion See. Book 6 p.186"
}], "Text",
 CellChangeTimes->{{3.6236664989899793`*^9, 3.623666657251979*^9}, {
   3.624853276665631*^9, 3.6248533203456306`*^9}, {3.627199772816925*^9, 
   3.6271997731601267`*^9}, 
   3.627199868173545*^9},ExpressionUUID->"46456de0-eca7-4878-bec2-\
6dad580b6729"],

Cell["\<\
pParam -> {
 pnu->1*^13,(*Chemisorbed to bulk prefactor*)
 pESol->1.0, (*Chemisorbed to bulk arrhenius energy*)
 palpha->1*^35, (*Recombination prefactor*)
 pER->0.7, (*Recombination arrhenius energy*)
  }\
\>", "Program",
 CellChangeTimes->{{3.6333460420416517`*^9, 3.633346193017516*^9}, {
  3.633346225589899*^9, 
  3.633346285025137*^9}},ExpressionUUID->"75a40d03-df17-4f0c-8e90-\
e257db4892bb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "csurfsol", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "AdsorbedConc", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"CSOLPLOTMAX", "\[Rule]", "1*^-4"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AdsorbedConc", "[", 
    RowBox[{"SolBndCondParam_", ",", "cs_", ",", "atx_", ",", "tempfuc_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"csolplotmax", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "CSOLPLOTMAX", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"roh", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"prohW", "/.", "InputParam"}], ")"}], "/", 
         RowBox[{"tolenscale", "^", "3"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"a0", "=", 
        RowBox[{"N", "[", 
         RadicalBox[
          FractionBox[
           RowBox[{"prohW", "/.", "InputParam"}], 
           SuperscriptBox["tolenscale", "3"]], 
          RowBox[{"-", "3"}]], "]"}]}], ",", "\[IndentingNewLine]", "diff", 
       ",", "\[IndentingNewLine]", "tosurf", ",", "\[IndentingNewLine]", 
       "ESol", ",", "Nu", ",", "\[IndentingNewLine]", "tobulk", ",", 
       "\[IndentingNewLine]", "alpha", ",", "ER", ",", "\[IndentingNewLine]", 
       "recrate", ",", "\[IndentingNewLine]", "caexp", ",", "difffluxexp", 
       ",", "toplot"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ESol", "=", 
       RowBox[{"pESol", "/.", "SolBndCondParam"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Nu", "=", 
       RowBox[{"pnu", "/.", "SolBndCondParam"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"alpha", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"palpha", "/.", "SolBndCondParam"}], ")"}], "*", 
        SuperscriptBox["tolenscale", "2"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"diff", "=", 
       RowBox[{"DofTempFunc", "[", "tempfuc", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ER", "=", 
       RowBox[{"pER", "/.", "SolBndCondParam"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tosurf", "=", 
       RowBox[{"0.5", "*", 
        FractionBox["diff", 
         SuperscriptBox["a0", "2"]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tobulk", "=", 
       RowBox[{"Nu", "*", 
        RowBox[{"Exp", "[", 
         FractionBox[
          RowBox[{"-", "ESol"}], 
          RowBox[{"KBoltz", "*", 
           RowBox[{"tempfuc", "[", 
            RowBox[{"x", ",", "t"}], "]"}]}]], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"recrate", "=", 
       RowBox[{
        SuperscriptBox["alpha", "2"], "*", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "ER"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"tempfuc", "[", 
             RowBox[{"x", ",", " ", "t"}], "]"}], "*", "KBoltz"}], ")"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<SurfaceModel->tobulk at x = 0, t = 0: \>\"", ",", " ", 
        RowBox[{"tobulk", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "\[Rule]", "0"}], ",", 
           RowBox[{"t", "\[Rule]", "0"}]}], "}"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<SurfaceModel->tosurf: \>\"", ",", " ", "tosurf"}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<SurfaceModel->recomb at x = 0, t = 0: \>\"", ",", 
        RowBox[{"recrate", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "\[Rule]", "0"}], ",", 
           RowBox[{"t", "\[Rule]", "0"}]}], "}"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"caexp", "=", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"-", "a0"}], " ", "roh", " ", "tobulk"}], "+", 
         RowBox[{"a0", " ", "roh", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["tobulk", "2"], "+", 
            RowBox[{
            "4", " ", "a0", " ", "csurfsol", " ", "recrate", " ", "roh", " ", 
             "tosurf"}]}]]}]}], 
        RowBox[{"2", " ", 
         SuperscriptBox["a0", "2"], " ", "recrate", " ", 
         SuperscriptBox["roh", "2"]}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"difffluxexp", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "a0"}], " ", "csurfsol", " ", "roh", " ", "tosurf"}], 
        "+", 
        FractionBox[
         RowBox[{"tobulk", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "a0"}], " ", "roh", " ", "tobulk"}], "+", 
            RowBox[{"a0", " ", "roh", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["tobulk", "2"], "+", 
               RowBox[{
               "4", " ", "a0", " ", "csurfsol", " ", "recrate", " ", "roh", 
                " ", "tosurf"}]}]]}]}], ")"}]}], 
         RowBox[{"2", " ", "a0", " ", "recrate", " ", "roh"}]]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"toplot", "=", 
       RowBox[{"caexp", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", "0"}], ",", 
          RowBox[{"t", "\[Rule]", "0"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Plot version of CA: \>\"", ",", "toplot"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"NumberQ", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"toplot", "/.", 
           RowBox[{"{", 
            RowBox[{"csurfsol", "\[Rule]", "0.1"}], "}"}]}], "]"}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"Plot", "[", 
          RowBox[{"toplot", ",", 
           RowBox[{"{", 
            RowBox[{"csurfsol", ",", "0", ",", "csolplotmax"}], "}"}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", "\"\<CA of CS\>\""}]}], "]"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Non numeric result for CA encountered --> no plotting\>\"", 
          "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"toplot", "=", 
       RowBox[{"difffluxexp", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", "0"}], ",", 
          RowBox[{"t", "\[Rule]", "0"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Plot version of diffflux: \>\"", ",", "toplot"}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"NumberQ", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"toplot", "/.", 
           RowBox[{"{", 
            RowBox[{"csurfsol", "\[Rule]", "0.1"}], "}"}]}], "]"}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"Plot", "[", 
          RowBox[{"toplot", ",", 
           RowBox[{"{", 
            RowBox[{"csurfsol", ",", "0", ",", "csolplotmax"}], "}"}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", "\"\<diffflux of CS\>\""}]}], 
          "]"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Non numeric result for difffluxexp encountered --> no plotting\
\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"caexp", "=", 
       RowBox[{"caexp", "/.", 
        RowBox[{"{", 
         RowBox[{"csurfsol", "\[Rule]", "cs"}], "}"}]}]}], " ", ";", 
      "\[IndentingNewLine]", 
      RowBox[{"difffluxexp", "=", 
       RowBox[{"difffluxexp", "/.", 
        RowBox[{"{", 
         RowBox[{"csurfsol", "\[Rule]", "cs"}], "}"}]}]}], " ", ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"CAEXP", "->", "caexp"}], ",", "\[IndentingNewLine]", 
         RowBox[{"TOBULK", "->", "tobulk"}], ",", "\[IndentingNewLine]", 
         RowBox[{"TOSURF", "->", "tosurf"}], ",", "\[IndentingNewLine]", 
         RowBox[{"DIFFFLUX", "->", "difffluxexp"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"DIFF", "\[Rule]", "diff"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ROH", "->", "roh"}], ",", "\[IndentingNewLine]", 
         RowBox[{"A0", "\[Rule]", "a0"}], ",", "\[IndentingNewLine]", 
         RowBox[{"RECRATE", "->", "recrate"}]}], "\[IndentingNewLine]", "}"}],
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SurfaceModel", "[", 
    RowBox[{"ID_", ",", "atx_", ",", "tempfuc_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "SolBndCondParam", ",", "\[IndentingNewLine]", "cares", ",", 
       "gammadiff", ",", "bndcond", ",", "diff", ",", "roh", ",", "sign"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SolBndCondParam", "=", 
       RowBox[{"pParam", "/.", 
        RowBox[{"(", 
         RowBox[{"ID", "/.", 
          RowBox[{"(", 
           RowBox[{"pSolBndCond", "/.", "InputParam"}], ")"}]}], ")"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"cares", "=", 
       RowBox[{"AdsorbedConc", "[", 
        RowBox[{"SolBndCondParam", ",", 
         RowBox[{"csol", "[", 
          RowBox[{"atx", ",", "t"}], "]"}], ",", "atx", ",", "tempfuc"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gammadiff", "=", 
       RowBox[{"DIFFFLUX", "/.", "cares"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"diff", "=", 
       RowBox[{"DIFF", "/.", "cares"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"roh", "=", 
       RowBox[{"ROH", "/.", "cares"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sign", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"ID", ",", "pLeft"}], "]"}], ",", "1", ",", " ", 
         RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<ID = \>\"", ",", "ID", ",", "\"\< Flux sign = \>\"", ",", " ", 
        "sign"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"bndcond", "=", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"csol", "[", 
           RowBox[{"x", ",", "t"}], "]"}], ",", "x"}], "]"}], "==", " ", 
        RowBox[{
         RowBox[{"-", "sign"}], "*", 
         FractionBox["gammadiff", 
          RowBox[{"diff", "*", "roh"}]], "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "100"}], "*", "t"}], "]"}]}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bndcond", "/.", 
       RowBox[{"x", "\[Rule]", "atx"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.623666698014779*^9, 3.6236667701315794`*^9}, {
   3.6236668030163794`*^9, 3.623666859301179*^9}, {3.6236669134955792`*^9, 
   3.623666920125579*^9}, {3.623666953322379*^9, 3.6236669660675793`*^9}, {
   3.6236671693667793`*^9, 3.623667172517979*^9}, {3.623667232640379*^9, 
   3.623667414161979*^9}, {3.623667578305179*^9, 3.6236676707663794`*^9}, {
   3.623667986167179*^9, 3.623668032233979*^9}, {3.623668083089979*^9, 
   3.623668135474779*^9}, {3.623668310444379*^9, 3.623668405722946*^9}, {
   3.623668493866553*^9, 3.6236685324381576`*^9}, {3.6236687288444443`*^9, 
   3.623668732729143*^9}, {3.6236688005631604`*^9, 3.6236690778841915`*^9}, 
   3.623669173247443*^9, {3.6236692058990803`*^9, 3.623669206117486*^9}, {
   3.623669275747912*^9, 3.623669312345981*^9}, {3.623670115140793*^9, 
   3.6236701202263927`*^9}, {3.6236705546707926`*^9, 3.6236705810035925`*^9}, 
   3.6236707503883924`*^9, 3.623670792289993*^9, {3.623671190574393*^9, 
   3.623671204598793*^9}, {3.623671248107193*^9, 3.623671267669593*^9}, {
   3.623672530458393*^9, 3.623672534607993*^9}, {3.6236729544159927`*^9, 
   3.623673019640793*^9}, {3.6236731333491926`*^9, 3.6236731375767927`*^9}, {
   3.6237387078411093`*^9, 3.623738839240752*^9}, {3.6237435460811834`*^9, 
   3.623743556096448*^9}, {3.6241047222908955`*^9, 3.624104722852499*^9}, {
   3.624104795330564*^9, 3.624104802803012*^9}, {3.6241048375600348`*^9, 
   3.6241048381684384`*^9}, {3.624689447987879*^9, 3.62468947224964*^9}, {
   3.624689539064868*^9, 3.624689539470471*^9}, {3.6247685845149145`*^9, 
   3.624768597681399*^9}, {3.624768920554674*^9, 3.624768943393221*^9}, {
   3.624862564329427*^9, 3.6248626240154095`*^9}, {3.6248794065355086`*^9, 
   3.6248794207939086`*^9}, {3.6270351542186875`*^9, 
   3.6270352312982874`*^9}, {3.6271997918958473`*^9, 3.627199797979886*^9}, {
   3.6271998332829123`*^9, 3.627199839382551*^9}, {3.633346211986873*^9, 
   3.633346218289192*^9}, {3.633346307863244*^9, 3.633346310796006*^9}, {
   3.6333478905958185`*^9, 3.6333479059772215`*^9}, {3.633347945413516*^9, 
   3.633347949531863*^9}, 3.633348298031395*^9},
 CellLabel->
  "In[759]:=",ExpressionUUID->"af17c2a3-8487-4178-8086-fd959477d27d"],

Cell[BoxData[
 RowBox[{"SurfaceModel", "[", 
  RowBox[{"1", ",", "0.0", ",", 
   RowBox[{"1000", "&"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.623667677006379*^9, 3.6236677537895794`*^9}, {
  3.6236684392078424`*^9, 3.623668442110075*^9}, {3.623738856728464*^9, 
  3.6237388683817387`*^9}, {3.6237435714157457`*^9, 
  3.6237435715405464`*^9}},ExpressionUUID->"bc1b0f25-d58c-41b5-a475-\
55db8b5435f4"],

Cell[TextData[StyleBox["Extended surface model for atomic beam loading",
 FontSize->18,
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.627117900790519*^9, 
  3.6271179133798*^9}},ExpressionUUID->"7090e51b-0da9-4bf7-8de5-9e5c5fad426d"],

Cell["\<\
Includes multiple surface sites with different recombination parameters
Include Eley Radeal type abstraction by incident atom beam
Incident atom beam is partially deposited partially reflected
All surface sites are saturable
Bulk uptake via solubility boundary
Atoms jump from bulk to the surface based on a jump rate given by Einsteins \
relation for a jump over one crystal lattice length / 2.
The top most surface site is fed/depleted by gradient driven diffusion See. \
Book 6 p.186\
\>", "Text",
 CellChangeTimes->{{3.6271911487235394`*^9, 
  3.6271912625658164`*^9}},ExpressionUUID->"bba9b70c-57b8-41f6-95d0-\
f18730637b6d"],

Cell["\<\
pParam -> {
  pLHParam -> {(*Langmuir\[Dash]Hinshelwood paramters*)
    {pFrac -> 1, pNuRec -> 1*^-6, pERec -> 1.42, pNuBulk -> 1*^13, pEBulk -> \
1.0 },
    {pFrac -> 1, pNuRec -> 1*^-6, pERec -> 1.0, pNuBulk -> 1*^13, pEBulk -> \
1.0},
    {pFrac -> 1, pNuRec -> 1*^-6, pERec -> 0.6, pNuBulk -> 1*^13, pEBulk -> \
1.0}
    },
  pRefl -> 0.96,(*Thermal atom reflection yield*)
  pERParam -> 1*^-20 ,(*Eley\[Dash]Rideal abstraction cross section m^2*)
  pAtomFlux -> 1*^19 ,(*Atom flux*)
  pSolSel -> 2 (*Index of solution in quadrature that yields positive \
concentrations depends on mathematica version*),
  pCS0PLOTMAX -> 0.0001,(*Maximum solute concentration in the plot CAi vs \
CSol*)
  pTURNONAT -> 1, (*When to turn on the boundary condition*)
  pTURNONSCALE -> 10(*How fast to turn on the boundary condition*)
  }\
\>", "Program",
 CellChangeTimes->{{3.633349364083392*^9, 
  3.6333493964841766`*^9}},ExpressionUUID->"38405bf7-6bf0-48ac-8707-\
7e2f13391ccf"],

Cell["Expressions for the various fluxes in the surface", "Text",
 CellChangeTimes->{{3.633348924938974*^9, 
  3.633348940289669*^9}},ExpressionUUID->"880dac17-6122-4d77-8f06-\
6fc3ae56c847"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CAI", "[", "i_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Subscript", "[", 
     RowBox[{"CA", ",", "i"}], "]"}], "[", "t", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CAISymbol", "[", "i_", "]"}], ":=", 
   RowBox[{"Subscript", "[", 
    RowBox[{"CA", ",", "i"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GammaSurf", "[", 
   RowBox[{"si_", ",", "CS0_", ",", "inp_", ",", "Temp_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"diff", ",", "\[IndentingNewLine]", 
      RowBox[{"rohw", "=", 
       FractionBox[
        RowBox[{"prohW", "/.", "InputParam"}], 
        SuperscriptBox["tolenscale", "3"]]}], ",", "\[IndentingNewLine]", 
      RowBox[{"a0", " ", "=", 
       RowBox[{"N", "[", 
        RadicalBox[
         FractionBox[
          RowBox[{"prohW", "/.", "InputParam"}], 
          SuperscriptBox["tolenscale", "3"]], 
         RowBox[{"-", "3"}]], "]"}]}], ",", "\[IndentingNewLine]", "tosurf", 
      ",", "\[IndentingNewLine]", 
      RowBox[{"lhparam", " ", "=", " ", 
       RowBox[{"pLHParam", "/.", "inp"}]}], ",", "\[IndentingNewLine]", 
      "siteconc", " ", ",", "\[IndentingNewLine]", "numlh"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"numlh", "=", 
      RowBox[{"Length", "[", "lhparam", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"siteconc", "=", 
      RowBox[{"pFrac", "/.", 
       RowBox[{"Part", "[", 
        RowBox[{"lhparam", ",", "si"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"diff", "=", 
      RowBox[{"DofTemp", "[", "Temp", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tosurf", " ", "=", " ", 
      FractionBox["diff", 
       SuperscriptBox["a0", "2"]]}], ";", "\[IndentingNewLine]", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"EXPR", "->", 
        RowBox[{"TOSURF", "*", "CS0", "*", "ADENS0", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Subscript", "[", 
            RowBox[{"eta", ",", "si"}], "]"}], "-", 
           RowBox[{"CAI", "[", "si", "]"}]}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"REPRULE", "\[Rule]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TOSURF", "->", "tosurf"}], ",", "\[IndentingNewLine]", 
          RowBox[{"ADENS0", "->", 
           RowBox[{"rohw", "*", "a0"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Subscript", "[", 
            RowBox[{"eta", ",", "si"}], "]"}], "->", "siteconc"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"DIFF", "->", "diff"}], ",", "\[IndentingNewLine]", 
          RowBox[{"ROH", "->", "rohw"}]}], "\[IndentingNewLine]", "}"}]}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GammaBulk", "[", 
   RowBox[{"si_", ",", "inp_", ",", "Temp_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rohw", "=", 
       FractionBox[
        RowBox[{"prohW", "/.", "InputParam"}], 
        SuperscriptBox["tolenscale", "3"]]}], ",", "\[IndentingNewLine]", 
      RowBox[{"a0", " ", "=", 
       RowBox[{"N", "[", 
        RadicalBox[
         FractionBox[
          RowBox[{"prohW", "/.", "InputParam"}], 
          SuperscriptBox["tolenscale", "3"]], 
         RowBox[{"-", "3"}]], "]"}]}], ",", "\[IndentingNewLine]", "tobulk", 
      ",", "\[IndentingNewLine]", 
      RowBox[{"lhparam", " ", "=", " ", 
       RowBox[{"pLHParam", "/.", "inp"}]}], ",", "\[IndentingNewLine]", 
      "tobulkpre", ",", "tobulkeact"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tobulkpre", "=", 
      RowBox[{"pNuBulk", "/.", 
       RowBox[{"Part", "[", 
        RowBox[{"lhparam", ",", "si"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tobulkeact", "=", 
      RowBox[{"pEBulk", "/.", 
       RowBox[{"Part", "[", 
        RowBox[{"lhparam", ",", "si"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"EXPR", "->", 
        RowBox[{"ADENS0", "*", 
         RowBox[{"Subscript", "[", 
          RowBox[{"ToBulk", ",", "si"}], "]"}], "*", 
         RowBox[{"CAI", "[", "si", "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"REPRULE", "\[Rule]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Subscript", "[", 
            RowBox[{"ToBulk", ",", "si"}], "]"}], "->", 
           RowBox[{"ArrFunc", "[", 
            RowBox[{"Temp", ",", "tobulkpre", ",", "tobulkeact"}], "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ADENS0", "->", 
           RowBox[{"rohw", "*", "a0"}]}]}], "\[IndentingNewLine]", "}"}]}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GammaRec", "[", 
   RowBox[{"si_", ",", "inp_", ",", "Temp_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rohw", "=", 
       FractionBox[
        RowBox[{"prohW", "/.", "InputParam"}], 
        SuperscriptBox["tolenscale", "3"]]}], ",", "\[IndentingNewLine]", 
      RowBox[{"a0", " ", "=", 
       RowBox[{"N", "[", 
        RadicalBox[
         FractionBox[
          RowBox[{"prohW", "/.", "InputParam"}], 
          SuperscriptBox["tolenscale", "3"]], 
         RowBox[{"-", "3"}]], "]"}]}], ",", "\[IndentingNewLine]", "tobulk", 
      ",", "\[IndentingNewLine]", 
      RowBox[{"lhparam", " ", "=", " ", 
       RowBox[{"pLHParam", "/.", "inp"}]}], ",", "\[IndentingNewLine]", 
      "recpre", ",", "receact"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"recpre", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"pNuRec", "/.", 
         RowBox[{"Part", "[", 
          RowBox[{"lhparam", ",", "si"}], "]"}]}], ")"}], "*", 
       RowBox[{"(", 
        SuperscriptBox["tolenscale", "2"], ")"}]}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"Convert", " ", "from", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"m", "^", "2"}], "/", "#"}], "/", "sec"}], " ", "to", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"um", "^", "2"}], "/", "#"}], "/", "sec"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"receact", "=", 
      RowBox[{"pERec", "/.", 
       RowBox[{"Part", "[", 
        RowBox[{"lhparam", ",", "si"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"EXPR", "->", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", "ADENS0", ")"}], "2"], "*", 
         RowBox[{"Subscript", "[", 
          RowBox[{"RecRate", ",", "si"}], "]"}], "*", 
         SuperscriptBox[
          RowBox[{"CAI", "[", "si", "]"}], "2"]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"REPRULE", "\[Rule]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Subscript", "[", 
            RowBox[{"RecRate", ",", "si"}], "]"}], "->", 
           RowBox[{"ArrFunc", "[", 
            RowBox[{"Temp", ",", "recpre", ",", "receact"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ADENS0", "->", 
           RowBox[{"rohw", "*", "a0"}]}]}], "\[IndentingNewLine]", "}"}]}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GammaDepRefl", "[", 
   RowBox[{"si_", ",", "inp_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"atomflux", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"pAtomFlux", "/.", "inp"}], ")"}], "/", 
        RowBox[{"(", 
         SuperscriptBox["tolenscale", "2"], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"lhparam", " ", "=", " ", 
       RowBox[{"pLHParam", "/.", "inp"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"refl", " ", "=", " ", 
       RowBox[{"pRefl", "/.", "inp"}]}], ",", "\[IndentingNewLine]", 
      "siteconc"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"siteconc", "=", 
      RowBox[{"pFrac", "/.", 
       RowBox[{"Part", "[", 
        RowBox[{"lhparam", ",", "si"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"EXPR", "->", 
        RowBox[{"ATOMFLUX", "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", "REFL"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Subscript", "[", 
            RowBox[{"eta", ",", "si"}], "]"}], "-", 
           RowBox[{"CAI", "[", "si", "]"}]}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"REPRULE", "\[Rule]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Subscript", "[", 
            RowBox[{"eta", ",", "si"}], "]"}], "->", "siteconc"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ATOMFLUX", "->", "atomflux"}], ",", "\[IndentingNewLine]", 
          RowBox[{"REFL", "->", "refl"}]}], "\[IndentingNewLine]", "}"}]}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GammaAbsER", "[", 
    RowBox[{"si_", ",", "inp_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rohw", "=", 
        FractionBox[
         RowBox[{"prohW", "/.", "InputParam"}], 
         SuperscriptBox["tolenscale", "3"]]}], ",", "\[IndentingNewLine]", 
       RowBox[{"a0", " ", "=", 
        RowBox[{"N", "[", 
         RadicalBox[
          FractionBox[
           RowBox[{"prohW", "/.", "InputParam"}], 
           SuperscriptBox["tolenscale", "3"]], 
          RowBox[{"-", "3"}]], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"atomflux", " ", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"pAtomFlux", "/.", "inp"}], ")"}], "/", 
         RowBox[{"(", 
          SuperscriptBox["tolenscale", "2"], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"siger", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"pERParam", "/.", "inp"}], ")"}], "*", 
         SuperscriptBox["tolenscale", "2"]}]}], ","}], "\[IndentingNewLine]", 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"EXPR", "->", 
        RowBox[{"ATOMFLUX", "*", "ADENS0", "*", "SIGER", "*", 
         RowBox[{"CAI", "[", "si", "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"REPRULE", "\[Rule]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ATOMFLUX", "->", "atomflux"}], ",", "\[IndentingNewLine]", 
          RowBox[{"ADENS0", "->", 
           RowBox[{"rohw", "*", "a0"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"SIGER", "->", "siger"}]}], "\[IndentingNewLine]", 
         "}"}]}]}], "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.626765587658354*^9, 3.626765598749954*^9}, {
   3.626765775592765*^9, 3.626766076456293*^9}, {3.6267661238961973`*^9, 
   3.6267661277806225`*^9}, {3.6267701453630505`*^9, 
   3.6267702259843674`*^9}, {3.626770287381563*^9, 3.626770416124793*^9}, {
   3.626770449884615*^9, 3.6267704676375284`*^9}, {3.6267713873463554`*^9, 
   3.62677139594201*^9}, {3.6267714403554945`*^9, 3.626771577464774*^9}, {
   3.6267717563043203`*^9, 3.626771842557273*^9}, {3.626771876518691*^9, 
   3.6267718843655415`*^9}, {3.6267721770294294`*^9, 
   3.6267722144072685`*^9}, {3.6267725196996927`*^9, 3.626772670770093*^9}, {
   3.626772721267293*^9, 3.626773228955926*^9}, {3.626773362586383*^9, 
   3.626773392959777*^9}, {3.626773447216925*^9, 3.6267734495257397`*^9}, {
   3.626773485140768*^9, 3.6267735029716825`*^9}, {3.6267736392229557`*^9, 
   3.626773678691209*^9}, {3.626774056213629*^9, 3.626774067632902*^9}, {
   3.626774166038333*^9, 3.6267741781440105`*^9}, {3.6270297146939306`*^9, 
   3.627029726830731*^9}, 3.627029767858731*^9, {3.6270298364987307`*^9, 
   3.627029854719531*^9}, {3.6270304124066486`*^9, 3.627030518798649*^9}, {
   3.6270311559216194`*^9, 3.6270312209816384`*^9}, {3.6270316683425035`*^9, 
   3.6270318260625477`*^9}, {3.62703224652078*^9, 3.627032267081761*^9}, {
   3.627032413845668*^9, 3.627032558029998*^9}, 3.627032606699814*^9, {
   3.6270326633252726`*^9, 3.6270327458945413`*^9}, {3.627032818152815*^9, 
   3.627032941516033*^9}, {3.6270329731056285`*^9, 3.627033036051564*^9}, {
   3.6270330673047647`*^9, 3.6270331393299646`*^9}, {3.6270331845075645`*^9, 
   3.6270331856151648`*^9}, {3.6270332481711645`*^9, 
   3.6270332614155645`*^9}, {3.6270334341075644`*^9, 
   3.6270334550271645`*^9}, {3.6270334858059645`*^9, 
   3.6270334915467644`*^9}, {3.6270335276763644`*^9, 
   3.6270335495631647`*^9}, {3.6270337136127644`*^9, 
   3.6270337159683647`*^9}, {3.6270342187563643`*^9, 
   3.6270343067559643`*^9}, {3.627035040769888*^9, 3.6270350627502875`*^9}, {
   3.6270354364878874`*^9, 3.6270354792170334`*^9}, {3.627035557312636*^9, 
   3.627035589761468*^9}, {3.6270356500414133`*^9, 3.6270357681516953`*^9}, {
   3.627035827946879*^9, 3.627035935478368*^9}, {3.627036085410703*^9, 
   3.627036239913103*^9}, {3.6270362921731033`*^9, 3.627036415323103*^9}, {
   3.6270365769722805`*^9, 3.6270365840236163`*^9}, {3.627036733438091*^9, 
   3.6270367760736856`*^9}, {3.627037061403121*^9, 3.627037168856003*^9}, {
   3.627037204018403*^9, 3.627037273922003*^9}, {3.6270392305038643`*^9, 
   3.627039257850664*^9}, {3.6270392920614643`*^9, 3.6270392997990646`*^9}, {
   3.6270393339006643`*^9, 3.6270394052862644`*^9}, {3.6270394576086645`*^9, 
   3.6270395957785006`*^9}, {3.6270396448411293`*^9, 
   3.6270397179280663`*^9}, {3.627101291979427*^9, 3.627101314162769*^9}, {
   3.627101350401801*^9, 3.6271015624695606`*^9}, {3.627101601734915*^9, 
   3.627101889586115*^9}, {3.627101951611715*^9, 3.627101997132515*^9}, {
   3.627102391723282*^9, 3.6271023953269043`*^9}, {3.627102463670943*^9, 
   3.6271025134196615`*^9}, {3.6271026197979507`*^9, 3.6271026320596294`*^9}, 
   3.6271170998168745`*^9, {3.627117530317546*^9, 3.627117530582751*^9}, {
   3.633348007438321*^9, 3.633348010558281*^9}, {3.633348356421447*^9, 
   3.633348361834577*^9}, {3.6333483945317583`*^9, 3.633348420225808*^9}, {
   3.6333486639437933`*^9, 3.6333487006999855`*^9}, {3.633349729709908*^9, 
   3.633349748117672*^9}},
 CellLabel->
  "In[763]:=",ExpressionUUID->"fb58e04a-3b9b-49ca-8ba7-f5e5fbc76c9c"],

Cell["\<\
Build & solve the flux balance equations for the equilibrium state\
\>", "Text",
 CellChangeTimes->{{3.6333489490570383`*^9, 
  3.6333489734403067`*^9}},ExpressionUUID->"7b1746d3-12a6-4fa8-9603-\
8b98c05e0553"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BuildSurfEQN", "[", 
   RowBox[{"CS0_", ",", "inp_", ",", "Temp_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lhparam", " ", "=", " ", 
       RowBox[{"pLHParam", "/.", "inp"}]}], ",", "\[IndentingNewLine]", 
      "numlh", ",", "\[IndentingNewLine]", "GammaDepReflarray", ",", 
      "GammaSurfarray", ",", "GammaAbsERarray", ",", "GammaRecarray", ",", 
      "GammaBulkarray"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"numlh", " ", "=", " ", 
      RowBox[{"Length", "[", "lhparam", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"GammaDepReflarray", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"GammaDepRefl", "[", 
         RowBox[{"si", ",", "inp"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"si", ",", "1", ",", "numlh"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"GammaSurfarray", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"GammaSurf", "[", 
         RowBox[{"si", ",", "CS0", ",", "inp", ",", "Temp"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"si", ",", "1", ",", "numlh"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"GammaAbsERarray", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"GammaAbsER", "[", 
         RowBox[{"si", ",", "inp"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"si", ",", "1", ",", "numlh"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"GammaRecarray", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"GammaRec", "[", 
         RowBox[{"si", ",", "inp", ",", "Temp"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"si", ",", "1", ",", "numlh"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"GammaBulkarray", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"GammaBulk", "[", 
         RowBox[{"si", ",", "inp", ",", "Temp"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"si", ",", "1", ",", "numlh"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"EQN", "\[Rule]", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"0", "==", 
             RowBox[{
              FractionBox["1", "ADENS0"], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"EXPR", "/.", 
                  RowBox[{"Part", "[", 
                   RowBox[{"GammaDepReflarray", ",", "si"}], "]"}]}], ")"}], 
                "+", 
                RowBox[{"(", 
                 RowBox[{"EXPR", "/.", 
                  RowBox[{"Part", "[", 
                   RowBox[{"GammaSurfarray", ",", "si"}], "]"}]}], ")"}], "-", 
                RowBox[{"(", 
                 RowBox[{"EXPR", "/.", 
                  RowBox[{"Part", "[", 
                   RowBox[{"GammaAbsERarray", ",", "si"}], "]"}]}], ")"}], 
                "-", 
                RowBox[{"(", 
                 RowBox[{"EXPR", "/.", 
                  RowBox[{"Part", "[", 
                   RowBox[{"GammaRecarray", ",", "si"}], "]"}]}], ")"}], "-", 
                RowBox[{"(", 
                 RowBox[{"EXPR", "/.", 
                  RowBox[{"Part", "[", 
                   RowBox[{"GammaBulkarray", ",", "si"}], "]"}]}], ")"}]}], 
               ")"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"si", ",", "1", ",", "numlh"}], "}"}]}], 
           "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "}"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"VARS", "->", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"CAI", "[", "si", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"si", ",", "1", ",", "numlh"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"REPRULE", "\[Rule]", 
        RowBox[{"Union", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"REPRULE", "/.", "#"}], "&"}], ",", 
              "GammaDepReflarray"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"REPRULE", "/.", "#"}], "&"}], ",", "GammaSurfarray"}],
              "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"REPRULE", "/.", "#"}], "&"}], ",", 
              "GammaAbsERarray"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"REPRULE", "/.", "#"}], "&"}], ",", "GammaRecarray"}], 
             "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"REPRULE", "/.", "#"}], "&"}], ",", "GammaBulkarray"}],
              "]"}]}], "\[IndentingNewLine]", "}"}], "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SolveEQRes", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"SOLSEL", "\[Rule]", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SolveEQRes", "[", 
   RowBox[{"eqbuild_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"solsel", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "SOLSEL", "]"}]}], ",", 
      "\[IndentingNewLine]", "eqres"}], " ", "\[IndentingNewLine]", "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"eqres", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"EQN", "/.", "eqbuild"}], ",", 
           RowBox[{"VARS", "/.", "eqbuild"}]}], "}"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Map", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"#", ",", "solsel"}], "]"}], "&"}], ",", "eqres"}], 
       "\[IndentingNewLine]", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.626765587658354*^9, 3.626765598749954*^9}, {
   3.626765775592765*^9, 3.626766076456293*^9}, {3.6267661238961973`*^9, 
   3.6267661277806225`*^9}, {3.6267701453630505`*^9, 
   3.6267702259843674`*^9}, {3.626770287381563*^9, 3.626770416124793*^9}, {
   3.626770449884615*^9, 3.6267704676375284`*^9}, {3.6267713873463554`*^9, 
   3.62677139594201*^9}, {3.6267714403554945`*^9, 3.626771577464774*^9}, {
   3.6267717563043203`*^9, 3.626771842557273*^9}, {3.626771876518691*^9, 
   3.6267718843655415`*^9}, {3.6267721770294294`*^9, 
   3.6267722144072685`*^9}, {3.6267725196996927`*^9, 3.626772670770093*^9}, {
   3.626772721267293*^9, 3.626773228955926*^9}, {3.626773362586383*^9, 
   3.626773392959777*^9}, {3.626773447216925*^9, 3.6267734495257397`*^9}, {
   3.626773485140768*^9, 3.6267735029716825`*^9}, {3.6267736392229557`*^9, 
   3.626773678691209*^9}, {3.626774056213629*^9, 3.626774067632902*^9}, {
   3.626774166038333*^9, 3.6267741781440105`*^9}, {3.6270297146939306`*^9, 
   3.627029726830731*^9}, 3.627029767858731*^9, {3.6270298364987307`*^9, 
   3.627029854719531*^9}, {3.6270304124066486`*^9, 3.627030518798649*^9}, {
   3.6270311559216194`*^9, 3.6270312209816384`*^9}, {3.6270316683425035`*^9, 
   3.6270318260625477`*^9}, {3.62703224652078*^9, 3.627032267081761*^9}, {
   3.627032413845668*^9, 3.627032558029998*^9}, 3.627032606699814*^9, {
   3.6270326633252726`*^9, 3.6270327458945413`*^9}, {3.627032818152815*^9, 
   3.627032941516033*^9}, {3.6270329731056285`*^9, 3.627033036051564*^9}, {
   3.6270330673047647`*^9, 3.6270331393299646`*^9}, {3.6270331845075645`*^9, 
   3.6270331856151648`*^9}, {3.6270332481711645`*^9, 
   3.6270332614155645`*^9}, {3.6270334341075644`*^9, 
   3.6270334550271645`*^9}, {3.6270334858059645`*^9, 
   3.6270334915467644`*^9}, {3.6270335276763644`*^9, 
   3.6270335495631647`*^9}, {3.6270337136127644`*^9, 
   3.6270337159683647`*^9}, {3.6270342187563643`*^9, 
   3.6270343067559643`*^9}, {3.627035040769888*^9, 3.6270350627502875`*^9}, {
   3.6270354364878874`*^9, 3.6270354792170334`*^9}, {3.627035557312636*^9, 
   3.627035589761468*^9}, {3.6270356500414133`*^9, 3.6270357681516953`*^9}, {
   3.627035827946879*^9, 3.627035935478368*^9}, {3.627036085410703*^9, 
   3.627036239913103*^9}, {3.6270362921731033`*^9, 3.627036415323103*^9}, {
   3.6270365769722805`*^9, 3.6270365840236163`*^9}, {3.627036733438091*^9, 
   3.6270367760736856`*^9}, {3.627037061403121*^9, 3.627037168856003*^9}, {
   3.627037204018403*^9, 3.627037273922003*^9}, {3.6270392305038643`*^9, 
   3.627039257850664*^9}, {3.6270392920614643`*^9, 3.6270392997990646`*^9}, {
   3.6270393339006643`*^9, 3.6270394052862644`*^9}, {3.6270394576086645`*^9, 
   3.6270395957785006`*^9}, {3.6270396448411293`*^9, 
   3.6270397179280663`*^9}, {3.627101291979427*^9, 3.627101314162769*^9}, {
   3.627101350401801*^9, 3.6271015624695606`*^9}, {3.627101601734915*^9, 
   3.627101889586115*^9}, {3.627101951611715*^9, 3.627101997132515*^9}, {
   3.627102391723282*^9, 3.6271023953269043`*^9}, {3.627102463670943*^9, 
   3.6271025134196615`*^9}, {3.6271026197979507`*^9, 
   3.6271026320596294`*^9}, {3.6271170998168745`*^9, 3.6271171036856747`*^9}, 
   3.6271171426076746`*^9},
 CellLabel->
  "In[770]:=",ExpressionUUID->"e2aa3592-73a8-4fbe-bb58-fb4367244fec"],

Cell["\<\
Build & solve the flux balance differential equations for the time evolution \
of the surface concentration(s)\
\>", "Text",
 CellChangeTimes->{{3.6333489806944466`*^9, 3.6333489959359393`*^9}, {
  3.633405337867541*^9, 
  3.633405348927799*^9}},ExpressionUUID->"fab01276-34fb-4bed-a802-\
6cdb9c26dbb1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BuildSurfDGL", "[", 
   RowBox[{"CS0_", ",", "inp_", ",", "Temp_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lhparam", " ", "=", " ", 
       RowBox[{"pLHParam", "/.", "inp"}]}], ",", "\[IndentingNewLine]", 
      "numlh", ",", "\[IndentingNewLine]", "GammaDepReflarray", ",", 
      "GammaSurfarray", ",", "GammaAbsERarray", ",", "GammaRecarray", ",", 
      "GammaBulkarray"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"numlh", " ", "=", " ", 
      RowBox[{"Length", "[", "lhparam", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"GammaDepReflarray", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"GammaDepRefl", "[", 
         RowBox[{"si", ",", "inp"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"si", ",", "1", ",", "numlh"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"GammaSurfarray", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"GammaSurf", "[", 
         RowBox[{"si", ",", "CS0", ",", "inp", ",", "Temp"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"si", ",", "1", ",", "numlh"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"GammaAbsERarray", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"GammaAbsER", "[", 
         RowBox[{"si", ",", "inp"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"si", ",", "1", ",", "numlh"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"GammaRecarray", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"GammaRec", "[", 
         RowBox[{"si", ",", "inp", ",", "Temp"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"si", ",", "1", ",", "numlh"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"GammaBulkarray", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"GammaBulk", "[", 
         RowBox[{"si", ",", "inp", ",", "Temp"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"si", ",", "1", ",", "numlh"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"EQN", "\[Rule]", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"CAI", "[", "si", "]"}], ",", "t"}], "]"}], "==", 
               RowBox[{
                FractionBox["1", "ADENS0"], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"EXPR", "/.", 
                    RowBox[{"Part", "[", 
                    RowBox[{"GammaDepReflarray", ",", "si"}], "]"}]}], ")"}], 
                  "+", 
                  RowBox[{"(", 
                   RowBox[{"EXPR", "/.", 
                    RowBox[{"Part", "[", 
                    RowBox[{"GammaSurfarray", ",", "si"}], "]"}]}], ")"}], 
                  "-", 
                  RowBox[{"(", 
                   RowBox[{"EXPR", "/.", 
                    RowBox[{"Part", "[", 
                    RowBox[{"GammaAbsERarray", ",", "si"}], "]"}]}], ")"}], 
                  "-", 
                  RowBox[{"(", 
                   RowBox[{"EXPR", "/.", 
                    RowBox[{"Part", "[", 
                    RowBox[{"GammaRecarray", ",", "si"}], "]"}]}], ")"}], "-", 
                  RowBox[{"(", 
                   RowBox[{"EXPR", "/.", 
                    RowBox[{"Part", "[", 
                    RowBox[{"GammaBulkarray", ",", "si"}], "]"}]}], ")"}]}], 
                 ")"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"CAI", "[", "si", "]"}], "\[Equal]", "0"}], ")"}], "/.", 
               RowBox[{"t", "\[Rule]", "0"}]}]}], "\[IndentingNewLine]", 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"si", ",", "1", ",", "numlh"}], "}"}]}], 
           "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "}"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"VARS", "->", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"CAISymbol", "[", "si", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"si", ",", "1", ",", "numlh"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"REPRULE", "->", 
        RowBox[{"Union", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"REPRULE", "/.", "#"}], "&"}], ",", 
              "GammaDepReflarray"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"REPRULE", "/.", "#"}], "&"}], ",", "GammaSurfarray"}],
              "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"REPRULE", "/.", "#"}], "&"}], ",", 
              "GammaAbsERarray"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"REPRULE", "/.", "#"}], "&"}], ",", "GammaRecarray"}], 
             "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"REPRULE", "/.", "#"}], "&"}], ",", "GammaBulkarray"}],
              "]"}]}], "\[IndentingNewLine]", "}"}], "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SolveDGLRes", "[", 
   RowBox[{"eqbuild_", ",", "tmax_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"verb", " ", "=", " ", 
       RowBox[{"pVERBOSE", "/.", "InputParam"}]}], ",", "\[IndentingNewLine]",
       "eqn", ",", "vars", ",", "reprule"}], "\[IndentingNewLine]", "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reprule", "=", 
      RowBox[{"(", 
       RowBox[{"REPRULE", "/.", "eqbuild"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"eqn", "=", 
      RowBox[{"(", 
       RowBox[{"EQN", "/.", "eqbuild"}], ")"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vars", " ", "=", " ", 
      RowBox[{"VARS", "/.", "eqbuild"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"verb", "\[GreaterEqual]", " ", "2"}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"TableForm", "[", "eqn", "]"}], "]"}], ";", 
        RowBox[{"Print", "[", 
         RowBox[{"TableForm", "[", 
          RowBox[{"eqn", ",", 
           RowBox[{"TableDirections", "\[Rule]", "Row"}]}], "]"}], "]"}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"First", "[", 
      RowBox[{"NDSolve", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Evaluate", "[", 
         RowBox[{"eqn", "/.", "reprule"}], "]"}], ",", "\[IndentingNewLine]", 
        "vars", ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "tmax"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PrecisionGoal", "\[Rule]", "8"}], ",", "\[IndentingNewLine]", 
        RowBox[{"AccuracyGoal", "\[Rule]", "10"}]}], "\[IndentingNewLine]", 
       "]"}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.633348704725069*^9, 3.6333489178564377`*^9}},
 CellLabel->
  "In[773]:=",ExpressionUUID->"12dd34ef-fa20-41cc-bc40-cd82cd4df33c"],

Cell[BoxData[{
 RowBox[{"dlgbuild", "=", 
  RowBox[{"BuildSurfDGL", "[", 
   RowBox[{"1*^-7", ",", 
    RowBox[{"Evaluate", "[", " ", 
     RowBox[{"pParam", "/.", 
      RowBox[{"(", 
       RowBox[{"pLeft", "/.", 
        RowBox[{"(", 
         RowBox[{"pSolBndCond", "/.", "InputParam"}], ")"}]}], ")"}]}], "]"}],
     ",", "300"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"surftmax", " ", "=", " ", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"surfres", "=", 
   RowBox[{"SolveDGLRes", "[", 
    RowBox[{"dlgbuild", ",", "surftmax"}], "]"}]}], ";"}], "\n", 
 RowBox[{"numlh", " ", "=", 
  RowBox[{"Length", "[", "surfres", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"LogPlot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"CAI", "[", "si", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"si", ",", " ", "1", ",", "numlh"}], "}"}]}], "]"}], "/.", 
     "surfres"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "surftmax"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}], ",", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"AddLegend", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ToString", "[", 
        RowBox[{"StandardForm", "[", 
         RowBox[{"CAI", "[", "si", "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"si", ",", " ", "1", ",", "numlh"}], "}"}]}], "]"}], "]"}], 
    "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"CAI", "[", "si", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"si", ",", " ", "1", ",", "numlh"}], "}"}]}], "]"}], "/.", 
     "surfres"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "surftmax"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"Red", ",", "Thick"}], "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<Time (sec).\>\"", ",", "\"\<Sum surface conc.\>\""}], 
     "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"ImageSize", "\[Rule]", "500"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.6334049620543475`*^9, 3.6334049891044006`*^9}, {
  3.633405043360505*^9, 3.633405046496065*^9}, {3.633405080316431*^9, 
  3.633405090627899*^9}, {3.633405248465879*^9, 
  3.63340525306782*^9}},ExpressionUUID->"d1fc1451-1fa7-4272-b68d-\
d0960651aa5c"],

Cell["\<\
The extended surface model as  a TESSIM neumann boundary condition\
\>", "Text",
 CellChangeTimes->{{3.633349013626535*^9, 3.633349036808135*^9}, {
  3.633405356353304*^9, 
  3.633405358443677*^9}},ExpressionUUID->"353594df-e0c7-46d0-82a6-\
b24be0a9ac81"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SurfModExSurfStat", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"SOLSEL", "\[Rule]", "2"}], ",", " ", 
     RowBox[{"CS0PLOTMAX", "\[Rule]", "0.001"}], ",", 
     RowBox[{"VERBOSE", "\[Rule]", "4"}], ",", 
     RowBox[{"PLOTATT", "\[Rule]", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SurfModExSurfStat", "[", 
    RowBox[{"surfinp_", ",", " ", "tempfunc_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"att", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "PLOTATT", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"verb", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "VERBOSE", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"solsel", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "SOLSEL", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"cs0plotmax", "=", 
        RowBox[{"OptionValue", "[", "CS0PLOTMAX", "]"}]}], ",", 
       "\[IndentingNewLine]", "eqeqn", ",", "eqres", ",", "cares", ",", 
       "\[IndentingNewLine]", "cavec", ",", "reprules", ",", "toplot", ",", 
       "numtest", ",", "\[IndentingNewLine]", "numca", ",", "gammadiff", ",", 
       "gradres"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ClearAll", "[", "CS0", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"eqeqn", "=", 
       RowBox[{"BuildSurfEQN", "[", 
        RowBox[{"CS0", ",", "surfinp", ",", 
         RowBox[{"tempfunc", "[", 
          RowBox[{"x", ",", "t"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cavec", "=", 
       RowBox[{"(", 
        RowBox[{"VARS", "/.", "eqeqn"}], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"numca", " ", "=", " ", 
       RowBox[{"Length", " ", "[", "cavec", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"reprules", "=", 
       RowBox[{"REPRULE", "/.", "eqeqn"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"eqres", "=", 
       RowBox[{"SolveEQRes", "[", 
        RowBox[{"eqeqn", ",", 
         RowBox[{"SOLSEL", "\[Rule]", "solsel"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"toplot", " ", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"cavec", "/.", "eqres"}], "/.", "reprules"}], ")"}], "/.", 
        RowBox[{"t", "\[Rule]", "att"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cares", " ", "=", 
       RowBox[{
        RowBox[{"cavec", "/.", "eqres"}], "/.", "reprules"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"numtest", "=", 
       RowBox[{"(", 
        RowBox[{"toplot", "/.", 
         RowBox[{"CS0", "->", "cs0plotmax"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<VERBOSE = \>\"", ",", "verb", ",", " ", "\"\< at t = \>\"", ",", 
        "att"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Evaluate", "[", 
         RowBox[{"And", "@@", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"NumericQ", "[", "#", "]"}], "&"}], ",", "numtest"}], 
           "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"Plot", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Evaluate", "[", "toplot", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"CS0", ",", "0", ",", "cs0plotmax"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"PlotLabel", "\[Rule]", 
            RowBox[{"\"\<Surface conc test plot @ t = \>\"", "<>", 
             RowBox[{"ToString", "[", "att", "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<CS-Bulk@x = 0 (at. frac.)\>\"", ",", 
              "\"\<Surface conc.\>\""}], "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"AddLegend", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"ToString", "[", 
                RowBox[{"StandardForm", "[", 
                 RowBox[{"CAI", "[", "si", "]"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"si", ",", "1", ",", "numca"}], "}"}]}], "]"}], "]"}],
             "]"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<SurfModExSurfStat->Non numeric result: \>\"", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"verb", ">=", "4"}], ",", "numtest", ",", 
            "\"\<<EXPR>\>\""}], "]"}], ",", 
          "\"\< encounterd--> no plotting\>\""}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"gammadiff", " ", "=", " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"EXPR", "/.", 
            RowBox[{"GammaBulk", "[", 
             RowBox[{"si", ",", "surfinp", ",", 
              RowBox[{"tempfunc", "[", 
               RowBox[{"x", ",", "t"}], "]"}]}], "]"}]}], ")"}], "-", 
          RowBox[{"(", 
           RowBox[{"EXPR", "/.", 
            RowBox[{"GammaSurf", "[", 
             RowBox[{"si", ",", "CS0", ",", "surfinp", ",", 
              RowBox[{"tempfunc", "[", 
               RowBox[{"x", ",", "t"}], "]"}]}], "]"}]}], ")"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"si", ",", "1", ",", "numca"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"toplot", " ", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox["gammadiff", 
            RowBox[{"DIFF", "*", "ROH"}]]}], "/.", "eqres"}], "/.", 
         "reprules"}], "/.", 
        RowBox[{"t", "\[Rule]", "att"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"numtest", " ", "=", 
       RowBox[{"(", 
        RowBox[{"toplot", "/.", 
         RowBox[{"CS0", "->", "cs0plotmax"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"NumericQ", "[", "numtest", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"Plot", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Chop", "[", "toplot", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"CS0", ",", "0", ",", "cs0plotmax"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"PlotLabel", "\[Rule]", 
            RowBox[{"\"\<Gradient boundary condition test plot @ t = \>\"", "<>", 
             RowBox[{"ToString", "[", "att", "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<CS-Bulk@x = 0 (at. frac.)\>\"", ",", 
              "\"\<Solute gradient #/um\>\""}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ImageSize", "\[Rule]", "500"}]}], "\[IndentingNewLine]", 
          "]"}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<SurfModExBoundCond->Non numeric result: \>\"", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"verb", ">=", "4"}], ",", "numtest", ",", 
            "\"\<<EXPR>\>\""}], "]"}], ",", 
          "\"\< encounterd--> no plotting\>\""}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"gradres", " ", "=", " ", 
       RowBox[{"Simplify", "[", " ", 
        RowBox[{"-", 
         FractionBox["gammadiff", 
          RowBox[{"DIFF", "*", "ROH"}]]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CAVEC", "->", "cavec"}], ",", "\[IndentingNewLine]", 
        RowBox[{"CARES", "\[Rule]", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"cavec", "/.", "eqres"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"NUMREPRULE", "\[Rule]", "reprules"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"GRADRES", "->", "gradres"}], "/.", "eqres"}]}], 
       "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SurfModExBoundCond", "[", 
   RowBox[{"ID_", ",", "atx_", ",", "tempfunc_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"verb", " ", "=", " ", 
       RowBox[{"pVERBOSE", "/.", "InputParam"}]}], ",", "\[IndentingNewLine]",
       "turnonat", " ", ",", "\[IndentingNewLine]", "turnonscale", ",", 
      "\[IndentingNewLine]", "cs0plotmax", ",", "\[IndentingNewLine]", 
      "surfinp", ",", "surfstat", ",", "\[IndentingNewLine]", "sign", ",", 
      "\[IndentingNewLine]", "gammadiff", " ", ",", "bndcond", ",", "cares", 
      ",", "gradres", ",", "\[IndentingNewLine]", "solsel"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"surfinp", " ", "=", " ", 
      RowBox[{"pParam", "/.", 
       RowBox[{"(", 
        RowBox[{"ID", "/.", 
         RowBox[{"(", 
          RowBox[{"pSolBndCond", "/.", "InputParam"}], ")"}]}], ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"solsel", "=", 
      RowBox[{"pSolSel", "/.", "surfinp"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"turnonat", " ", "=", " ", 
      RowBox[{"pTURNONAT", "/.", "surfinp"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"turnonscale", "=", 
      RowBox[{"pTURNONSCALE", "/.", "surfinp"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cs0plotmax", "=", 
      RowBox[{"pCS0PLOTMAX", "/.", "surfinp"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<Selected solution index (for positive adsorbed concentrations): \>\
\"", ",", " ", "solsel"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"surfstat", " ", "=", " ", 
      RowBox[{"SurfModExSurfStat", "[", 
       RowBox[{"surfinp", ",", " ", "tempfunc", ",", 
        RowBox[{"SOLSEL", "\[Rule]", "solsel"}], ",", " ", 
        RowBox[{"CS0PLOTMAX", "\[Rule]", "cs0plotmax"}], ",", 
        RowBox[{"VERBOSE", "->", "verb"}], ",", 
        RowBox[{"PLOTATT", "->", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"(", 
           RowBox[{"pSolBndCondPlotTime", "/.", "InputParam"}], ")"}], 
          "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sign", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ID", " ", "\[Equal]", "1"}], ",", "1", ",", " ", 
        RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<SurfModExBoundCond->ID = \>\"", ",", "ID", ",", 
       "\"\< Flux sign = \>\"", ",", " ", "sign"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"gradres", "=", 
      RowBox[{"(", 
       RowBox[{"GRADRES", "/.", "surfstat"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bndcond", "=", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"csol", "[", 
          RowBox[{"x", ",", "t"}], "]"}], ",", "x"}], "]"}], "\[Equal]", 
       RowBox[{"gradres", "*", 
        RowBox[{"TurnOn", "[", 
         RowBox[{"t", ",", "turnonat", ",", "turnonscale"}], "]"}]}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Chop", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"bndcond", "/.", 
           RowBox[{"(", 
            RowBox[{"NUMREPRULE", "/.", "surfstat"}], ")"}]}], ")"}], "/.", 
         RowBox[{"x", "\[Rule]", "atx"}]}], ")"}], "/.", 
       RowBox[{"CS0", "->", 
        RowBox[{"csol", "[", 
         RowBox[{"atx", ",", "t"}], "]"}]}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetSurfStatFromInputParam", "[", 
   RowBox[{"ID_", ",", "atx_", ",", "tempfunc_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"verb", " ", "=", " ", 
       RowBox[{"pVERBOSE", "/.", "InputParam"}]}], ",", "\[IndentingNewLine]",
       "turnonat", " ", ",", "\[IndentingNewLine]", "turnonscale", ",", 
      "\[IndentingNewLine]", "cs0plotmax", ",", "\[IndentingNewLine]", 
      "surfinp", ",", "surfstat", ",", "\[IndentingNewLine]", "sign", ",", 
      "\[IndentingNewLine]", "gammadiff", " ", ",", "bndcond", ",", "cares", 
      ",", "gradres", ",", "\[IndentingNewLine]", "solsel"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"surfinp", " ", "=", " ", 
      RowBox[{"pParam", "/.", 
       RowBox[{"(", 
        RowBox[{"ID", "/.", 
         RowBox[{"(", 
          RowBox[{"pSolBndCond", "/.", "InputParam"}], ")"}]}], ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"solsel", "=", 
      RowBox[{"pSolSel", "/.", "surfinp"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<Selected solution index (for positive adsorbed concentrations): \>\
\"", ",", " ", "solsel"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"SurfModExSurfStat", "[", 
      RowBox[{"surfinp", ",", " ", "tempfunc", ",", 
       RowBox[{"SOLSEL", "\[Rule]", "solsel"}], ",", " ", 
       RowBox[{"CS0PLOTMAX", "\[Rule]", "cs0plotmax"}], ",", 
       RowBox[{"VERBOSE", "->", "verb"}], ",", 
       RowBox[{"PLOTATT", "->", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"(", 
          RowBox[{"pSolBndCondPlotTime", "/.", 
           RowBox[{"(", 
            RowBox[{"pSolBndCond", "/.", "InputParam"}], ")"}]}], ")"}], 
         "]"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.626765587658354*^9, 3.626765598749954*^9}, {
   3.626765775592765*^9, 3.626766076456293*^9}, {3.6267661238961973`*^9, 
   3.6267661277806225`*^9}, {3.6267701453630505`*^9, 
   3.6267702259843674`*^9}, {3.626770287381563*^9, 3.626770416124793*^9}, {
   3.626770449884615*^9, 3.6267704676375284`*^9}, {3.6267713873463554`*^9, 
   3.62677139594201*^9}, {3.6267714403554945`*^9, 3.626771577464774*^9}, {
   3.6267717563043203`*^9, 3.626771842557273*^9}, {3.626771876518691*^9, 
   3.6267718843655415`*^9}, {3.6267721770294294`*^9, 
   3.6267722144072685`*^9}, {3.6267725196996927`*^9, 3.626772670770093*^9}, {
   3.626772721267293*^9, 3.626773228955926*^9}, {3.626773362586383*^9, 
   3.626773392959777*^9}, {3.626773447216925*^9, 3.6267734495257397`*^9}, {
   3.626773485140768*^9, 3.6267735029716825`*^9}, {3.6267736392229557`*^9, 
   3.626773678691209*^9}, {3.626774056213629*^9, 3.626774067632902*^9}, {
   3.626774166038333*^9, 3.6267741781440105`*^9}, {3.6270297146939306`*^9, 
   3.627029726830731*^9}, 3.627029767858731*^9, {3.6270298364987307`*^9, 
   3.627029854719531*^9}, {3.6270304124066486`*^9, 3.627030518798649*^9}, {
   3.6270311559216194`*^9, 3.6270312209816384`*^9}, {3.6270316683425035`*^9, 
   3.6270318260625477`*^9}, {3.62703224652078*^9, 3.627032267081761*^9}, {
   3.627032413845668*^9, 3.627032558029998*^9}, 3.627032606699814*^9, {
   3.6270326633252726`*^9, 3.6270327458945413`*^9}, {3.627032818152815*^9, 
   3.627032941516033*^9}, {3.6270329731056285`*^9, 3.627033036051564*^9}, {
   3.6270330673047647`*^9, 3.6270331393299646`*^9}, {3.6270331845075645`*^9, 
   3.6270331856151648`*^9}, {3.6270332481711645`*^9, 
   3.6270332614155645`*^9}, {3.6270334341075644`*^9, 
   3.6270334550271645`*^9}, {3.6270334858059645`*^9, 
   3.6270334915467644`*^9}, {3.6270335276763644`*^9, 
   3.6270335495631647`*^9}, {3.6270337136127644`*^9, 
   3.6270337159683647`*^9}, {3.6270342187563643`*^9, 
   3.6270343067559643`*^9}, {3.627035040769888*^9, 3.6270350627502875`*^9}, {
   3.6270354364878874`*^9, 3.6270354792170334`*^9}, {3.627035557312636*^9, 
   3.627035589761468*^9}, {3.6270356500414133`*^9, 3.6270357681516953`*^9}, {
   3.627035827946879*^9, 3.627035935478368*^9}, {3.627036085410703*^9, 
   3.627036239913103*^9}, {3.6270362921731033`*^9, 3.627036415323103*^9}, {
   3.6270365769722805`*^9, 3.6270365840236163`*^9}, {3.627036733438091*^9, 
   3.6270367760736856`*^9}, {3.627037061403121*^9, 3.627037168856003*^9}, {
   3.627037204018403*^9, 3.627037273922003*^9}, {3.6270392305038643`*^9, 
   3.627039257850664*^9}, {3.6270392920614643`*^9, 3.6270392997990646`*^9}, {
   3.6270393339006643`*^9, 3.6270394052862644`*^9}, {3.6270394576086645`*^9, 
   3.6270395957785006`*^9}, {3.6270396448411293`*^9, 
   3.6270397179280663`*^9}, {3.627101291979427*^9, 3.627101314162769*^9}, {
   3.627101350401801*^9, 3.6271015624695606`*^9}, {3.627101601734915*^9, 
   3.627101889586115*^9}, {3.627101951611715*^9, 3.627101997132515*^9}, {
   3.627102391723282*^9, 3.6271023953269043`*^9}, {3.627102463670943*^9, 
   3.6271025134196615`*^9}, {3.6271026197979507`*^9, 
   3.6271026320596294`*^9}, {3.6271170998168745`*^9, 3.6271171036856747`*^9}, 
   3.6271171426076746`*^9, {3.627191290976384*^9, 3.627191345947484*^9}, {
   3.6271914038486423`*^9, 3.627191437349312*^9}, {3.6271995618805556`*^9, 
   3.6271995714277554`*^9}, {3.627199744830345*^9, 3.6271997480751657`*^9}, {
   3.627202477839476*^9, 3.627202535263444*^9}, {3.627202607179905*^9, 
   3.627202610299925*^9}, {3.6272026905156393`*^9, 3.6272027358495297`*^9}, {
   3.6272028906805224`*^9, 3.6272029054070168`*^9}, {3.6272031061811104`*^9, 
   3.627203222703862*^9}, {3.627203296944738*^9, 3.627203347660663*^9}, {
   3.627203433898016*^9, 3.627203499558837*^9}, {3.627203988980774*^9, 
   3.6272040203525753`*^9}, {3.627204071489703*^9, 3.627204103157906*^9}, {
   3.6272064829219756`*^9, 3.6272066684703712`*^9}, {3.627207163948351*^9, 
   3.6272073682628603`*^9}, {3.6333490746225348`*^9, 3.633349085308535*^9}, {
   3.6333494536402473`*^9, 3.6333494545606356`*^9}, {3.6333495427463055`*^9, 
   3.633349563509639*^9}, 3.6333496174225473`*^9, {3.6333496708362627`*^9, 
   3.633349684782484*^9}, 3.6337591086506853`*^9},
 CellLabel->
  "In[775]:=",ExpressionUUID->"97ae04bc-c872-4adb-83cc-cb7667c49074"],

Cell[BoxData[
 RowBox[{
  RowBox[{"stat", " ", "=", " ", 
   RowBox[{"SurfModExSurfStat", "[", 
    RowBox[{
     RowBox[{"Part", "[", 
      RowBox[{
       RowBox[{"pSolBndCondParam", "/.", "InputParam"}], ",", "1"}], "]"}], 
     ",", " ", 
     RowBox[{"(", 
      RowBox[{"800", "&"}], ")"}], ",", 
     RowBox[{"SOLSEL", "\[Rule]", "1"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6272030725940948`*^9, 3.6272030788653355`*^9}, {
  3.6272033825112867`*^9, 
  3.6272034244131556`*^9}},ExpressionUUID->"8abc56d8-3d72-42f5-b912-\
bf1f29e3acf2"],

Cell[BoxData[
 RowBox[{"SurfModExBoundCond", "[", 
  RowBox[{"pLeft", ",", "0", ",", 
   RowBox[{"(", 
    RowBox[{"800", "&"}], ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.633349582744192*^9, 
  3.633349583430584*^9}},ExpressionUUID->"049fcde1-5cf6-4d8e-8680-\
d260fef35782"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Trapping equations", "Section",
 CellChangeTimes->{{3.4967415807506065`*^9, 3.4967415858125887`*^9}, {
  3.502014499623535*^9, 
  3.502014501670397*^9}},ExpressionUUID->"4fb1f146-bc10-4f8a-a88e-\
140b89137a14"],

Cell["\<\
The trapping equation takes a Temperature function as parameter which \
describes the time evolution of the temperature and must be a function of \
[x,t]. It further takes the activation energy EST for trapping and ETS for \
detrapping together with a frequency prefactor nu0. The index i passed to the \
function is the index (ID) of the trap and is used to label the trapped \
population. Further the trap distribution  \[Eta]ti (concentration of the \
i-th trap) as function of depth, time and reference concentration must be \
passed \[Eta]ti[c[xref], x,t,i]\
\>", "Text",
 CellChangeTimes->{{3.4967416932234635`*^9, 3.4967416950201545`*^9}, {
  3.496741816460843*^9, 3.496741892390567*^9}, {3.4971681376105185`*^9, 
  3.497168160984868*^9}, {3.4971681971371965`*^9, 3.4971682449299507`*^9}, {
  3.4971732340302863`*^9, 3.497173258138736*^9}, {3.5045924169987035`*^9, 
  3.5045924174049716`*^9}, {3.5045924844861016`*^9, 3.504592487345605*^9}, {
  3.633407208025097*^9, 
  3.6334072081811037`*^9}},ExpressionUUID->"40edb7f0-f729-4149-950f-\
af5701d6e885"],

Cell["\<\
Trapping term with the least amount of free parameters i.e. jump into trap is \
derived from solute diffusion coefficient\
\>", "Text",
 CellChangeTimes->{{3.6334091662552714`*^9, 
  3.633409194880904*^9}},ExpressionUUID->"d99c05db-639f-484c-bc2e-\
efa013437479"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "TrappRateComp", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"TrapProfTime", " ", "\[Rule]", "t"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TrappRateComp", "[", 
   RowBox[{"TempFunc_", ",", "i_", ",", "etai_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"verb", " ", "=", " ", 
       RowBox[{"VERBOSE", "/.", "InputParam"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"trapproftime", "=", 
       RowBox[{"OptionValue", "[", "TrapProfTime", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"TrapModelParam", "=", " ", 
       RowBox[{"pTrapModelParam", "/.", "InputParam"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"TrapCreationModelParam", "=", 
       RowBox[{"pDefectCreation", "/.", "InputParam"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"DiffParam", "=", 
       RowBox[{"pTraceDiffParam", "/.", "InputParam"}]}], ",", 
      "\[IndentingNewLine]", "xref", ",", "CurTrapParam", ",", 
      "\[IndentingNewLine]", "doft", ",", "doft0", ",", ",", 
      "\[IndentingNewLine]", "ETS", ",", "\[IndentingNewLine]", "NTrap", ",", 
      "\[IndentingNewLine]", "refconc", ",", "\[IndentingNewLine]", "nu0", 
      ",", "\[IndentingNewLine]", "Ediff", ",", "\[IndentingNewLine]", "beta",
       ",", "\[IndentingNewLine]", 
      RowBox[{"alattice", " ", "=", 
       RowBox[{"N", "[", 
        RadicalBox[
         FractionBox[
          RowBox[{"prohW", "/.", "InputParam"}], 
          SuperscriptBox["tolenscale", "3"]], 
         RowBox[{"-", "3"}]], "]"}]}], ",", "\[IndentingNewLine]", 
      "traprate0", ",", "\[IndentingNewLine]", "detraprate0"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"xref", "=", 
      RowBox[{"pxref", "/.", "TrapModelParam"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"beta", "=", 
      RowBox[{"pNumInterstit", "/.", "TrapModelParam"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CurTrapParam", "=", 
      RowBox[{"Part", "[", 
       RowBox[{
        RowBox[{"Evaluate", "[", 
         RowBox[{"pTraps", "/.", "TrapModelParam"}], "]"}], ",", "i"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"doft", "=", 
      RowBox[{"DofTempFunc", "[", "TempFunc", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"doft0", "=", 
      RowBox[{"doft", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "\[Rule]", "0"}], ",", 
         RowBox[{"t", "\[Rule]", "0"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NTrap", "=", 
      RowBox[{"Length", "[", "TrapParam", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ETS", "=", 
      RowBox[{"pETS", "/.", "CurTrapParam"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nu0", "=", 
      RowBox[{"pnu0", "/.", "CurTrapParam"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ediff", "=", 
      RowBox[{"pED", "/.", "DiffParam"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"refconc", "=", 
      RowBox[{
       RowBox[{"csol", "[", 
        RowBox[{"xref", ",", "t"}], "]"}], "+", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"jj", "=", "1"}], "NTrap"], 
        RowBox[{
         RowBox[{"Subscript", "[", 
          RowBox[{"ctrp", ",", "jj"}], "]"}], "[", 
         RowBox[{"xref", ",", "t"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"traprate0", "=", 
      FractionBox["doft0", 
       SuperscriptBox["alattice", "2"]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"traprate0", "=", "nu0"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"detraprate0", "=", 
      RowBox[{"nu0", "*", 
       RowBox[{"Exp", "[", 
        FractionBox[
         RowBox[{"-", "ETS"}], 
         RowBox[{"KBoltz", "*", 
          RowBox[{"TempFunc", "[", 
           RowBox[{"0", ",", "0"}], "]"}]}]], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"verb", "\[GreaterEqual]", " ", "1"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<i: \>\"", ",", "i", ",", "  ", 
         "\"\< Trapping rate pre-factor at t=0: \>\"", ",", " ", "traprate0", 
         ",", " ", "\"\< De-trapping rate pre-factor at t=0: \>\"", ",", "  ",
          "detraprate0"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"AFACT", "->", 
         RowBox[{"doft", "/", 
          RowBox[{"(", 
           RowBox[{"beta", "*", 
            SuperscriptBox["alattice", "2"]}], ")"}]}]}], ",", 
        RowBox[{"BFACT", "->", 
         RowBox[{"nu0", "*", 
          RowBox[{"Exp", "[", 
           FractionBox[
            RowBox[{"-", "ETS"}], 
            RowBox[{"KBoltz", "*", 
             RowBox[{"TempFunc", "[", 
              RowBox[{"x", ",", "t"}], "]"}]}]], "]"}]}]}], ",", 
        RowBox[{"ETHAIFACT", "->", 
         RowBox[{"etai", "[", 
          RowBox[{"refconc", ",", "x", ",", "trapproftime", ",", "i"}], 
          "]"}]}]}], "}"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "TrappRate", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"TrapProfTime", " ", "\[Rule]", "t"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TrappRate", "[", 
   RowBox[{"TempFunc_", ",", "i_", ",", "etai_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"verb", " ", "=", " ", 
       RowBox[{"VERBOSE", "/.", "InputParam"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"trapproftile", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "TrapProfTime", "]"}]}], ",", 
      "\[IndentingNewLine]", "Tcomponents", ",", "res"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Tcomponents", " ", "=", 
      RowBox[{"TrappRateComp", "[", 
       RowBox[{"TempFunc", ",", "i", ",", "etai", ",", 
        RowBox[{"TrapProfTime", "->", "trapproftile"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", " ", "=", " ", 
      RowBox[{"Evaluate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"AFACT", "*", 
          RowBox[{"csol", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{"ETHAIFACT", "-", 
            RowBox[{
             RowBox[{"Subscript", "[", 
              RowBox[{"ctrp", ",", "i"}], "]"}], "[", 
             RowBox[{"x", ",", "t"}], "]"}]}], ")"}]}], "-", 
         RowBox[{"BFACT", "*", 
          RowBox[{
           RowBox[{"Subscript", "[", 
            RowBox[{"ctrp", ",", "i"}], "]"}], "[", 
           RowBox[{"x", ",", "t"}], "]"}]}]}], "/.", "Tcomponents"}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"verb", "\[GreaterEqual]", " ", "1"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Traprate \>\"", ",", " ", "i", " ", ",", " ", "\"\< = \>\"", ",",
          " ", "res"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", "res"}]}],
    "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4967415989831147`*^9, 3.496741608044687*^9}, {
   3.4967416810684586`*^9, 3.496741814054839*^9}, {3.4967418949996743`*^9, 
   3.4967419089513707`*^9}, {3.496741939042039*^9, 3.496741990083687*^9}, {
   3.4971682530798073`*^9, 3.497168309692483*^9}, {3.497168528162466*^9, 
   3.49716865041607*^9}, {3.4971687179841986`*^9, 3.4971687184059114`*^9}, {
   3.497172964962494*^9, 3.497172971680986*^9}, {3.497173229874196*^9, 
   3.4971732300773134`*^9}, {3.497177688374858*^9, 3.497177690609147*^9}, {
   3.4971777304513674`*^9, 3.497177765606267*^9}, {3.4984502029268336`*^9, 
   3.4984502593799586`*^9}, {3.4984502900049586`*^9, 3.4984502901768336`*^9}, 
   3.4984505360830836`*^9, {3.504592422092682*^9, 3.504592432171258*^9}, {
   3.504600921835099*^9, 3.504600924457848*^9}, 3.504868424776186*^9, {
   3.5049275377910323`*^9, 3.5049275438538427`*^9}, {3.5049317048149815`*^9, 
   3.5049317119403467`*^9}, {3.5049526678746176`*^9, 
   3.5049526888444414`*^9}, {3.504952879651085*^9, 3.504952991750574*^9}, {
   3.504953059269656*^9, 3.504953098256027*^9}, {3.5227388777482567`*^9, 
   3.522738918402691*^9}, {3.5227390111441565`*^9, 3.522739017094729*^9}, 
   3.5287164978104906`*^9, {3.5704190522997093`*^9, 3.570419164158591*^9}, {
   3.622356511228414*^9, 3.622356570259383*^9}, 3.622356601912098*^9, {
   3.6223577832025*^9, 3.6223578002378936`*^9}, {3.6228694029373455`*^9, 
   3.6228694683956985`*^9}, {3.63340663066457*^9, 3.6334066367328925`*^9}, {
   3.6334067192402344`*^9, 3.6334067205038185`*^9}, {3.6334071029075804`*^9, 
   3.6334071414413095`*^9}, {3.6334087472134438`*^9, 
   3.6334088009859543`*^9}, {3.6334088314835634`*^9, 
   3.6334088642587433`*^9}, {3.6334089010118723`*^9, 
   3.6334089097009606`*^9}, {3.6334089508688326`*^9, 3.63340914142039*^9}, {
   3.633409302020331*^9, 3.6334093023167267`*^9}, {3.6334093849332676`*^9, 
   3.633409388521222*^9}, {3.754254463712935*^9, 3.754254474153871*^9}, {
   3.754254546400529*^9, 3.7542546279804068`*^9}, 3.75425465963415*^9, {
   3.754254725390169*^9, 3.754254785059328*^9}, 3.754254858072446*^9, {
   3.754254967165688*^9, 3.754255129526986*^9}, {3.754336491815379*^9, 
   3.754336492386321*^9}, {3.754336614660177*^9, 3.754336615639947*^9}, {
   3.754336685319659*^9, 3.754336697263775*^9}, {3.754336739261096*^9, 
   3.754336739666233*^9}, {3.754336976211433*^9, 3.754337136149338*^9}, {
   3.754337171108005*^9, 3.754337182506546*^9}, {3.754337217068246*^9, 
   3.754337346555283*^9}, 3.75433788445326*^9, 3.7543380413361197`*^9, {
   3.754339776675687*^9, 3.75433977719452*^9}, {3.754494773862362*^9, 
   3.7544948712869344`*^9}, {3.7544949265930977`*^9, 3.754494937678732*^9}, {
   3.7544950060696435`*^9, 3.7544950103108864`*^9}, {3.7544950487580853`*^9, 
   3.7544950642859735`*^9}, {3.754495118694085*^9, 3.754495148705802*^9}, {
   3.7546110582928*^9, 3.754611079636092*^9}, {3.7546144653888817`*^9, 
   3.754614497175169*^9}, 3.754633158800621*^9, {3.7546336572038*^9, 
   3.7546336801548223`*^9}, {3.755455859478002*^9, 3.755455863431883*^9}, {
   3.755456397756775*^9, 3.755456397952209*^9}, {3.755456433992621*^9, 
   3.755456434119504*^9}, {3.755485671060688*^9, 3.7554857716841183`*^9}, {
   3.755485807924802*^9, 3.755485809040666*^9}, {3.755485992128378*^9, 
   3.755485992925668*^9}, 3.755550189058035*^9, {3.755550807357979*^9, 
   3.755550857820716*^9}, {3.755550904757102*^9, 3.755550918707611*^9}, {
   3.7555509985712967`*^9, 3.755551008315084*^9}, {3.755551042393083*^9, 
   3.755551146500798*^9}, {3.755551179594378*^9, 3.755551182558323*^9}, 
   3.755551500020359*^9, {3.755618663155265*^9, 3.7556186647375717`*^9}, 
   3.755630951364018*^9, {3.755634198497075*^9, 3.755634200057282*^9}, {
   3.755710581756109*^9, 3.755710581927807*^9}, {3.755969923609535*^9, 
   3.755969923909728*^9}, {3.7559759901457663`*^9, 3.755976205806315*^9}, 
   3.7559764586067123`*^9, {3.7559803114552813`*^9, 3.7559803150753183`*^9}, {
   3.755980770677721*^9, 3.755980774498621*^9}, {3.756047324959146*^9, 
   3.7560473269414663`*^9}, {3.756065076765277*^9, 3.756065079839179*^9}, {
   3.75615200833689*^9, 3.7561520105440683`*^9}, {3.756152402480751*^9, 
   3.756152423015164*^9}, {3.756152517284379*^9, 3.756152517643216*^9}, 
   3.7561525719430923`*^9, {3.756153173106496*^9, 3.756153176963023*^9}, {
   3.756153536388723*^9, 3.756153539170416*^9}, {3.756154186249366*^9, 
   3.7561541891528187`*^9}, {3.756154524835235*^9, 3.756154537581444*^9}, {
   3.756155693320483*^9, 3.7561557130166388`*^9}, {3.756156278976804*^9, 
   3.756156280752872*^9}, {3.7561563832098703`*^9, 3.7561563966711893`*^9}, {
   3.756156787925303*^9, 3.756156790792801*^9}, {3.756156854825506*^9, 
   3.7561568549771*^9}, {3.7561572510257874`*^9, 3.7561572511781473`*^9}, {
   3.756157312419716*^9, 3.7561573140795107`*^9}, {3.7561576019806623`*^9, 
   3.7561576048129587`*^9}, {3.75615806392913*^9, 3.756158070811019*^9}, {
   3.756164395842317*^9, 3.756164433378229*^9}, {3.7561647783266907`*^9, 
   3.7561647858347588`*^9}, {3.7561649568497343`*^9, 
   3.7561649569993887`*^9}, {3.7561670813006496`*^9, 3.756167102926998*^9}, {
   3.7561671620714006`*^9, 3.756167211708898*^9}, {3.756167277370064*^9, 
   3.7561672976844*^9}, 3.756167443990309*^9, {3.75616752376304*^9, 
   3.756167527835951*^9}, 3.756168077297513*^9, {3.756223276677726*^9, 
   3.7562232856356163`*^9}, {3.756223384236709*^9, 3.756223384441996*^9}, {
   3.7562237618121853`*^9, 3.756223772603018*^9}, {3.756228641771592*^9, 
   3.756228645234281*^9}, {3.756228684480893*^9, 3.7562286855843277`*^9}, {
   3.756228793844295*^9, 3.756228811724975*^9}, 3.756229211810121*^9, {
   3.756229755513566*^9, 3.756229758839747*^9}, {3.756229836543394*^9, 
   3.75622985886899*^9}, 3.7562304901961203`*^9, {3.756230685212813*^9, 
   3.756230688145446*^9}, {3.756233714623637*^9, 3.756233761547242*^9}, {
   3.756234872056735*^9, 3.756234872846799*^9}, 3.7566617343345013`*^9, {
   3.756661816651951*^9, 3.75666181847305*^9}, {3.7566707962028217`*^9, 
   3.756670796374434*^9}, {3.7566708671048183`*^9, 3.7566708674199257`*^9}, {
   3.7566718371876574`*^9, 3.756671837411558*^9}, {3.756671917614159*^9, 
   3.756671917805237*^9}, 3.756675067866962*^9, {3.756675113193635*^9, 
   3.756675127735882*^9}, {3.75685568352209*^9, 3.756855686162871*^9}, 
   3.757255003200008*^9, 3.757340605601359*^9, {3.757340651872402*^9, 
   3.757340652074341*^9}, {3.757626992947548*^9, 3.757626993297325*^9}, {
   3.757627098457226*^9, 3.757627099107643*^9}, {3.765912697169279*^9, 
   3.765912706608247*^9}, {3.765913955216477*^9, 3.76591395563614*^9}, {
   3.765914025913217*^9, 3.765914026329033*^9}, {3.765914738373814*^9, 
   3.765914740967955*^9}, {3.808062853365301*^9, 3.808062881753743*^9}, 
   3.808062975406386*^9, {3.808066755400782*^9, 3.808066758901907*^9}, 
   3.8080668197649517`*^9, {3.808077884042554*^9, 3.808077887275001*^9}, {
   3.808077947714085*^9, 3.808077956132476*^9}, {3.808078003165866*^9, 
   3.808078032498287*^9}, {3.840729843319646*^9, 3.840729873822935*^9}, {
   3.840729918568619*^9, 3.840729968103586*^9}, {3.840730581856077*^9, 
   3.840730625093896*^9}, {3.84073066479373*^9, 3.840730693223258*^9}, {
   3.84073077063484*^9, 3.84073077318405*^9}, {3.8407308368710613`*^9, 
   3.8407308950846367`*^9}, {3.8407309335489283`*^9, 3.840730992334051*^9}, {
   3.8407312617437468`*^9, 3.840731330885427*^9}, {3.8407313903673677`*^9, 
   3.8407313926312637`*^9}, {3.8407314542608747`*^9, 3.840731490948906*^9}, {
   3.840731537279393*^9, 3.840731543972927*^9}, {3.840731589426779*^9, 
   3.8407316897164917`*^9}, {3.840731782283568*^9, 3.840731863826438*^9}, {
   3.8407321009492817`*^9, 3.840732106732544*^9}, {3.842989733448702*^9, 
   3.842989766521331*^9}, {3.8429902753783817`*^9, 3.84299031540298*^9}, {
   3.8429903753988037`*^9, 3.8429904680767307`*^9}, {3.842990514520322*^9, 
   3.842990557943861*^9}, {3.842990713786075*^9, 3.842990729979706*^9}, {
   3.842990777796925*^9, 3.842990964507285*^9}, 3.84307315857624*^9, 
   3.84307535545399*^9, 3.8430802774026947`*^9, 3.8430809643103447`*^9, {
   3.8430834960660877`*^9, 3.843083523807508*^9}, 3.843143302037746*^9, {
   3.843149034897751*^9, 3.8431490358101473`*^9}, {3.872780653903657*^9, 
   3.872780654191598*^9}, {3.8727810227558517`*^9, 3.872781032246017*^9}, {
   3.873982028526877*^9, 3.8739820518843317`*^9}, {3.873982094155662*^9, 
   3.873982104243251*^9}, {3.8739821674655647`*^9, 3.873982167853423*^9}, {
   3.8741741158869543`*^9, 3.874174139537054*^9}, 3.875277460214786*^9, {
   3.881954695372423*^9, 3.881954708141589*^9}, 3.8897149224794283`*^9, {
   3.8897149706717377`*^9, 3.8897150163635073`*^9}, {3.8897184595945683`*^9, 
   3.889718469392867*^9}, {3.889718509855176*^9, 3.889718510525859*^9}, {
   3.8897186584868793`*^9, 3.889718676061966*^9}},
 CellLabel->
  "In[779]:=",ExpressionUUID->"71686af9-b89e-4841-902a-27a7cade271c"],

Cell[BoxData[
 RowBox[{"TrappRate", "[", 
  RowBox[{"ConstTempFunc", ",", " ", "1", ",", " ", 
   RowBox[{
    RowBox[{"(", "1*^-4", ")"}], "&"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.633409565108961*^9, 3.63340961356194*^9}, {
  3.6334098642507257`*^9, 
  3.633409866216301*^9}},ExpressionUUID->"ee678a7c-39fe-4f83-856b-\
93a959233592"],

Cell["\<\
Activated trapping : Jump into trap requires an activation energy\
\>", "Text",
 CellChangeTimes->{{3.6334091986716557`*^9, 
  3.633409218374203*^9}},ExpressionUUID->"628dc2ba-796e-403f-b832-\
0ffd98d37ef9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ActTrappRateComp", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"TrapProfTime", " ", "\[Rule]", "t"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ActTrappRateComp", "[", 
   RowBox[{"TempFunc_", ",", "i_", ",", "etai_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"verb", " ", "=", " ", 
       RowBox[{"VERBOSE", "/.", "InputParam"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"trapproftime", "=", 
       RowBox[{"OptionValue", "[", "TrapProfTime", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"TrapModelParam", "=", " ", 
       RowBox[{"pTrapModelParam", "/.", "InputParam"}]}], ",", 
      "\[IndentingNewLine]", "xref", ",", " ", "CurTrapParam", " ", ",", 
      "\[IndentingNewLine]", "EST", ",", "\[IndentingNewLine]", "ETS", ",", 
      "\[IndentingNewLine]", "NTrap", ",", "\[IndentingNewLine]", "refconc", 
      ",", "\[IndentingNewLine]", "nu0", ",", "\[IndentingNewLine]", "beta", 
      ",", "\[IndentingNewLine]", 
      RowBox[{"alattice", " ", "=", 
       RowBox[{"N", "[", 
        RadicalBox[
         FractionBox[
          RowBox[{"prohW", "/.", "InputParam"}], 
          SuperscriptBox["tolenscale", "3"]], 
         RowBox[{"-", "3"}]], "]"}]}], ",", "\[IndentingNewLine]", 
      "traprate0", ",", "\[IndentingNewLine]", "detraprate0"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"xref", "=", 
      RowBox[{"pxref", "/.", "TrapModelParam"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"beta", "=", 
      RowBox[{"pNumInterstit", "/.", "TrapModelParam"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CurTrapParam", "=", 
      RowBox[{"Part", "[", 
       RowBox[{
        RowBox[{"Evaluate", "[", 
         RowBox[{"pTraps", "/.", "TrapModelParam"}], "]"}], ",", "i"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ETS", "=", 
      RowBox[{"pETS", "/.", "CurTrapParam"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"Jump", " ", "out", " ", "of", " ", "trap"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"EST", "=", 
      RowBox[{"pEST", "/.", "CurTrapParam"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"Jump", " ", "into", " ", "trap"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"nu0", "=", 
      RowBox[{"pnu0", "/.", "CurTrapParam"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"refconc", "=", 
      RowBox[{
       RowBox[{"csol", "[", 
        RowBox[{"xref", ",", "t"}], "]"}], "+", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"jj", "=", "1"}], "NTrap"], 
        RowBox[{
         RowBox[{"Subscript", "[", 
          RowBox[{"ctrp", ",", "jj"}], "]"}], "[", 
         RowBox[{"xref", ",", "t"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"traprate0", "=", 
      RowBox[{"nu0", "*", 
       RowBox[{"Exp", "[", 
        FractionBox[
         RowBox[{"-", "EST"}], 
         RowBox[{"KBoltz", "*", 
          RowBox[{"TempFunc", "[", 
           RowBox[{"0", ",", "0"}], "]"}]}]], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"detraprate0", "=", 
      RowBox[{"nu0", "*", 
       RowBox[{"Exp", "[", 
        FractionBox[
         RowBox[{"-", "ETS"}], 
         RowBox[{"KBoltz", "*", 
          RowBox[{"TempFunc", "[", 
           RowBox[{"0", ",", "0"}], "]"}]}]], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<i: \>\"", ",", "i", ",", "  ", 
       "\"\< Trapping rate pre-factor at t=0: \>\"", ",", " ", "traprate0", 
       ",", " ", "\"\< De-trapping rate pre-factor at t=0: \>\"", ",", "  ", 
       "detraprate0"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"AFACT", "->", 
        RowBox[{
         FractionBox["nu0", "beta"], "*", 
         RowBox[{"Exp", "[", 
          FractionBox[
           RowBox[{"-", "EST"}], 
           RowBox[{"KBoltz", "*", 
            RowBox[{"TempFunc", "[", 
             RowBox[{"x", ",", "t"}], "]"}]}]], "]"}]}]}], ",", 
       RowBox[{"BFACT", "->", 
        RowBox[{"nu0", "*", 
         RowBox[{"Exp", "[", 
          FractionBox[
           RowBox[{"-", "ETS"}], 
           RowBox[{"KBoltz", "*", 
            RowBox[{"TempFunc", "[", 
             RowBox[{"x", ",", "t"}], "]"}]}]], "]"}]}]}], ",", 
       RowBox[{"ETHAIFACT", "->", 
        RowBox[{"etai", "[", 
         RowBox[{"refconc", ",", "x", ",", "trapproftime", ",", "i"}], 
         "]"}]}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ActTrappRate", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"TrapProfTime", " ", "\[Rule]", "t"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ActTrappRate", "[", 
   RowBox[{"TempFunc_", ",", "i_", ",", "etai_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"verb", " ", "=", " ", 
       RowBox[{"VERBOSE", "/.", "InputParam"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"trapproftile", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "TrapProfTime", "]"}]}], ",", 
      "\[IndentingNewLine]", "Tcomponents", ",", "res"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Tcomponents", " ", "=", 
      RowBox[{"ActTrappRateComp", "[", 
       RowBox[{"TempFunc", ",", "i", ",", "etai", ",", 
        RowBox[{"TrapProfTime", "->", "trapproftile"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", " ", "=", " ", 
      RowBox[{"Evaluate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"AFACT", "*", 
          RowBox[{"csol", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{"ETHAIFACT", "-", 
            RowBox[{
             RowBox[{"Subscript", "[", 
              RowBox[{"ctrp", ",", "i"}], "]"}], "[", 
             RowBox[{"x", ",", "t"}], "]"}]}], ")"}]}], "-", 
         RowBox[{"BFACT", "*", 
          RowBox[{
           RowBox[{"Subscript", "[", 
            RowBox[{"ctrp", ",", "i"}], "]"}], "[", 
           RowBox[{"x", ",", "t"}], "]"}]}]}], "/.", "Tcomponents"}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"verb", "\[GreaterEqual]", " ", "1"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Traprate \>\"", ",", " ", "i", " ", ",", " ", "\"\< = \>\"", ",",
          " ", "res"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", "res"}]}],
    "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4967415989831147`*^9, 3.496741608044687*^9}, {
   3.4967416810684586`*^9, 3.496741814054839*^9}, {3.4967418949996743`*^9, 
   3.4967419089513707`*^9}, {3.496741939042039*^9, 3.496741990083687*^9}, {
   3.4971682530798073`*^9, 3.497168309692483*^9}, {3.497168528162466*^9, 
   3.49716865041607*^9}, {3.4971687179841986`*^9, 3.4971687184059114`*^9}, {
   3.497172964962494*^9, 3.497172971680986*^9}, {3.497173229874196*^9, 
   3.4971732300773134`*^9}, {3.497177688374858*^9, 3.497177690609147*^9}, {
   3.4971777304513674`*^9, 3.497177765606267*^9}, {3.4984502029268336`*^9, 
   3.4984502593799586`*^9}, {3.4984502900049586`*^9, 3.4984502901768336`*^9}, 
   3.4984505360830836`*^9, {3.504592422092682*^9, 3.504592432171258*^9}, {
   3.504600921835099*^9, 3.504600924457848*^9}, 3.504868424776186*^9, {
   3.5049275377910323`*^9, 3.5049275438538427`*^9}, {3.5049317048149815`*^9, 
   3.5049317119403467`*^9}, {3.5049526678746176`*^9, 
   3.5049526888444414`*^9}, {3.504952879651085*^9, 3.504952991750574*^9}, {
   3.504953059269656*^9, 3.504953098256027*^9}, {3.5227388777482567`*^9, 
   3.522738918402691*^9}, {3.5227390111441565`*^9, 3.522739017094729*^9}, 
   3.5287164978104906`*^9, {3.5704190522997093`*^9, 3.570419164158591*^9}, {
   3.622356511228414*^9, 3.622356570259383*^9}, 3.622356601912098*^9, {
   3.6223577832025*^9, 3.6223578002378936`*^9}, {3.6228694029373455`*^9, 
   3.6228694683956985`*^9}, {3.63340663066457*^9, 3.6334066367328925`*^9}, {
   3.633409149750683*^9, 3.6334091558814044`*^9}, {3.6334092324608226`*^9, 
   3.6334093785061502`*^9}, {3.63340941622447*^9, 3.6334094448501034`*^9}, 
   3.633409482882416*^9, {3.633409519105151*^9, 3.6334095476995845`*^9}, 
   3.633409890848385*^9},
 CellLabel->
  "In[783]:=",ExpressionUUID->"b52e6d6a-bb58-4895-b4c4-4a9c3cb08719"],

Cell[, "Input",ExpressionUUID->"d6233e26-b5de-4f66-95c4-cfe294f358e1"],

Cell[, "Text",ExpressionUUID->"f5d9e52e-cb2f-4d17-97fb-8eaeef83dc9a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SoluteTrapCoupling", "[", "i_", "]"}], ":=", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Subscript", "[", 
      RowBox[{"ctrp", ",", "i"}], "]"}], "[", 
     RowBox[{"x", ",", "t"}], "]"}], ",", "t"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SoluteTrapCouplingManualMoL", "[", 
   RowBox[{"ti_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Subscript", "[", 
       RowBox[{"ctrp", ",", "ti"}], "]"}], "[", "i", "]"}], "[", "t", "]"}], 
    ",", "t"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4967415989831147`*^9, 3.496741608044687*^9}, {
   3.4967416810684586`*^9, 3.496741814054839*^9}, {3.4967418949996743`*^9, 
   3.4967419089513707`*^9}, {3.496741939042039*^9, 3.496741990083687*^9}, {
   3.4971682530798073`*^9, 3.497168309692483*^9}, {3.497168528162466*^9, 
   3.49716865041607*^9}, {3.4971687179841986`*^9, 3.4971687184059114`*^9}, {
   3.497172964962494*^9, 3.497172971680986*^9}, {3.497173229874196*^9, 
   3.4971732300773134`*^9}, {3.497177688374858*^9, 3.497177690609147*^9}, {
   3.4971777304513674`*^9, 3.497177765606267*^9}, {3.4984502029268336`*^9, 
   3.4984502593799586`*^9}, {3.4984502900049586`*^9, 3.4984502901768336`*^9}, 
   3.4984505360830836`*^9, {3.504592422092682*^9, 3.504592432171258*^9}, {
   3.504600921835099*^9, 3.504600924457848*^9}, 3.504868424776186*^9, {
   3.5049275377910323`*^9, 3.5049275438538427`*^9}, {3.5049317048149815`*^9, 
   3.5049317119403467`*^9}, {3.5049526678746176`*^9, 
   3.5049526888444414`*^9}, {3.504952879651085*^9, 3.504952991750574*^9}, {
   3.504953059269656*^9, 3.504953098256027*^9}, {3.5227388777482567`*^9, 
   3.522738918402691*^9}, {3.5227390111441565`*^9, 3.522739017094729*^9}, 
   3.5287164978104906`*^9, {3.5704190522997093`*^9, 3.570419164158591*^9}, {
   3.622356511228414*^9, 3.622356570259383*^9}, 3.622356601912098*^9, {
   3.6223577832025*^9, 3.6223578002378936`*^9}, {3.6228694029373455`*^9, 
   3.6228694683956985`*^9}, 3.63340663066457*^9, {3.63340675109863*^9, 
   3.633406756262163*^9}, {3.6334201451403766`*^9, 3.6334201646402516`*^9}, {
   3.840732579239558*^9, 3.840732621232512*^9}, {3.842625090889298*^9, 
   3.8426250946949863`*^9}, {3.842625189483156*^9, 3.8426251999102383`*^9}, {
   3.8897185829942837`*^9, 3.88971858915382*^9}},
 CellLabel->
  "In[787]:=",ExpressionUUID->"2c518ac3-e08b-487d-9ce2-70e4c1f27557"]
}, Open  ]],

Cell[CellGroupData[{

Cell[, "Section",ExpressionUUID->"b9555b3c-fa46-48d9-8df2-83eeb2b4b45f"],

Cell[, "Program",ExpressionUUID->"c4c52884-a77e-4199-9f59-59ba3d6a4cf4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ImplRateSurf", "[", 
   RowBox[{"From_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ImplParam", "=", 
       RowBox[{"pImplParam", "/.", "InputParam"}]}], ",", 
      "\[IndentingNewLine]", "center", " ", ",", "width", " ", ",", "flx", 
      ",", "\[IndentingNewLine]", 
      RowBox[{"dens", "=", 
       FractionBox[
        RowBox[{"prohW", "/.", "InputParam"}], 
        SuperscriptBox["tolenscale", "3"]]}], ",", "\[IndentingNewLine]", 
      "nrm"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"center", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"pImplRng", "/.", "ImplParam"}], ")"}], "*", "tolenscale"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"width", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"pImplStrgl", "/.", "ImplParam"}], ")"}], "*", 
       "tolenscale"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"flx", " ", "=", " ", 
      FractionBox[
       RowBox[{"(", 
        RowBox[{"pImplFlux", "/.", "ImplParam"}], ")"}], 
       SuperscriptBox["tolenscale", "2"]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nrm", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{"GaussFunc", "[", 
         RowBox[{"rr", ",", "center", ",", "width", ",", "1"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"rr", ",", "0", ",", "\[Infinity]"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"nrm", " ", "has", " ", "units", " ", "of", " ", "length"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<ImplRateSurf->Nrm: \>\"", ",", " ", "nrm", ",", 
         "\"\< flux/dens: \>\"", ",", 
         FractionBox["flx", "dens"]}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      FractionBox["flx", 
       RowBox[{"nrm", "*", "dens"}]], "*", 
      RowBox[{"GaussFunc", "[", 
       RowBox[{"x", ",", "center", ",", "width", ",", "1"}], "]"}]}]}]}], 
   RowBox[{"(*", 
    RowBox[{
    "Must", " ", "divide", " ", "by", " ", "density", " ", "to", " ", "yield",
      " ", "correct", " ", "uints", " ", "see", " ", "book", " ", "3", " ", 
     "p", ".88"}], "*)"}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4971778228696933`*^9, 3.497177838994074*^9}, {
   3.497178954076253*^9, 3.4971790238548236`*^9}, {3.4971793669666476`*^9, 
   3.497179389856394*^9}, {3.497179477993634*^9, 3.4971794790717173`*^9}, {
   3.4972650120187435`*^9, 3.497265012831212*^9}, {3.4973331807032623`*^9, 
   3.497333184922039*^9}, {3.497333233437975*^9, 3.4973332384067564`*^9}, 
   3.4983710808602266`*^9, {3.4984593718706837`*^9, 3.4984594074653444`*^9}, {
   3.49845943951304*^9, 3.4984594716544876`*^9}, {3.4984595611411705`*^9, 
   3.498459566016327*^9}, {3.5046072475532017`*^9, 3.5046072849767528`*^9}, {
   3.5046073753089247`*^9, 3.5046073953566976`*^9}, {3.504607788671192*^9, 
   3.5046078069063845`*^9}, {3.5049326211118937`*^9, 3.504932623346383*^9}, {
   3.518943509264078*^9, 3.5189435401218867`*^9}, {3.518943660398629*^9, 
   3.5189436678007555`*^9}, {3.5189438836024055`*^9, 3.51894397879937*^9}, {
   3.5189440276003075`*^9, 3.5189440882384005`*^9}, {3.5189441206890717`*^9, 
   3.518944122297551*^9}, {3.519006132202371*^9, 3.5190061602764077`*^9}, {
   3.5190062049763546`*^9, 3.5190062066547794`*^9}, {3.5190062667139*^9, 
   3.519006276166918*^9}, {3.519010250029976*^9, 3.5190102534191904`*^9}, {
   3.5190104908672457`*^9, 3.5190105060640464`*^9}, {3.5190279709362607`*^9, 
   3.5190279812600894`*^9}, {3.528708751118186*^9, 3.528708766320922*^9}, {
   3.528708801070032*^9, 3.5287088015700197`*^9}, {3.5305190420672917`*^9, 
   3.5305190892991476`*^9}, 3.5305191596627426`*^9, {3.557649503494816*^9, 
   3.557649508150976*^9}, 3.6239872463064337`*^9, 3.6239876439861155`*^9, 
   3.6239877005179787`*^9, {3.6240177427204266`*^9, 3.6240177492256684`*^9}, {
   3.626668747377968*^9, 3.6266687690940027`*^9}, {3.6266695065329857`*^9, 
   3.6266695639097853`*^9}, {3.626669626668586*^9, 3.6266696269181857`*^9}, {
   3.6266698274292927`*^9, 3.626669884823164*^9}, 3.633410213561451*^9, 
   3.6334120775949855`*^9, {3.6334121173279305`*^9, 3.6334121276706643`*^9}, {
   3.6334121781831408`*^9, 3.633412228617617*^9}, {3.6334124836441803`*^9, 
   3.6334124898529005`*^9}, {3.633413879283496*^9, 3.633413881139872*^9}, 
   3.872781229614259*^9},
 CellLabel->
  "In[789]:=",ExpressionUUID->"c27fcd5f-2cec-4c88-8e2e-d1122d64c089"],

Cell[, "Input",ExpressionUUID->"06601610-a78d-411b-9cda-330bc81e3f6f"],

Cell[, "Program",ExpressionUUID->"3b48685b-d5a8-48be-ba1b-3b5c7daf2ad4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ImplRate", "[", 
   RowBox[{"From_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ImplParam", "=", 
       RowBox[{"pImplParam", "/.", "InputParam"}]}], ",", 
      "\[IndentingNewLine]", "center", " ", ",", "width", " ", ",", "flx", 
      ",", "implstepsteep", ",", "\[IndentingNewLine]", 
      RowBox[{"dens", "=", 
       FractionBox[
        RowBox[{"prohW", "/.", "InputParam"}], 
        SuperscriptBox["tolenscale", "3"]]}], ",", "\[IndentingNewLine]", 
      "rr", ",", "\[IndentingNewLine]", "nrm"}], "\[IndentingNewLine]", "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"center", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"pImplRng", "/.", "ImplParam"}], ")"}], "*", "tolenscale"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"width", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"pImplStrgl", "/.", "ImplParam"}], ")"}], "*", 
       "tolenscale"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"flx", " ", "=", " ", 
      FractionBox[
       RowBox[{"(", 
        RowBox[{"pImplFlux", "/.", "ImplParam"}], ")"}], 
       SuperscriptBox["tolenscale", "2"]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"implstepsteep", "=", 
      RowBox[{"pImplStepSteepnes", "/.", "ImplParam"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nrm", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GaussFunc", "[", 
          RowBox[{"rr", ",", "center", ",", "width", ",", "1"}], "]"}], "*", 
         RowBox[{"BMFunc", "[", 
          RowBox[{
          "rr", ",", "From", ",", "implstepsteep", ",", "0", ",", "1"}], 
          "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"rr", ",", "From", ",", "\[Infinity]"}], "}"}], ",", 
        RowBox[{"MaxRecursion", "\[Rule]", "50"}]}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"nrm", " ", "has", " ", "units", " ", "of", " ", "length"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<ImplRate->From: \>\"", ",", " ", 
         RowBox[{"N", "[", "From", "]"}], ",", "\"\< Nrm: \>\"", ",", " ", 
         "nrm", ",", "\"\< flux/dens: \>\"", ",", 
         FractionBox["flx", "dens"]}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      FractionBox["flx", 
       RowBox[{"nrm", "*", "dens"}]], "*", 
      RowBox[{"GaussFunc", "[", 
       RowBox[{"x", ",", "center", ",", "width", ",", "1"}], "]"}], "*", 
      RowBox[{"BMFunc", "[", 
       RowBox[{"x", ",", "From", ",", "implstepsteep", ",", "0", ",", "1"}], 
       "]"}]}]}]}], 
   RowBox[{"(*", 
    RowBox[{
    "Must", " ", "divide", " ", "by", " ", "density", " ", "to", " ", "yield",
      " ", "correct", " ", "uints", " ", "see", " ", "book", " ", "3", " ", 
     "p", ".88"}], "*)"}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4971778228696933`*^9, 3.497177838994074*^9}, {
   3.497178954076253*^9, 3.4971790238548236`*^9}, {3.4971793669666476`*^9, 
   3.497179389856394*^9}, {3.497179477993634*^9, 3.4971794790717173`*^9}, {
   3.4972650120187435`*^9, 3.497265012831212*^9}, {3.4973331807032623`*^9, 
   3.497333184922039*^9}, {3.497333233437975*^9, 3.4973332384067564`*^9}, 
   3.4983710808602266`*^9, {3.4984593718706837`*^9, 3.4984594074653444`*^9}, {
   3.49845943951304*^9, 3.4984594716544876`*^9}, {3.4984595611411705`*^9, 
   3.498459566016327*^9}, {3.5046072475532017`*^9, 3.5046072849767528`*^9}, {
   3.5046073753089247`*^9, 3.5046073953566976`*^9}, {3.504607788671192*^9, 
   3.5046078069063845`*^9}, {3.5049326211118937`*^9, 3.504932623346383*^9}, {
   3.518943509264078*^9, 3.5189435401218867`*^9}, {3.518943660398629*^9, 
   3.5189436678007555`*^9}, {3.5189438836024055`*^9, 3.51894397879937*^9}, {
   3.5189440276003075`*^9, 3.5189440882384005`*^9}, {3.5189441206890717`*^9, 
   3.518944122297551*^9}, {3.519006132202371*^9, 3.5190061602764077`*^9}, {
   3.5190062049763546`*^9, 3.5190062066547794`*^9}, {3.5190062667139*^9, 
   3.519006276166918*^9}, {3.519010250029976*^9, 3.5190102534191904`*^9}, {
   3.5190104908672457`*^9, 3.5190105060640464`*^9}, {3.5190279709362607`*^9, 
   3.5190279812600894`*^9}, {3.528708751118186*^9, 3.528708766320922*^9}, {
   3.528708801070032*^9, 3.5287088015700197`*^9}, {3.5305190420672917`*^9, 
   3.5305190892991476`*^9}, 3.5305191596627426`*^9, {3.557649503494816*^9, 
   3.557649508150976*^9}, 3.6239872463064337`*^9, 3.6239876439861155`*^9, 
   3.6239877005179787`*^9, {3.6240177427204266`*^9, 3.6240177492256684`*^9}, {
   3.626668747377968*^9, 3.6266687690940027`*^9}, {3.6266695065329857`*^9, 
   3.6266695639097853`*^9}, {3.626669626668586*^9, 3.6266696269181857`*^9}, {
   3.6266698274292927`*^9, 3.626669884823164*^9}, {3.633410213561451*^9, 
   3.633410217321003*^9}, {3.6334122628749976`*^9, 3.633412285292054*^9}, {
   3.6334124945796404`*^9, 3.633412495047634*^9}, {3.633413922214145*^9, 
   3.6334139376735473`*^9}, 3.840822210541451*^9},
 CellLabel->
  "In[790]:=",ExpressionUUID->"f96582ec-b2b6-48e6-9140-29525632da55"],

Cell[, "Input",ExpressionUUID->"34f6f82d-2e4d-4167-9722-2d03afd06802"],

Cell[, "Program",ExpressionUUID->"cdf9fd50-90c8-4242-b1c5-bedc0d8619e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CutOffImplRate", "[", 
   RowBox[{"From_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ImplParam", "=", 
       RowBox[{"pImplParam", "/.", "InputParam"}]}], ",", 
      "\[IndentingNewLine]", "center", " ", ",", "width", " ", ",", "flx", 
      ",", "implstepsteep", ",", "\[IndentingNewLine]", "implOfftime", " ", 
      ",", "ImplOffScale", ",", "\[IndentingNewLine]", 
      RowBox[{"dens", "=", 
       FractionBox[
        RowBox[{"prohW", "/.", "InputParam"}], 
        SuperscriptBox["tolenscale", "3"]]}], ",", "\[IndentingNewLine]", 
      "rr", ",", "\[IndentingNewLine]", "nrm"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"center", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"pImplRng", "/.", "ImplParam"}], ")"}], "*", "tolenscale"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"width", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"pImplStrgl", "/.", "ImplParam"}], ")"}], "*", 
       "tolenscale"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"implstepsteep", "=", 
      RowBox[{"pImplStepSteepnes", "/.", "ImplParam"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"flx", " ", "=", " ", 
      FractionBox[
       RowBox[{"(", 
        RowBox[{"pImplFlux", "/.", "ImplParam"}], ")"}], 
       SuperscriptBox["tolenscale", "2"]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"implOfftime", "  ", "=", 
      RowBox[{"(", 
       RowBox[{"pImplOffTime", "/.", "ImplParam"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ImplOffScale", "=", 
      RowBox[{"(", 
       RowBox[{"pImplOffScale", "/.", "ImplParam"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nrm", "=", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"2.0", "/", 
         RowBox[{"(", 
          RowBox[{"center", "+", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"center", "^", "2"}]}], "*", 
              RowBox[{"width", "^", "2"}]}], "]"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Sqrt", "[", "Pi", "]"}], "*", "width"}], ")"}]}], "+", 
           RowBox[{"center", "*", 
            RowBox[{"Erf", "[", 
             RowBox[{"center", "*", "width"}], "]"}]}]}], ")"}]}], ";"}], 
       "*)"}], 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"0.5", "+", 
           RowBox[{"0.5", "*", 
            RowBox[{"Erf", "[", 
             RowBox[{"width", "*", "1000", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "rr"}], "*", "1000"}], "+", 
                RowBox[{"center", "*", "1000"}]}], ")"}]}], "]"}]}]}], ")"}], 
         "*", 
         RowBox[{"BMFunc", "[", 
          RowBox[{
          "rr", ",", "From", ",", "implstepsteep", ",", "0", ",", "1"}], 
          "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"rr", ",", "From", ",", "0.2"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"nrm", " ", "has", " ", "units", " ", "of", " ", "length"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      FractionBox["flx", 
       RowBox[{"nrm", "*", "dens"}]], "*", 
      RowBox[{"(", 
       RowBox[{"0.5", "+", 
        RowBox[{"0.5", "*", 
         RowBox[{"Erf", "[", 
          RowBox[{"width", "*", "1000", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "x"}], "*", "1000"}], "+", 
             RowBox[{"center", "*", "1000"}]}], ")"}]}], "]"}]}]}], ")"}], 
      "*", 
      RowBox[{"BMFunc", "[", 
       RowBox[{"x", ",", "From", ",", "implstepsteep", ",", "0", ",", "1"}], 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4971778228696933`*^9, 3.497177838994074*^9}, {
   3.497178954076253*^9, 3.4971790238548236`*^9}, {3.4971793669666476`*^9, 
   3.497179389856394*^9}, {3.497179477993634*^9, 3.4971794790717173`*^9}, {
   3.4972650120187435`*^9, 3.497265012831212*^9}, {3.4973331807032623`*^9, 
   3.497333184922039*^9}, {3.497333233437975*^9, 3.4973332384067564`*^9}, 
   3.4983710808602266`*^9, {3.4984593718706837`*^9, 3.4984594074653444`*^9}, {
   3.49845943951304*^9, 3.4984594716544876`*^9}, {3.4984595611411705`*^9, 
   3.498459566016327*^9}, {3.5046072475532017`*^9, 3.5046072849767528`*^9}, {
   3.5046073753089247`*^9, 3.5046073953566976`*^9}, {3.504607788671192*^9, 
   3.5046078069063845`*^9}, {3.5049326211118937`*^9, 3.504932623346383*^9}, {
   3.518943509264078*^9, 3.5189435401218867`*^9}, {3.518943660398629*^9, 
   3.5189436678007555`*^9}, {3.5189438836024055`*^9, 3.51894397879937*^9}, {
   3.5189440276003075`*^9, 3.5189440882384005`*^9}, {3.5189441206890717`*^9, 
   3.518944122297551*^9}, {3.519006132202371*^9, 3.5190061602764077`*^9}, {
   3.5190062049763546`*^9, 3.5190062066547794`*^9}, {3.5190062667139*^9, 
   3.519006276166918*^9}, {3.519010250029976*^9, 3.5190102534191904`*^9}, {
   3.5190104908672457`*^9, 3.5190105060640464`*^9}, {3.5190279709362607`*^9, 
   3.5190279812600894`*^9}, {3.528708751118186*^9, 3.528708766320922*^9}, {
   3.528708801070032*^9, 3.5287088015700197`*^9}, {3.5305190420672917`*^9, 
   3.5305190892991476`*^9}, 3.5305191596627426`*^9, {3.557649503494816*^9, 
   3.557649508150976*^9}, 3.6239872463064337`*^9, 3.6239876439861155`*^9, 
   3.6239877005179787`*^9, {3.6240177427204266`*^9, 3.6240177492256684`*^9}, {
   3.626668747377968*^9, 3.6266687690940027`*^9}, {3.6266695065329857`*^9, 
   3.6266695639097853`*^9}, {3.626669626668586*^9, 3.6266696269181857`*^9}, {
   3.6266698274292927`*^9, 3.626669884823164*^9}, {3.633410213561451*^9, 
   3.6334102211585536`*^9}, {3.6334124276408987`*^9, 3.6334124703843503`*^9}, 
   3.633412533984735*^9, {3.6334125871488533`*^9, 3.633412591859993*^9}, {
   3.633412814484739*^9, 3.6334128186186857`*^9}, {3.6334139912432604`*^9, 
   3.6334139914772573`*^9}, {3.7531079573664417`*^9, 3.7531080078468*^9}, 
   3.753109141728176*^9, {3.75310920828588*^9, 3.7531092196219263`*^9}, {
   3.753110483751562*^9, 3.753110617054126*^9}, {3.753111236942357*^9, 
   3.7531112386253757`*^9}, {3.753111297243227*^9, 3.753111348273368*^9}, {
   3.753111383693845*^9, 3.7531113900875483`*^9}, {3.753111744744101*^9, 
   3.753111773271308*^9}, 3.7531118412664843`*^9, {3.753111945325429*^9, 
   3.7531119833276987`*^9}, {3.7531123617007437`*^9, 
   3.7531123888448057`*^9}, {3.753112772870085*^9, 3.753112879450199*^9}},
 CellLabel->
  "In[791]:=",ExpressionUUID->"bb99081a-6589-4b05-92c5-793c42de27d9"],

Cell[, "Input",ExpressionUUID->"583be63a-cf49-4ddb-b532-c049f5456b95"],

Cell[, "Program",ExpressionUUID->"67ce42d3-ad25-42fe-89f6-49da5d206a61"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"OnOffImplRateSurf", "[", 
   RowBox[{"From_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ImplParam", "=", 
       RowBox[{"pImplParam", "/.", "InputParam"}]}], ",", 
      "\[IndentingNewLine]", "center", " ", ",", "width", " ", ",", "flx", 
      ",", "\[IndentingNewLine]", 
      RowBox[{"dens", "=", 
       FractionBox[
        RowBox[{"prohW", "/.", "InputParam"}], 
        SuperscriptBox["tolenscale", "3"]]}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "implOfftime", ",", "ImplOffScale", ",", 
      "implOntime", " ", ",", "ImplOnscale", ",", "\[IndentingNewLine]", 
      "nrm"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"center", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"pImplRng", "/.", "ImplParam"}], ")"}], "*", "tolenscale"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"width", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"pImplStrgl", "/.", "ImplParam"}], ")"}], "*", 
       "tolenscale"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"flx", " ", "=", " ", 
      FractionBox[
       RowBox[{"(", 
        RowBox[{"pImplFlux", "/.", "ImplParam"}], ")"}], 
       SuperscriptBox["tolenscale", "2"]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"implOfftime", "  ", "=", 
      RowBox[{"(", 
       RowBox[{"pImplOffTime", "/.", "ImplParam"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ImplOffScale", "=", 
      RowBox[{"(", 
       RowBox[{"pImplOffScale", "/.", "ImplParam"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"implOntime", "  ", "=", 
      RowBox[{"(", 
       RowBox[{"pImplOnTime", "/.", "ImplParam"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ImplOnscale", "=", 
      RowBox[{"(", 
       RowBox[{"pImplOnScale", "/.", "ImplParam"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nrm", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{"GaussFunc", "[", 
         RowBox[{"rr", ",", "center", ",", "width", ",", "1"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"rr", ",", "0", ",", "\[Infinity]"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"nrm", " ", "has", " ", "units", " ", "of", " ", "length"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      FractionBox["flx", 
       RowBox[{"nrm", "*", "dens"}]], "*", 
      RowBox[{"GaussFunc", "[", 
       RowBox[{"x", ",", "center", ",", "width", ",", "1"}], "]"}], "*", 
      RowBox[{"CutOff", "[", 
       RowBox[{"t", ",", "implOfftime", ",", "ImplOffScale"}], "]"}], "*", 
      RowBox[{"TurnOn", "[", 
       RowBox[{"t", ",", "implOntime", ",", "ImplOnscale"}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OnOffImplRateSurfPlasmaAnneal", "[", 
   RowBox[{"From_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ImplParam", "=", 
       RowBox[{"pImplParam", "/.", "InputParam"}]}], ",", 
      "\[IndentingNewLine]", "center", " ", ",", "width", " ", ",", "flx", 
      ",", "\[IndentingNewLine]", 
      RowBox[{"dens", "=", 
       FractionBox[
        RowBox[{"prohW", "/.", "InputParam"}], 
        SuperscriptBox["tolenscale", "3"]]}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "implOfftime", ",", "ImplOffScale", ",", 
      "implOntime", " ", ",", "ImplOnscale", ",", "implOfftime2", ",", 
      "\[IndentingNewLine]", "nrm"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"center", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"pImplRng", "/.", "ImplParam"}], ")"}], "*", "tolenscale"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"width", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"pImplStrgl", "/.", "ImplParam"}], ")"}], "*", 
       "tolenscale"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"flx", " ", "=", " ", 
      FractionBox[
       RowBox[{"(", 
        RowBox[{"pImplFlux", "/.", "ImplParam"}], ")"}], 
       SuperscriptBox["tolenscale", "2"]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"implOfftime", "  ", "=", 
      RowBox[{"(", 
       RowBox[{"pImplOffTime", "/.", "ImplParam"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"implOfftime2", "  ", "=", 
      RowBox[{"(", 
       RowBox[{"pImplOffTime2", "/.", "ImplParam"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ImplOffScale", "=", 
      RowBox[{"(", 
       RowBox[{"pImplOffScale", "/.", "ImplParam"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"implOntime", "  ", "=", 
      RowBox[{"(", 
       RowBox[{"pImplOnTime", "/.", "ImplParam"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ImplOnscale", "=", 
      RowBox[{"(", 
       RowBox[{"pImplOnScale", "/.", "ImplParam"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nrm", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{"GaussFunc", "[", 
         RowBox[{"rr", ",", "center", ",", "width", ",", "1"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"rr", ",", "0", ",", "\[Infinity]"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"nrm", " ", "has", " ", "units", " ", "of", " ", "length"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      FractionBox["flx", 
       RowBox[{"nrm", "*", "dens"}]], "*", 
      RowBox[{"GaussFunc", "[", 
       RowBox[{"x", ",", "center", ",", "width", ",", "1"}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CutOff", "[", 
         RowBox[{"t", ",", "implOfftime", ",", "ImplOffScale"}], "]"}], "+", 
        RowBox[{"TurnOn", "[", 
         RowBox[{"t", ",", "implOntime", ",", "ImplOnscale"}], "]"}], "+", 
        RowBox[{"CutOff", "[", 
         RowBox[{"t", ",", "implOfftime2", ",", "ImplOffScale"}], "]"}], "-", 
        "1"}], ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4971778228696933`*^9, 3.497177838994074*^9}, {
   3.497178954076253*^9, 3.4971790238548236`*^9}, {3.4971793669666476`*^9, 
   3.497179389856394*^9}, {3.497179477993634*^9, 3.4971794790717173`*^9}, {
   3.4972650120187435`*^9, 3.497265012831212*^9}, {3.4973331807032623`*^9, 
   3.497333184922039*^9}, {3.497333233437975*^9, 3.4973332384067564`*^9}, 
   3.4983710808602266`*^9, {3.4984593718706837`*^9, 3.4984594074653444`*^9}, {
   3.49845943951304*^9, 3.4984594716544876`*^9}, {3.4984595611411705`*^9, 
   3.498459566016327*^9}, {3.5046072475532017`*^9, 3.5046072849767528`*^9}, {
   3.5046073753089247`*^9, 3.5046073953566976`*^9}, {3.504607788671192*^9, 
   3.5046078069063845`*^9}, {3.5049326211118937`*^9, 3.504932623346383*^9}, {
   3.518943509264078*^9, 3.5189435401218867`*^9}, {3.518943660398629*^9, 
   3.5189436678007555`*^9}, {3.5189438836024055`*^9, 3.51894397879937*^9}, {
   3.5189440276003075`*^9, 3.5189440882384005`*^9}, {3.5189441206890717`*^9, 
   3.518944122297551*^9}, {3.519006132202371*^9, 3.5190061602764077`*^9}, {
   3.5190062049763546`*^9, 3.5190062066547794`*^9}, {3.5190062667139*^9, 
   3.519006276166918*^9}, {3.519010250029976*^9, 3.5190102534191904`*^9}, {
   3.5190104908672457`*^9, 3.5190105060640464`*^9}, {3.5190279709362607`*^9, 
   3.5190279812600894`*^9}, {3.528708751118186*^9, 3.528708766320922*^9}, {
   3.528708801070032*^9, 3.5287088015700197`*^9}, {3.5305190420672917`*^9, 
   3.5305190892991476`*^9}, 3.5305191596627426`*^9, {3.557649503494816*^9, 
   3.557649508150976*^9}, 3.6239872463064337`*^9, 3.6239876439861155`*^9, 
   3.6239877005179787`*^9, {3.6240177427204266`*^9, 3.6240177492256684`*^9}, {
   3.626668747377968*^9, 3.6266687690940027`*^9}, {3.6266695065329857`*^9, 
   3.6266695639097853`*^9}, {3.626669626668586*^9, 3.6266696269181857`*^9}, {
   3.6266698274292927`*^9, 3.626669884823164*^9}, {3.633410213561451*^9, 
   3.6334102211585536`*^9}, {3.6334127605406303`*^9, 
   3.6334128422835827`*^9}, {3.63341399907436*^9, 3.6334140308511524`*^9}, {
   3.8432514146283817`*^9, 3.843251420160026*^9}, {3.8432519762357893`*^9, 
   3.8432520227794323`*^9}, 3.843252193121724*^9},
 CellLabel->
  "In[792]:=",ExpressionUUID->"1a055aa0-bb35-4abc-a773-7686890a2a5c"],

Cell[, "Input",ExpressionUUID->"c78d9131-4253-4179-861a-95a5f0c1a5b9"],

Cell[, "Program",ExpressionUUID->"c8069569-a009-4997-a87d-b8850129f2e6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"ImplRatePlaQDFull", " ", "includes", " ", "D"}], "+"}], ",", 
    " ", 
    RowBox[{"D2", "+", " ", 
     RowBox[{"and", " ", "D3"}], "+", " ", 
     RowBox[{
     "implantation", " ", "profiles", " ", "and", " ", "reflection", " ", 
      RowBox[{"yields", ".", " ", "Added"}], " ", "by", " ", 
      RowBox[{"A", ".", "Manhard"}], " ", "2014"}], "-", "01", "-", "21"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Required", " ", 
      RowBox[{"input", ":", " ", "pImplBias"}]}], " ", "=", " ", 
     RowBox[{
      RowBox[{"bias", " ", "voltage", " ", 
       RowBox[{
        RowBox[{"(", "V", ")"}], ".", " ", "pPlasmaPot"}]}], " ", "=", " ", 
      RowBox[{"plasma", " ", "potential", " ", 
       RowBox[{
        RowBox[{"(", "eV", ")"}], ".", " ", "pD1Fraction"}]}]}]}], ",", " ", 
    "pD2Fraction", ",", " ", 
    RowBox[{"pD3Fraction", " ", "=", " ", 
     RowBox[{
      RowBox[{"fractions", " ", "of", " ", "D"}], "+"}]}], ",", " ", 
    RowBox[{
     RowBox[{"D2", "+", " ", 
      RowBox[{"and", " ", "D3"}], "+", 
      RowBox[{".", " ", "pImplFlux"}]}], " ", "=", " ", 
     RowBox[{"total", " ", "incident", " ", "D", " ", "flux", " ", "in", " ", 
      RowBox[{"D", "/", "m\.b2s"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ImplRatePlaQDFull", "[", 
    RowBox[{"From_", ",", "x_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"verb", "=", 
        RowBox[{"VERBOSE", "/.", "InputParam"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"ImplParam", "=", 
        RowBox[{"pImplParam", "/.", "InputParam"}]}], ",", 
       "\[IndentingNewLine]", "impangle", ",", "implOntime", ",", 
       "ImplOnScale", ",", "implOfftime", ",", "ImplOffScale", ",", 
       "\[IndentingNewLine]", "bias", ",", "plasmapotential", ",", 
       "\[IndentingNewLine]", "D1Frac", ",", "D2Frac", ",", "totflx", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dens", "=", 
        FractionBox[
         RowBox[{"prohW", "/.", "InputParam"}], 
         SuperscriptBox["tolenscale", "3"]]}], ",", "\[IndentingNewLine]", 
       "implstepsteep", ",", "\[IndentingNewLine]", "totenergy", ",", 
       "\[IndentingNewLine]", "D1center", ",", "\[IndentingNewLine]", 
       "D1sigma", ",", "\[IndentingNewLine]", "D1refl", ",", 
       "\[IndentingNewLine]", "D2center", ",", "\[IndentingNewLine]", 
       "D2sigma", ",", "\[IndentingNewLine]", "D2refl", ",", 
       "\[IndentingNewLine]", "D3center", ",", "\[IndentingNewLine]", 
       "D3sigma", ",", "\[IndentingNewLine]", "D3refl", ",", 
       "\[IndentingNewLine]", "D3Frac", ",", "\[IndentingNewLine]", 
       "tointegrate", ",", "\[IndentingNewLine]", "IncidentNrm", ",", 
       "\[IndentingNewLine]", "ImplFrac", ",", "\[IndentingNewLine]", 
       "onscale", ",", " ", "offscale"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"impangle", "=", 
       RowBox[{"(", 
        RowBox[{"pImplAngle", "/.", "ImplParam"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"plasmapotential", "=", 
       RowBox[{"(", 
        RowBox[{"pPlasmaPot", "/.", "ImplParam"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bias", "=", 
       RowBox[{"(", 
        RowBox[{"pImplBias", "/.", "ImplParam"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"implOntime", "  ", "=", 
       RowBox[{"(", 
        RowBox[{"pImplOnTime", "/.", "ImplParam"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ImplOnScale", "=", 
       RowBox[{"(", 
        RowBox[{"pImplOnScale", "/.", "ImplParam"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"implOfftime", "  ", "=", 
       RowBox[{"(", 
        RowBox[{"pImplOffTime", "/.", "ImplParam"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ImplOffScale", "=", 
       RowBox[{"(", 
        RowBox[{"pImplOffScale", "/.", "ImplParam"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"implstepsteep", "=", 
       RowBox[{"pImplStepSteepnes", "/.", "ImplParam"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"D1Frac", "=", 
       RowBox[{"(", 
        RowBox[{"pD1Fraction", " ", "/.", " ", "ImplParam"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"D2Frac", "=", 
       RowBox[{"(", 
        RowBox[{"pD2Fraction", " ", "/.", " ", "ImplParam"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"totflx", "=", 
       FractionBox[
        RowBox[{"(", 
         RowBox[{"pImplFlux", "/.", "ImplParam"}], ")"}], 
        SuperscriptBox["tolenscale", "2"]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"D3Frac", "=", 
       RowBox[{"1", "-", "D1Frac", "-", "D2Frac"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"totenergy", "=", 
       RowBox[{"bias", "+", "plasmapotential"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"D1center", "=", 
       RowBox[{"1*^-9", "*", "tolenscale", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "0.54243"}], " ", "+", " ", 
          RowBox[{"0.3991", " ", "*", " ", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"totenergy", "  ", "+", " ", "0.14818"}], "]"}]}]}], 
         ")"}]}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "fit", " ", "to", " ", "SDTRIM", " ", "calculations", " ", "5"}], " ",
         "-", " ", 
        RowBox[{"615", " ", "eV"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"D1sigma", " ", "=", " ", 
       RowBox[{"1*^-9", "*", "tolenscale", "*", 
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{"-", "2.07114"}], " ", "+", "  ", 
          RowBox[{"0.39214", " ", "*", " ", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"totenergy", "  ", "+", " ", "59.13706"}], "]"}]}]}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"D1refl", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"0.4453", " ", "*", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"totenergy", "/", "9923.26"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"-", "0.0879"}], ")"}]}]}], ")"}], " ", "/", " ", 
        RowBox[{"(", 
         RowBox[{"1", " ", "+", " ", 
          RowBox[{"0.5964", " ", "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"totenergy", "/", "9923.26"}], ")"}], "^", 
            "1.3344"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"D2center", "=", 
       RowBox[{"1*^-9", "*", "tolenscale", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "0.54243"}], " ", "+", " ", 
          RowBox[{"0.3991", " ", "*", " ", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{"totenergy", " ", "/", "2"}], " ", "+", " ", "0.14818"}],
             "]"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"D2sigma", " ", "=", " ", 
       RowBox[{"1*^-9", "*", "tolenscale", "*", 
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{"-", "2.07114"}], " ", "+", "  ", 
          RowBox[{"0.39214", " ", "*", " ", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{"totenergy", "/", "2"}], "  ", "+", " ", "59.13706"}], 
            "]"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"D2refl", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"0.4453", " ", "*", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"totenergy", "/", "2"}], "/", "9923.26"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"-", "0.0879"}], ")"}]}]}], ")"}], " ", "/", " ", 
        RowBox[{"(", 
         RowBox[{"1", " ", "+", " ", 
          RowBox[{"0.5964", " ", "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"totenergy", "/", "2"}], "/", "9923.26"}], ")"}], "^", 
            "1.3344"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"D3center", " ", "=", " ", 
       RowBox[{"1*^-9", "*", "tolenscale", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "0.54243"}], " ", "+", " ", 
          RowBox[{"0.3991", " ", "*", " ", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{"totenergy", "/", "3"}], " ", "+", " ", "0.14818"}], 
            "]"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"D3sigma", " ", "=", " ", 
       RowBox[{"1*^-9", "*", "tolenscale", "*", 
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{"-", "2.07114"}], " ", "+", "  ", 
          RowBox[{"0.39214", " ", "*", " ", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{"totenergy", "/", "3"}], " ", "+", " ", "59.13706"}], 
            "]"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"D3refl", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"0.4453", " ", "*", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"totenergy", "/", "3"}], "/", "9923.26"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"-", "0.0879"}], ")"}]}]}], ")"}], " ", "/", " ", 
        RowBox[{"(", 
         RowBox[{"1", " ", "+", " ", 
          RowBox[{"0.5964", " ", "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"totenergy", "/", "3"}], "/", "9923.26"}], ")"}], "^", 
            "1.3344"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tointegrate", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"NormalizedGauss", "[", 
           RowBox[{"rr", ",", "D1center", ",", "D1sigma", ",", "D1Frac"}], 
           "]"}], " ", "+", " ", 
          RowBox[{"NormalizedGauss", "[", 
           RowBox[{"rr", ",", "D2center", ",", "D2sigma", ",", "D2Frac"}], 
           "]"}], " ", "+", " ", 
          RowBox[{"NormalizedGauss", "[", 
           RowBox[{"rr", ",", "D3center", ",", "D3sigma", ",", "D3Frac"}], 
           "]"}]}], ")"}], "*", 
        RowBox[{"BMFunc", "[", 
         RowBox[{
         "rr", ",", "0", ",", "implstepsteep", ",", "From", ",", "1"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verb", "\[GreaterEqual]", " ", "3"}], ",", 
        RowBox[{"Print", "[", "tointegrate", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"IncidentNrm", "=", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{"tointegrate", ",", 
         RowBox[{"{", 
          RowBox[{"rr", ",", "From", ",", "\[Infinity]"}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"(*", 
       RowBox[{
       "IncidentNrm", " ", "has", " ", "units", " ", "of", " ", "length"}], 
       "*)"}], " ", 
      RowBox[{"(*", 
       RowBox[{"corresponds", " ", "to", " ", "INCIDENT", " ", "flux"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"ImplFrac", " ", "=", " ", 
       RowBox[{
        RowBox[{"D1Frac", "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", "D1refl"}], ")"}]}], " ", "+", " ", 
        RowBox[{"D2Frac", "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", "D2refl"}], ")"}]}], " ", "+", " ", 
        RowBox[{"D3Frac", "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", "D3refl"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verb", "\[GreaterEqual]", " ", "1"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ImplRatePlaQDFull->IncidentNrm: \>\"", ",", " ", "IncidentNrm", 
          ",", "\"\< flux/dens: \>\"", ",", 
          FractionBox["totflx", "dens"]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verb", "\[GreaterEqual]", " ", "1"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Implantation angle correction factor: \>\"", ",", 
          RowBox[{"N", "[", 
           RowBox[{"Cos", "[", "impangle", "]"}], "]"}]}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verb", "\[GreaterEqual]", " ", "1"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<D+ fraction: \>\"", ",", " ", "D1Frac", ",", " ", 
          "\"\<   D+ reflection: \>\"", ",", " ", "D1refl", ",", 
          "\"\<   D2+ fraction: \>\"", ",", " ", "D2Frac", ",", " ", 
          "\"\<   D2+ reflection: \>\"", ",", " ", "D2refl", ",", 
          "\"\<   D3+ fraction: \>\"", ",", " ", "D3Frac", ",", " ", 
          "\"\<   D3+ reflection: \>\"", ",", " ", "D3refl", ",", " ", 
          "\"\<  implanted fraction: \>\"", ",", " ", "ImplFrac"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"onscale", "=", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"NumberQ", "[", "implOntime", "]"}], "&&", 
          RowBox[{"NumberQ", "[", "ImplOnScale", "]"}]}], " ", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"verb", "\[GreaterEqual]", " ", "3"}], ",", 
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<Numerical value for pImplOnTime->\>\"", ",", "implOfftime", 
              ",", "\"\< found\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"TurnOn", "[", 
           RowBox[{"t", ",", "implOntime", ",", "ImplOnScale"}], "]"}]}], ",",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<No plasma ON detected\>\"", "]"}], ";", 
          "\[IndentingNewLine]", "1"}]}], "\[IndentingNewLine]", "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"offscale", "=", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"NumberQ", "[", "implOfftime", "]"}], "&&", 
          RowBox[{"NumberQ", "[", "ImplOffScale", "]"}]}], " ", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"verb", "\[GreaterEqual]", " ", "3"}], ",", 
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<Numerical value for pImplOffTime->\>\"", ",", "implOfftime",
               ",", "\"\< found\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", " ", 
          RowBox[{"CutOff", "[", 
           RowBox[{"t", ",", "implOfftime", ",", "ImplOffScale"}], "]"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<No plasma OFF detected\>\"", "]"}], ";", 
          "\[IndentingNewLine]", "1"}]}], "\[IndentingNewLine]", "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verb", "\[GreaterEqual]", " ", "1"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Plasma on scale: \>\"", ",", "onscale"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verb", "\[GreaterEqual]", " ", "1"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Plasma off scale: \>\"", ",", "offscale"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       FractionBox["totflx", 
        RowBox[{"IncidentNrm", "*", "dens"}]], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"NormalizedGauss", "[", 
          RowBox[{"x", ",", 
           RowBox[{"D1center", "*", 
            RowBox[{"Cos", "[", "impangle", "]"}]}], ",", "D1sigma", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "D1refl"}], ")"}], "*", "D1Frac"}]}], "]"}], 
         " ", "+", " ", 
         RowBox[{"NormalizedGauss", "[", 
          RowBox[{"x", ",", 
           RowBox[{"D2center", "*", 
            RowBox[{"Cos", "[", "impangle", "]"}]}], ",", "D2sigma", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "D2refl"}], ")"}], "*", "D2Frac"}]}], "]"}], 
         "+", 
         RowBox[{"NormalizedGauss", "[", 
          RowBox[{"x", ",", 
           RowBox[{"D3center", "*", 
            RowBox[{"Cos", "[", "impangle", "]"}]}], ",", "D3sigma", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "D3refl"}], ")"}], "*", "D3Frac"}]}], "]"}]}], 
        ")"}], "*", 
       RowBox[{"BMFunc", "[", 
        RowBox[{"x", ",", "From", ",", "implstepsteep", ",", "0", ",", "1"}], 
        "]"}], "*", "onscale", "*", "offscale"}]}]}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Must", " ", "divide", " ", "by", " ", "density", " ", "to", " ", 
      "yield", " ", "correct", " ", "units", " ", "see", " ", "book", " ", 
      "3", " ", "p", ".88"}], "*)"}], 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Fluxes", " ", "corrected", " ", "by", " ", "reflection", " ", 
       RowBox[{"yield", ".", " ", "See"}], " ", "Eckstein"}], ",", " ", 
      RowBox[{"IPP", "-", 
       RowBox[{"Report", " ", 
        RowBox[{"17", "/", "12"}], " ", 
        RowBox[{"(", "2009", ")"}]}]}], ",", " ", 
      RowBox[{"Eq", ".", " ", 
       RowBox[{"(", "6", ")"}], "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4971778228696933`*^9, 3.497177838994074*^9}, {
   3.497178954076253*^9, 3.4971790238548236`*^9}, {3.4971793669666476`*^9, 
   3.497179389856394*^9}, {3.497179477993634*^9, 3.4971794790717173`*^9}, {
   3.4972650120187435`*^9, 3.497265012831212*^9}, {3.4973331807032623`*^9, 
   3.497333184922039*^9}, {3.497333233437975*^9, 3.4973332384067564`*^9}, 
   3.4983710808602266`*^9, {3.4984593718706837`*^9, 3.4984594074653444`*^9}, {
   3.49845943951304*^9, 3.4984594716544876`*^9}, {3.4984595611411705`*^9, 
   3.498459566016327*^9}, {3.5046072475532017`*^9, 3.5046072849767528`*^9}, {
   3.5046073753089247`*^9, 3.5046073953566976`*^9}, {3.504607788671192*^9, 
   3.5046078069063845`*^9}, {3.5049326211118937`*^9, 3.504932623346383*^9}, {
   3.518943509264078*^9, 3.5189435401218867`*^9}, {3.518943660398629*^9, 
   3.5189436678007555`*^9}, {3.5189438836024055`*^9, 3.51894397879937*^9}, {
   3.5189440276003075`*^9, 3.5189440882384005`*^9}, {3.5189441206890717`*^9, 
   3.518944122297551*^9}, {3.519006132202371*^9, 3.5190061602764077`*^9}, {
   3.5190062049763546`*^9, 3.5190062066547794`*^9}, {3.5190062667139*^9, 
   3.519006276166918*^9}, {3.519010250029976*^9, 3.5190102534191904`*^9}, {
   3.5190104908672457`*^9, 3.5190105060640464`*^9}, {3.5190279709362607`*^9, 
   3.5190279812600894`*^9}, {3.528708751118186*^9, 3.528708766320922*^9}, {
   3.528708801070032*^9, 3.5287088015700197`*^9}, {3.5305190420672917`*^9, 
   3.5305190892991476`*^9}, 3.5305191596627426`*^9, {3.557649503494816*^9, 
   3.557649508150976*^9}, {3.5844314676848187`*^9, 3.584431525395973*^9}, {
   3.59531507307795*^9, 3.595315092288557*^9}, {3.595315130148671*^9, 
   3.5953151770881023`*^9}, {3.59531522087572*^9, 3.5953152867394648`*^9}, {
   3.595315777677287*^9, 3.595315972692499*^9}, {3.595316015017274*^9, 
   3.595316208996463*^9}, {3.595320296414555*^9, 3.5953203191997128`*^9}, {
   3.595320376960761*^9, 3.595320617647725*^9}, {3.595320663628058*^9, 
   3.595320723042212*^9}, {3.595320754703781*^9, 3.595320968352502*^9}, {
   3.59928950254503*^9, 3.599289701735124*^9}, {3.599289734171854*^9, 
   3.599289832822591*^9}, {3.599289913909968*^9, 3.599289915652417*^9}, {
   3.5992899466394176`*^9, 3.599289985690946*^9}, {3.599293666231716*^9, 
   3.5992937263399267`*^9}, {3.5992937977270823`*^9, 3.599293910885449*^9}, {
   3.5992939429800797`*^9, 3.599294172319907*^9}, {3.599294216373692*^9, 
   3.599294218165476*^9}, {3.5992944577702627`*^9, 3.599294461002344*^9}, {
   3.599294534643712*^9, 3.59929479419739*^9}, {3.599294993257822*^9, 
   3.59929499409754*^9}, {3.5992950246041393`*^9, 3.599295066572343*^9}, {
   3.59929513190628*^9, 3.5992953077498903`*^9}, {3.599295350784384*^9, 
   3.599295358891659*^9}, {3.599295988604721*^9, 3.599296079899736*^9}, {
   3.5992962262553387`*^9, 3.599296235588402*^9}, {3.5992963755993347`*^9, 
   3.599296384553072*^9}, {3.599296545957546*^9, 3.599296549292688*^9}, {
   3.599296816593266*^9, 3.599296823701461*^9}, {3.599297096315722*^9, 
   3.599297118353918*^9}, {3.599297152024888*^9, 3.5992971550510197`*^9}, {
   3.599297222860408*^9, 3.59929735049759*^9}, {3.599299123145831*^9, 
   3.599299176676402*^9}, {3.599299209677209*^9, 3.59929923354988*^9}, {
   3.599308953147089*^9, 3.599308998877429*^9}, {3.5993091558979816`*^9, 
   3.599309189117697*^9}, {3.599309428471994*^9, 3.599309443973485*^9}, {
   3.599360135496876*^9, 3.5993601446409073`*^9}, {3.5993602304909763`*^9, 
   3.599360240160898*^9}, {3.599360332237607*^9, 3.599360338053239*^9}, {
   3.599360514007724*^9, 3.599360522040958*^9}, {3.59944904271837*^9, 
   3.5994490754799337`*^9}, {3.599449115229032*^9, 3.5994493830055*^9}, {
   3.599462437550507*^9, 3.5994624806423187`*^9}, {3.599462514274688*^9, 
   3.599462530009841*^9}, {3.599464047017839*^9, 3.599464094395706*^9}, {
   3.5994641502295647`*^9, 3.599464162691676*^9}, {3.5994642283689213`*^9, 
   3.5994642705650682`*^9}, {3.5994644060845423`*^9, 3.59946440648831*^9}, {
   3.6240155888915625`*^9, 3.6240155893056035`*^9}, {3.624015657337406*^9, 
   3.624015673608033*^9}, {3.624016371884548*^9, 3.62401637840331*^9}, {
   3.6240176724575768`*^9, 3.624017679883224*^9}, {3.6240177233139024`*^9, 
   3.62401773697959*^9}, {3.6240966832434144`*^9, 3.6240967238038197`*^9}, {
   3.624096754474127*^9, 3.6240968267948503`*^9}, {3.63341315604236*^9, 
   3.6334131618298855`*^9}, {3.63341326366538*^9, 3.6334132637745786`*^9}, {
   3.63341335961975*^9, 3.633413674626511*^9}, {3.6334140539544563`*^9, 
   3.633414054188453*^9}, {3.6334140878060226`*^9, 3.6334141571159334`*^9}, {
   3.633414267747719*^9, 3.6334143246813927`*^9}, {3.633414354835806*^9, 
   3.633414505691475*^9}},
 CellLabel->
  "In[794]:=",ExpressionUUID->"ff77483a-c6a4-49a1-95bc-3d063e4c87b5"],

Cell[, "Input",ExpressionUUID->"4bbcfbfa-5524-4de6-ba65-4dda8e61c285"]
}, Open  ]],

Cell[CellGroupData[{

Cell[, "Section",ExpressionUUID->"f1ca1695-4575-4de6-b27e-9c42e762ea9f"],

Cell[, "Text",ExpressionUUID->"16649ae6-a42a-4b17-b165-9963673f6771"],

Cell[, "Text",ExpressionUUID->"0a039a22-dd0b-4008-9524-468d26252238"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetSteepnes", "[", "TrapProfParam_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"global", " ", "=", " ", 
       RowBox[{"pTrapProfSteepness", "/.", 
        RowBox[{"(", 
         RowBox[{"pTrapModelParam", "/.", "InputParam"}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"verb", " ", "=", " ", 
       RowBox[{"pVERBOSE", "/.", "InputParam"}]}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "[", 
        RowBox[{"verb", " ", ">", " ", "2"}], "]"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<GetSteepnes->TrapProfParam: \>\"", ",", "TrapProfParam", ",", 
         " ", "\"\< Global pTrapProfSteepness->\>\"", ",", " ", "global"}], 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"GetParameter", "[", 
      RowBox[{"pSteepness", ",", "TrapProfParam", ",", 
       RowBox[{"DEFAULT", "->", "global"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4971725867426434`*^9, 3.4971726451154013`*^9}, {
   3.497172723487392*^9, 3.4971727379243374`*^9}, {3.497173171673306*^9, 
   3.4971732247493925`*^9}, {3.4971732708726215`*^9, 
   3.4971733803527927`*^9}, {3.4971747422536182`*^9, 3.497174754456275*^9}, {
   3.4983874563270617`*^9, 3.498387459701997*^9}, {3.498388268248972*^9, 
   3.498388270327057*^9}, {3.498388572836874*^9, 3.4983886121173697`*^9}, {
   3.4983917044798703`*^9, 3.49839170474549*^9}, {3.50459251905015*^9, 
   3.5045925238941174`*^9}, {3.5046049266367292`*^9, 3.50460492910559*^9}, {
   3.50460496573223*^9, 3.504604967482309*^9}, {3.5046061291280985`*^9, 
   3.5046061567230844`*^9}, {3.5046063547007036`*^9, 
   3.5046063784361415`*^9}, {3.5046064347980413`*^9, 
   3.5046064637993407`*^9}, {3.5128897529167447`*^9, 
   3.5128897734796395`*^9}, {3.5128898153085675`*^9, 
   3.5128898942788343`*^9}, {3.5128902040035305`*^9, 3.512890219535079*^9}, {
   3.512891123583686*^9, 3.512891171553357*^9}, {3.5129953424445887`*^9, 
   3.512995346578642*^9}, {3.5226695817494216`*^9, 3.5226695950423822`*^9}, {
   3.5226696687394295`*^9, 3.5226699099808865`*^9}, {3.5227447908825245`*^9, 
   3.522744796124192*^9}, {3.5304145509241486`*^9, 3.5304145718915567`*^9}, {
   3.530526126544136*^9, 3.530526169109454*^9}, {3.530526233605673*^9, 
   3.53052634802437*^9}, {3.530526676613001*^9, 3.53052682131946*^9}, 
   3.541500423089278*^9, 3.56792571868828*^9, {3.5679311528957806`*^9, 
   3.56793131000578*^9}, {3.5679313827757807`*^9, 3.5679314502657804`*^9}, {
   3.5679316650357804`*^9, 3.5679317967057805`*^9}, {3.5679318959457808`*^9, 
   3.5679319570157804`*^9}, 3.5679320174857807`*^9, {3.5679331913327804`*^9, 
   3.5679332812127805`*^9}, {3.5703546578696566`*^9, 3.570354685779936*^9}, 
   3.584077474911214*^9, {3.5840780989526443`*^9, 3.584078165061983*^9}, {
   3.6334146703161645`*^9, 3.6334147029041467`*^9}, {3.6334147709192743`*^9, 
   3.633414796144151*^9}},
 CellLabel->
  "In[795]:=",ExpressionUUID->"00ac684f-275e-4b3d-bbee-b26abf66085f"],

Cell[, "Input",ExpressionUUID->"6e1852c1-8816-4e60-b931-ab49e476bbe3"],

Cell[, "Text",ExpressionUUID->"7b139315-f4b8-4987-bb28-52de7fdf6f2d"],

Cell[, "Program",ExpressionUUID->"ee83e3e1-7784-4b9e-967d-8ba060176457"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"mstepconcindeptrapprof", "[", 
    RowBox[{"refconc_", ",", "x_", ",", "t_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"TrapModelParam", " ", "=", " ", 
        RowBox[{"pTrapModelParam", "/.", "InputParam"}]}], ",", 
       "\[IndentingNewLine]", "curtrapprofparam", ",", "\[IndentingNewLine]", 
       "steps", ",", "\[IndentingNewLine]", "nstep", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"verb", " ", "=", " ", 
        RowBox[{"pVERBOSE", "/.", "InputParam"}]}]}], "\[IndentingNewLine]", 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"curtrapprofparam", "=", 
       RowBox[{"Part", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"pTrapProfFunc", "/.", "TrapModelParam"}], ")"}], ",", 
         "i"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"steps", " ", "=", " ", 
       RowBox[{"pSteps", "/.", 
        RowBox[{"(", 
         RowBox[{"pFuncPars", "/.", "curtrapprofparam"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nstep", "=", " ", 
       RowBox[{"Length", "[", "steps", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"TrueQ", "[", 
         RowBox[{"verb", " ", "\[GreaterEqual]", "  ", "1"}], "]"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<mstepconcindeptrapprof->nsteps: \>\"", ",", "nstep", ",", " ", 
          "\"\< i: \>\"", ",", "i"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Sum", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Module", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"left", "=", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"(", 
               RowBox[{"pLeft", "/.", 
                RowBox[{"Part", "[", 
                 RowBox[{"steps", ",", "jj"}], "]"}]}], ")"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"right", "=", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"(", 
               RowBox[{"pRight", "/.", 
                RowBox[{"Part", "[", 
                 RowBox[{"steps", ",", "jj"}], "]"}]}], ")"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"pos", "=", 
             RowBox[{
              RowBox[{"Evaluate", "[", 
               RowBox[{"(", 
                RowBox[{"pPos", "/.", 
                 RowBox[{"Part", "[", 
                  RowBox[{"steps", ",", "jj"}], "]"}]}], ")"}], "]"}], "*", 
              "tolenscale"}]}], ",", "\[IndentingNewLine]", "Steepnes"}], 
           "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Steepnes", "=", 
            RowBox[{"GetSteepnes", "[", 
             RowBox[{"Part", "[", 
              RowBox[{"steps", ",", "jj"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"TrueQ", "[", 
              RowBox[{"verb", " ", "\[GreaterEqual]", "  ", "1"}], "]"}], ",", 
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<mstepconcindeptrapprof #\>\"", ",", "i", ",", 
               "\"\< Steepnes: \>\"", ",", "Steepnes", ",", " ", 
               "\"\< Part[steps,jj]: \>\"", ",", 
               RowBox[{"Part", "[", 
                RowBox[{"steps", ",", "jj"}], "]"}]}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"BMFunc", "[", 
            RowBox[{
            "x", ",", "pos", ",", "Steepnes", ",", "left", ",", "right"}], 
            "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"jj", ",", "1", ",", "nstep"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4971725867426434`*^9, 3.4971726451154013`*^9}, {
   3.497172723487392*^9, 3.4971727379243374`*^9}, {3.497173171673306*^9, 
   3.4971732247493925`*^9}, {3.4971732708726215`*^9, 
   3.4971733803527927`*^9}, {3.4971747422536182`*^9, 3.497174754456275*^9}, {
   3.4983874563270617`*^9, 3.498387459701997*^9}, {3.498388268248972*^9, 
   3.498388270327057*^9}, {3.498388572836874*^9, 3.4983886121173697`*^9}, {
   3.4983917044798703`*^9, 3.49839170474549*^9}, {3.50459251905015*^9, 
   3.5045925238941174`*^9}, {3.5046049266367292`*^9, 3.50460492910559*^9}, {
   3.50460496573223*^9, 3.504604967482309*^9}, {3.5046061291280985`*^9, 
   3.5046061567230844`*^9}, {3.5046063547007036`*^9, 
   3.5046063784361415`*^9}, {3.5046064347980413`*^9, 
   3.5046064637993407`*^9}, {3.5128897529167447`*^9, 
   3.5128897734796395`*^9}, {3.5128898153085675`*^9, 
   3.5128898942788343`*^9}, {3.5128902040035305`*^9, 3.512890219535079*^9}, {
   3.512891123583686*^9, 3.512891171553357*^9}, {3.5129953424445887`*^9, 
   3.512995346578642*^9}, {3.5226695817494216`*^9, 3.5226695950423822`*^9}, {
   3.5226696687394295`*^9, 3.5226699099808865`*^9}, {3.5227447908825245`*^9, 
   3.522744796124192*^9}, {3.5304145509241486`*^9, 3.5304145718915567`*^9}, {
   3.530526126544136*^9, 3.530526169109454*^9}, {3.530526233605673*^9, 
   3.53052634802437*^9}, {3.530526676613001*^9, 3.53052682131946*^9}, 
   3.541500423089278*^9, 3.56792571868828*^9, {3.5679311528957806`*^9, 
   3.56793131000578*^9}, {3.5679313827757807`*^9, 3.5679314502657804`*^9}, {
   3.5679316650357804`*^9, 3.5679317967057805`*^9}, {3.5679318959457808`*^9, 
   3.5679319570157804`*^9}, 3.5679320174857807`*^9, {3.5679331913327804`*^9, 
   3.5679332812127805`*^9}, {3.5703546578696566`*^9, 3.570354685779936*^9}, 
   3.584077474911214*^9, {3.5840780989526443`*^9, 3.584078165061983*^9}, {
   3.6334146703161645`*^9, 3.6334147029041467`*^9}, 3.63341530280549*^9, {
   3.6334154516673694`*^9, 3.6334155381430497`*^9}, 3.6334155686736193`*^9, 
   3.633415699293913*^9},
 CellLabel->
  "In[796]:=",ExpressionUUID->"40af3cea-c8fb-44ea-a488-87fea39487b4"],

Cell[, "Input",ExpressionUUID->"e8b2876e-afa9-4dee-a078-1f132c17699b"],

Cell[, "Text",ExpressionUUID->"f41e3830-c97f-46bf-bc63-ed86d4de91bf"],

Cell[, "Program",ExpressionUUID->"83698ac2-8fdc-437d-aef0-a51cb3b21ff3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"concindeptrapprof", "[", 
    RowBox[{"refconc_", ",", "x_", ",", "t_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"TrapModelParam", " ", "=", " ", 
        RowBox[{"pTrapModelParam", "/.", "InputParam"}]}], ",", 
       "\[IndentingNewLine]", "curtrapprofparam", ",", "\[IndentingNewLine]", 
       "Steepnes", ",", "\[IndentingNewLine]", "left", ",", 
       "\[IndentingNewLine]", "right", ",", "\[IndentingNewLine]", "pos", ",",
        "\[IndentingNewLine]", 
       RowBox[{"verb", " ", "=", " ", 
        RowBox[{"pVERBOSE", "/.", "InputParam"}]}], ",", 
       "\[IndentingNewLine]", "exp"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"curtrapprofparam", "=", 
       RowBox[{"pFuncPars", "/.", 
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"pTrapProfFunc", "/.", "TrapModelParam"}], ")"}], ",", 
          "i"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Steepnes", "=", 
       RowBox[{"GetSteepnes", "[", "curtrapprofparam", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"left", "=", 
       RowBox[{"(", 
        RowBox[{"pLeft", "/.", "curtrapprofparam"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"right", "=", 
       RowBox[{"(", 
        RowBox[{"pRight", "/.", "curtrapprofparam"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"pPos", "/.", "curtrapprofparam"}], ")"}], "*", 
        "tolenscale"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"TrueQ", "[", 
         RowBox[{"verb", " ", "\[GreaterEqual]", " ", "1"}], "]"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<concindeptrapprof->left: \>\"", ",", " ", "left", ",", 
          "\"\< pos: \>\"", ",", "pos", ",", "\"\< right: \>\"", ",", "right",
           ",", "\"\< Steepnes: \>\"", ",", "Steepnes"}], "]"}]}], "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"BMFunc", "[", 
       RowBox[{"x", ",", "pos", ",", "Steepnes", ",", "left", ",", "right"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4971725867426434`*^9, 3.4971726451154013`*^9}, {
   3.497172723487392*^9, 3.4971727379243374`*^9}, {3.497173171673306*^9, 
   3.4971732247493925`*^9}, {3.4971732708726215`*^9, 
   3.4971733803527927`*^9}, {3.4971747422536182`*^9, 3.497174754456275*^9}, {
   3.4983874563270617`*^9, 3.498387459701997*^9}, {3.498388268248972*^9, 
   3.498388270327057*^9}, {3.498388572836874*^9, 3.4983886121173697`*^9}, {
   3.4983917044798703`*^9, 3.49839170474549*^9}, {3.50459251905015*^9, 
   3.5045925238941174`*^9}, {3.5046049266367292`*^9, 3.50460492910559*^9}, {
   3.50460496573223*^9, 3.504604967482309*^9}, {3.5046061291280985`*^9, 
   3.5046061567230844`*^9}, {3.5046063547007036`*^9, 
   3.5046063784361415`*^9}, {3.5046064347980413`*^9, 
   3.5046064637993407`*^9}, {3.5128897529167447`*^9, 
   3.5128897734796395`*^9}, {3.5128898153085675`*^9, 
   3.5128898942788343`*^9}, {3.5128902040035305`*^9, 3.512890219535079*^9}, {
   3.512891123583686*^9, 3.512891171553357*^9}, {3.5129953424445887`*^9, 
   3.512995346578642*^9}, {3.5226695817494216`*^9, 3.5226695950423822`*^9}, {
   3.5226696687394295`*^9, 3.5226699099808865`*^9}, {3.5227447908825245`*^9, 
   3.522744796124192*^9}, {3.5304145509241486`*^9, 3.5304145718915567`*^9}, {
   3.530526126544136*^9, 3.530526169109454*^9}, {3.530526233605673*^9, 
   3.53052634802437*^9}, {3.530526676613001*^9, 3.53052682131946*^9}, 
   3.541500423089278*^9, 3.56792571868828*^9, {3.5679311528957806`*^9, 
   3.56793131000578*^9}, {3.5679313827757807`*^9, 3.5679314502657804`*^9}, {
   3.5679316650357804`*^9, 3.5679317967057805`*^9}, {3.5679318959457808`*^9, 
   3.5679319570157804`*^9}, 3.5679320174857807`*^9, {3.5679331913327804`*^9, 
   3.5679332812127805`*^9}, {3.5703546578696566`*^9, 3.570354685779936*^9}, 
   3.584077474911214*^9, {3.5840780989526443`*^9, 3.584078165061983*^9}, {
   3.6334146703161645`*^9, 3.6334147029041467`*^9}, 3.63341530280549*^9, 
   3.633415343429713*^9, 3.6334153794049273`*^9, {3.6334160168946667`*^9, 
   3.633416023727423*^9}, {3.6334160580004034`*^9, 3.6334160602623887`*^9}, {
   3.633416098138946*^9, 3.6334161042385073`*^9}},
 CellLabel->
  "In[797]:=",ExpressionUUID->"af3dee50-1fb9-4f11-b526-5a0f76cf1cea"],

Cell[, "Input",ExpressionUUID->"663d703a-9759-4723-9b23-efd77e4b41c1"],

Cell[, "Input",ExpressionUUID->"7a43dd58-d10e-4a84-b7d5-10dcd5f49f8e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"concindeptrapproftanh", "[", 
    RowBox[{"refconc_", ",", "x_", ",", "t_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"TrapModelParam", " ", "=", " ", 
        RowBox[{"pTrapModelParam", "/.", "InputParam"}]}], ",", 
       "\[IndentingNewLine]", "curtrapprofparam", ",", "\[IndentingNewLine]", 
       "Steepnes", ",", "\[IndentingNewLine]", "left", ",", 
       "\[IndentingNewLine]", "right", ",", "\[IndentingNewLine]", "pos", ",",
        "\[IndentingNewLine]", 
       RowBox[{"verb", " ", "=", " ", 
        RowBox[{"pVERBOSE", "/.", "InputParam"}]}], ",", 
       "\[IndentingNewLine]", "exp"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"curtrapprofparam", "=", 
       RowBox[{"pFuncPars", "/.", 
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"pTrapProfFunc", "/.", "TrapModelParam"}], ")"}], ",", 
          "i"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Steepnes", "=", 
       RowBox[{"GetSteepnes", "[", "curtrapprofparam", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"left", "=", 
       RowBox[{"(", 
        RowBox[{"pLeft", "/.", "curtrapprofparam"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"right", "=", 
       RowBox[{"(", 
        RowBox[{"pRight", "/.", "curtrapprofparam"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"pPos", "/.", "curtrapprofparam"}], ")"}], "*", 
        "tolenscale"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"TrueQ", "[", 
         RowBox[{"verb", " ", "\[GreaterEqual]", " ", "1"}], "]"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<concindeptrapproftanh->left: \>\"", ",", " ", "left", ",", 
          "\"\< pos: \>\"", ",", "pos", ",", "\"\< right: \>\"", ",", "right",
           ",", "\"\< Steepnes: \>\"", ",", "Steepnes"}], "]"}]}], "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"BMFuncTanh", "[", 
       RowBox[{"x", ",", "pos", ",", "Steepnes", ",", "left", ",", "right"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.633753851190048*^9, 3.6337538523288484`*^9}, 
   3.6337539325596485`*^9, 3.6337541980248485`*^9, {3.754255168449988*^9, 
   3.7542551782354403`*^9}, {3.754255225016553*^9, 3.754255232653583*^9}, 
   3.7542553670408993`*^9, {3.8080668555524282`*^9, 3.8080669053157454`*^9}, {
   3.808067146175262*^9, 3.80806719496039*^9}, {3.8080672731263847`*^9, 
   3.8080672965304613`*^9}, {3.808067387032201*^9, 3.808067387936953*^9}},
 CellLabel->
  "In[798]:=",ExpressionUUID->"52a8c5df-b6f9-4f6e-8c80-c88a954b9b55"],

Cell[CellGroupData[{

Cell[, "Input",ExpressionUUID->"a40b3aa4-4ace-459b-9539-4261ae0f4ba7"],

Cell[CellGroupData[{

Cell[, "Print",ExpressionUUID->"2ad7151f-171f-4f83-91be-fb08538c0fbf"],

Cell[, "Print",ExpressionUUID->"d5b3ab13-519e-4bad-8af1-b1241ce36333"]
}, Open  ]],

Cell[, "Output",ExpressionUUID->"b6d4566c-1f8e-4e92-b028-d92df56a3136"],

Cell[, "Output",ExpressionUUID->"5bc26c81-3b5c-4136-95a7-7974eca942da"]
}, Open  ]],

Cell[, "Text",ExpressionUUID->"cc0f6539-9a0e-4e5d-a7b6-ddb8ae3e8e5b"],

Cell[, "Program",ExpressionUUID->"ece3036d-079b-4b59-b445-d35d7b7736b5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"consttrapprof", "[", 
    RowBox[{"refconc_", ",", "x_", ",", "t_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"TrapModelParam", " ", "=", " ", 
        RowBox[{"pTrapModelParam", "/.", "InputParam"}]}], ",", 
       "\[IndentingNewLine]", "curtrapprofparam", ",", "\[IndentingNewLine]", 
       "right"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"curtrapprofparam", "=", 
       RowBox[{"pFuncPars", "/.", 
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"pTrapProfFunc", "/.", "TrapModelParam"}], ")"}], ",", 
          "i"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"right", "=", 
       RowBox[{"pRight", "/.", "curtrapprofparam"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "right", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4971725867426434`*^9, 3.4971726451154013`*^9}, {
   3.497172723487392*^9, 3.4971727379243374`*^9}, {3.497173171673306*^9, 
   3.4971732247493925`*^9}, {3.4971732708726215`*^9, 
   3.4971733803527927`*^9}, {3.4971747422536182`*^9, 3.497174754456275*^9}, {
   3.4983874563270617`*^9, 3.498387459701997*^9}, {3.498388268248972*^9, 
   3.498388270327057*^9}, {3.498388572836874*^9, 3.4983886121173697`*^9}, {
   3.4983917044798703`*^9, 3.49839170474549*^9}, {3.50459251905015*^9, 
   3.5045925238941174`*^9}, {3.5046049266367292`*^9, 3.50460492910559*^9}, {
   3.50460496573223*^9, 3.504604967482309*^9}, {3.5046061291280985`*^9, 
   3.5046061567230844`*^9}, {3.5046063547007036`*^9, 
   3.5046063784361415`*^9}, {3.5046064347980413`*^9, 
   3.5046064637993407`*^9}, {3.5128897529167447`*^9, 
   3.5128897734796395`*^9}, {3.5128898153085675`*^9, 
   3.5128898942788343`*^9}, {3.5128902040035305`*^9, 3.512890219535079*^9}, {
   3.512891123583686*^9, 3.512891171553357*^9}, {3.5129953424445887`*^9, 
   3.512995346578642*^9}, {3.5226695817494216`*^9, 3.5226695950423822`*^9}, {
   3.5226696687394295`*^9, 3.5226699099808865`*^9}, {3.5227447908825245`*^9, 
   3.522744796124192*^9}, {3.5304145509241486`*^9, 3.5304145718915567`*^9}, {
   3.530526126544136*^9, 3.530526169109454*^9}, {3.530526233605673*^9, 
   3.53052634802437*^9}, {3.530526676613001*^9, 3.53052682131946*^9}, 
   3.541500423089278*^9, 3.56792571868828*^9, {3.5679311528957806`*^9, 
   3.56793131000578*^9}, {3.5679313827757807`*^9, 3.5679314502657804`*^9}, {
   3.5679316650357804`*^9, 3.5679317967057805`*^9}, {3.5679318959457808`*^9, 
   3.5679319570157804`*^9}, 3.5679320174857807`*^9, {3.5679331913327804`*^9, 
   3.5679332812127805`*^9}, {3.5703546578696566`*^9, 3.570354685779936*^9}, 
   3.584077474911214*^9, {3.5840780989526443`*^9, 3.584078165061983*^9}, {
   3.6334146703161645`*^9, 3.6334147029041467`*^9}, 3.63341530280549*^9, 
   3.633415343429713*^9, 3.6334153794049273`*^9, 3.6334160002339735`*^9, {
   3.6334161637365255`*^9, 3.6334161669189053`*^9}},
 CellLabel->
  "In[799]:=",ExpressionUUID->"f6eb8cc5-adfd-47e3-aef3-73cb76a0048e"],

Cell[, "Input",ExpressionUUID->"9780c45a-1257-432c-b565-d5a7a61a2d84"],

Cell[, "Text",ExpressionUUID->"2a5a59f0-6a06-4e84-b02a-9e38e0873d48"],

Cell[, "Text",ExpressionUUID->"7e9986b5-f8c7-451c-b96d-6d448fbda048"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ntrapevo", "[", 
    RowBox[{"refconc_", ",", "x_", ",", "t_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"trapprofparam", "=", 
        RowBox[{"(", 
         RowBox[{"pTrapProf", "/.", "InputParam"}], ")"}]}], ",", 
       "\[IndentingNewLine]", "curtrapprofparam", ",", "\[IndentingNewLine]", 
       "tau", " ", ",", "\[IndentingNewLine]", "maxconc", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ln05", "=", 
        RowBox[{"Log", "[", "0.5", "]"}]}]}], "\[IndentingNewLine]", "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"curtrapprofparam", "=", 
       RowBox[{"trapprofparam", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tau", " ", "=", 
       RowBox[{"pTau", "/.", " ", "curtrapprofparam"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"maxconc", " ", "=", " ", 
       RowBox[{"pMaxConc", "/.", "curtrapprofparam"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ntrapevo, maxconc: \>\"", ",", " ", "maxconc", ",", " ", 
          "\"\< tau: \>\"", ",", " ", "tau"}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"ln05", " ", "t"}], "tau"]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{"ln05", " ", "t"}], "tau"]}]]}], ")"}], " ", 
       "maxconc"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4971725867426434`*^9, 3.4971726451154013`*^9}, {
   3.497172723487392*^9, 3.4971727379243374`*^9}, {3.497173171673306*^9, 
   3.4971732247493925`*^9}, {3.4971732708726215`*^9, 
   3.4971733803527927`*^9}, {3.4971747422536182`*^9, 3.497174754456275*^9}, {
   3.4983874563270617`*^9, 3.498387459701997*^9}, {3.498388268248972*^9, 
   3.498388270327057*^9}, {3.498388572836874*^9, 3.4983886121173697`*^9}, {
   3.4983917044798703`*^9, 3.49839170474549*^9}, {3.50459251905015*^9, 
   3.5045925238941174`*^9}, {3.5046049266367292`*^9, 3.50460492910559*^9}, {
   3.50460496573223*^9, 3.504604967482309*^9}, {3.5046061291280985`*^9, 
   3.5046061567230844`*^9}, {3.5046063547007036`*^9, 
   3.5046063784361415`*^9}, {3.5046064347980413`*^9, 
   3.5046064637993407`*^9}, {3.5128897529167447`*^9, 
   3.5128897734796395`*^9}, {3.5128898153085675`*^9, 
   3.5128898942788343`*^9}, {3.5128902040035305`*^9, 3.512890219535079*^9}, {
   3.512891123583686*^9, 3.512891171553357*^9}, {3.5129953424445887`*^9, 
   3.512995346578642*^9}, {3.5226695817494216`*^9, 3.5226695950423822`*^9}, {
   3.5226696687394295`*^9, 3.5226699099808865`*^9}, {3.5227447908825245`*^9, 
   3.522744796124192*^9}, {3.5304145509241486`*^9, 3.5304145718915567`*^9}, {
   3.530526126544136*^9, 3.530526169109454*^9}, {3.530526233605673*^9, 
   3.53052634802437*^9}, {3.530526676613001*^9, 3.53052682131946*^9}, 
   3.541500423089278*^9, 3.56792571868828*^9, {3.5679311528957806`*^9, 
   3.56793131000578*^9}, {3.5679313827757807`*^9, 3.5679314502657804`*^9}, {
   3.5679316650357804`*^9, 3.5679317967057805`*^9}, {3.5679318959457808`*^9, 
   3.5679319570157804`*^9}, 3.5679320174857807`*^9, {3.5679331913327804`*^9, 
   3.5679332812127805`*^9}, {3.5703546578696566`*^9, 3.570354685779936*^9}, 
   3.584077474911214*^9, {3.5840780989526443`*^9, 3.584078165061983*^9}, {
   3.6334146703161645`*^9, 3.6334147029041467`*^9}, 3.63341530280549*^9, 
   3.633415343429713*^9, 3.633416204545864*^9},
 CellLabel->
  "In[800]:=",ExpressionUUID->"3a4ee90d-8c97-489d-9ac1-a6620e69d2c7"],

Cell[, "Text",ExpressionUUID->"c51252bd-36cb-41e6-9a23-9640cc61ac6b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"expsatbmtrapevo", "[", 
    RowBox[{"refconc_", ",", "x_", ",", "t_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"trapprofparam", "=", 
        RowBox[{"(", 
         RowBox[{"pTrapProf", "/.", "InputParam"}], ")"}]}], ",", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"paa", "\[Rule]", "aa"}], ",", 
         RowBox[{"pbb", "\[Rule]", "bb"}], ",", 
         RowBox[{"pLeft", "\[Rule]", "left"}], ",", 
         RowBox[{"pRight", "\[Rule]", "right"}], ",", 
         RowBox[{"pPos", "\[Rule]", "pos"}]}], "*)"}], "\[IndentingNewLine]", 
       "Steepnes", " ", ",", "\[IndentingNewLine]", "curtrapprofparam", ",", 
       "\[IndentingNewLine]", "aa", ",", "bb", ",", "left", ",", "right", ",",
        "pos"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"curtrapprofparam", "=", 
       RowBox[{"trapprofparam", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Steepnes", "=", 
       RowBox[{"GetSteepnes", "[", "curtrapprofparam", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"aa", " ", "=", 
       RowBox[{"paa", "/.", " ", "curtrapprofparam"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bb", " ", "=", 
       RowBox[{"pbb", "/.", " ", "curtrapprofparam"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"left", " ", "=", 
       RowBox[{"pLeft", "/.", " ", "curtrapprofparam"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"right", " ", "=", 
       RowBox[{"pRight", "/.", " ", "curtrapprofparam"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"pPos", "/.", "curtrapprofparam"}], ")"}], "*", 
        "tolenscale"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<expsatbmtrapevo, aa: \>\"", ",", " ", "aa", ",", " ", 
        "\"\< bb: \>\"", ",", " ", "bb", ",", " ", "\"\< left: \>\"", ",", 
        " ", "left", ",", " ", "\"\< right: \>\"", ",", " ", "right"}], "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"BMFunc", "[", 
        RowBox[{"x", ",", "pos", ",", "Steepnes", ",", "left", ",", "right"}],
         "]"}], "*", 
       RowBox[{"ExpSat", "[", 
        RowBox[{"aa", ",", "bb", ",", "t"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4971725867426434`*^9, 3.4971726451154013`*^9}, {
   3.497172723487392*^9, 3.4971727379243374`*^9}, {3.497173171673306*^9, 
   3.4971732247493925`*^9}, {3.4971732708726215`*^9, 
   3.4971733803527927`*^9}, {3.4971747422536182`*^9, 3.497174754456275*^9}, {
   3.4983874563270617`*^9, 3.498387459701997*^9}, {3.498388268248972*^9, 
   3.498388270327057*^9}, {3.498388572836874*^9, 3.4983886121173697`*^9}, {
   3.4983917044798703`*^9, 3.49839170474549*^9}, {3.50459251905015*^9, 
   3.5045925238941174`*^9}, {3.5046049266367292`*^9, 3.50460492910559*^9}, {
   3.50460496573223*^9, 3.504604967482309*^9}, {3.5046061291280985`*^9, 
   3.5046061567230844`*^9}, {3.5046063547007036`*^9, 
   3.5046063784361415`*^9}, {3.5046064347980413`*^9, 
   3.5046064637993407`*^9}, {3.5128897529167447`*^9, 
   3.5128897734796395`*^9}, {3.5128898153085675`*^9, 
   3.5128898942788343`*^9}, {3.5128902040035305`*^9, 3.512890219535079*^9}, {
   3.512891123583686*^9, 3.512891171553357*^9}, {3.5129953424445887`*^9, 
   3.512995346578642*^9}, {3.5226695817494216`*^9, 3.5226695950423822`*^9}, {
   3.5226696687394295`*^9, 3.5226699099808865`*^9}, {3.5227447908825245`*^9, 
   3.522744796124192*^9}, {3.5304145509241486`*^9, 3.5304145718915567`*^9}, {
   3.530526126544136*^9, 3.530526169109454*^9}, {3.530526233605673*^9, 
   3.53052634802437*^9}, {3.530526676613001*^9, 3.53052682131946*^9}, 
   3.541500423089278*^9, 3.56792571868828*^9, {3.5679311528957806`*^9, 
   3.56793131000578*^9}, {3.5679313827757807`*^9, 3.5679314502657804`*^9}, {
   3.5679316650357804`*^9, 3.5679317967057805`*^9}, {3.5679318959457808`*^9, 
   3.5679319570157804`*^9}, 3.5679320174857807`*^9, {3.5679331913327804`*^9, 
   3.5679332812127805`*^9}, {3.5703546578696566`*^9, 3.570354685779936*^9}, 
   3.584077474911214*^9, {3.5840780989526443`*^9, 3.584078165061983*^9}, {
   3.6334146703161645`*^9, 3.6334147029041467`*^9}, 3.63341530280549*^9, 
   3.633415343429713*^9, 3.633416204545864*^9, 3.633416292716499*^9},
 CellLabel->
  "In[801]:=",ExpressionUUID->"4d111183-b58c-4dc3-927c-7167f6e1c842"]
}, Open  ]],

Cell[CellGroupData[{

Cell[, "Section",ExpressionUUID->"655e6d03-69a9-4baa-823f-ca6848526551"],

Cell[, "Text",ExpressionUUID->"ee540c19-8894-49e2-9edb-158c3ea4a27e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GaussStepFunc", "[", 
    RowBox[{
     RowBox[{"x_", "?", "NumberQ"}], ",", 
     RowBox[{"Amp_", "?", "NumberQ"}], ",", 
     RowBox[{"Center_", "?", "NumberQ"}], ",", 
     RowBox[{"Sig_", "?", "NumberQ"}], ",", " ", 
     RowBox[{"Base_", "?", "NumberQ"}]}], "]"}], ":=", 
   RowBox[{"N", "[", 
    RowBox[{"Base", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Amp", "-", "Base"}], ")"}], "*", 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"x", "-", "Center"}], ")"}], "2"], 
         SuperscriptBox["Sig", "2"]]}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gausscompile", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "  ", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Amp", ",", "  ", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Center", ",", "  ", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Sig", ",", "  ", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Base", ",", "  ", "_Real"}], "}"}]}], "}"}], ",", 
     RowBox[{"Base", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Amp", "-", "Base"}], ")"}], "*", 
       RowBox[{"Exp", "[", 
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x", "-", "Center"}], ")"}], "2"], 
          SuperscriptBox["Sig", "2"]]}], "]"}]}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CGaussStepFunc", "[", 
    RowBox[{
     RowBox[{"x_", "?", "NumberQ"}], ",", 
     RowBox[{"Amp_", "?", "NumberQ"}], ",", 
     RowBox[{"Center_", "?", "NumberQ"}], ",", 
     RowBox[{"Sig_", "?", "NumberQ"}], ",", " ", 
     RowBox[{"Base_", "?", "NumberQ"}]}], "]"}], ":=", 
   RowBox[{"gausscompile", "[", 
    RowBox[{
    "x", " ", ",", "Amp", ",", "Center", ",", "Sig", ",", " ", "Base"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IntegGaussStepFunc", "[", 
    RowBox[{
     RowBox[{"Amp_", "?", "NumberQ"}], ",", 
     RowBox[{"Center_", "?", "NumberQ"}], ",", 
     RowBox[{"Sig_", "?", "NumberQ"}], ",", " ", 
     RowBox[{"Base_", "?", "NumberQ"}], ",", " ", 
     RowBox[{"From_", "?", "NumberQ"}], ",", " ", 
     RowBox[{"To_", "?", "NumberQ"}]}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "Base", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "From"}], "+", "To"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Amp", "-", "Base"}], ")"}], " ", 
       SqrtBox["\[Pi]"], " ", "Sig", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Erf", "[", 
          FractionBox[
           RowBox[{"Center", "-", "From"}], "Sig"], "]"}], "-", 
         RowBox[{"Erf", "[", 
          FractionBox[
           RowBox[{"Center", "-", "To"}], "Sig"], "]"}]}], ")"}]}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CalcNumStep", "[", 
   RowBox[{
    RowBox[{"From_", "?", "NumberQ"}], ",", 
    RowBox[{"To_", "?", "NumberQ"}], ",", 
    RowBox[{"PeakParam_", "?", "ArrayQ"}], ",", 
    RowBox[{"MaxStep_", "?", "NumberQ"}], ",", 
    RowBox[{"AmpScale_", "?", "NumberQ"}]}], "]"}], ":=", 
  RowBox[{"Sum", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"CurAmp", " ", "=", " ", 
         RowBox[{"AmpScale", "*", 
          RowBox[{"PeakParam", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}], ",", 
        RowBox[{"CurCenter", " ", "=", " ", 
         RowBox[{"PeakParam", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", 
        RowBox[{"CurSig", " ", "=", " ", 
         RowBox[{"PeakParam", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "3"}], "]"}], "]"}]}], ",", 
        RowBox[{"CurBase", "=", 
         RowBox[{"1", "/", "MaxStep"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"N", "[", 
       RowBox[{"IntegGaussStepFunc", "[", 
        RowBox[{
        "CurAmp", ",", "CurCenter", ",", "CurSig", ",", "CurBase", ",", 
         "From", ",", "To"}], "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "PeakParam", "]"}]}], "}"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StepWidth", "[", 
   RowBox[{
    RowBox[{"atx_", "?", "NumberQ"}], ",", 
    RowBox[{"PeakParam_", "?", "ArrayQ"}], ",", 
    RowBox[{"AmpScale_", "?", "NumberQ"}], ",", 
    RowBox[{"MaxStep_", "?", "NumberQ"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "NumLocSteps", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NumLocSteps", "=", 
      RowBox[{"Sum", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"CurAmp", " ", "=", " ", 
             RowBox[{"AmpScale", "*", 
              RowBox[{"PeakParam", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}], ",", 
            RowBox[{"CurCenter", " ", "=", " ", 
             RowBox[{"PeakParam", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", 
            RowBox[{"CurSig", " ", "=", " ", 
             RowBox[{"PeakParam", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "3"}], "]"}], "]"}]}], ",", 
            RowBox[{"CurBase", "=", 
             RowBox[{"1", "/", "MaxStep"}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"CGaussStepFunc", "[", 
           RowBox[{
           "atx", ",", "CurAmp", ",", "CurCenter", ",", "CurSig", ",", 
            "CurBase"}], "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "PeakParam", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"1", "/", "NumLocSteps"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StepWidth2", "[", 
   RowBox[{
    RowBox[{"atx_", "?", "NumberQ"}], ",", 
    RowBox[{"PeakParam_", "?", "ArrayQ"}], ",", 
    RowBox[{"AmpScale_", "?", "NumberQ"}], ",", 
    RowBox[{"MaxStep_", "?", "NumberQ"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"deltax", ",", "\[IndentingNewLine]", "deltaxest"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"deltaxest", "=", 
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"Sum", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"CurAmp", " ", "=", " ", 
               RowBox[{"AmpScale", "*", 
                RowBox[{"PeakParam", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}], ",", 
              RowBox[{"CurCenter", " ", "=", " ", 
               RowBox[{"PeakParam", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", 
              RowBox[{"CurSig", " ", "=", " ", 
               RowBox[{"PeakParam", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "3"}], "]"}], "]"}]}], ",", 
              RowBox[{"CurBase", "=", 
               RowBox[{"1", "/", "MaxStep"}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"CGaussStepFunc", "[", 
             RowBox[{
             "atx", ",", "CurAmp", ",", "CurCenter", ",", "CurSig", ",", 
              "CurBase"}], "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "PeakParam", "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"deltax", "/.", 
      RowBox[{"FindRoot", "[", 
       RowBox[{
        RowBox[{"1", "==", 
         RowBox[{"CalcNumStep", "[", 
          RowBox[{"atx", ",", 
           RowBox[{"atx", "+", "deltax"}], ",", "PeakParam", ",", "MaxStep", 
           ",", "AmpScale"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"deltax", ",", "deltaxest", ",", "0", ",", "\[Infinity]"}], 
         "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BuildGaussianGrid", "[", 
   RowBox[{
    RowBox[{"From_", "?", "NumberQ"}], ",", 
    RowBox[{"To_", "?", "NumberQ"}], ",", 
    RowBox[{"NumSteps_", "?", "NumberQ"}], ",", 
    RowBox[{"MaxStep_", "?", "NumberQ"}], ",", 
    RowBox[{"PeakParam_", "?", "ArrayQ"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "Scalfactor", ",", "\[IndentingNewLine]", "StepList", ",", 
      "\[IndentingNewLine]", "ii", ",", "\[IndentingNewLine]", "CurX", ",", 
      "\[IndentingNewLine]", "curdx", ",", "\[IndentingNewLine]", "nsteps0", 
      ",", "\[IndentingNewLine]", "PosList"}], "\[IndentingNewLine]", "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nsteps0", "=", 
      RowBox[{"CalcNumStep", "[", 
       RowBox[{
       "From", ",", "To", ",", "PeakParam", ",", "MaxStep", ",", "0"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<nsteps0: \>\"", ",", " ", "nsteps0", ",", " ", 
       "\"\< MaxStep: \>\"", ",", " ", "MaxStep"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"ii", "=", "1"}], ",", 
       RowBox[{"ii", "\[LessEqual]", " ", 
        RowBox[{"Length", "[", "PeakParam", "]"}]}], ",", 
       RowBox[{"ii", "+=", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Peak: \>\"", ",", " ", "ii", ",", " ", 
         "\"\< Steps/unit length: \>\"", ",", " ", 
         RowBox[{"PeakParam", "[", 
          RowBox[{"[", 
           RowBox[{"ii", ",", " ", "1"}], "]"}], "]"}], ",", " ", 
         "\"\< width (unit of length): \>\"", ",", " ", 
         RowBox[{"PeakParam", "[", 
          RowBox[{"[", 
           RowBox[{"ii", ",", " ", "3"}], "]"}], "]"}], ",", " ", 
         "\"\< center  (unit of length): \>\"", ",", " ", 
         RowBox[{"PeakParam", "[", 
          RowBox[{"[", 
           RowBox[{"ii", ",", " ", "2"}], "]"}], "]"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"nsteps0", ">", " ", "NumSteps"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<Unable to build grid to span entire range with current setting \
for MaxStep and PeakParam\>\"", "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Scalfactor", " ", "=", " ", 
      RowBox[{"Scalfactor", "/.", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{"NumSteps", "==", 
          RowBox[{"CalcNumStep", "[", 
           RowBox[{
           "From", ",", "To", ",", "PeakParam", ",", "MaxStep", ",", 
            "Scalfactor"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"Scalfactor", ",", "1.0", ",", "0", ",", 
           RowBox[{"+", "\[Infinity]"}]}], "}"}], ",", 
         RowBox[{"StepMonitor", "\[RuleDelayed]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Step to x = \>\"", ",", "Scalfactor"}], "]"}]}]}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<Scalfactor:\>\"", ",", " ", "Scalfactor", ",", " ", 
       "\"\< CurNumSteps: \>\"", ",", " ", 
       RowBox[{"CalcNumStep", "[", 
        RowBox[{
        "From", ",", "To", ",", "PeakParam", ",", "MaxStep", ",", 
         "Scalfactor"}], "]"}], ",", "  ", "\"\<Req. NumStep: \>\"", ",", " ",
        "NumSteps"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ShowStatus", "[", "\"\<ii: 0\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", "\"\<Building grid with current scale factor...\>\"", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"StepList", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"PosList", "=", 
      RowBox[{
       RowBox[{"Reap", "[", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ii", "=", "1"}], ";", 
           RowBox[{"CurX", "=", "0"}]}], ",", 
          RowBox[{"ii", "\[LessEqual]", " ", "NumSteps"}], ",", 
          RowBox[{"ii", "+=", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Sow", "[", "CurX", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"curdx", "=", 
            RowBox[{"StepWidth2", "[", 
             RowBox[{
             "CurX", ",", "PeakParam", ",", "Scalfactor", ",", "MaxStep"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"StepList", "=", " ", 
            RowBox[{"Append", "[", 
             RowBox[{"StepList", ",", "curdx"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"ii", ",", 
                FractionBox["NumSteps", "10"]}], "]"}], "\[Equal]", "0"}], 
             ",", 
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<ii: \>\"", ",", " ", "ii", ",", " ", "\"\< CurX: \>\"", 
               ",", " ", "CurX", ",", " ", "\"\< curdx: \>\"", ",", " ", 
               "curdx"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"CurX", "+=", "curdx"}]}]}], "\[IndentingNewLine]", "]"}], 
        "\[IndentingNewLine]", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<For loop complete\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PosList", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"PosList", ",", 
        RowBox[{
         RowBox[{"TrueQ", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "\[GreaterEqual]", "From"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"#", "\[LessEqual]", "To"}], ")"}]}], "]"}], "&"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"PosList", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"PosList", "[", 
          RowBox[{"[", 
           RowBox[{"Length", "[", "PosList", "]"}], "]"}], "]"}], "<", "To"}],
         ",", 
        RowBox[{"Append", "[", 
         RowBox[{"PosList", ",", "To"}], "]"}], ",", "PosList"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"PosList", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"PosList", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ">", "From"}], ",", 
        RowBox[{"Prepend", "[", 
         RowBox[{"PosList", ",", "From"}], "]"}], ",", "PosList"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"ListLogPlot", "[", 
       RowBox[{"PosList", ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"PlotLabel", "\[Rule]", "\"\<PosList\>\""}]}], "]"}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"ListLogPlot", "[", 
       RowBox[{"StepList", ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"PlotLabel", "\[Rule]", "\"\<StepList\>\""}]}], "]"}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "PosList", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.457090353820964*^9, 3.4570903856497*^9}, {
   3.457090492526752*^9, 3.4570905222929487`*^9}, {3.457090633841965*^9, 
   3.4570906643113003`*^9}, 3.457090782469819*^9, {3.457090857596261*^9, 
   3.457090880065443*^9}, 3.457091076100456*^9, {3.4570916205952854`*^9, 
   3.457091625970389*^9}, {3.4570916589710226`*^9, 3.4570917099095*^9}, 
   3.457091758332305*^9, 3.457091870803214*^9, {3.4570920205873404`*^9, 
   3.457092026118696*^9}, {3.457092086932364*^9, 3.457092096932556*^9}, {
   3.4570921715277386`*^9, 3.45709235417187*^9}, {3.4570923971258197`*^9, 
   3.4570924388609962`*^9}, 3.457092478033623*^9, {3.4570926627871704`*^9, 
   3.4570927948365803`*^9}, {3.4570931979380703`*^9, 3.45709320731325*^9}, {
   3.457093240157631*^9, 3.457093269142562*^9}, {3.4570933176747437`*^9, 
   3.457093406442073*^9}, {3.457094330522315*^9, 3.457094341350648*^9}, {
   3.4570945527609572`*^9, 3.457094655091047*^9}, {3.4570947447958937`*^9, 
   3.4570947547023344`*^9}, 3.4783504831160984`*^9, {3.478350516460275*^9, 
   3.4783505791485777`*^9}, 3.4783506353524218`*^9, {3.4783508268704987`*^9, 
   3.4783508444332232`*^9}, {3.4783513257831345`*^9, 
   3.4783513867370396`*^9}, {3.4783515835520587`*^9, 3.4783515848177*^9}, {
   3.478403619515484*^9, 3.4784036247343006`*^9}, {3.4784069562925687`*^9, 
   3.478406963730164*^9}, {3.478407112075813*^9, 3.478407171998455*^9}, {
   3.4784073336880245`*^9, 3.478407348031958*^9}, {3.4784073836261635`*^9, 
   3.478407385876192*^9}, {3.4784077711154985`*^9, 3.4784077829594*^9}, {
   3.478408269043747*^9, 3.478408278715746*^9}, {3.4784083532010736`*^9, 
   3.4784083563729897`*^9}, {3.478408484327752*^9, 3.478408628938978*^9}, {
   3.478415456338868*^9, 3.4784155557620153`*^9}, {3.4784220466732235`*^9, 
   3.478422184456237*^9}, {3.4784222505977087`*^9, 3.478422348083331*^9}, {
   3.4784297437717447`*^9, 3.478429756615659*^9}, {3.47842978711605*^9, 
   3.478429875132801*^9}, {3.497262215423012*^9, 3.497262224203925*^9}, {
   3.4972622797330427`*^9, 3.4972622880920963`*^9}, {3.4972624357270517`*^9, 
   3.4972625047400265`*^9}, {3.49726265023444*^9, 3.4972626801551657`*^9}, {
   3.4972628257589493`*^9, 3.497262919739715*^9}, {3.497262967300389*^9, 
   3.497263024173205*^9}, {3.4972632430554247`*^9, 3.49726326960128*^9}, {
   3.4972633105215836`*^9, 3.4972633229742303`*^9}, {3.4972634923271017`*^9, 
   3.497263495639475*^9}, {3.497263639462077*^9, 3.497263641430751*^9}, {
   3.4972636725701804`*^9, 3.497263829767269*^9}, {3.497263874374931*^9, 
   3.497263880827808*^9}, {3.4972668080930333`*^9, 3.497266816582676*^9}, {
   3.497332788136217*^9, 3.4973329175687494`*^9}, 3.4973329545701704`*^9, 
   3.504603393802436*^9, 3.504603667830337*^9, {3.504603936951768*^9, 
   3.5046039550463285`*^9}, 3.5049338351271725`*^9, {3.504933879082548*^9, 
   3.5049338842546883`*^9}, {3.504933954367653*^9, 3.5049339650713253`*^9}, {
   3.5049345540389795`*^9, 3.5049346160734053`*^9}, {3.5049347471269903`*^9, 
   3.504934880008793*^9}, 3.5049349112135153`*^9, {3.5049349645756226`*^9, 
   3.504935042392107*^9}, 3.5049351363656683`*^9, {3.504958149624491*^9, 
   3.504958173672597*^9}, {3.504958255645544*^9, 3.5049583253366117`*^9}, {
   3.504959471239029*^9, 3.504959507740898*^9}},
 CellLabel->
  "In[802]:=",ExpressionUUID->"b0b64841-34ec-4d87-b958-924a2bbeca62"],

Cell[, "Text",ExpressionUUID->"1118a1b0-c252-4433-8763-1236429f479a"],

Cell[, "Program",ExpressionUUID->"75abb917-d5da-48f4-b509-09d9f274ed0b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BuildTransition", "[", 
    RowBox[{"width_", ",", "stepfrom_", ",", "stepto_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "dstep", ",", "\[IndentingNewLine]", "curgrd", ",", 
       "\[IndentingNewLine]", "scale", ",", "\[IndentingNewLine]", "nstepmax",
        ",", "\[IndentingNewLine]", "locnstep"}], "\[IndentingNewLine]", 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<stepfrom: \>\"", ",", 
         RowBox[{"stepfrom", "//", "N"}], ",", "\"\< stepto: \>\"", ",", " ", 
         RowBox[{"stepto", "//", "N"}]}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nstepmax", "=", 
       RowBox[{
        RowBox[{"Ceiling", "[", 
         FractionBox[
          RowBox[{"stepfrom", "-", "stepto", "+", 
           RowBox[{"2", " ", "width"}]}], 
          RowBox[{"stepfrom", "+", "stepto"}]], "]"}], "//", "N"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"locnstep", "=", 
       RowBox[{"nstepmax", "//", "N"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<nstepmax: \>\"", ",", "nstepmax", ",", " ", "\"\< nstep: \>\"", 
          ",", " ", "locnstep"}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"dstep", "=", 
       FractionBox[
        RowBox[{"stepto", "-", "stepfrom"}], "locnstep"]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"curgrd", "=", 
       RowBox[{"Accumulate", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"stepfrom", "+", 
           RowBox[{"kk", "*", "dstep"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"kk", ",", "1", ",", "locnstep"}], "}"}]}], "]"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"scale", "=", 
       RowBox[{"width", "/", 
        RowBox[{"Last", "[", "curgrd", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"curgrd", "*=", "scale"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<BuildTransition Last[curgrd]: \>\"", ",", 
          RowBox[{"Last", "[", "curgrd", "]"}], ",", "\"\< width: \>\"", ",", 
          "width", ",", " ", "\"\< Last[Differences[curgrd]] \>\"", ",", 
          RowBox[{"Last", "[", 
           RowBox[{"Differences", "[", "curgrd", "]"}], "]"}]}], "]"}], ";"}],
        "*)"}], "\[IndentingNewLine]", "curgrd"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BuildSection", "[", 
    RowBox[{"width_", ",", "step_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"lnstep", ",", " ", "lstep", ",", "res"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lnstep", "=", 
       RowBox[{"Floor", "[", 
        FractionBox[
         RowBox[{"width", "-", "step"}], "step"], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lstep", " ", "=", " ", 
       FractionBox[
        RowBox[{"width", "-", "step"}], "lnstep"]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", " ", "=", " ", 
       RowBox[{"Range", "[", 
        RowBox[{"step", ",", "width", ",", "lstep"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<width+step: \>\"", ",", " ", 
          RowBox[{"width", "+", "step"}], ",", " ", 
          "\"\< Last[res] + step: \>\"", ",", 
          RowBox[{"step", "+", " ", 
           RowBox[{"Last", "[", "res", "]"}]}], ",", "\"\< lstep: \>\"", ",", 
          " ", "lstep", ",", " ", "\"\< step: \>\"", ",", "step"}], "]"}], 
        ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "res", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BuildLinStepGrid", "[", "input_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"from", " ", "=", " ", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"FROM", "/.", "input"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"to", " ", "=", "  ", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"TO", "/.", "input"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"secrep", "=", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"SECTIONS", "/.", "input"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "grid", ",", "\[IndentingNewLine]", "numsect", 
       ",", "\[IndentingNewLine]", "curentry", ",", "\[IndentingNewLine]", 
       "cursec", ",", "\[IndentingNewLine]", "prevsec", ",", 
       "\[IndentingNewLine]", "nextsec", ",", "\[IndentingNewLine]", 
       "curfrom", ",", "\[IndentingNewLine]", "zerosteps", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"totwidth", " ", "=", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"minfloat", " ", "=", " ", "1*^-6"}]}], "\[IndentingNewLine]", 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"numsect", " ", "=", " ", 
       RowBox[{"Length", "[", "secrep", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"grid", " ", "=", " ", 
       RowBox[{"{", "from", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"curfrom", "=", "from"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"ii", "=", "1"}], ",", 
        RowBox[{"ii", "<=", "numsect"}], ",", 
        RowBox[{"ii", "+=", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"cursec", "=", 
          RowBox[{"Part", "[", 
           RowBox[{"secrep", ",", "ii"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{"ii", ",", "2"}], "]"}], "\[Equal]", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<Transition: \>\"", ",", "cursec"}], "]"}], ";"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"prevsec", "=", 
             RowBox[{"Part", "[", 
              RowBox[{"secrep", ",", 
               RowBox[{"ii", "-", "1"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"nextsec", "=", 
             RowBox[{"Part", "[", 
              RowBox[{"secrep", ",", 
               RowBox[{"ii", "+", "1"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"curentry", "=", 
             RowBox[{"BuildTransition", "[", 
              RowBox[{
               RowBox[{"Evaluate", "[", 
                RowBox[{"WIDTH", "/.", "cursec"}], "]"}], ",", 
               RowBox[{"Evaluate", "[", 
                RowBox[{"STEP", "/.", "prevsec"}], "]"}], ",", 
               RowBox[{"Evaluate", "[", 
                RowBox[{"STEP", "/.", "nextsec"}], "]"}]}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<Section: \>\"", ",", "cursec"}], "]"}], ";"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"curentry", "=", 
            RowBox[{"BuildSection", "[", 
             RowBox[{
              RowBox[{"Evaluate", "[", 
               RowBox[{"WIDTH", "/.", "cursec"}], "]"}], ",", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"STEP", "/.", "cursec"}], "]"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<curfrom: \>\"", ",", "curfrom"}], "]"}], ";"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"totwidth", "+=", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"WIDTH", "/.", "cursec"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"curentry", "+=", "curfrom"}], ";", "\[IndentingNewLine]", 
         RowBox[{"curfrom", "=", 
          RowBox[{"Last", "[", "curentry", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Last of curentry \>\"", ",", " ", "ii", ",", "\"\<: \>\"", 
             ",", 
             RowBox[{
              RowBox[{"Last", "[", "curentry", "]"}], "//", "N"}]}], "]"}], 
           ";"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"grid", ",", "curentry"}], "]"}]}]}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Section \>\"", ",", "ii", ",", "\"\< has \>\"", ",", 
           RowBox[{"Length", "[", "curentry", "]"}], ",", "\"\< steps\>\""}], 
          "]"}], ";"}], "*)"}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<totwidth: \>\"", ",", " ", 
          RowBox[{"totwidth", "//", "N"}], ",", " ", "\"\< to - from: \>\"", 
          ",", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"to", "-", "from"}], ")"}], "//", "N"}]}], "]"}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"totwidth", " ", "-", 
           RowBox[{"(", 
            RowBox[{"to", "-", "from"}], ")"}]}], "]"}], ">", "minfloat"}], 
        ",", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<Total width does not match\>\"", "]"}], 
          ";"}], "*)"}], 
        RowBox[{"Abort", "[", "]"}]}], " ", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"grid", "=", 
       RowBox[{"Flatten", "[", "grid", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"zerosteps", " ", "=", " ", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Differences", "[", "grid", "]"}], ",", 
         RowBox[{
          RowBox[{"#", "\[LessEqual]", "minfloat"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "zerosteps", "]"}], ">", "0"}], ",", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{"Length", "[", "zerosteps", "]"}], ",", " ", 
            "\"\< Zero steps encountered\>\""}], "]"}], ";"}], "*)"}], 
        RowBox[{"Abort", "[", "]"}]}], 
       RowBox[{"(*", 
        RowBox[{",", 
         RowBox[{
         "Print", "[", "\"\<All steps are larger than 0 i.e GOOD\>\"", 
          "]"}]}], "*)"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"First", "[", "grid", "]"}], "-", "from"}], ")"}], "]"}],
           ">", "minfloat"}], ")"}], " ", ",", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Grid fit missmatch at from: \>\"", ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"First", "[", "grid", "]"}], "-", "from"}], ")"}]}], 
           "]"}], ";"}], "*)"}], 
        RowBox[{"Abort", "[", "]"}]}], 
       RowBox[{"(*", 
        RowBox[{",", 
         RowBox[{"Print", "[", "\"\<Grid matches From i.e GOOD\>\"", "]"}]}], 
        "*)"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"Last", "[", "grid", "]"}], "-", "to"}], "]"}], ")"}], 
         ">", "minfloat"}], " ", ",", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Grid fit missmatch at to: \>\"", ",", 
            RowBox[{
             RowBox[{"Last", "[", "grid", "]"}], "-", "to"}]}], "]"}], ";"}], 
         "*)"}], 
        RowBox[{"Abort", "[", "]"}]}], 
       RowBox[{"(*", 
        RowBox[{",", 
         RowBox[{"Print", "[", "\"\<Grid matches To i.e GOOD\>\"", "]"}]}], 
        "*)"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"grid", "[", 
        RowBox[{"[", 
         RowBox[{"Length", "[", "grid", "]"}], "]"}], "]"}], "=", "to"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"grid", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", "from"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"ListLogPlot", "[", 
          RowBox[{"grid", ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", "\"\<PosList\>\""}], ",", 
           RowBox[{"BaseStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
              RowBox[{"FontSize", "\[Rule]", "28"}]}], "}"}]}]}], "]"}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"ListLogPlot", "[", 
          RowBox[{
           RowBox[{"Differences", "[", "grid", "]"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", "\"\<StepList\>\""}], ",", 
           RowBox[{"BaseStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
              RowBox[{"FontSize", "\[Rule]", "28"}]}], "}"}]}]}], "]"}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Successfully built a grid with \>\"", ",", 
          RowBox[{"Length", "[", "grid", "]"}], ",", "\"\< steps\>\""}], 
         "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "grid", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BuildTanhGrid", "[", "input_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"left", "=", 
        RowBox[{"pLeft", "/.", "input"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"right", "=", 
        RowBox[{"pRight", "/.", "input"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{"pPosition", "/.", "input"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"steep", "=", 
        RowBox[{"pSteepness", "/.", "input"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"thick", "=", 
        RowBox[{"pThick", "/.", "input"}]}], ",", "\[IndentingNewLine]", "f", 
       ",", "grid"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f", "=", 
       RowBox[{
        RowBox[{"BMFuncTanh", "[", 
         RowBox[{"x", ",", "pos", ",", "steep", ",", "left", ",", "right"}], 
         "]"}], "+", 
        RowBox[{"BMFuncTanh", "[", 
         RowBox[{"x", ",", 
          RowBox[{"thick", "-", "pos"}], ",", "steep", ",", "right", ",", 
          "left"}], "]"}], "-", "right"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"grid", "=", 
       RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"ii", "=", "0"}], ",", 
        RowBox[{
         RowBox[{"grid", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "\[LessEqual]", "thick"}], ",", 
        RowBox[{"ii", "+=", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{"grid", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"grid", ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"x", "+", "f"}], ")"}], "/.", 
             RowBox[{"x", "\[Rule]", 
              RowBox[{"grid", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}]}]}], "]"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"grid", "=", 
       RowBox[{"Drop", "[", 
        RowBox[{"grid", ",", 
         RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"grid", "=", 
       RowBox[{"Append", "[", 
        RowBox[{"grid", ",", "thick"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "grid", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BuildConstFacGrid", "[", "input_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"left", "=", 
        RowBox[{"pLeft", "/.", "input"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"right", "=", 
        RowBox[{"pRight", "/.", "input"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{"pPosition", "/.", "input"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"steep", "=", 
        RowBox[{"pSteepness", "/.", "input"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"thick", "=", 
        RowBox[{"pThick", "/.", "input"}]}], ",", "\[IndentingNewLine]", "f", 
       ",", "grid", ",", "gridTemp"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"f", "=", 
        RowBox[{"Piecewise", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"x", "^", "2"}], "*", 
               RowBox[{"left", "/", 
                RowBox[{"pos", "^", "2"}]}]}], "+", 
              RowBox[{"x", "*", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"pos", "-", 
                  RowBox[{"2", "*", "left", "*", "steep"}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"pos", "*", "steep"}], ")"}]}]}], "+", "left"}], ",", 
             RowBox[{"x", "<", "pos"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"x", "/", "steep"}], ">", "right"}], ",", "right", 
               ",", 
               RowBox[{"x", "/", "steep"}]}], "]"}], ",", 
             RowBox[{"x", "\[GreaterEqual]", "pos"}]}], "}"}]}], "}"}], 
         "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f", "=", 
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"x", "^", "2"}], "*", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"pos", "-", 
                 RowBox[{"left", "*", "steep"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"pos", "^", "2"}], "*", "steep"}], ")"}]}]}], "+", 
             "left"}], ",", 
            RowBox[{"x", "<", "pos"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "/", "steep"}], ">", "right"}], ",", "right", ",", 
              RowBox[{"x", "/", "steep"}]}], "]"}], ",", 
            RowBox[{"x", "\[GreaterEqual]", "pos"}]}], "}"}]}], "}"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"grid", "=", 
       RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"ii", "=", "0"}], ",", 
        RowBox[{
         RowBox[{"grid", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "\[LessEqual]", 
         RowBox[{"thick", "/", "2"}]}], ",", 
        RowBox[{"ii", "+=", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{"grid", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"grid", ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"x", "+", "f"}], ")"}], "/.", 
             RowBox[{"x", "\[Rule]", 
              RowBox[{"grid", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}]}]}], "]"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"gridTemp", "=", "grid"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"ii", "=", "1"}], ",", 
        RowBox[{"ii", "<", 
         RowBox[{
          RowBox[{"Length", "[", "gridTemp", "]"}], "-", "1"}]}], ",", 
        RowBox[{"ii", "++"}], ",", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"grid", ",", 
          RowBox[{
           RowBox[{"grid", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}], "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"gridTemp", "[", 
              RowBox[{"[", 
               RowBox[{"-", "ii"}], "]"}], "]"}], "-", 
             RowBox[{"gridTemp", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"-", "ii"}], "-", "1"}], "]"}], "]"}]}], ")"}]}]}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"grid", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "<", "thick"}], ",", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"grid", ",", 
          RowBox[{
           RowBox[{"grid", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}], "+", "left"}]}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"grid", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"grid", ",", 
         RowBox[{
          RowBox[{"#", "<", "thick"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"grid", "=", 
       RowBox[{"Append", "[", 
        RowBox[{"grid", ",", "thick"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "grid", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5296609755780935`*^9, 3.5296610324654417`*^9}, {
   3.5296610992115965`*^9, 3.5296611060237045`*^9}, {3.5296611966903563`*^9, 
   3.529661246125009*^9}, {3.529661311277506*^9, 3.5296614697527523`*^9}, {
   3.529662711149994*^9, 3.529662724024252*^9}, {3.5296650036585627`*^9, 
   3.529665040218957*^9}, {3.529665074513856*^9, 3.529665187179241*^9}, {
   3.5296652263176117`*^9, 3.5296653666064053`*^9}, {3.529665436867983*^9, 
   3.5296654989269085`*^9}, {3.529665912918686*^9, 3.5296659252617254`*^9}, {
   3.5296668808941774`*^9, 3.5296673454924154`*^9}, {3.5297276773395476`*^9, 
   3.5297279407111764`*^9}, {3.5297280357880845`*^9, 3.529728181661217*^9}, {
   3.5297283964084682`*^9, 3.529728521375619*^9}, {3.5297285525783443`*^9, 
   3.529728553609581*^9}, {3.529728595655918*^9, 3.5297286022339587`*^9}, {
   3.5297286464521427`*^9, 3.5297286478115005`*^9}, {3.5297289080269194`*^9, 
   3.529728997150779*^9}, {3.529729110961822*^9, 3.529729159929945*^9}, {
   3.529729192835774*^9, 3.529729296381324*^9}, {3.5297298515460925`*^9, 
   3.529730068746437*^9}, {3.5297301000741615`*^9, 3.5297301221207542`*^9}, {
   3.5297301901823826`*^9, 3.5297302604471083`*^9}, {3.5297320714551773`*^9, 
   3.529732322170718*^9}, {3.529732355357793*^9, 3.5297324445129023`*^9}, {
   3.529734399972247*^9, 3.529734411206478*^9}, {3.5297356129098463`*^9, 
   3.5297360831694517`*^9}, {3.5297361279188786`*^9, 3.529736160621585*^9}, {
   3.5297362115584335`*^9, 3.5297362376205997`*^9}, {3.529736314166495*^9, 
   3.5297364382742815`*^9}, 3.5297365655539017`*^9, {3.529736730723663*^9, 
   3.5297367406766605`*^9}, {3.5297367719887595`*^9, 3.529736788441674*^9}, {
   3.5297402671783953`*^9, 3.529740268147133*^9}, {3.529740367692734*^9, 
   3.5297405342999763`*^9}, {3.5297406236738324`*^9, 3.529740643079834*^9}, {
   3.5297407390629807`*^9, 3.5297407435160484`*^9}, {3.5297448619477067`*^9, 
   3.529744898337866*^9}, {3.529745109100793*^9, 3.5297451487565355`*^9}, {
   3.5297452497708673`*^9, 3.529745275973657*^9}, {3.5297453332854233`*^9, 
   3.5297453593007154`*^9}, {3.5297453899565735`*^9, 
   3.5297453918159246`*^9}, {3.5297455152362194`*^9, 
   3.5297455334391117`*^9}, {3.529745564594963*^9, 3.529745577938542*^9}, {
   3.535874257484375*^9, 3.53587429334375*^9}, 3.5895325102798667`*^9, {
   3.5895331655177155`*^9, 3.58953317342665*^9}, {3.58953326290825*^9, 
   3.58953341745745*^9}, {3.5895335264698496`*^9, 3.5895335317582498`*^9}, {
   3.63341671979067*^9, 3.6334167349380755`*^9}, {3.755468710196156*^9, 
   3.755468787507333*^9}, {3.755468830062531*^9, 3.755468856961315*^9}, {
   3.755468919911846*^9, 3.755468950264077*^9}, {3.755469127477899*^9, 
   3.755469166939925*^9}, {3.840721146670598*^9, 3.8407213340815163`*^9}, {
   3.840723844478547*^9, 3.840723852528511*^9}, {3.842705861512175*^9, 
   3.842705866048118*^9}, {3.842706875630436*^9, 3.842706877457219*^9}, {
   3.84270693705305*^9, 3.8427070465127583`*^9}, 3.842707365250152*^9, {
   3.8427074102125673`*^9, 3.842707490656546*^9}, {3.842707525230846*^9, 
   3.8427075415037317`*^9}, {3.8427076014774942`*^9, 3.842707609776959*^9}, {
   3.842707726741431*^9, 3.842707772667182*^9}, {3.842707808989572*^9, 
   3.842707871137258*^9}, {3.84270791751357*^9, 3.842707947174326*^9}, {
   3.842708041290846*^9, 3.8427080672243958`*^9}, {3.842708272480362*^9, 
   3.84270827873833*^9}, {3.842709687038966*^9, 3.842709783393291*^9}, {
   3.8427098667389174`*^9, 3.842709869683082*^9}, {3.842710057902031*^9, 
   3.842710069366911*^9}, {3.842710574176909*^9, 3.8427106124333572`*^9}, {
   3.842710860721017*^9, 3.842710861233512*^9}, {3.842710919830422*^9, 
   3.842710932787472*^9}, {3.8427199946615887`*^9, 3.84272002747257*^9}},
 CellLabel->
  "In[810]:=",ExpressionUUID->"962f2113-bb72-49fa-836c-c82803d2f796"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LimitGrd", "[", 
   RowBox[{"grd_", ",", "maxx_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Limits", " ", "a", " ", "given", " ", "grid", " ", "to", " ", "a", " ",
        "maxiumum", " ", "depth"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"curmaxx", "=", 
       RowBox[{"Max", "[", "grd", "]"}]}], ",", "\[IndentingNewLine]", 
      "subgrid"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"subgrid", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"grd", ",", 
        RowBox[{
         RowBox[{"#", "\[LessEqual]", " ", "maxx"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"ListLogPlot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"subgrid", ",", "grd"}], "}"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Red", ",", 
               RowBox[{"PointSize", "[", "Large", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Blue", ",", 
               RowBox[{"PointSize", "[", "Small", "]"}]}], "}"}]}], "}"}]}], 
          ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", "\"\<Limit grid comparison\>\""}], 
          ",", 
          RowBox[{"BaseStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
             RowBox[{"FontSize", "\[Rule]", "28"}]}], "}"}]}]}], "]"}], "]"}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Limited grid contains \>\"", ",", " ", 
         RowBox[{"Length", "[", "subgrid", "]"}], ",", 
         "\"\< compared to \>\"", ",", " ", 
         RowBox[{"Length", "[", "grd", "]"}], ",", 
         "\"\< in the original grid\>\""}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", "subgrid"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5402708042586308`*^9, 3.540270866467607*^9}, {
   3.5402710423783207`*^9, 3.540271108650803*^9}, {3.540271168153928*^9, 
   3.540271194906905*^9}, {3.540272604768281*^9, 3.5402726415830917`*^9}, 
   3.755468966038268*^9},
 CellLabel->
  "In[815]:=",ExpressionUUID->"0df96b7d-e133-47b4-8d05-817df801f24d"],

Cell[CellGroupData[{

Cell[, "Subsubsection",ExpressionUUID->"b95e1e35-2d91-4122-869c-6e4c68c0ad80"],

Cell[, "Input",ExpressionUUID->"cbb6699e-9626-442c-9fd8-1f4445ec132b"],

Cell[, "Input",ExpressionUUID->"af958044-2a19-4e12-b48b-ee3c4b9a4de6"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[, "Section",ExpressionUUID->"16ad38dc-7c1e-4e32-9b20-25b5e6242b8e"],

Cell[, "Text",ExpressionUUID->"b1fe5d5d-f140-424a-a1ab-6db985987704"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fluxatt", "[", 
   RowBox[{"att_", ",", "theeqn_", ",", "thregrid_", ",", " ", 
    RowBox[{"xmax_", "?", "NumberQ"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"thedens", "=", 
       FractionBox[
        RowBox[{"prohW", "/.", "InputParam"}], 
        SuperscriptBox["tolenscale", "3"]]}], ",", "\[IndentingNewLine]", 
      RowBox[{"tointeg", " ", "=", " ", 
       RowBox[{
        RowBox[{"IMPLRATE", "/.", "theeqn"}], "/.", 
        RowBox[{"t", "\[Rule]", "att"}]}]}], ",", "tab", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"subgrid", " ", "=", " ", 
       RowBox[{"Select", "[", 
        RowBox[{"thregrid", ",", 
         RowBox[{
          RowBox[{"#", "<", "xmax"}], "&"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tab", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#", ",", " ", 
           RowBox[{"tointeg", "/.", 
            RowBox[{"x", "\[Rule]", "#"}]}]}], "}"}], "&"}], ",", "subgrid"}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"thedens", "*", 
      RowBox[{"ListIntegrate", "[", "tab", "]"}]}]}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[816]:=",ExpressionUUID->"b81207d6-8d2d-4e24-bafb-f8dba6b8b938"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "BuildImplantationCase", "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"TempFunc", "\[Rule]", "ConstTempFunc"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"InitSolConcFunc", "\[Rule]", 
      RowBox[{"ConstFuncofx", "[", "0", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"InitTrapConcFunc", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ConstFuncofx", "[", "0", "]"}], ",", 
        RowBox[{"ConstFuncofx", "[", "0", "]"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"MaxPlott", "\[Rule]", "1000"}], ",", 
     RowBox[{"MaxPlotx", "\[Rule]", "100"}], ",", 
     RowBox[{"SourcePlotTime", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"FontSize", "\[Rule]", "18"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BuildImplantationCase", "[", 
   RowBox[{"Grid_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TofXandt", "=", 
       RowBox[{"OptionValue", "[", "TempFunc", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"srcplttime", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "SourcePlotTime", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"maxt", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "MaxPlott", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"maxx", "=", " ", 
       RowBox[{"OptionValue", "[", "MaxPlotx", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"inittrapconcofx", "=", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"OptionValue", "[", "InitTrapConcFunc", "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"initsolconcofx", "=", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"OptionValue", "[", "InitSolConcFunc", "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ImplParam", "=", 
       RowBox[{"pImplParam", "/.", "InputParam"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"TrapModelParam", "=", 
       RowBox[{"pTrapModelParam", "/.", "InputParam"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"solbndcnd", " ", "=", " ", 
       RowBox[{"(", 
        RowBox[{"pSolBndCond", "/.", "InputParam"}], ")"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"soldriftoft", "=", 
       RowBox[{"(", 
        RowBox[{"pSoluteModel", "/.", 
         RowBox[{"(", 
          RowBox[{"pSolModelParam", "/.", "InputParam"}], ")"}]}], ")"}]}], 
      ",", "\[IndentingNewLine]", "Srcoft", ",", "\[IndentingNewLine]", 
      "TrapProfofxandt", ",", "\[IndentingNewLine]", "numtrap", ",", 
      "\[IndentingNewLine]", "implcenter", ",", "implwidth", ",", 
      "\[IndentingNewLine]", "traprate", ",", "\[IndentingNewLine]", 
      "solbndcndtab", ",", "\[IndentingNewLine]", "trapdrifts", ",", 
      "\[IndentingNewLine]", "traprates", ",", "\[IndentingNewLine]", 
      "soldrift", ",", "\[IndentingNewLine]", "implrate", ",", 
      "\[IndentingNewLine]", "tgtthick", ",", "\[IndentingNewLine]", "dgleqn",
       ",", "\[IndentingNewLine]", "trapprof", ",", "\[IndentingNewLine]", 
      "ImplPlotMin", ",", "\[IndentingNewLine]", "ImplPlotMax", ",", 
      "\[IndentingNewLine]", "FirstGridStep", ",", "\[IndentingNewLine]", 
      "reqsol", ",", "\[IndentingNewLine]", "pltdata", ",", 
      "\[IndentingNewLine]", "subgrid"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Srcoft", "=", 
      RowBox[{"pImplModel", "/.", "ImplParam"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"implcenter", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"pImplRng", "/.", "ImplParam"}], ")"}], "*", "tolenscale"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"implwidth", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"pImplStrgl", "/.", "ImplParam"}], ")"}], "*", 
       "tolenscale"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrapProfofxandt", "=", 
      RowBox[{"pFunc", "/.", 
       RowBox[{"(", 
        RowBox[{"pTrapProfFunc", "/.", "TrapModelParam"}], " ", ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"numtrap", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"pTraps", "/.", "TrapModelParam"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"traprate", "=", 
      RowBox[{"(", 
       RowBox[{"pTrapModel", "/.", "TrapModelParam"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tgtthick", "=", 
      RowBox[{"Max", "[", "Grid", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<# of traps: \>\"", ",", " ", "numtrap", ",", " ", 
         "\"\< tgtthick: \>\"", ",", "tgtthick"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"TrueQ", "[", 
          RowBox[{
           RowBox[{"Length", "[", "TrapProfofxandt", "]"}], "\[GreaterEqual]",
            "  ", "numtrap"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
         "Print", "[", 
          "\"\<SUCCESS->Number of traps and number of trap profile functions \
match\>\"", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
         "Print", "[", 
          "\"\<ERROR->Number of traps and number of trap profile functions \
MISSMATCH\>\"", "]"}]}], "\[IndentingNewLine]", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Starting temperature: \>\"", ",", " ", 
         RowBox[{"TofXandt", "[", 
          RowBox[{"0", ",", "0"}], "]"}]}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"trapdrifts", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SoluteTrapCoupling", 
         RowBox[{"(*", "ManualMoL", "*)"}], "[", "ti", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"traprates", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"traprate", "[", 
         RowBox[{"TofXandt", ",", "ti", ",", 
          RowBox[{"TrapProfofxandt", "[", 
           RowBox[{"[", "ti", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<soldriftoft: \>\"", ",", "soldriftoft"}], "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"soldrift", "=", 
      RowBox[{"soldriftoft", "[", "TofXandt", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<soldrift: \>\"", ",", "soldrift"}], "]"}], ";"}], "*)"}],
      "\[IndentingNewLine]", 
     RowBox[{"FirstGridStep", "=", 
      RowBox[{"Part", "[", 
       RowBox[{"Grid", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"implrate", "=", 
      RowBox[{"Srcoft", "[", 
       RowBox[{"FirstGridStep", ",", "x"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<implrate: \>\"", ",", " ", "implrate"}], "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"solbndcndtab", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"pModel", "/.", 
           RowBox[{"(", 
            RowBox[{"pLeft", "/.", "solbndcnd"}], ")"}]}], ")"}], "[", 
         RowBox[{"pLeft", ",", "0", ",", "TofXandt"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"pModel", "/.", 
           RowBox[{"(", 
            RowBox[{"pRight", "/.", "solbndcnd"}], ")"}]}], ")"}], "[", 
         RowBox[{"pRight", ",", "tgtthick", ",", "TofXandt"}], "]"}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Solute boundary conditions: \>\"", ",", 
         RowBox[{"TableForm", "[", "solbndcndtab", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Implanting for depths > \>\"", ",", " ", "FirstGridStep"}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"TofXandt", "[", 
           RowBox[{"0", ",", "t"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", "maxt"}], "}"}], ",", 
          RowBox[{
          "PlotLabel", "\[Rule]", 
           "\"\<Temperature as function of time at x = 0\>\""}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ImplPlotMin", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"0", ",", 
        RowBox[{"implcenter", "-", 
         RowBox[{"5", "*", "implwidth"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ImplPlotMax", "=", 
      RowBox[{"Min", "[", 
       RowBox[{"tgtthick", ",", 
        RowBox[{"implcenter", "+", 
         RowBox[{"5", "*", "implwidth"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "\[IndentingNewLine]", 
        RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"#", ",", 
                RowBox[{"implrate", "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"x", "\[Rule]", "#"}], ",", " ", 
                   RowBox[{"t", "\[Rule]", "srcplttime"}]}], "}"}]}]}], "}"}],
               "&"}], ",", 
             RowBox[{"Select", "[", 
              RowBox[{"Grid", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", ">=", "ImplPlotMin"}], " ", "&&", " ", 
                 RowBox[{"#", " ", "\[LessEqual]", " ", "ImplPlotMax"}]}], 
                "&"}]}], "]"}]}], "]"}], "]"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", 
           RowBox[{"\"\<Implantation distribution @ t->\>\"", "<>", 
            RowBox[{"ToString", "[", "srcplttime", "]"}]}]}], ",", 
          RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}], 
        "\[IndentingNewLine]", "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"LogLogPlot", "[", 
         RowBox[{
          RowBox[{"initsolconcofx", "[", "x", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0.001", ",", "maxx"}], "}"}], ",", 
          RowBox[{
          "PlotLabel", "\[Rule]", 
           "\"\<Initial solute concentration depth profile\>\""}]}], "]"}], 
        "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"LogLogPlot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"inittrapconcofx", "[", 
               RowBox[{"[", "ti", "]"}], "]"}], ")"}], "[", "x", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0.001", ",", "maxx"}], "}"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Part", "[", 
                  RowBox[{"Grid", ",", "2"}], "]"}], ",", 
                 RowBox[{"Part", "[", 
                  RowBox[{"Grid", ",", 
                   RowBox[{"-", "1"}]}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1*^-10", ",", "1"}], "}"}]}], "}"}]}], ",", 
            RowBox[{"PlotLabel", "\[Rule]", 
             RowBox[{"\"\<Initial traped concentration depth profile: \>\"", "<>", 
              RowBox[{"ToString", "[", "ti", "]"}]}]}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"trapprof", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"TrapProfofxandt", ",", "ti"}], "]"}], "[", 
         RowBox[{"0", ",", "x", ",", "t", ",", "ti"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"subgrid", " ", "=", " ", 
      RowBox[{"Select", "[", 
       RowBox[{"Grid", ",", 
        RowBox[{
         RowBox[{"#", "<", "maxx"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Plotting traps in Grid up to depth \>\"", ",", " ", "maxx"}], 
        "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"pltdata", "=", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ShowStatus", "[", 
           RowBox[{"\"\<TrapProfofxandt @ \>\"", "<>", 
            RowBox[{"ToString", "[", "ti", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Part", "[", 
                  RowBox[{"trapprof", ",", "ti"}], "]"}], ")"}], "/.", 
                RowBox[{"x", "\[Rule]", "#"}]}]}], "}"}], "&"}], ",", 
            "subgrid"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}], "/.", 
       RowBox[{"t", "->", "maxt"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<PlotData Ready, \>\"", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"Flatten", "[", "pltdata", "]"}], "]"}], ",", " ", 
         "\"\< entries\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"ListLogLogPlot", "[", "\[IndentingNewLine]", 
         RowBox[{"pltdata", ",", "\[IndentingNewLine]", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Depth (um)\>\"", ",", " ", "\"\<Concentration\>\""}],
             "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"BaseStyle", "\[Rule]", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
             RowBox[{"FontSize", "\[Rule]", 
              RowBox[{"OptionValue", "[", "FontSize", "]"}]}]}], "}"}]}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"AddLegend", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"\"\<Trap \>\"", "<>", 
                RowBox[{"ToString", "[", "ti", "]"}]}], ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
               RowBox[{"FontWeight", "\[Rule]", "Bold"}], ",", " ", 
               RowBox[{"FontSize", "\[Rule]", "16"}]}], " ", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}], "]"}],
           ",", "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"subgrid", ",", "2"}], "]"}], ",", 
               RowBox[{"Part", "[", 
                RowBox[{"subgrid", ",", 
                 RowBox[{"-", "1"}]}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1*^-10", ",", "1"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", 
           RowBox[{"\"\<Trap distribution at t = \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"N", "[", "maxt", "]"}], "]"}]}]}]}], "]"}], "]"}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"dgleqn", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"csol", "[", "i", "]"}], "[", "t", "]"}], ",", 
                  "t"}], "]"}], "\[Equal]", 
                RowBox[{
                 RowBox[{"soldrift", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", "-", "1"}], "]"}], "]"}], "+", 
                 RowBox[{"(", 
                  RowBox[{"implrate", "/.", 
                   RowBox[{"x", "\[Rule]", 
                    RowBox[{"Grid", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], ")"}], "-", 
                 RowBox[{"Sum", "[", 
                  RowBox[{
                   RowBox[{"trapdrifts", "[", 
                    RowBox[{"[", "ti", "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], 
                  "]"}]}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "2", ",", 
                 RowBox[{
                  RowBox[{"Length", "[", "Grid", "]"}], "-", "1"}]}], "}"}]}],
               "]"}], ",", "\[IndentingNewLine]", "solbndcndtab", ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"csol", "[", "i", "]"}], "[", "0", "]"}], "\[Equal]", 
                RowBox[{"initsolconcofx", "[", 
                 RowBox[{"Grid", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", "Grid", "]"}]}], "}"}]}], "]"}]}], 
            "\[IndentingNewLine]", "}"}], ",", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"ctrp", ",", "ti"}], "]"}], "[", "i", "]"}], "[", 
                    "t", "]"}], ",", "t"}], "]"}], "==", 
                    RowBox[{"traprates", "[", 
                    RowBox[{"[", "ti", "]"}], "]"}]}], ")"}], "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"ctrp", ",", "ti"}], "]"}], "[", 
                    RowBox[{"x", ",", "t"}], "]"}], "\[Rule]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"ctrp", ",", "ti"}], "]"}], "[", "i", "]"}], "[", 
                    "t", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"csol", "[", 
                    RowBox[{"x", ",", "t"}], "]"}], "\[Rule]", 
                    RowBox[{
                    RowBox[{"csol", "[", "i", "]"}], "[", "t", "]"}]}], ",", 
                    RowBox[{"x", "\[Rule]", 
                    RowBox[{"Grid", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "2", ",", 
                   RowBox[{
                    RowBox[{"Length", "[", "Grid", "]"}], "-", "1"}]}], 
                  "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"ctrp", ",", "ti"}], "]"}], "[", "i", "]"}], "[", 
                    "0", "]"}], "\[Equal]", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"inittrapconcofx", "[", 
                    RowBox[{"[", "ti", "]"}], "]"}], ")"}], "[", "x", "]"}]}],
                   "/.", 
                  RowBox[{"x", "->", 
                   RowBox[{"Grid", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "2", ",", 
                   RowBox[{
                    RowBox[{"Length", "[", "Grid", "]"}], "-", "1"}]}], 
                  "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"reqsol", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"csol", "[", "i", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "Grid", "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Subscript", "[", 
                 RowBox[{"ctrp", ",", "ti"}], "]"}], "[", "i", "]"}], " ", 
               ",", 
               RowBox[{"{", 
                RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "2", ",", 
               RowBox[{
                RowBox[{"Length", "[", "Grid", "]"}], "-", "1"}]}], "}"}]}], 
            "]"}]}], "]"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"dgleqn", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"csol", "[", 
               RowBox[{"x", ",", "t"}], "]"}], ",", "t"}], "]"}], "\[Equal]", 
            RowBox[{"soldrift", "-", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{"trapdrifts", "[", 
                RowBox[{"[", "ti", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}]}]}], 
           ",", "\[IndentingNewLine]", "solbndcndtab", ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"csol", "[", 
             RowBox[{"x", ",", "0"}], "]"}], "\[Equal]", 
            RowBox[{"initsolconcofx", "[", "x", "]"}]}]}], 
          "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Subscript", "[", 
                   RowBox[{"ctrp", ",", "ti"}], "]"}], "[", 
                  RowBox[{"x", ",", "t"}], "]"}], ",", "t"}], "]"}], "==", 
               RowBox[{"traprates", "[", 
                RowBox[{"[", "ti", "]"}], "]"}]}], ")"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Subscript", "[", 
                RowBox[{"ctrp", ",", "ti"}], "]"}], "[", 
               RowBox[{"x", ",", "0"}], "]"}], "\[Equal]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"inittrapconcofx", "[", 
                 RowBox[{"[", "ti", "]"}], "]"}], ")"}], "[", "x", "]"}]}]}], 
            "\[IndentingNewLine]", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"reqsol", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "csol", "}"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Subscript", "[", 
            RowBox[{"ctrp", ",", "ti"}], "]"}], " ", ",", 
           RowBox[{"{", 
            RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}]}], "]"}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"DGL", "->", "dgleqn"}], ",", 
       RowBox[{"TRAPRATES", "->", "traprates"}], ",", 
       RowBox[{"TRAPPROFILES", "\[Rule]", "trapprof"}], ",", 
       RowBox[{"IMPLRATE", "->", "implrate"}], ",", 
       RowBox[{"TEMP", "->", "TofXandt"}], ",", " ", 
       RowBox[{"VARS", "->", "reqsol"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "BuildAnnealingCase", "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"TempFunc", "\[Rule]", "ConstTempFunc"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"TrapProfTime", "\[Rule]", "t"}], ",", "\[IndentingNewLine]", 
     RowBox[{"InitSolConcFunc", "\[Rule]", 
      RowBox[{"ConstFuncofx", "[", "0", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"InitTrapConcFunc", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ConstFuncofx", "[", "0", "]"}], ",", 
        RowBox[{"ConstFuncofx", "[", "0", "]"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"MaxPlott", "\[Rule]", "1000"}], ",", "\[IndentingNewLine]", 
     RowBox[{"MaxPlotx", "\[Rule]", "100"}], ",", "\[IndentingNewLine]", 
     RowBox[{"FontSize", "\[Rule]", "18"}], ",", "\[IndentingNewLine]", 
     RowBox[{"NDrop", "\[Rule]", "50"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BuildAnnealingCase", "[", 
   RowBox[{"Grid_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TofXandt", "=", 
       RowBox[{"OptionValue", "[", "TempFunc", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"maxt", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "MaxPlott", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"maxx", "=", " ", 
       RowBox[{"OptionValue", "[", "MaxPlotx", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"inittrapconcofx", "=", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"OptionValue", "[", "InitTrapConcFunc", "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"initsolconcofx", "=", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"OptionValue", "[", "InitSolConcFunc", "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ImplParam", "=", 
       RowBox[{"pImplParam", "/.", "InputParam"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"TrapModelParam", "=", 
       RowBox[{"pTrapModelParam", "/.", "InputParam"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"solbndcnd", " ", "=", " ", 
       RowBox[{"(", 
        RowBox[{"pSolBndCond", "/.", "InputParam"}], ")"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"soldriftoft", "=", 
       RowBox[{"(", 
        RowBox[{"pSoluteModel", "/.", 
         RowBox[{"(", 
          RowBox[{"pSolModelParam", "/.", "InputParam"}], ")"}]}], ")"}]}], 
      ",", "\[IndentingNewLine]", "Srcoft", ",", "\[IndentingNewLine]", 
      "TrapProfofxandt", ",", "\[IndentingNewLine]", "numtrap", ",", 
      "\[IndentingNewLine]", "implcenter", ",", "implwidth", ",", 
      "\[IndentingNewLine]", "traprate", ",", "\[IndentingNewLine]", 
      "solbndcndtab", ",", "\[IndentingNewLine]", "trapdrifts", ",", 
      "\[IndentingNewLine]", "traprates", ",", "\[IndentingNewLine]", 
      "soldrift", ",", "\[IndentingNewLine]", "dummyimplrate", ",", 
      "\[IndentingNewLine]", "tgtthick", ",", "\[IndentingNewLine]", "dgleqn",
       ",", "\[IndentingNewLine]", "trapprof", ",", "\[IndentingNewLine]", 
      "ImplPlotMin", ",", "\[IndentingNewLine]", "ImplPlotMax", ",", 
      "\[IndentingNewLine]", "FirstGridStep", ",", "\[IndentingNewLine]", 
      "reqsol", ",", "\[IndentingNewLine]", "pltdata", ",", 
      "\[IndentingNewLine]", "subgrid"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"TrapProfofxandt", "=", 
      RowBox[{"pFunc", "/.", 
       RowBox[{"(", 
        RowBox[{"pTrapProfFunc", "/.", "TrapModelParam"}], " ", ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"numtrap", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"pTraps", "/.", "TrapModelParam"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"traprate", "=", 
      RowBox[{"(", 
       RowBox[{"pTrapModel", "/.", "TrapModelParam"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tgtthick", "=", 
      RowBox[{"Max", "[", "Grid", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<# of traps: \>\"", ",", " ", "numtrap", ",", " ", 
       "\"\< tgtthick: \>\"", ",", "tgtthick"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"TrueQ", "[", 
        RowBox[{
         RowBox[{"Length", "[", "TrapProfofxandt", "]"}], "\[GreaterEqual]", 
         "  ", "numtrap"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<SUCCESS->Number of traps and number of trap profile functions \
match\>\"", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<ERROR->Number of traps and number of trap profile functions \
MISSMATCH\>\"", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Starting temperature: \>\"", ",", " ", 
       RowBox[{"TofXandt", "[", 
        RowBox[{"0", ",", "0"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"trapdrifts", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SoluteTrapCoupling", "[", "ti", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"traprates", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"traprate", "[", 
         RowBox[{"TofXandt", ",", "ti", ",", 
          RowBox[{"TrapProfofxandt", "[", 
           RowBox[{"[", "ti", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<soldriftoft: \>\"", ",", "soldriftoft"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"soldrift", "=", 
      RowBox[{"soldriftoft", "[", "TofXandt", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<soldrift: \>\"", ",", "soldrift"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"FirstGridStep", "=", 
      RowBox[{"Part", "[", 
       RowBox[{"Grid", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"solbndcndtab", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"pModel", "/.", 
           RowBox[{"(", 
            RowBox[{"pLeft", "/.", "solbndcnd"}], ")"}]}], ")"}], "[", 
         RowBox[{"pLeft", ",", "0", ",", "TofXandt"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"pModel", "/.", 
           RowBox[{"(", 
            RowBox[{"pRight", "/.", "solbndcnd"}], ")"}]}], ")"}], "[", 
         RowBox[{"pRight", ",", "tgtthick", ",", "TofXandt"}], "]"}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Solute boundary conditions: \>\"", ",", 
       RowBox[{"TableForm", "[", "solbndcndtab", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"LogLogPlot", "[", 
       RowBox[{
        RowBox[{"initsolconcofx", "[", "x", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0.001", ",", "maxx"}], "}"}], ",", 
        RowBox[{
        "PlotLabel", "\[Rule]", 
         "\"\<Initial solute concentration depth profile\>\""}]}], "]"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"LogLogPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"inittrapconcofx", "[", 
             RowBox[{"[", "ti", "]"}], "]"}], ")"}], "[", "x", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0.001", ",", "maxx"}], "}"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"Grid", ",", "2"}], "]"}], ",", 
               RowBox[{"Part", "[", 
                RowBox[{"Grid", ",", 
                 RowBox[{"-", "1"}]}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1*^-10", ",", "1"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", 
           RowBox[{"\"\<Initial traped concentration depth profile: \>\"", "<>", 
            RowBox[{"ToString", "[", "ti", "]"}]}]}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}], ";", 
     RowBox[{"trapprof", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"TrapProfofxandt", ",", "ti"}], "]"}], "[", 
         RowBox[{"0", ",", "x", ",", "t", ",", "ti"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"subgrid", " ", "=", " ", 
      RowBox[{"Select", "[", 
       RowBox[{"Grid", ",", 
        RowBox[{
         RowBox[{"#", "<", "maxx"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<Plotting traps in Grid up to depth \>\"", ",", " ", "maxx"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"pltdata", "=", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ShowStatus", "[", 
           RowBox[{"\"\<TrapProfofxandt @ \>\"", "<>", 
            RowBox[{"ToString", "[", "ti", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Part", "[", 
                  RowBox[{"trapprof", ",", "ti"}], "]"}], ")"}], "/.", 
                RowBox[{"x", "\[Rule]", "#"}]}]}], "}"}], "&"}], ",", 
            "subgrid"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}], "/.", 
       RowBox[{"t", "->", "maxt"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"ListLogLogPlot", "[", "\[IndentingNewLine]", 
       RowBox[{"pltdata", ",", "\[IndentingNewLine]", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<Depth (um)\>\"", ",", " ", "\"\<Concentration\>\""}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"BaseStyle", "\[Rule]", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
           RowBox[{"FontSize", "\[Rule]", 
            RowBox[{"OptionValue", "[", "FontSize", "]"}]}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AddLegend", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"\"\<Trap \>\"", "<>", 
              RowBox[{"ToString", "[", "ti", "]"}]}], ",", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
             RowBox[{"FontWeight", "\[Rule]", "Bold"}], ",", " ", 
             RowBox[{"FontSize", "\[Rule]", "16"}]}], " ", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"subgrid", ",", "2"}], "]"}], ",", 
             RowBox[{"Part", "[", 
              RowBox[{"subgrid", ",", 
               RowBox[{"-", "1"}]}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1*^-10", ",", "1"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"PlotLabel", "\[Rule]", 
         RowBox[{"\"\<Trap distribution at t = \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"N", "[", "maxt", "]"}], "]"}]}]}]}], "]"}], "]"}], ";", 
     RowBox[{"dgleqn", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"csol", "[", 
               RowBox[{"x", ",", "t"}], "]"}], ",", "t"}], "]"}], "==", 
            RowBox[{"soldrift", "-", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{"trapdrifts", "[", 
                RowBox[{"[", "ti", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}]}]}], 
           ",", "\[IndentingNewLine]", "solbndcndtab", ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"csol", "[", 
             RowBox[{"x", ",", "0"}], "]"}], "\[Equal]", 
            RowBox[{"initsolconcofx", "[", "x", "]"}]}]}], 
          "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Subscript", "[", 
                  RowBox[{"ctrp", ",", "ti"}], "]"}], "[", 
                 RowBox[{"x", ",", "t"}], "]"}], ",", "t"}], "]"}], "==", 
              RowBox[{"traprates", "[", 
               RowBox[{"[", "ti", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Subscript", "[", 
                RowBox[{"ctrp", ",", "ti"}], "]"}], "[", 
               RowBox[{"x", ",", "0"}], "]"}], "\[Equal]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"inittrapconcofx", "[", 
                 RowBox[{"[", "ti", "]"}], "]"}], ")"}], "[", "x", "]"}]}]}], 
            "\[IndentingNewLine]", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dummyimplrate", "=", 
      RowBox[{
       FractionBox["1", "dens"], "*", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "-", "x"}], ")"}], "2"]}]]}], 
        RowBox[{
         SqrtBox["\[Pi]"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"Erf", "[", "1", "]"}]}], ")"}]}]]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"reqsol", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "csol", "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Subscript", "[", 
           RowBox[{"ctrp", ",", "ti"}], "]"}], " ", ",", 
          RowBox[{"{", 
           RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"DGL", "->", "dgleqn"}], ",", 
       RowBox[{"TRAPRATES", "->", "traprates"}], ",", 
       RowBox[{"TRAPPROFILES", "\[Rule]", "trapprof"}], ",", 
       RowBox[{"IMPLRATE", "->", "dummyimplrate"}], ",", 
       RowBox[{"TEMP", "->", "TofXandt"}], ",", " ", 
       RowBox[{"VARS", "->", "reqsol"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "PrevSolConc", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"PFun", "\[Rule]", "LogLogPlot"}], ",", 
     RowBox[{"ChoppLevel", "\[Rule]", "1*^-14"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PrevSolConc", "[", 
   RowBox[{"sol_", ",", "grd_", ",", "tfin_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"numtrap", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"pTraps", "/.", "InputParam"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"plotfun", "=", 
       RowBox[{"OptionValue", "[", "PFun", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"pltrng", " ", "=", 
       RowBox[{"OptionValue", "[", "PlotRange", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"choplev", "=", 
       RowBox[{"OptionValue", "[", "ChoppLevel", "]"}]}], ",", 
      "\[IndentingNewLine]", "func", ",", "\[IndentingNewLine]", "res", ",", 
      "\[IndentingNewLine]", "tabxy"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<ChoppLevel: \>\"", ",", " ", "choplev"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"func", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"csol", "[", 
         RowBox[{"x", ",", "t"}], "]"}], "/.", "sol"}], "/.", 
       RowBox[{"t", "\[Rule]", "tfin"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tabxy", "=", 
      RowBox[{"Chop", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "func"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "grd"}], "}"}]}], "]"}], ",", "choplev"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"Interpolation2D", "[", "tabxy", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"plotfun", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"res", "[", "x", "]"}], ",", "func"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0.001", ",", 
          RowBox[{"Max", "[", "grd", "]"}]}], "}"}], ",", 
        RowBox[{"PlotRange", "->", "pltrng"}], ",", 
        RowBox[{
        "PlotLabel", "\[Rule]", 
         "\"\<Comparison of CSol and chopped CSol interpolation\>\""}]}], 
       "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "res", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "PrevTrapConc", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"PFun", "\[Rule]", "LogLogPlot"}], ",", 
     RowBox[{"ChoppLevel", "\[Rule]", "1*^-14"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PrevTrapConc", "[", 
   RowBox[{"i_", ",", "sol_", ",", "grd_", ",", "tfin_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"numtrap", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"pTraps", "/.", "InputParam"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"plotfun", "=", 
       RowBox[{"OptionValue", "[", "PFun", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"pltrng", " ", "=", 
       RowBox[{"OptionValue", "[", "PlotRange", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"choplev", "=", 
       RowBox[{"OptionValue", "[", "ChoppLevel", "]"}]}], ",", 
      "\[IndentingNewLine]", "func", ",", "\[IndentingNewLine]", "res", ",", 
      "\[IndentingNewLine]", "tabxy"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"func", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Subscript", "[", 
          RowBox[{"ctrp", ",", "i"}], "]"}], "[", 
         RowBox[{"x", ",", "t"}], "]"}], "/.", "sol"}], "/.", 
       RowBox[{"t", "\[Rule]", "tfin"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tabxy", "=", 
      RowBox[{"Chop", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "func"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "grd"}], "}"}]}], "]"}], ",", "choplev"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"Interpolation2D", "[", "tabxy", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"plotfun", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"res", "[", "x", "]"}], ",", "func"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0.001", ",", 
          RowBox[{"Max", "[", "grd", "]"}]}], "}"}], ",", 
        RowBox[{"PlotRange", "->", "pltrng"}], ",", 
        RowBox[{"PlotLabel", "\[Rule]", 
         RowBox[{
         "\"\<Comparison of CTrap and chopped CTrap interpolation: \>\"", "<>", 
          RowBox[{"ToString", "[", "i", "]"}]}]}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "res", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ManualFillTrapedConc", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"pSteepnes", " ", "\[Rule]", "1*^-2"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ManualFillTrapedConc", "[", 
   RowBox[{"fillfrac_", ",", "i_", ",", "maxdepth_", ",", "time_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TrapModelParam", "=", 
       RowBox[{"pTrapModelParam", "/.", "InputParam"}]}], ",", 
      "\[IndentingNewLine]", "TrapProfofxandt", ",", "\[IndentingNewLine]", 
      RowBox[{"Steepnes", "=", 
       RowBox[{"OptionValue", "[", "pSteepnes", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"LeftConc", "=", "1"}], ",", "\[IndentingNewLine]", 
      RowBox[{"RightConc", "=", "0.0"}], ",", "\[IndentingNewLine]", "func", 
      ",", "ff", ",", "\[IndentingNewLine]", 
      RowBox[{"verb", " ", "=", " ", 
       RowBox[{"pVERBOSE", "/.", "InputParam"}]}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"TrapProfofxandt", "=", 
      RowBox[{"pFunc", "/.", 
       RowBox[{"(", 
        RowBox[{"pTrapProfFunc", "/.", "TrapModelParam"}], " ", ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "[", 
        RowBox[{"verb", ">", "0"}], "]"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<ManualFillTrapedConc->pSteepnes = \>\"", ",", "Steepnes"}], 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ff", "=", 
      RowBox[{"Part", "[", 
       RowBox[{"TrapProfofxandt", ",", "i"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"func", "[", "x_", "]"}], "=", 
      RowBox[{"fillfrac", "*", 
       RowBox[{"ff", "[", 
        RowBox[{"0", ",", "x", ",", "time", ",", "i"}], "]"}], "*", 
       RowBox[{"BMFunc", "[", 
        RowBox[{
        "x", ",", "maxdepth", ",", "Steepnes", ",", "LeftConc", ",", 
         "RightConc"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "[", 
        RowBox[{"verb", ">", "1"}], "]"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<ManualFillTrapedConc func = \>\"", ",", 
         RowBox[{"func", "[", "x", "]"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Function", "[", 
      RowBox[{"func", "[", "#", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ManualFillTrapedConcFromTo", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"pSteepnes", " ", "\[Rule]", "1*^-2"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ManualFillTrapedConcFromTo", "[", 
   RowBox[{
   "fillfrac_", ",", "i_", ",", "fromfill_", ",", "tofill_", ",", "time_", 
    ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TrapModelParam", "=", 
       RowBox[{"pTrapModelParam", "/.", "InputParam"}]}], ",", 
      "\[IndentingNewLine]", "TrapProfofxandt", ",", "\[IndentingNewLine]", 
      RowBox[{"Steepnes", "=", 
       RowBox[{"OptionValue", "[", "pSteepnes", "]"}]}], ",", 
      "\[IndentingNewLine]", "func", ",", "ff", ",", "\[IndentingNewLine]", 
      RowBox[{"verb", " ", "=", " ", 
       RowBox[{"pVERBOSE", "/.", "InputParam"}]}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"TrapProfofxandt", "=", 
      RowBox[{"pFunc", "/.", 
       RowBox[{"(", 
        RowBox[{"pTrapProfFunc", "/.", "TrapModelParam"}], " ", ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "[", 
        RowBox[{"verb", ">", "0"}], "]"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<ManualFillTrapedConc->pSteepnes = \>\"", ",", "Steepnes"}], 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ff", "=", 
      RowBox[{"Part", "[", 
       RowBox[{"TrapProfofxandt", ",", "i"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"func", "[", "x_", "]"}], "=", 
      RowBox[{"fillfrac", "*", 
       RowBox[{"ff", "[", 
        RowBox[{"0", ",", "x", ",", "time", ",", "i"}], "]"}], "*", 
       RowBox[{"BMFunc", "[", 
        RowBox[{"x", ",", "fromfill", ",", "Steepnes", ",", "0", ",", "1"}], 
        "]"}], "*", 
       RowBox[{"BMFunc", "[", 
        RowBox[{"x", ",", "tofill", ",", "Steepnes", ",", "1", ",", "0"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "[", 
        RowBox[{"verb", ">", "1"}], "]"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<ManualFillTrapedConc func = \>\"", ",", 
         RowBox[{"func", "[", "x", "]"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Function", "[", 
      RowBox[{"func", "[", "#", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ManualFillConcFrom", "[", 
   RowBox[{"fill_", ",", "fromfill_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", "func", "\[IndentingNewLine]", "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"func", "[", "x_", "]"}], "=", 
      RowBox[{"Piecewise", "[", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"fill", ",", 
          RowBox[{"x", "\[GreaterEqual]", "fromfill"}]}], "}"}], "}"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Function", "[", 
      RowBox[{"func", "[", "#", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ManualFillTrapedConcToFillLevel", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"pSteepnes", " ", "\[Rule]", "1*^-2"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ManualFillTrapedConcToFillLevel", "[", 
   RowBox[{
   "fillfrac_", ",", "i_", ",", "j_", ",", "maxdepth_", ",", "time_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TrapModelParam", "=", 
       RowBox[{"pTrapModelParam", "/.", "InputParam"}]}], ",", 
      "\[IndentingNewLine]", "TrapProfofxandt", ",", "\[IndentingNewLine]", 
      RowBox[{"Steepnes", "=", 
       RowBox[{"OptionValue", "[", "pSteepnes", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"LeftConc", "=", "1"}], ",", "\[IndentingNewLine]", 
      RowBox[{"RightConc", "=", "0.0"}], ",", "\[IndentingNewLine]", "func", 
      ",", "ff", ",", "\[IndentingNewLine]", 
      RowBox[{"verb", " ", "=", " ", 
       RowBox[{"pVERBOSE", "/.", "InputParam"}]}], ",", "\[IndentingNewLine]",
       "nfill", ",", "\[IndentingNewLine]", "funcTemp"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nfill", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"pETS", "/.", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"pTraps", "/.", 
           RowBox[{"(", 
            RowBox[{"pTrapModelParam", "/.", "InputParam"}], ")"}]}], ")"}], 
         "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"TrapProfofxandt", "=", 
      RowBox[{"pFunc", "/.", 
       RowBox[{"(", 
        RowBox[{"pTrapProfFunc", "/.", "TrapModelParam"}], " ", ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "[", 
        RowBox[{"verb", ">", "0"}], "]"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<ManualFillTrapedConc->pSteepnes = \>\"", ",", "Steepnes"}], 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ff", "=", 
      RowBox[{"Part", "[", 
       RowBox[{"TrapProfofxandt", ",", "i"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"funcTemp", "=", 
      RowBox[{"fillfrac", "*", 
       RowBox[{"ff", "[", 
        RowBox[{"0", ",", "x", ",", "time", ",", "i"}], "]"}], "*", 
       RowBox[{"BMFunc", "[", 
        RowBox[{
        "x", ",", "maxdepth", ",", "Steepnes", ",", "LeftConc", ",", 
         "RightConc"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"func", "[", "x_", "]"}], "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"jj", "\[Equal]", "0"}], ",", 
          RowBox[{
           RowBox[{"ff", "[", 
            RowBox[{"0", ",", "x", ",", "time", ",", "i"}], "]"}], "-", 
           "funcTemp"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"jj", "\[Equal]", "j"}], ",", "funcTemp", ",", "0"}], 
           "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"jj", ",", "0", ",", "nfill"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "[", 
        RowBox[{"verb", ">", "1"}], "]"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<ManualFillTrapedConc func = \>\"", ",", 
         RowBox[{"func", "[", "x", "]"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Function", "[", 
      RowBox[{"func", "[", "#", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.502014317375279*^9, 3.502014351593232*^9}, {
   3.502014875949251*^9, 3.50201487852736*^9}, 3.504592841142704*^9, {
   3.5046000602473555`*^9, 3.5046001940971017`*^9}, {3.504600250849644*^9, 
   3.504600344853855*^9}, {3.5046005995527654`*^9, 3.504600798362955*^9}, {
   3.5046008527381573`*^9, 3.504600871612582*^9}, {3.504601377098547*^9, 
   3.5046013926755753`*^9}, 3.504601428704289*^9, {3.50460160122598*^9, 
   3.504601917352672*^9}, {3.504601986073621*^9, 3.504601989948745*^9}, {
   3.504604250340807*^9, 3.5046042514033546`*^9}, {3.5046047322217693`*^9, 
   3.5046047596136217`*^9}, {3.5046080076966295`*^9, 3.504608091997281*^9}, {
   3.5046081378430843`*^9, 3.5046081632660985`*^9}, {3.5046082354568324`*^9, 
   3.504608241300844*^9}, {3.504608347180588*^9, 3.50460836174374*^9}, {
   3.504608402823705*^9, 3.5046084690766735`*^9}, {3.504608506000202*^9, 
   3.5046085742532597`*^9}, {3.5046086113017945`*^9, 3.504608669773164*^9}, {
   3.504612238276776*^9, 3.5046122407456365`*^9}, {3.50486266894112*^9, 
   3.5048626905556517`*^9}, {3.5048627268787613`*^9, 
   3.5048627277911654`*^9}, {3.504863516492528*^9, 3.504863528246828*^9}, {
   3.5048654702129927`*^9, 3.504865503294081*^9}, {3.504928164526245*^9, 
   3.504928196355999*^9}, {3.504930803378416*^9, 3.5049308434115047`*^9}, {
   3.504937987578057*^9, 3.5049379971874313`*^9}, {3.5050458837765713`*^9, 
   3.505045900949325*^9}, {3.505047994650267*^9, 3.505047994947158*^9}, {
   3.507365231310726*^9, 3.5073653280813055`*^9}, {3.5073675648520727`*^9, 
   3.507367570274225*^9}, {3.5074437655207653`*^9, 3.507443818320344*^9}, {
   3.5074438651196146`*^9, 3.5074438732137794`*^9}, {3.5074439229663267`*^9, 
   3.5074439949543867`*^9}, 3.507444087552878*^9, {3.5075175079939623`*^9, 
   3.5075175238228974`*^9}, {3.507526970290907*^9, 3.5075270062302465`*^9}, 
   3.5128919188333297`*^9, {3.518942499248643*^9, 3.5189425668516054`*^9}, {
   3.5189433259599485`*^9, 3.5189433850832605`*^9}, {3.518943459869721*^9, 
   3.518943476891488*^9}, {3.518943548273595*^9, 3.5189435513187737`*^9}, {
   3.52273502630478*^9, 3.5227350306777077`*^9}, {3.5227385633050222`*^9, 
   3.522738587700807*^9}, {3.522738777510007*^9, 3.5227388167900314`*^9}, {
   3.522739949835223*^9, 3.5227399932697153`*^9}, {3.5227401075019617`*^9, 
   3.522740135396246*^9}, {3.522740195589174*^9, 3.5227402529864264`*^9}, 
   3.5297477550512996`*^9, 3.5304224655752163`*^9, {3.540269762809288*^9, 
   3.540269836841714*^9}, {3.540269873571331*^9, 3.540269887199155*^9}, {
   3.5402737391310368`*^9, 3.540273743724661*^9}, {3.540273788308865*^9, 
   3.5402738014858637`*^9}, {3.540527054182313*^9, 3.540527195387245*^9}, {
   3.540527432077775*^9, 3.5405274430154147`*^9}, {3.5405275007661543`*^9, 
   3.540527530125905*^9}, {3.5405282052751713`*^9, 3.5405282244472923`*^9}, {
   3.540528436481256*^9, 3.540528482122465*^9}, 3.540528737813238*^9, {
   3.540532429672993*^9, 3.540532430751132*^9}, {3.5405331325257397`*^9, 
   3.540533143900885*^9}, 3.5407135559720955`*^9, {3.5459683858046465`*^9, 
   3.545968427473855*^9}, {3.546657371578125*^9, 3.5466574198125*^9}, {
   3.546657517390625*^9, 3.54665754890625*^9}, {3.54665769540625*^9, 
   3.546657705203125*^9}, {3.546657886265625*^9, 3.54665791421875*^9}, {
   3.5551315154679585`*^9, 3.555131593119239*^9}, {3.555131951768159*^9, 
   3.555132161192255*^9}, {3.555132258889127*^9, 3.5551322662011585`*^9}, {
   3.5551325283562546`*^9, 3.555132529481183*^9}, {3.555133300197479*^9, 
   3.555133312931039*^9}, {3.5551333459757986`*^9, 3.555133370880455*^9}, {
   3.555410394082164*^9, 3.55541040252804*^9}, 3.5568479775609856`*^9, {
   3.5575515694366446`*^9, 3.557551602388926*^9}, {3.5575516435753717`*^9, 
   3.5575516450128345`*^9}, {3.5575604618625135`*^9, 3.557560549459553*^9}, {
   3.557560579845899*^9, 3.55756059290656*^9}, {3.557560773490505*^9, 
   3.5575607782867045`*^9}, {3.5575609273594623`*^9, 
   3.5575609479034443`*^9}, {3.557715050568218*^9, 3.5577150661058183`*^9}, {
   3.5577151112522182`*^9, 3.5577151279910183`*^9}, {3.558071445167119*^9, 
   3.5580714459796295`*^9}, {3.560588581588523*^9, 3.560588586307031*^9}, 
   3.5679240153382807`*^9, {3.568704450367279*^9, 3.568704517993713*^9}, {
   3.5687094948853073`*^9, 3.568709497428124*^9}, {3.5687095308903384`*^9, 
   3.568709538269186*^9}, {3.5687096882485476`*^9, 3.568709735782052*^9}, {
   3.568709793798824*^9, 3.5687098026596804`*^9}, {3.568709833984681*^9, 
   3.568709834390284*^9}, {3.568711544948555*^9, 3.568711589564841*^9}, {
   3.568711623401458*^9, 3.568711641497574*^9}, {3.5687117166120553`*^9, 
   3.5687118115698643`*^9}, {3.568711944950719*^9, 3.568711957774001*^9}, {
   3.568712124835472*^9, 3.5687121343203325`*^9}, {3.5687121660353365`*^9, 
   3.568712167891748*^9}, {3.568712230089347*^9, 3.568712282646084*^9}, {
   3.5687124804521565`*^9, 3.568712482838972*^9}, {3.568712642443595*^9, 
   3.568712697981556*^9}, {3.568712780365684*^9, 3.568712833484024*^9}, {
   3.568712955289605*^9, 3.5687129829173822`*^9}, {3.568713023399642*^9, 
   3.5687130575950613`*^9}, {3.568719066560099*^9, 3.5687191111500993`*^9}, 
   3.5687191572027335`*^9, {3.568719199290926*^9, 3.568719201175966*^9}, {
   3.5687193985920267`*^9, 3.568719415149828*^9}, {3.568719654822675*^9, 
   3.56871979335406*^9}, {3.5687198302644296`*^9, 3.5687198454645815`*^9}, 
   3.568720012216249*^9, {3.568720069716824*^9, 3.568720076226889*^9}, {
   3.5687201127572546`*^9, 3.568720114977277*^9}, {3.568720158197709*^9, 
   3.5687201636977634`*^9}, {3.5687202633312683`*^9, 3.568720266391299*^9}, {
   3.568720311081746*^9, 3.568720317281808*^9}, {3.5687203550221853`*^9, 
   3.568720395292588*^9}, {3.5687204703333387`*^9, 3.5687205039136744`*^9}, {
   3.568726734522709*^9, 3.568726743803405*^9}, {3.570355942652505*^9, 
   3.5703559578926573`*^9}, 3.5735272594991302`*^9, {3.5736319056678743`*^9, 
   3.5736319069491878`*^9}, {3.5840776740168934`*^9, 
   3.5840776943266907`*^9}, {3.584077725886375*^9, 3.5840777363762703`*^9}, {
   3.5840784329093046`*^9, 3.584078483498799*^9}, {3.5904686363134975`*^9, 
   3.5904686828885975`*^9}, 3.590468735301897*^9, {3.590469051563097*^9, 
   3.5904690811272974`*^9}, {3.590469255879597*^9, 3.590469323959797*^9}, {
   3.590469982779997*^9, 3.5904700095148973`*^9}, {3.590470116841897*^9, 
   3.5904701347375975`*^9}, {3.6012079235769033`*^9, 3.601208019512633*^9}, {
   3.622356623845909*^9, 3.622356676402832*^9}, {3.6223569149291773`*^9, 
   3.6223569153347764`*^9}, {3.622356978733793*^9, 3.6223569838038435`*^9}, {
   3.622451092813095*^9, 3.622451095215522*^9}, {3.6224511433108797`*^9, 
   3.622451144246874*^9}, {3.6228695044948435`*^9, 3.622869525508285*^9}, {
   3.6228695602140875`*^9, 3.622869623644416*^9}, {3.6241783655335016`*^9, 
   3.6241783679435253`*^9}, {3.6266703040552077`*^9, 3.626670339811783*^9}, {
   3.626673550142815*^9, 3.626673628657615*^9}, {3.626674575917937*^9, 
   3.6266746429693155`*^9}, {3.6266753016178403`*^9, 3.626675305205656*^9}, {
   3.6333424368069925`*^9, 3.6333424880962934`*^9}, {3.633406768539206*^9, 
   3.6334067693035965`*^9}, {3.6334174518536873`*^9, 
   3.6334175947478557`*^9}, {3.633417664400963*^9, 3.6334176792207727`*^9}, {
   3.6334177933801093`*^9, 3.633417880770189*^9}, {3.6334179396906333`*^9, 
   3.633418026316323*^9}, {3.6334185387237573`*^9, 3.6334185542299585`*^9}, 
   3.633418595045842*^9, {3.6334188124126635`*^9, 3.633418827341672*^9}, {
   3.633419327252529*^9, 3.63341943374255*^9}, 3.6334199755894675`*^9, {
   3.633420181846941*^9, 3.6334201822213387`*^9}, {3.6334202647760096`*^9, 
   3.633420295304825*^9}, {3.633420384754078*^9, 3.633420399589488*^9}, {
   3.6334205264938607`*^9, 3.6334205286622334`*^9}, {3.633420881112118*^9, 
   3.6334209739465275`*^9}, {3.633429786645336*^9, 3.6334297875033245`*^9}, {
   3.633429817844936*^9, 3.6334298531628833`*^9}, {3.6334299068261952`*^9, 
   3.6334299287283144`*^9}, 3.633430124209408*^9, {3.633430549925754*^9, 
   3.633430572639063*^9}, {3.633430629734331*^9, 3.6334306800592856`*^9}, {
   3.6334307183879943`*^9, 3.6334307322094173`*^9}, {3.6334315625983944`*^9, 
   3.6334315635187826`*^9}, {3.633431593735595*^9, 3.6334316855248184`*^9}, {
   3.753108987643875*^9, 3.753109118663656*^9}, {3.753109984772729*^9, 
   3.7531100099143467`*^9}, {3.7539056862460012`*^9, 3.753905724570046*^9}, 
   3.753906023242784*^9, {3.754254111011541*^9, 3.754254270458202*^9}, {
   3.7542543319544983`*^9, 3.754254335468642*^9}, 3.754254389614462*^9, {
   3.754255400981167*^9, 3.754255404871467*^9}, {3.7542559022532578`*^9, 
   3.7542559257335367`*^9}, {3.754255976578918*^9, 3.7542560125875273`*^9}, {
   3.754337573543336*^9, 3.7543375832544537`*^9}, {3.754337653921165*^9, 
   3.7543377525343437`*^9}, {3.754337796565566*^9, 3.754337863962468*^9}, {
   3.754337905077857*^9, 3.7543379329999638`*^9}, {3.754337995190054*^9, 
   3.754338016084055*^9}, {3.754338076045555*^9, 3.754338146936942*^9}, {
   3.754338961245401*^9, 3.754338966818149*^9}, {3.75433951183672*^9, 
   3.754339524314909*^9}, 3.75433957046462*^9, {3.754407093351295*^9, 
   3.7544071627870893`*^9}, {3.754407322495116*^9, 3.754407366859867*^9}, {
   3.7544074195747433`*^9, 3.754407628052897*^9}, {3.754611101624404*^9, 
   3.754611107595722*^9}, {3.75461116337582*^9, 3.754611164678741*^9}, 
   3.754611209323226*^9, {3.754611270634948*^9, 3.7546113038270473`*^9}, {
   3.7546113365804157`*^9, 3.754611416696002*^9}, {3.7546114557026*^9, 
   3.7546114573562717`*^9}, {3.754611573893361*^9, 3.7546115759088783`*^9}, {
   3.7546337118493347`*^9, 3.754633720980383*^9}, {3.755455508768887*^9, 
   3.755455566747345*^9}, {3.7554556416854*^9, 3.755455683407784*^9}, {
   3.755455810773382*^9, 3.755455824682637*^9}, {3.7554691935616093`*^9, 
   3.75546922027983*^9}, {3.755469273897708*^9, 3.7554692770545473`*^9}, {
   3.755469313892433*^9, 3.755469366198348*^9}, {3.755489340124115*^9, 
   3.755489342956345*^9}, {3.756217595339079*^9, 3.756217629256115*^9}, {
   3.7562177825376797`*^9, 3.756217784239229*^9}, {3.756678922694578*^9, 
   3.756678930881052*^9}, 3.756678964536076*^9, {3.757255014406192*^9, 
   3.757255014522992*^9}, {3.7616899531643953`*^9, 3.761689955564457*^9}, {
   3.765744091905328*^9, 3.765744101744547*^9}, 3.7657441373918247`*^9, {
   3.808666535044924*^9, 3.808666544078413*^9}, 3.808666584333906*^9, {
   3.8407324309622707`*^9, 3.840732453003777*^9}, {3.8407325325892067`*^9, 
   3.840732565763809*^9}, {3.840732633298698*^9, 3.840732889567049*^9}, {
   3.8407329236739683`*^9, 3.840733040054324*^9}, {3.840733138314497*^9, 
   3.840733138827791*^9}, {3.840733224382391*^9, 3.840733240470564*^9}, {
   3.840733343691984*^9, 3.840733353419997*^9}, {3.840733475242442*^9, 
   3.840733477106255*^9}, {3.840733568507073*^9, 3.840733636979026*^9}, 
   3.840733677574637*^9, {3.8407338896381693`*^9, 3.840733930434145*^9}, {
   3.840734009282772*^9, 3.840734023583829*^9}, {3.840734089388343*^9, 
   3.8407342075751657`*^9}, {3.840734241904503*^9, 3.840734283293584*^9}, {
   3.840734355157968*^9, 3.840734524338269*^9}, {3.8407346163517857`*^9, 
   3.8407348687808313`*^9}, {3.840734906662723*^9, 3.840734913516233*^9}, {
   3.84073495643188*^9, 3.840735174141314*^9}, {3.8407352135127697`*^9, 
   3.840735218077507*^9}, {3.8407352762421103`*^9, 3.840735277003807*^9}, {
   3.840735402992679*^9, 3.840735403075122*^9}, {3.8407354443393297`*^9, 
   3.840735446069107*^9}, {3.840976960800468*^9, 3.840976963158732*^9}, {
   3.8409803400158863`*^9, 3.840980345618884*^9}, {3.840982524348956*^9, 
   3.840982524843244*^9}, 3.8426253215583057`*^9, {3.8426253643521957`*^9, 
   3.842625364549284*^9}, {3.842625464242984*^9, 3.842625526525691*^9}, {
   3.8426255602096977`*^9, 3.8426255610776873`*^9}, {3.842629223770975*^9, 
   3.842629227564652*^9}, {3.842629269747632*^9, 3.8426292758146667`*^9}, {
   3.8426293237566833`*^9, 3.8426293826551533`*^9}, {3.842629425023705*^9, 
   3.842629427395047*^9}, {3.842630652857326*^9, 3.842630665946259*^9}, {
   3.842630703926111*^9, 3.8426307100379677`*^9}, {3.8426309611859837`*^9, 
   3.842631192838523*^9}, {3.842632008667272*^9, 3.8426320150569677`*^9}, 
   3.842632215961697*^9, {3.842633305691813*^9, 3.8426333164625463`*^9}, {
   3.8426334336316147`*^9, 3.842633434511866*^9}, {3.842633491618269*^9, 
   3.842633533259344*^9}, {3.842633586346715*^9, 3.842633620963914*^9}, {
   3.842633653972179*^9, 3.84263370369636*^9}, {3.842633795938765*^9, 
   3.8426338270487843`*^9}, {3.842646530743034*^9, 3.842646691138131*^9}, {
   3.842647123818059*^9, 3.842647134928646*^9}, {3.8430806485052967`*^9, 
   3.8430807388361187`*^9}, {3.843080810230104*^9, 3.8430808122475758`*^9}, {
   3.873482090181377*^9, 3.873482092846588*^9}, {3.873482371769959*^9, 
   3.873482407916328*^9}, {3.873482475800231*^9, 3.8734824779768763`*^9}, {
   3.873482522316895*^9, 3.873482554145409*^9}, {3.873482644856399*^9, 
   3.873482675817276*^9}, {3.8734830289055347`*^9, 3.873483059186885*^9}, {
   3.873483127164501*^9, 3.873483209757864*^9}, {3.8734833735448637`*^9, 
   3.873483422672338*^9}, {3.8819547233555727`*^9, 3.881954929185521*^9}, {
   3.881954963624113*^9, 3.8819549826324778`*^9}, {3.882297266031474*^9, 
   3.882297301453813*^9}, {3.889715113751824*^9, 3.889715143523896*^9}, {
   3.889715177281107*^9, 3.889715208448185*^9}, {3.889715342616334*^9, 
   3.8897153470728397`*^9}, {3.889715381358737*^9, 3.8897154291645737`*^9}, {
   3.8897154713534727`*^9, 3.8897155611571817`*^9}, {3.889717527370063*^9, 
   3.889717527643446*^9}, 3.889718428459813*^9, {3.8897229141064377`*^9, 
   3.889723087325426*^9}, {3.8897234008514223`*^9, 3.889723401028595*^9}, {
   3.889723480489196*^9, 3.889723481834743*^9}, {3.8897236798844147`*^9, 
   3.889723708324375*^9}, {3.8897238106568413`*^9, 3.889723813156817*^9}},
 CellLabel->
  "In[912]:=",ExpressionUUID->"3db46be8-5f16-46f4-b5e8-ab3e2684df19"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SolveDLG", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PrecGoal", "\[Rule]", "8"}], ",", 
     RowBox[{"AccGoal", "\[Rule]", "10"}], ",", 
     RowBox[{"DiffOrder", "\[Rule]", "4"}], ",", 
     RowBox[{"MaxStepFrac", "->", 
      FractionBox["1", "100"]}], ",", 
     RowBox[{"MAXBDFORD", "\[Rule]", "5"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SolveDLG", "[", 
   RowBox[{"eqn_", ",", "tmax_", ",", "grd_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "i", ",", "\[IndentingNewLine]", "reqsol", ",", "\[IndentingNewLine]", 
      RowBox[{"numtrap", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"pTraps", "/.", "InputParam"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"acc", "=", 
       RowBox[{"OptionValue", "[", "AccGoal", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"prec", "=", 
       RowBox[{"OptionValue", "[", "PrecGoal", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"dord", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "DiffOrder", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"xmax", "=", 
       RowBox[{"Max", "[", "grd", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"maxtstepfrac", "=", 
       RowBox[{"OptionValue", "[", "MaxStepFrac", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"maxbdford", "=", 
       RowBox[{"OptionValue", "[", "MAXBDFORD", "]"}]}], ",", 
      "\[IndentingNewLine]", "dgl", ",", "\[IndentingNewLine]", "res", ",", 
      "\[IndentingNewLine]", "jacband"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Clear", "[", 
      RowBox[{"x", ",", "t"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"dgl", "=", 
      RowBox[{"DGL", "/.", "eqn"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"jacband", " ", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Floor", "[", 
          RowBox[{
           RowBox[{"Ceiling", "[", 
            RowBox[{"dord", "*", "0.5"}], "]"}], "*", "2.0"}], "]"}], "+", 
         "1"}], ")"}], " ", "*", 
       RowBox[{"(", 
        RowBox[{"numtrap", " ", "+", " ", "1"}], ")"}]}]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Jac-Bandwidth = \>\"", ",", "jacband", " ", ",", 
         "\"\< Max. BDF order: \>\"", ",", "maxbdford"}], "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"reqsol", "=", 
      RowBox[{"VARS", "/.", "eqn"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<solving from x = 0 to \>\"", ",", " ", "xmax", ",", " ", 
         "\"\< and t = 0 to \>\"", ",", "tmax", ",", " ", 
         "\"\< with acc = \>\"", ",", " ", "acc", ",", " ", 
         "\"\< prec = \>\"", ",", " ", "prec", ",", " ", 
         "\"\< on a grid with \>\"", ",", 
         RowBox[{"Length", "[", "grd", "]"}], ",", " ", "\"\< steps\>\""}], 
        "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ShowStatus", "[", "\"\<Waiting for NDSolve to start\>\"", "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"Timing", "[", 
       RowBox[{"NDSolve", "[", 
        RowBox[{"dgl", ",", "reqsol", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", "xmax"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "tmax"}], "}"}], ",", 
         RowBox[{"MaxSteps", "\[Rule]", "1000000"}], ",", 
         RowBox[{"StepMonitor", "\[RuleDelayed]", 
          RowBox[{"ShowStatus", "[", 
           RowBox[{"\"\<Step: \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"i", "++"}], "]"}], "<>", "\"\<@ t = \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"InputForm", "[", "t", "]"}], "]"}]}], "]"}]}], ",", 
         "  ", 
         RowBox[{"MaxStepFraction", "\[Rule]", "maxtstepfrac"}], ",", "  ", 
         RowBox[{"AccuracyGoal", "\[Rule]", "acc"}], ",", 
         RowBox[{"PrecisionGoal", "\[Rule]", "prec"}], ",", 
         "\[IndentingNewLine]", " ", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"$VersionNumber", "<", "8"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Using Version 7+ code\>\"", "]"}], 
             ";"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"Method", "\[Rule]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"\"\<MethodOfLines\>\"", ",", "\[IndentingNewLine]", 
              RowBox[{
              "\"\<DifferentiateBoundaryConditions\>\"", "\[Rule]", "False"}],
               ",", "\[IndentingNewLine]", 
              RowBox[{"Method", "\[Rule]", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{"IDA", ",", "\[IndentingNewLine]", 
                 RowBox[{
                 "\"\<MaxDifferenceOrder\>\"", "\[Rule]", "maxbdford"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                 "\"\<EquationSimplification\>\"", "\[Rule]", 
                  "\"\<Residual\>\""}], ",", "\[IndentingNewLine]", " ", 
                 RowBox[{"\"\<ImplicitSolver\>\"", "\[Rule]", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"\"\<Newton\>\"", ",", "\[IndentingNewLine]", " ", 
                    RowBox[{
                    "\"\<LinearSolveMethod\>\"", "\[Rule]", "Automatic"}]}], 
                   RowBox[{"(*", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Band\>\"", ",", 
                    RowBox[{"\"\<BandWidth\>\"", "\[Rule]", "12"}]}], "}"}], 
                    "*)"}], "}"}]}]}], "\[IndentingNewLine]", "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<SpatialDiscretization\>\"", "\[Rule]", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                "\"\<TensorProductGrid\>\"", ",", "\[IndentingNewLine]", " ", 
                 RowBox[{"\"\<DifferenceOrder\>\"", "\[Rule]", "dord"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"\"\<Coordinates\>\"", "\[Rule]", 
                  RowBox[{"{", "grd", "}"}]}]}], "}"}]}]}], 
             "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Using Version <7 code\>\"", "]"}], 
             ";"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"Method", "\[Rule]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"\"\<MethodOfLines\>\"", ",", "\[IndentingNewLine]", 
              RowBox[{
              "\"\<DifferentiateBoundaryConditions\>\"", "\[Rule]", "False"}],
               ",", "\[IndentingNewLine]", 
              RowBox[{"Method", "\[Rule]", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{"IDA", ",", "\[IndentingNewLine]", 
                 RowBox[{
                 "\"\<MaxDifferenceOrder\>\"", "\[Rule]", "maxbdford"}], ",", 
                 "\[IndentingNewLine]", " ", 
                 RowBox[{"\"\<ImplicitSolver\>\"", "\[Rule]", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"\"\<Newton\>\"", ",", "\[IndentingNewLine]", " ", 
                    RowBox[{
                    "\"\<LinearSolveMethod\>\"", "\[Rule]", "Automatic"}]}], 
                   RowBox[{"(*", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Band\>\"", ",", 
                    RowBox[{"\"\<BandWidth\>\"", "\[Rule]", "12"}]}], "}"}], 
                    "*)"}], "}"}]}]}], "\[IndentingNewLine]", "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<SpatialDiscretization\>\"", "\[Rule]", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                "\"\<TensorProductGrid\>\"", ",", "\[IndentingNewLine]", " ", 
                 RowBox[{"\"\<DifferenceOrder\>\"", "\[Rule]", "dord"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"\"\<Coordinates\>\"", "\[Rule]", 
                  RowBox[{"{", "grd", "}"}]}]}], "}"}]}]}], 
             "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"NormFunction", "\[Rule]", "\[Infinity]"}]}], "]"}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Time for solution: \>\"", ",", 
         RowBox[{"res", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\"\< sec\>\""}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"DateString", "[", 
         RowBox[{"{", 
          RowBox[{
          "\"\<DayName\>\"", ",", " ", "\"\<  \>\"", ",", "\"\<Month\>\"", 
           ",", "\"\</\>\"", ",", "\"\<YearShort\>\"", ",", "\"\<-> \>\"", 
           ",", "\"\<Hour\>\"", ",", "\"\<:\>\"", ",", "\"\<Minute\>\"", ",", 
           "\"\<:\>\"", ",", "\"\<Second\>\""}], "}"}], "]"}], "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"First", "[", 
      RowBox[{"res", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SolveDLGSKLManualMoL", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PrecGoal", "\[Rule]", "8"}], ",", 
     RowBox[{"AccGoal", "\[Rule]", "10"}], ",", 
     RowBox[{"DiffOrder", "\[Rule]", "4"}], ",", 
     RowBox[{"MaxStepFrac", "\[Rule]", 
      RowBox[{"1", "/", "100"}]}], ",", 
     RowBox[{"MAXBDFORD", "\[Rule]", "5"}], ",", 
     RowBox[{"InitStep", "\[Rule]", "1*^-12"}], ",", 
     RowBox[{"TAU", "\[Rule]", "2"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SolveDLGSKLManualMoL", "[", 
   RowBox[{"eqn_", ",", "tmax_", ",", "grd_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "i", ",", "\[IndentingNewLine]", "reqsol", ",", "\[IndentingNewLine]", 
      RowBox[{"numtrap", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"pTraps", "/.", "InputParam"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"prec", "=", 
       RowBox[{"OptionValue", "[", "PrecGoal", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"acc", "=", 
       RowBox[{"OptionValue", "[", "AccGoal", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"dord", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "DiffOrder", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"tauupdate", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "TAU", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"xmax", "=", 
       RowBox[{"Max", "[", "grd", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"maxtstepfrac", "=", 
       RowBox[{"OptionValue", "[", "MaxStepFrac", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"maxbdford", "=", 
       RowBox[{"OptionValue", "[", "MAXBDFORD", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"initstep", "=", 
       RowBox[{"OptionValue", "[", "InitStep", "]"}]}], ",", 
      "\[IndentingNewLine]", "dgl", ",", "\[IndentingNewLine]", "state", ",", 
      "res", ",", "\[IndentingNewLine]", "jacband"}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Clear", "[", 
      RowBox[{"x", ",", "t"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"dgl", "=", 
      RowBox[{"DGL", "/.", "eqn"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"jacband", " ", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Floor", "[", 
          RowBox[{
           RowBox[{"Ceiling", "[", 
            RowBox[{"dord", "*", "0.5"}], "]"}], "*", "2.0"}], "]"}], "+", 
         "1"}], ")"}], " ", "*", 
       RowBox[{"(", 
        RowBox[{"numtrap", " ", "+", " ", "1"}], ")"}]}]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Jac-Bandwidth = \>\"", ",", "jacband", " ", ",", 
         "\"\< Max. BDF order: \>\"", ",", "maxbdford"}], "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"reqsol", "=", 
      RowBox[{"VARS", "/.", "eqn"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<solving from x = 0 to \>\"", ",", " ", "xmax", ",", " ", 
         "\"\< and t = 0 to \>\"", ",", "tmax", ",", " ", 
         "\"\< with acc = \>\"", ",", " ", "acc", ",", " ", 
         "\"\< prec = \>\"", ",", " ", "prec", ",", " ", 
         "\"\< on a grid with \>\"", ",", 
         RowBox[{"Length", "[", "grd", "]"}], ",", " ", "\"\< steps\>\""}], 
        "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ShowStatus", "[", "\"\<Waiting for NDSolve to start\>\"", "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"Timing", "[", 
       RowBox[{"NDSolve`ProcessEquations", "[", 
        RowBox[{"dgl", ",", "reqsol", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "tmax"}], "}"}], ",", 
         RowBox[{"MaxSteps", "\[Rule]", "1000000"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"StepMonitor", "\[RuleDelayed]", 
          RowBox[{"ShowStatus", "[", 
           RowBox[{"\"\<Step: \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"i", "++"}], "]"}], "<>", "\"\<@ t = \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"InputForm", "[", "t", "]"}], "]"}]}], "]"}]}], ",", 
         "  ", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"EvaluationMonitor", "\[RuleDelayed]", " ", 
            RowBox[{"ShowStatus", "[", 
             RowBox[{"\"\<Step: \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"i", "++"}], "]"}], "<>", "\"\<@ t = \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"InputForm", "[", "t", "]"}], "]"}]}], "]"}]}], ","}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"MaxStepFraction", "\[Rule]", "maxtstepfrac"}], ",", "  ", 
         RowBox[{"AccuracyGoal", "\[Rule]", "acc"}], ",", 
         RowBox[{"PrecisionGoal", "\[Rule]", "prec"}], ",", 
         "\[IndentingNewLine]", " ", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"$VersionNumber", ">", "7"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Using Version 7+ code\>\"", "]"}], 
             ";"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"Method", "\[Rule]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"\"\<MethodOfLines\>\"", ",", "\[IndentingNewLine]", 
              RowBox[{
              "\"\<DifferentiateBoundaryConditions\>\"", "\[Rule]", "False"}],
               ",", "\[IndentingNewLine]", 
              RowBox[{"Method", "\[Rule]", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{"IDA", ",", "\[IndentingNewLine]", 
                 RowBox[{
                 "\"\<MaxDifferenceOrder\>\"", "\[Rule]", "maxbdford"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"\"\<EquationSimplification\>\"", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Residual\>\"", ",", " ", 
                    RowBox[{"\"\<SimplifySystem\>\"", "\[Rule]", "False"}]}], 
                   "}"}]}], ",", "\[IndentingNewLine]", " ", 
                 RowBox[{"\"\<ImplicitSolver\>\"", "\[Rule]", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"\"\<Newton\>\"", ",", "\[IndentingNewLine]", " ", 
                    RowBox[{
                    "\"\<LinearSolveMethod\>\"", "\[Rule]", "Automatic"}]}], 
                   RowBox[{"(*", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Band\>\"", ",", 
                    RowBox[{"\"\<BandWidth\>\"", "\[Rule]", "12"}]}], "}"}], 
                    "*)"}], "}"}]}]}], "\[IndentingNewLine]", "}"}]}]}], 
             RowBox[{"(*", 
              RowBox[{",", "\[IndentingNewLine]", 
               RowBox[{"\"\<SpatialDiscretization\>\"", "\[Rule]", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                 "\"\<TensorProductGrid\>\"", ",", "\[IndentingNewLine]", " ", 
                  RowBox[{"\"\<DifferenceOrder\>\"", "\[Rule]", "dord"}], ",",
                   "\[IndentingNewLine]", 
                  RowBox[{"\"\<Coordinates\>\"", "\[Rule]", 
                   RowBox[{"{", "grd", "}"}]}]}], "}"}]}]}], "*)"}], 
             "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Using Version <7 code\>\"", "]"}], 
             ";"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"Method", "\[Rule]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"\"\<MethodOfLines\>\"", ",", "\[IndentingNewLine]", 
              RowBox[{
              "\"\<DifferentiateBoundaryConditions\>\"", "\[Rule]", "False"}],
               ",", "\[IndentingNewLine]", 
              RowBox[{"Method", "\[Rule]", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{"IDA", ",", "\[IndentingNewLine]", 
                 RowBox[{
                 "\"\<MaxDifferenceOrder\>\"", "\[Rule]", "maxbdford"}], ",", 
                 "\[IndentingNewLine]", " ", 
                 RowBox[{"\"\<ImplicitSolver\>\"", "\[Rule]", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"\"\<Newton\>\"", ",", "\[IndentingNewLine]", " ", 
                    RowBox[{
                    "\"\<LinearSolveMethod\>\"", "\[Rule]", "Automatic"}]}], 
                   RowBox[{"(*", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Band\>\"", ",", 
                    RowBox[{"\"\<BandWidth\>\"", "\[Rule]", "12"}]}], "}"}], 
                    "*)"}], "}"}]}]}], "\[IndentingNewLine]", "}"}]}]}], 
             RowBox[{"(*", 
              RowBox[{",", "\[IndentingNewLine]", 
               RowBox[{"\"\<SpatialDiscretization\>\"", "\[Rule]", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                 "\"\<TensorProductGrid\>\"", ",", "\[IndentingNewLine]", " ", 
                  RowBox[{"\"\<DifferenceOrder\>\"", "\[Rule]", "dord"}], ",",
                   "\[IndentingNewLine]", 
                  RowBox[{"\"\<Coordinates\>\"", "\[Rule]", 
                   RowBox[{"{", "grd", "}"}]}]}], "}"}]}]}], "*)"}], 
             "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"NormFunction", "\[Rule]", "\[Infinity]"}]}], "]"}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Time for process equations: \>\"", ",", 
         RowBox[{"state", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\"\< sec\>\""}], "]"}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"state", " ", "=", " ", 
      RowBox[{"Part", "[", 
       RowBox[{"state", ",", "2", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"Timing", "[", "\[IndentingNewLine]", 
       RowBox[{"NDSolve`Iterate", "[", 
        RowBox[{"state", ",", " ", "initstep"}], "]"}], "\[IndentingNewLine]",
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Time for initial step: \>\"", ",", 
         RowBox[{"res", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\"\< sec\>\""}], "]"}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"res", "=", " ", 
      RowBox[{"Timing", "[", "\[IndentingNewLine]", 
       RowBox[{"NDSolve`Iterate", "[", 
        RowBox[{"state", ",", " ", "tmax"}], "]"}], "\[IndentingNewLine]", 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Time for iteration to tmax: \>\"", ",", 
         RowBox[{"res", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\"\< sec\>\""}], "]"}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"res", " ", "=", " ", 
      RowBox[{"Timing", "[", 
       RowBox[{"NDSolve`ProcessSolutions", "[", "state", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Time for ProcessSolutions: \>\"", ",", 
         RowBox[{"res", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\"\< sec\>\""}], "]"}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<res: \>\"", ",", "res"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"DateString", "[", 
         RowBox[{"{", 
          RowBox[{
          "\"\<DayName\>\"", ",", " ", "\"\<  \>\"", ",", "\"\<Month\>\"", 
           ",", "\"\</\>\"", ",", "\"\<YearShort\>\"", ",", "\"\<-> \>\"", 
           ",", "\"\<Hour\>\"", ",", "\"\<:\>\"", ",", "\"\<Minute\>\"", ",", 
           "\"\<:\>\"", ",", "\"\<Second\>\""}], "}"}], "]"}], "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"res", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SolveDLGEx", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PrecGoal", "\[Rule]", "8"}], ",", 
     RowBox[{"AccGoal", "\[Rule]", "10"}], ",", 
     RowBox[{"DiffOrder", "\[Rule]", "4"}], ",", 
     RowBox[{"MaxStepFrac", "->", 
      FractionBox["1", "100"]}], ",", 
     RowBox[{"MAXBDFORD", "\[Rule]", "5"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SolveDLGEx", "[", 
   RowBox[{"eqn_", ",", "tmax_", ",", "grd_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "i", ",", "\[IndentingNewLine]", "reqsol", ",", "\[IndentingNewLine]", 
      RowBox[{"numtrap", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"pTraps", "/.", "InputParam"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"acc", "=", 
       RowBox[{"OptionValue", "[", "PrecGoal", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"prec", "=", 
       RowBox[{"OptionValue", "[", "AccGoal", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"dord", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "DiffOrder", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"xmax", "=", 
       RowBox[{"Max", "[", "grd", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"maxtstepfrac", "=", 
       RowBox[{"OptionValue", "[", "MaxStepFrac", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"maxbdford", "=", 
       RowBox[{"OptionValue", "[", "MAXBDFORD", "]"}]}], ",", 
      "\[IndentingNewLine]", "dgl", ",", "\[IndentingNewLine]", "res", ",", 
      "\[IndentingNewLine]", "jacband", ",", "\[IndentingNewLine]", "state"}],
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"dgl", "=", 
      RowBox[{"DGL", "/.", "eqn"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"jacband", " ", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Floor", "[", 
          RowBox[{
           RowBox[{"Ceiling", "[", 
            RowBox[{"dord", "*", "0.5"}], "]"}], "*", "2.0"}], "]"}], "+", 
         "1"}], ")"}], " ", "*", 
       RowBox[{"(", 
        RowBox[{"numtrap", " ", "+", " ", "1"}], ")"}]}]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<Jac-Bandwidth = \>\"", ",", "jacband", " ", ",", 
       "\"\< Max. BDF order: \>\"", ",", "maxbdford"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"reqsol", "=", 
      RowBox[{"VARS", "/.", "eqn"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<solving from x = 0 to \>\"", ",", " ", "xmax", ",", " ", 
       "\"\< and t = 0 to \>\"", ",", "tmax", ",", " ", 
       "\"\< with acc = \>\"", ",", " ", "acc", ",", " ", 
       "\"\< on a grid with \>\"", ",", 
       RowBox[{"Length", "[", "grd", "]"}], ",", " ", "\"\< steps\>\""}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"NDSolve`ProcessEquations", "[", 
       RowBox[{"dgl", ",", "reqsol", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", "xmax"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "tmax"}], "}"}], ",", 
        RowBox[{"StepMonitor", "\[RuleDelayed]", 
         RowBox[{"ShowStatus", "[", 
          RowBox[{"\"\<Step: \>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"i", "++"}], "]"}], "<>", "\"\<@ t = \>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"InputForm", "[", "t", "]"}], "]"}]}], "]"}]}], ",", "  ", 
        RowBox[{"MaxStepFraction", "\[Rule]", "maxtstepfrac"}], ",", "  ", 
        RowBox[{"AccuracyGoal", "\[Rule]", "acc"}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", "prec"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"$VersionNumber", ">", "7"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<Using Version 7+ code\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Method", "\[Rule]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"\"\<MethodOfLines\>\"", ",", "\[IndentingNewLine]", 
              RowBox[{
              "\"\<DifferentiateBoundaryConditions\>\"", "\[Rule]", "False"}],
               ",", "\[IndentingNewLine]", 
              RowBox[{"Method", "\[Rule]", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{"IDA", ",", "\[IndentingNewLine]", 
                 RowBox[{
                 "\"\<MaxDifferenceOrder\>\"", "\[Rule]", "maxbdford"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"\"\<EquationSimplification\>\"", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Residual\>\"", ",", 
                    RowBox[{"\"\<SimplifySystem\>\"", "\[Rule]", "False"}]}], 
                   "}"}]}], ",", "\[IndentingNewLine]", " ", 
                 RowBox[{"\"\<ImplicitSolver\>\"", "\[Rule]", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"\"\<Newton\>\"", ",", "\[IndentingNewLine]", " ", 
                    RowBox[{
                    "\"\<LinearSolveMethod\>\"", "\[Rule]", "Automatic"}]}], 
                   RowBox[{"(*", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Band\>\"", ",", 
                    RowBox[{"\"\<BandWidth\>\"", "\[Rule]", "12"}]}], "}"}], 
                    "*)"}], "}"}]}]}], "\[IndentingNewLine]", "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<SpatialDiscretization\>\"", "\[Rule]", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                "\"\<TensorProductGrid\>\"", ",", "\[IndentingNewLine]", " ", 
                 RowBox[{"\"\<DifferenceOrder\>\"", "\[Rule]", "dord"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"\"\<Coordinates\>\"", "\[Rule]", 
                  RowBox[{"{", "grd", "}"}]}]}], "}"}]}]}], 
             "\[IndentingNewLine]", "}"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<Using Version <7 code\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Method", "\[Rule]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"\"\<MethodOfLines\>\"", ",", "\[IndentingNewLine]", 
              RowBox[{
              "\"\<DifferentiateBoundaryConditions\>\"", "\[Rule]", "False"}],
               ",", "\[IndentingNewLine]", 
              RowBox[{"Method", "\[Rule]", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{"IDA", ",", "\[IndentingNewLine]", 
                 RowBox[{
                 "\"\<MaxDifferenceOrder\>\"", "\[Rule]", "maxbdford"}], ",", 
                 "\[IndentingNewLine]", " ", 
                 RowBox[{"\"\<ImplicitSolver\>\"", "\[Rule]", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"\"\<Newton\>\"", ",", "\[IndentingNewLine]", " ", 
                    RowBox[{
                    "\"\<LinearSolveMethod\>\"", "\[Rule]", "Automatic"}]}], 
                   RowBox[{"(*", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Band\>\"", ",", 
                    RowBox[{"\"\<BandWidth\>\"", "\[Rule]", "12"}]}], "}"}], 
                    "*)"}], "}"}]}]}], "\[IndentingNewLine]", "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<SpatialDiscretization\>\"", "\[Rule]", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                "\"\<TensorProductGrid\>\"", ",", "\[IndentingNewLine]", " ", 
                 RowBox[{"\"\<DifferenceOrder\>\"", "\[Rule]", "dord"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"\"\<Coordinates\>\"", "\[Rule]", 
                  RowBox[{"{", "grd", "}"}]}]}], "}"}]}]}], 
             "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", "]"}],
         ",", 
        RowBox[{"NormFunction", "\[Rule]", "\[Infinity]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<Equation setup complete, advancing solution to \>\"", ",", "tmax", 
       ",", " ", "\"\< seconds\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"state", " ", "=", " ", 
      RowBox[{"First", "[", "res", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
     "ShowStatus", "[", "\"\<Waiting for NDSolve`Iterate to start\>\"", "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"$VersionNumber", ">", "7"}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
          RowBox[{"state", "[", "\"\<NumericalFunction\>\"", "]"}], "[", 
          "\"\<FunctionExpression\>\"", "]"}], "]"}], ";", 
        RowBox[{"Print", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"Rule", "[", "##", "]"}], "]"}], "&"}], " ", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"state", "[", "\"\<Variables\>\"", "]"}], ",", 
              RowBox[{"state", "[", "\"\<WorkingVariables\>\"", "]"}]}], 
             "}"}]}], "]"}], "]"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NDSolve`Iterate", "[", 
      RowBox[{"state", ",", " ", "tmax"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "state", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SolveDLGSKL", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PrecGoal", "\[Rule]", "8"}], ",", 
     RowBox[{"AccGoal", "\[Rule]", "10"}], ",", 
     RowBox[{"DiffOrder", "\[Rule]", "4"}], ",", 
     RowBox[{"MaxStepFrac", "\[Rule]", 
      RowBox[{"1", "/", "100"}]}], ",", 
     RowBox[{"MAXBDFORD", "\[Rule]", "5"}], ",", 
     RowBox[{"InitStep", "\[Rule]", "1*^-12"}], ",", 
     RowBox[{"TAU", "\[Rule]", "2"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SolveDLGSKL", "[", 
   RowBox[{"eqn_", ",", "tmax_", ",", "grd_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "i", ",", "\[IndentingNewLine]", "reqsol", ",", "\[IndentingNewLine]", 
      RowBox[{"numtrap", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"pTraps", "/.", "InputParam"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"prec", "=", 
       RowBox[{"OptionValue", "[", "PrecGoal", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"acc", "=", 
       RowBox[{"OptionValue", "[", "AccGoal", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"dord", "=", 
       RowBox[{"OptionValue", "[", "DiffOrder", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"tauupdate", "=", 
       RowBox[{"OptionValue", "[", "TAU", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"xmax", "=", 
       RowBox[{"Max", "[", "grd", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"maxtstepfrac", "=", 
       RowBox[{"OptionValue", "[", "MaxStepFrac", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"maxbdford", "=", 
       RowBox[{"OptionValue", "[", "MAXBDFORD", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"initstep", "=", 
       RowBox[{"OptionValue", "[", "InitStep", "]"}]}], ",", 
      "\[IndentingNewLine]", "dgl", ",", "\[IndentingNewLine]", "state", ",", 
      "res", ",", "\[IndentingNewLine]", "jacband"}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Clear", "[", 
      RowBox[{"x", ",", "t"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"dgl", "=", 
      RowBox[{"DGL", "/.", "eqn"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"jacband", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Floor", "[", 
          RowBox[{
           RowBox[{"Ceiling", "[", 
            RowBox[{"dord", "*", "0.5"}], "]"}], "*", "2.0"}], "]"}], "+", 
         "1"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{"numtrap", "+", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Jac-Bandwidth = \>\"", ",", "jacband", ",", 
         "\"\< Max. BDF order: \>\"", ",", "maxbdford"}], "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"reqsol", "=", 
      RowBox[{"VARS", "/.", "eqn"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<solving from x = 0 to \>\"", ",", "xmax", ",", 
         "\"\< and t = 0 to \>\"", ",", "tmax", ",", "\"\< with acc = \>\"", 
         ",", "acc", ",", "\"\< prec = \>\"", ",", "prec", ",", 
         "\"\< on a grid with \>\"", ",", 
         RowBox[{"Length", "[", "grd", "]"}], ",", "\"\< steps\>\""}], "]"}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ShowStatus", "[", "\"\<Waiting for NDSolve to start\>\"", "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"Timing", "[", 
       RowBox[{"NDSolve`ProcessEquations", "[", 
        RowBox[{"dgl", ",", "reqsol", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", "xmax"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "tmax"}], "}"}], ",", 
         RowBox[{"MaxSteps", "\[Rule]", "1000000"}], ",", 
         RowBox[{"StepMonitor", "\[RuleDelayed]", 
          RowBox[{"ShowStatus", "[", 
           RowBox[{"\"\<Step: \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"i", "++"}], "]"}], "<>", "\"\<@ t = \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"InputForm", "[", "t", "]"}], "]"}]}], "]"}]}], ",", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"EvaluationMonitor", "\[RuleDelayed]", 
            RowBox[{"ShowStatus", "[", 
             RowBox[{"\"\<Step: \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"i", "++"}], "]"}], "<>", "\"\<@ t = \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"InputForm", "[", "t", "]"}], "]"}]}], "]"}]}], ","}], 
          "*)"}], 
         RowBox[{"MaxStepFraction", "\[Rule]", "maxtstepfrac"}], ",", 
         RowBox[{"AccuracyGoal", "\[Rule]", "acc"}], ",", 
         RowBox[{"PrecisionGoal", "\[Rule]", "prec"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"$VersionNumber", ">", "7"}], ",", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Using Version 7+ code\>\"", "]"}], 
             ";"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"Method", "\[Rule]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"\"\<MethodOfLines\>\"", ",", "\[IndentingNewLine]", 
              RowBox[{
              "\"\<DifferentiateBoundaryConditions\>\"", "\[Rule]", "False"}],
               ",", "\[IndentingNewLine]", 
              RowBox[{"Method", "\[Rule]", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{"IDA", ",", "\[IndentingNewLine]", 
                 RowBox[{
                 "\"\<MaxDifferenceOrder\>\"", "\[Rule]", "maxbdford"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"\"\<EquationSimplification\>\"", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Residual\>\"", ",", 
                    RowBox[{"\"\<SimplifySystem\>\"", "\[Rule]", "False"}]}], 
                   "}"}]}], ",", 
                 RowBox[{"\"\<ImplicitSolver\>\"", "\[Rule]", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"\"\<Newton\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    "\"\<LinearSolveMethod\>\"", "\[Rule]", "Automatic"}]}], 
                   RowBox[{"(*", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Band\>\"", ",", 
                    RowBox[{"\"\<BandWidth\>\"", "\[Rule]", "12"}]}], "}"}], 
                    "*)"}], "}"}]}]}], "\[IndentingNewLine]", "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<SpatialDiscretization\>\"", "\[Rule]", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                "\"\<TensorProductGrid\>\"", ",", "\[IndentingNewLine]", 
                 RowBox[{"\"\<DifferenceOrder\>\"", "\[Rule]", "dord"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"\"\<Coordinates\>\"", "\[Rule]", 
                  RowBox[{"{", "grd", "}"}]}]}], "}"}]}]}], 
             "\[IndentingNewLine]", "}"}]}], ",", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Using Version <7 code\>\"", "]"}], 
             ";"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"Method", "\[Rule]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"\"\<MethodOfLines\>\"", ",", "\[IndentingNewLine]", 
              RowBox[{
              "\"\<DifferentiateBoundaryConditions\>\"", "\[Rule]", "False"}],
               ",", "\[IndentingNewLine]", 
              RowBox[{"Method", "\[Rule]", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{"IDA", ",", "\[IndentingNewLine]", 
                 RowBox[{
                 "\"\<MaxDifferenceOrder\>\"", "\[Rule]", "maxbdford"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"\"\<ImplicitSolver\>\"", "\[Rule]", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"\"\<Newton\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    "\"\<LinearSolveMethod\>\"", "\[Rule]", "Automatic"}]}], 
                   RowBox[{"(*", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Band\>\"", ",", 
                    RowBox[{"\"\<BandWidth\>\"", "\[Rule]", "12"}]}], "}"}], 
                    "*)"}], "}"}]}]}], "\[IndentingNewLine]", "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<SpatialDiscretization\>\"", "\[Rule]", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                "\"\<TensorProductGrid\>\"", ",", "\[IndentingNewLine]", 
                 RowBox[{"\"\<DifferenceOrder\>\"", "\[Rule]", "dord"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"\"\<Coordinates\>\"", "\[Rule]", 
                  RowBox[{"{", "grd", "}"}]}]}], "}"}]}]}], 
             "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"NormFunction", "\[Rule]", "\[Infinity]"}]}], "]"}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Time for process equations: \>\"", ",", 
         RowBox[{"state", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< sec\>\""}], "]"}], ";"}],
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"Part", "[", 
       RowBox[{"state", ",", "2", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"Timing", "[", 
       RowBox[{"NDSolve`Iterate", "[", 
        RowBox[{"state", ",", "initstep"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Time for initial step: \>\"", ",", 
         RowBox[{"res", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< sec\>\""}], "]"}], ";"}],
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"Timing", "[", 
       RowBox[{"NDSolve`Iterate", "[", 
        RowBox[{"state", ",", "tmax"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Time for iteration to tmax: \>\"", ",", 
         RowBox[{"res", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< sec\>\""}], "]"}], ";"}],
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"Timing", "[", 
       RowBox[{"NDSolve`ProcessSolutions", "[", "state", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Time for ProcessSolutions: \>\"", ",", 
         RowBox[{"res", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< sec\>\""}], "]"}], ";"}],
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<res: \>\"", ",", "res"}], "]"}], ";"}], "*)"}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"DateString", "[", 
         RowBox[{"{", 
          RowBox[{
          "\"\<DayName\>\"", ",", "\"\<  \>\"", ",", "\"\<Month\>\"", ",", 
           "\"\</\>\"", ",", "\"\<YearShort\>\"", ",", "\"\<-> \>\"", ",", 
           "\"\<Hour\>\"", ",", "\"\<:\>\"", ",", "\"\<Minute\>\"", ",", 
           "\"\<:\>\"", ",", "\"\<Second\>\""}], "}"}], "]"}], "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"res", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5046042134485292`*^9, 3.504604219964446*^9}, {
   3.504604301139958*^9, 3.50460438958142*^9}, {3.50460442228601*^9, 
   3.50460445989707*^9}, {3.504604557823332*^9, 3.504604593653062*^9}, {
   3.504604624998216*^9, 3.504604656265242*^9}, {3.5046052027740993`*^9, 
   3.504605207586815*^9}, {3.5046053890168176`*^9, 3.504605456457339*^9}, {
   3.5046055529929132`*^9, 3.5046055545711093`*^9}, {3.5048628219887843`*^9, 
   3.50486286435233*^9}, {3.504928243545915*^9, 3.5049282714379683`*^9}, 
   3.5049283154714727`*^9, {3.505025177367216*^9, 3.505025191508565*^9}, {
   3.505025258152602*^9, 3.505025283966424*^9}, {3.505208285813032*^9, 
   3.505208287922515*^9}, {3.5074555202632027`*^9, 3.507455533060733*^9}, {
   3.5129047701581955`*^9, 3.5129047818771706`*^9}, {3.5189290211012063`*^9, 
   3.5189290219444866`*^9}, {3.522053657988821*^9, 3.5220536700530195`*^9}, {
   3.522053707433282*^9, 3.522053712340223*^9}, {3.5220545980742917`*^9, 
   3.522054604715852*^9}, {3.522054638579994*^9, 3.522054668568591*^9}, {
   3.522054703182839*^9, 3.522054764378954*^9}, 3.522055210816804*^9, {
   3.52205532078541*^9, 3.5220553307399364`*^9}, {3.5220554813861446`*^9, 
   3.52205548799645*^9}, {3.5220555887450085`*^9, 3.5220556051066866`*^9}, {
   3.522055663849332*^9, 3.5220556695688868`*^9}, {3.522055752549319*^9, 
   3.5220557541120386`*^9}, {3.5220567238891892`*^9, 3.522056727530327*^9}, {
   3.522640381925547*^9, 3.522640389173459*^9}, {3.522640602970786*^9, 
   3.522640619434688*^9}, {3.5226406713100367`*^9, 3.522640681182129*^9}, {
   3.5226407353849173`*^9, 3.522640888230531*^9}, {3.522640943948498*^9, 
   3.5226410657876177`*^9}, {3.522641120693324*^9, 3.522641120958871*^9}, 
   3.5226413320529566`*^9, {3.5226475338828497`*^9, 3.5226475805722256`*^9}, {
   3.5226477528964787`*^9, 3.5226477633777666`*^9}, {3.5226478838735323`*^9, 
   3.5226478841859407`*^9}, {3.522668897482179*^9, 3.5226689025744295`*^9}, {
   3.522668972725646*^9, 3.522668987205757*^9}, {3.522669019977356*^9, 
   3.522669035941405*^9}, 3.5226691444250827`*^9, {3.52266921890315*^9, 
   3.5226692264634237`*^9}, {3.5226708663042445`*^9, 3.522670876235578*^9}, {
   3.522671502116696*^9, 3.5226715041760015`*^9}, {3.522740521230729*^9, 
   3.5227405248854113`*^9}, {3.529900983899823*^9, 3.529900992508647*^9}, {
   3.5402740655303593`*^9, 3.5402740843743134`*^9}, {3.5405304397412724`*^9, 
   3.5405305228517113`*^9}, {3.557715085200218*^9, 3.5577151012526183`*^9}, {
   3.558071446995267*^9, 3.558071447682776*^9}, {3.5606021631314373`*^9, 
   3.5606021673903737`*^9}, {3.5606022078112693`*^9, 3.560602227530301*^9}, {
   3.5705047646079063`*^9, 3.5705047718779793`*^9}, {3.573630856296854*^9, 
   3.5736308946400595`*^9}, {3.5759506630109386`*^9, 
   3.5759506698905387`*^9}, {3.6223572573681264`*^9, 
   3.6223573110950546`*^9}, {3.6235761541503*^9, 3.623576163822486*^9}, {
   3.6235787109632277`*^9, 3.623578853595835*^9}, {3.62407793164126*^9, 
   3.6240779370232944`*^9}, {3.6271286828202653`*^9, 3.627128695019622*^9}, {
   3.627128961736068*^9, 3.627128967554905*^9}, {3.627129056740677*^9, 
   3.627129104773384*^9}, {3.6271292113376675`*^9, 3.627129215112892*^9}, {
   3.753110129410795*^9, 3.75311012966645*^9}, {3.753110260909587*^9, 
   3.7531102794035*^9}, 3.753110814285297*^9, {3.753110938091954*^9, 
   3.75311095508468*^9}, 3.753111015698737*^9, {3.7531110645938663`*^9, 
   3.753111083520472*^9}, {3.754339611928564*^9, 3.754339622414793*^9}, 
   3.754339723136504*^9, {3.7554543249560213`*^9, 3.7554543325330544`*^9}, {
   3.75546899856278*^9, 3.755469007803936*^9}, {3.755469391126358*^9, 
   3.7554694091016197`*^9}, {3.8407311623787622`*^9, 
   3.8407311858245497`*^9}, {3.8407331472012863`*^9, 3.840733202811645*^9}, {
   3.840733805968254*^9, 3.8407338384715843`*^9}, {3.8407359907795353`*^9, 
   3.8407359925106487`*^9}, {3.840736049559973*^9, 3.840736191171659*^9}, {
   3.840736854194498*^9, 3.8407368542863007`*^9}, {3.840739636419415*^9, 
   3.840739636631311*^9}, 3.840739794741618*^9, {3.840805377825521*^9, 
   3.84080540905564*^9}, {3.840805461257292*^9, 3.840805461414624*^9}, {
   3.840810420361814*^9, 3.840810420570162*^9}, 3.840823222305188*^9, 
   3.8408239654905577`*^9, {3.840824145728324*^9, 3.84082414801971*^9}, 
   3.840824341547736*^9, {3.84082514448857*^9, 3.840825152939587*^9}, {
   3.842631786527259*^9, 3.8426317869981833`*^9}, {3.8426319311193323`*^9, 
   3.842631934044348*^9}, {3.8426469201646757`*^9, 3.842646925960133*^9}, {
   3.842646958521202*^9, 3.842646959017994*^9}, 3.8426471506465282`*^9, {
   3.881955326971094*^9, 3.881955331996293*^9}, {3.881955398009275*^9, 
   3.881955449185566*^9}, {3.8819555017298727`*^9, 3.8819555023285646`*^9}, 
   3.8819555361252747`*^9},
 CellLabel->
  "In[832]:=",ExpressionUUID->"80579cc9-5cf6-45d0-bad5-2f9c7291b6e7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "BuildFinalStateFileData", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"ChoppLevel", "\[Rule]", "1*^-10"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BuildFinalStateFileData", "[", 
   RowBox[{"sol_", ",", "grid_", ",", "tfin_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"choplev", "=", 
       RowBox[{"OptionValue", "[", "ChoppLevel", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"numtrap", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"pTraps", "/.", "InputParam"}], "]"}]}], ",", 
      "\[IndentingNewLine]", "trapprofiles", ",", "\[IndentingNewLine]", 
      "soluteprofiles", ",", "\[IndentingNewLine]", "totsimtime", ",", 
      "\[IndentingNewLine]", "thegrid", ",", "\[IndentingNewLine]", "res", 
      ",", "\[IndentingNewLine]", "curf"}], "\[IndentingNewLine]", "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<BuildFinalStateFileData->ChoppLevel: \>\"", ",", " ", "choplev"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"totsimtime", "=", "tfin"}], ";", "\[IndentingNewLine]", 
     RowBox[{"thegrid", "=", "grid"}], ";", "\[IndentingNewLine]", 
     RowBox[{"soluteprofiles", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"TrueQ", "[", 
         RowBox[{
          RowBox[{"Head", "[", "sol", "]"}], " ", "\[Equal]", " ", 
          "NDSolve`StateData"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<Processing NDSolve`StateData solute data\>\"", 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"res", " ", "=", " ", 
          RowBox[{"NDSolve`ProcessSolutions", "[", 
           RowBox[{"sol", ",", "\"\<Active\>\""}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"curf", "=", 
          RowBox[{
           RowBox[{"Part", "[", 
            RowBox[{"res", ",", "1", ",", "1"}], "]"}], "/.", "res"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{"curf", ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "Grd"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Processing NDSolve normal solution solute data\>\"", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Chop", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"csol", "[", 
               RowBox[{"x", ",", "t"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "grid"}], "}"}]}], "]"}], "/.", 
            RowBox[{"t", "\[Rule]", "tfin"}]}], "/.", "sol"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"trapprofiles", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"TrueQ", "[", 
         RowBox[{
          RowBox[{"Head", "[", "sol", "]"}], " ", "\[Equal]", " ", 
          "NDSolve`StateData"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<Processing NDSolve`StateData trap data\>\"", 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"res", " ", "=", " ", 
          RowBox[{"NDSolve`ProcessSolutions", "[", 
           RowBox[{"sol", ",", "\"\<Active\>\""}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"curf", "=", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{"res", ",", 
                RowBox[{"1", "+", 
                 RowBox[{"ti", "*", "2"}]}], ",", "1"}], "]"}], "/.", 
              "res"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Table", "[", 
             RowBox[{"curf", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "Grd"}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<Processing NDSolve normal trap data\>\"", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Chop", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Subscript", "[", 
                  RowBox[{"ctrp", ",", "ti"}], "]"}], "[", 
                 RowBox[{"x", ",", "t"}], "]"}], " ", ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "grid"}], "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}], "/.", 
            RowBox[{"t", "\[Rule]", "tfin"}]}], "/.", "sol"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{
       "totsimtime", ",", " ", "thegrid", ",", "soluteprofiles", ",", 
        "trapprofiles"}], "}"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StoreFinalStateASCII", "[", 
   RowBox[{"FinStateData_", ",", "FileNameBase_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"numtrap", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"Part", "[", 
         RowBox[{"FinStateData", ",", "4"}], "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", "solprof", ",", "\[IndentingNewLine]", 
      "totconc"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"totconc", "=", 
      RowBox[{"Part", "[", 
       RowBox[{"FinStateData", ",", "3"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"solprof", "=", 
      RowBox[{"Thread", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"FinStateData", ",", "2"}], "]"}], ",", 
         RowBox[{"Part", "[", 
          RowBox[{"FinStateData", ",", "3"}], "]"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"FileNameBase", "<>", "\"\<solprof.dat\>\""}], ",", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Depth (um)\>\"", ",", "\"\<Solute Concentration\>\""}], "}"}],
           "}"}], ",", "solprof"}], "]"}], ",", "\"\<Table\>\""}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"ii", "=", "1"}], ",", 
       RowBox[{"ii", "\[LessEqual]", " ", "numtrap"}], ",", 
       RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"FileNameBase", "<>", "\"\<trapprof\>\"", "<>", 
           RowBox[{"ToString", "[", "ii", "]"}], "<>", "\"\<.dat\>\""}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Depth (um)\>\"", ",", 
               RowBox[{"\"\<Trap Concentration \>\"", "<>", 
                RowBox[{"ToString", "[", "ii", "]"}]}]}], "}"}], "}"}], ",", 
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"FinStateData", ",", "2"}], "]"}], ",", 
               RowBox[{"Part", "[", 
                RowBox[{"FinStateData", ",", "4", ",", "ii"}], "]"}]}], "}"}],
              "]"}]}], "]"}], ",", "\"\<Table\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"totconc", "+=", 
         RowBox[{"Part", "[", 
          RowBox[{"FinStateData", ",", "4", ",", "ii"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"FileNameBase", "<>", "\"\<totprof.dat\>\""}], ",", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"\"\<Depth (um)\>\"", ",", "\"\<Total Concentration\>\""}],
            "}"}], "}"}], ",", 
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{"FinStateData", ",", "2"}], "]"}], ",", "totconc"}], 
           "}"}], "]"}]}], "]"}], ",", "\"\<Table\>\""}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SolConcFromFile", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"PFun", "\[Rule]", "LogLogPlot"}], ",", 
     RowBox[{"ChoppLevel", "\[Rule]", "1*^-14"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SolConcFromFile", "[", 
   RowBox[{"FinStateData_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"plotfun", "=", 
       RowBox[{"OptionValue", "[", "PFun", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"pltrng", " ", "=", 
       RowBox[{"OptionValue", "[", "PlotRange", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"choplev", "=", 
       RowBox[{"OptionValue", "[", "ChoppLevel", "]"}]}], ",", 
      "\[IndentingNewLine]", "res", ",", "\[IndentingNewLine]", "tabxy"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tabxy", "=", 
      RowBox[{"Chop", "[", 
       RowBox[{
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Part", "[", 
            RowBox[{"FinStateData", ",", "2"}], "]"}], ",", 
           RowBox[{"Part", "[", 
            RowBox[{"FinStateData", ",", "3"}], "]"}]}], "}"}], "]"}], ",", 
        "choplev"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"Interpolation2D", "[", "tabxy", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"plotfun", "[", 
       RowBox[{
        RowBox[{"res", "[", "x", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0.001", ",", 
          RowBox[{"Max", "[", 
           RowBox[{"Part", "[", 
            RowBox[{"FinStateData", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotRange", "->", "pltrng"}], ",", 
        RowBox[{"PlotLabel", "\[Rule]", "\"\<Solute profile\>\""}]}], "]"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "res", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "TrapConcFromFile", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"PFun", "\[Rule]", "LogLogPlot"}], ",", 
     RowBox[{"ChoppLevel", "\[Rule]", "1*^-14"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TrapConcFromFile", "[", 
   RowBox[{"i_", ",", "FinStateData_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"plotfun", "=", 
       RowBox[{"OptionValue", "[", "PFun", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"pltrng", " ", "=", 
       RowBox[{"OptionValue", "[", "PlotRange", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"choplev", "=", 
       RowBox[{"OptionValue", "[", "ChoppLevel", "]"}]}], ",", 
      "\[IndentingNewLine]", "res", ",", "\[IndentingNewLine]", "tabxy"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tabxy", "=", 
      RowBox[{"Chop", "[", 
       RowBox[{
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Part", "[", 
            RowBox[{"FinStateData", ",", "2"}], "]"}], ",", 
           RowBox[{"Part", "[", 
            RowBox[{"FinStateData", ",", "4", ",", "i"}], "]"}]}], "}"}], 
         "]"}], ",", "choplev"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"Interpolation2D", "[", "tabxy", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"plotfun", "[", 
       RowBox[{
        RowBox[{"res", "[", "x", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0.001", ",", 
          RowBox[{"Max", "[", 
           RowBox[{"Part", "[", 
            RowBox[{"FinStateData", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotRange", "->", "pltrng"}], ",", 
        RowBox[{"PlotLabel", "\[Rule]", 
         RowBox[{"\"\<Trap profile # \>\"", "<>", 
          RowBox[{"ToString", "[", "i", "]"}]}]}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "res", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5050183048278604`*^9, 3.505018332891797*^9}, {
   3.5050184067080765`*^9, 3.5050184155054016`*^9}, {3.50501850990086*^9, 
   3.5050185145104704`*^9}, {3.505018850730809*^9, 3.5050188941236553`*^9}, {
   3.505018968393083*^9, 3.5050190060043836`*^9}, {3.5050190971184235`*^9, 
   3.5050191206508784`*^9}, {3.5050191693877487`*^9, 3.5050192032957344`*^9}, 
   3.505024591040323*^9, {3.5050248730235095`*^9, 3.5050248973372545`*^9}, {
   3.5050250146713867`*^9, 3.505025017327773*^9}, {3.5050251364119945`*^9, 
   3.5050251506939754`*^9}, {3.5050255594961553`*^9, 3.505025562293174*^9}, 
   3.5050325702457123`*^9, {3.5050327619274006`*^9, 3.50503278310036*^9}, {
   3.505037230868215*^9, 3.505037309949377*^9}, {3.505039744118487*^9, 
   3.505039744743519*^9}, {3.505039854389757*^9, 3.5050398944543085`*^9}, {
   3.505039951675988*^9, 3.505039955004284*^9}, {3.505040092089427*^9, 
   3.505040101902429*^9}, {3.5051044215615625`*^9, 3.5051044385624332`*^9}, {
   3.5051044779238234`*^9, 3.5051047028415885`*^9}, {3.505104759172598*^9, 
   3.5051047685324516`*^9}, {3.505105404580641*^9, 3.505105458364644*^9}, {
   3.505105587918152*^9, 3.505105648186863*^9}, {3.5129584917256765`*^9, 
   3.5129585206949825`*^9}, {3.5129585623989086`*^9, 3.512958562664539*^9}, {
   3.512970388089946*^9, 3.5129704354003267`*^9}, {3.512970898047967*^9, 
   3.5129709195779767`*^9}, {3.522666080655447*^9, 3.522666084357482*^9}, {
   3.5226661159731717`*^9, 3.5226661994954505`*^9}, {3.522666241155057*^9, 
   3.52266640332605*^9}, {3.522666478350831*^9, 3.5226664789912677`*^9}, {
   3.5226665613576365`*^9, 3.522666681603476*^9}, {3.540268908075488*^9, 
   3.5402689887260523`*^9}, {3.540269024198223*^9, 3.540269186415648*^9}, {
   3.540269436175819*^9, 3.540269485018751*^9}, {3.54026952848988*^9, 
   3.540269533143215*^9}, 3.540269570227274*^9, {3.540269609317185*^9, 
   3.5402696271171093`*^9}, {3.5402697027786837`*^9, 3.540269703659274*^9}, {
   3.540275074257958*^9, 3.540275076994059*^9}},
 CellLabel->
  "In[840]:=",ExpressionUUID->"ad469b0e-5606-48b4-bd93-8bc542b137f9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[, "Section",ExpressionUUID->"07d7a953-2475-4396-b7aa-5e1a7bd35da4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetNumTraps", "[", "]"}], ":=", 
   RowBox[{"Length", "[", 
    RowBox[{"pTraps", "/.", 
     RowBox[{"(", 
      RowBox[{"pTrapModelParam", "/.", "InputParam"}], ")"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.633431328480176*^9, 3.633431363111732*^9}},
 CellLabel->
  "In[847]:=",ExpressionUUID->"a426c31b-c511-482e-a564-b6282b4dfe10"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "PlotFinalState", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"PFun", "\[Rule]", "LogLogPlot"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotFinalState", "[", 
   RowBox[{"sol_", ",", "xmin_", ",", "xmax_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"textstyle", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
         RowBox[{"FontSize", "\[Rule]", "28"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"pltrng", "=", 
       RowBox[{"OptionValue", "[", "PlotRange", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"plotfun", "=", 
       RowBox[{"OptionValue", "[", "PFun", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"numtrap", "=", 
       RowBox[{"GetNumTraps", "[", "]"}]}], ",", "\[IndentingNewLine]", 
      "legend", ",", "\[IndentingNewLine]", "res", ",", "\[IndentingNewLine]",
       "funs"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "[", 
        RowBox[{
         RowBox[{"Head", "[", "sol", "]"}], " ", "==", "  ", 
         "NDSolve`StateData"}], "]"}], ",", 
       RowBox[{
       "Print", "[", 
        "\"\<Solution was derived by SolveDLGEx, proceeding!\>\"", "]"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<Solution was not derived from SolveDLGEx -> Aborting\>\"", 
         "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"res", " ", "=", " ", 
      RowBox[{"NDSolve`ProcessSolutions", "[", 
       RowBox[{"sol", ",", "\"\<Active\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"funs", "=", 
      RowBox[{"Evaluate", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Tooltip", "[", " ", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"res", ",", "1", ",", "1"}], "]"}], ",", 
             "\"\<Solute\>\""}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Tooltip", "[", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"res", ",", 
                 RowBox[{"1", "+", 
                  RowBox[{"ti", "*", "2"}]}], ",", "1"}], "]"}], ",", 
               RowBox[{"\"\<Trap \>\"", "<>", 
                RowBox[{"ToString", "[", "ti", "]"}]}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}]}], 
          "}"}], "]"}], "/.", "res"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"plotfun", "[", 
      RowBox[{"funs", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "xmin", ",", "xmax"}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "pltrng"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotStyle", "\[Rule]", "Thick"}], ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<Depth (\[Mu]m)\>\"", ",", "\"\<Concentration\>\""}], 
         "}"}]}], ",", 
       RowBox[{"BaseStyle", "\[Rule]", "textstyle"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "PlotCSol", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"NumTime", "\[Rule]", "10"}], ",", 
     RowBox[{"PFun", "\[Rule]", "LogLogPlot"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotCSol", "[", 
   RowBox[{"sol_", ",", "t0_", ",", "tmax_", ",", "xmin_", ",", "xmax_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"textstyle", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
         RowBox[{"FontSize", "\[Rule]", "28"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"pltrng", "=", 
       RowBox[{"OptionValue", "[", "PlotRange", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ntime", "=", 
       RowBox[{"OptionValue", "[", "NumTime", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"plotfun", "=", 
       RowBox[{"OptionValue", "[", "PFun", "]"}]}], ",", 
      "\[IndentingNewLine]", "legend"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"legend", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"N", "[", "t", "]"}], "]"}], "<>", "\"\< s\>\""}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "t0", ",", "tmax", ",", 
          FractionBox[
           RowBox[{"tmax", "-", "t0"}], "ntime"]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"plotfun", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"csol", "[", 
            RowBox[{"x", ",", "t"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "t0", ",", "tmax", ",", 
             FractionBox[
              RowBox[{"tmax", "-", "t0"}], "ntime"]}], "}"}]}], "]"}], "/.", 
         "sol"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "xmin", ",", "xmax"}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "pltrng"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotLegend", "\[Rule]", "legend"}], " ", ",", 
       RowBox[{"LegendPosition", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1.1", ",", 
          RowBox[{"-", "0.4"}]}], "}"}]}], ",", " ", 
       RowBox[{"LegendShadow", "\[Rule]", "None"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Thick"}], ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Depth (\[Mu]m)\>\"", ",", "\"\<Solute concentration\>\""}], 
         "}"}]}], ",", 
       RowBox[{"BaseStyle", "\[Rule]", "textstyle"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "PlotCSolAtt", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"PFun", "\[Rule]", "LogLogPlot"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotCSolAtt", "[", 
   RowBox[{"sol_", ",", "att_", ",", "xmin_", ",", "xmax_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"textstyle", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
         RowBox[{"FontSize", "\[Rule]", "28"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"pltrng", "=", 
       RowBox[{"OptionValue", "[", "PlotRange", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"plotfun", "=", 
       RowBox[{"OptionValue", "[", "PFun", "]"}]}], ",", 
      "\[IndentingNewLine]", "legend"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"plotfun", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"csol", "[", 
          RowBox[{"x", ",", "att"}], "]"}], "/.", "sol"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "xmin", ",", "xmax"}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "pltrng"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Thick"}], ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Depth (\[Mu]m)\>\"", ",", "\"\<Solute concentration\>\""}], 
         "}"}]}], ",", 
       RowBox[{"BaseStyle", "\[Rule]", "textstyle"}]}], "]"}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "PlotCTrap", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"NumTime", "\[Rule]", "10"}], ",", 
     RowBox[{"PFun", "\[Rule]", "LogLogPlot"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotCTrap", "[", 
   RowBox[{"sol_", ",", "t0_", ",", "tmax_", ",", "xmin_", ",", "xmax_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"textstyle", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
         RowBox[{"FontSize", "\[Rule]", "28"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"pltrng", "=", 
       RowBox[{"OptionValue", "[", "PlotRange", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ntime", "=", 
       RowBox[{"OptionValue", "[", "NumTime", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"numtrap", "=", 
       RowBox[{"GetNumTraps", "[", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"plotfun", "=", 
       RowBox[{"OptionValue", "[", "PFun", "]"}]}], ",", 
      "\[IndentingNewLine]", "toplot", ",", "\[IndentingNewLine]", "legend"}],
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", "\[IndentingNewLine]", 
       RowBox[{"plotfun", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Subscript", "[", 
               RowBox[{"ctrp", ",", "ti"}], "]"}], "[", 
              RowBox[{"x", ",", "t"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", "t0", ",", "tmax", ",", 
               FractionBox["tmax", "ntime"]}], "}"}]}], "]"}], "/.", "sol"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "xmin", ",", "xmax"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", "pltrng"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotStyle", "\[Rule]", "Thick"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{"\"\<Concentration in trap: \>\"", "<>", 
           RowBox[{"ToString", "[", "ti", "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotLegend", "\[Rule]", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"N", "[", "t", "]"}], "]"}], "<>", "\"\< s\>\""}], ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", "t0", ",", "tmax", ",", 
               FractionBox["tmax", "ntime"]}], "}"}]}], "]"}], "]"}]}], " ", 
         ",", 
         RowBox[{"LegendPosition", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"1.1", ",", 
            RowBox[{"-", "0.4"}]}], "}"}]}], ",", 
         RowBox[{"LegendShadow", "\[Rule]", "None"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Depth (\[Mu]m)\>\"", ",", "\"\<Trapped concentration\>\""}], 
           "}"}]}], ",", 
         RowBox[{"BaseStyle", "\[Rule]", "textstyle"}]}], "]"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "PlotCTrapAtt", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"PFun", "\[Rule]", "LogLogPlot"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotCTrapAtt", "[", 
   RowBox[{"sol_", ",", "att_", ",", "xmin_", ",", "xmax_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"textstyle", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
         RowBox[{"FontSize", "\[Rule]", "28"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"pltrng", "=", 
       RowBox[{"OptionValue", "[", "PlotRange", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"numtrap", "=", 
       RowBox[{"GetNumTraps", "[", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"plotfun", "=", 
       RowBox[{"OptionValue", "[", "PFun", "]"}]}], ",", 
      "\[IndentingNewLine]", "toplot", ",", "\[IndentingNewLine]", "legend"}],
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", "\[IndentingNewLine]", 
       RowBox[{"plotfun", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Subscript", "[", 
             RowBox[{"ctrp", ",", "ti"}], "]"}], "[", 
            RowBox[{"x", ",", "att"}], "]"}], "/.", "sol"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "xmin", ",", "xmax"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", "pltrng"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotStyle", "\[Rule]", "Thick"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{"\"\<Concentration in trap: \>\"", "<>", 
           RowBox[{"ToString", "[", "ti", "]"}], "<>", "\"\< @ t = \>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"StandardForm", "[", "att", "]"}], "]"}], "<>", 
           "\"\<sec.\>\""}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Depth (\[Mu]m)\>\"", ",", "\"\<Trapped concentration\>\""}], 
           "}"}]}], ",", 
         RowBox[{"BaseStyle", "\[Rule]", "textstyle"}]}], "]"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExportFinalTrapConcentrations", "[", 
   RowBox[{"sol_", ",", "grid_", ",", "tfin_", ",", "FName_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TrapModelParam", " ", "=", " ", 
       RowBox[{"pTrapModelParam", "/.", "InputParam"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"xref", "=", 
       RowBox[{"pxref", "/.", "InputParam"}]}], ",", "\[IndentingNewLine]", 
      "refconc", ",", "\[IndentingNewLine]", 
      RowBox[{"numtrap", "=", 
       RowBox[{"GetNumTraps", "[", "]"}]}], ",", "\[IndentingNewLine]", 
      "TrapProfofxandt", ",", "\[IndentingNewLine]", "toexport", ",", 
      "\[IndentingNewLine]", "header"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"xref", "=", 
      RowBox[{"pxref", "/.", "TrapModelParam"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrapProfofxandt", "=", 
      RowBox[{"pFunc", "/.", 
       RowBox[{"(", 
        RowBox[{"pTrapProfFunc", "/.", "TrapModelParam"}], " ", ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"refconc", "=", 
      RowBox[{"N", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"csol", "[", 
          RowBox[{"xref", ",", "tfin"}], "]"}], "+", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Subscript", "[", 
             RowBox[{"ctrp", ",", "ti"}], "]"}], "[", 
            RowBox[{"xref", ",", "tfin"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}]}], "/.", 
        "sol"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"toexport", "=", 
      RowBox[{"N", "[", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Chop", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"TrapProfofxandt", "[", 
                  RowBox[{"[", "ti", "]"}], "]"}], ")"}], "[", 
                RowBox[{"refconc", ",", "x", ",", "tfin", ",", "ti"}], "]"}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], 
             "\[IndentingNewLine]", "]"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"x", ",", "grid"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"header", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<x (um)\>\"", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"\"\<Trap\>\"", "<>", 
            RowBox[{"ToString", "[", "ti", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}]}], "}"}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"FName", ",", 
       RowBox[{"Prepend", "[", 
        RowBox[{"toexport", ",", "header"}], "]"}], ",", 
       "\[IndentingNewLine]", "\"\<Table\>\""}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ExportProfiles", "]"}], " ", "=", 
   RowBox[{"{", 
    RowBox[{"Choplev", " ", "\[Rule]", "1*^-7"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExportProfiles", "[", 
    RowBox[{"sol_", ",", "grid_", ",", "FName_", ",", "TimeList_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"toexport", ",", "\[IndentingNewLine]", 
       RowBox[{"numtrap", "=", 
        RowBox[{"GetNumTraps", "[", "]"}]}], ",", "\[IndentingNewLine]", 
       "header", ",", "\[IndentingNewLine]", 
       RowBox[{"chopper", " ", "=", 
        RowBox[{"N", "[", " ", 
         RowBox[{"OptionValue", "[", "Choplev", "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"header", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<x (um)\>\"", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<Solute@\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"ScientificForm", "[", "t", "]"}], "]"}]}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"\"\<Trap\>\"", "<>", 
                 RowBox[{"ToString", "[", "ti", "]"}], "<>", "\"\<@\>\"", "<>", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"ScientificForm", "[", "t", "]"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}]}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "TimeList"}], "}"}]}], "]"}]}], "}"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<ExportProfiles chopping @ \>\"", ",", "chopper"}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"toexport", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"csol", "[", 
                    RowBox[{"x", ",", "t"}], "]"}], ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"ctrp", ",", "ti"}], "]"}], "[", 
                    RowBox[{"x", ",", "t"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], 
                    "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"t", ",", "TimeList"}], "}"}]}], "]"}]}], "}"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "grid"}], "}"}]}], "]"}], "/.", "sol"}], ",", 
         "chopper"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"FName", ",", 
        RowBox[{"Prepend", "[", 
         RowBox[{"toexport", ",", "header"}], "]"}], ",", "\"\<Table\>\""}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "PlotCTot", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"NumTime", "\[Rule]", "10"}], ",", 
     RowBox[{"PFun", "\[Rule]", "LogLogPlot"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotCTot", "[", 
   RowBox[{"sol_", ",", "t0_", ",", "tmax_", ",", "xmin_", ",", "xmax_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"textstyle", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
         RowBox[{"FontSize", "\[Rule]", "28"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"pltrng", "=", 
       RowBox[{"OptionValue", "[", "PlotRange", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ntime", "=", 
       RowBox[{"OptionValue", "[", "NumTime", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"numtrap", "=", 
       RowBox[{"GetNumTraps", "[", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"plotfun", "=", 
       RowBox[{"OptionValue", "[", "PFun", "]"}]}], ",", 
      "\[IndentingNewLine]", "toplot", ",", "\[IndentingNewLine]", "legend", 
      ",", "\[IndentingNewLine]", "func"}], "\[IndentingNewLine]", "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"func", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"csol", "[", 
         RowBox[{"x", ",", "t"}], "]"}], "+", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Subscript", "[", 
            RowBox[{"ctrp", ",", "ti"}], "]"}], "[", 
           RowBox[{"x", ",", "t"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}]}], "/.", 
       "sol"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"legend", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"N", "[", "t", "]"}], "]"}], "<>", "\"\< s\>\""}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "t0", ",", "tmax", ",", 
          FractionBox["tmax", "ntime"]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"plotfun", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Table", "[", 
          RowBox[{"func", ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "t0", ",", "tmax", ",", 
             FractionBox["tmax", "ntime"]}], "}"}]}], "]"}], "]"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "xmin", ",", "xmax"}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "pltrng"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotStyle", "\[Rule]", "Thick"}], ",", 
       RowBox[{"PlotLegend", "\[Rule]", "legend"}], " ", ",", 
       RowBox[{"LegendPosition", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1.1", ",", 
          RowBox[{"-", "0.4"}]}], "}"}]}], ",", 
       RowBox[{"LegendShadow", "\[Rule]", "None"}], ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Depth (\[Mu]m)\>\"", ",", "\"\<Total concentration\>\""}], 
         "}"}]}], ",", 
       RowBox[{"BaseStyle", "\[Rule]", "textstyle"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ExportCTot", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"NumTime", "\[Rule]", "10"}], ",", " ", 
     RowBox[{"MaxX", "\[Rule]", "\[Infinity]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExportCTot", "[", 
    RowBox[{
    "FileName_", ",", "sol_", ",", "grd_", ",", "t0_", ",", "tmax_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ntime", "=", 
        RowBox[{"OptionValue", "[", "NumTime", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"numtrap", "=", 
        RowBox[{"GetNumTraps", "[", "]"}]}], ",", "\[IndentingNewLine]", 
       "toexport", ",", "\[IndentingNewLine]", "func", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"maxdepth", "=", 
        RowBox[{"OptionValue", "[", "MaxX", "]"}]}], ",", 
       "\[IndentingNewLine]", "grid"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"grid", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"grd", ",", 
         RowBox[{
          RowBox[{"#", "<", "maxdepth"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Exporting to maximum depth of \>\"", ",", " ", 
        RowBox[{"Max", "[", "grid", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"func", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"csol", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "+", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Subscript", "[", 
             RowBox[{"ctrp", ",", "ti"}], "]"}], "[", 
            RowBox[{"x", ",", "t"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}]}], "/.", 
        "sol"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"toexport", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "func"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "t0", ",", "tmax", ",", 
           FractionBox["tmax", "ntime"]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "grid"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Export", "[", 
        RowBox[{"FileName", ",", " ", 
         RowBox[{"Chop", "[", "toexport", "]"}], ",", "\"\<Table\>\""}], 
        "]"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Chop", "[", "toexport", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "PlotDiffFrontOft", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"NumTime", "\[Rule]", "10"}], ",", 
     RowBox[{"PFun", "\[Rule]", "Plot"}], ",", 
     RowBox[{"FrontConcVal", "->", " ", "1*^-4"}], ",", 
     RowBox[{"FitStartValue", "\[Rule]", "0.0001"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotDiffFrontOft", "[", 
   RowBox[{"sol_", ",", "grd_", ",", "t0_", ",", "tmax_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"textstyle", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
         RowBox[{"FontSize", "\[Rule]", "28"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"pltrng", "=", 
       RowBox[{"OptionValue", "[", "PlotRange", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ntime", "=", 
       RowBox[{"OptionValue", "[", "NumTime", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"numtrap", "=", 
       RowBox[{"GetNumTraps", "[", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"plotfun", "=", 
       RowBox[{"OptionValue", "[", "PFun", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"frontconc", "=", 
       RowBox[{"OptionValue", "[", "FrontConcVal", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"diff0", "=", 
       RowBox[{"OptionValue", "[", "FitStartValue", "]"}]}], ",", 
      "\[IndentingNewLine]", "zeropos", ",", "\[IndentingNewLine]", "times", 
      ",", "\[IndentingNewLine]", "fres"}], "\[IndentingNewLine]", "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"times", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"t", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "t0", ",", "tmax", ",", 
          FractionBox[
           RowBox[{"tmax", "-", "t0"}], "ntime"]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ShowStatus", "[", 
      RowBox[{
      "\"\<PlotDiffFrontOft@ Searching for diffusion from during \>\"", "<>", 
       RowBox[{"ToString", "[", " ", 
        RowBox[{"Length", "[", "times", "]"}], "]"}], "<>", " ", 
       "\"\< time steps\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"zeropos", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Module", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"func", "=", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"csol", "[", 
                RowBox[{"x", ",", "att"}], "]"}], "+", 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Subscript", "[", 
                   RowBox[{"ctrp", ",", "ti"}], "]"}], "[", 
                  RowBox[{"x", ",", "att"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}]}], 
              ")"}]}], ",", "\[IndentingNewLine]", "from", ",", 
            "\[IndentingNewLine]", "to", ",", "\[IndentingNewLine]", 
            "functab", ",", "\[IndentingNewLine]", "fi"}], 
           "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"functab", "=", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 FractionBox[
                  RowBox[{"func", "-", "frontconc"}], "frontconc"]}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "grd"}], "}"}]}], "]"}], "/.", "sol"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"from", " ", "=", " ", 
            RowBox[{"Min", "[", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Part", "[", 
                 RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", 
               RowBox[{"Select", "[", 
                RowBox[{"functab", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", " ", 
                    "0"}], "&&", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ">", 
                    RowBox[{"grd", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "&"}]}], "]"}]}], 
              "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"to", "=", 
            RowBox[{"Max", "[", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Part", "[", 
                 RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", 
               RowBox[{"Select", "[", 
                RowBox[{"functab", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[GreaterEqual]", " ", 
                    "0"}], "&&", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ">", 
                    RowBox[{"grd", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "&"}]}], "]"}]}], 
              "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"fi", "=", 
            RowBox[{"Interpolation", "[", 
             RowBox[{"functab", ",", 
              RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"ShowStatus", "[", 
            RowBox[{"\"\<PlotDiffFrontOft@Att: \>\"", "<>", 
             RowBox[{"ToString", "[", "att", "]"}], "<>", "\"\< From: \>\"", "<>",
              " ", 
             RowBox[{"ToString", "[", "from", "]"}], "<>", " ", 
             "\"\< to: \>\"", "<>", 
             RowBox[{"ToString", "[", "to", "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"att", ",", 
             RowBox[{"x", "/.", 
              RowBox[{"FindRoot", "[", 
               RowBox[{
                RowBox[{"fi", "[", "x", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "from", ",", "to"}], "}"}], ",", 
                RowBox[{"DampingFactor", "\[Rule]", "0.1"}], ",", 
                RowBox[{"AccuracyGoal", "\[Rule]", "6"}], ",", 
                RowBox[{"PrecisionGoal", "\[Rule]", "6"}]}], "]"}]}]}], 
            "}"}]}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
        ",", 
        RowBox[{"{", 
         RowBox[{"att", ",", "times"}], "}"}]}], "\[IndentingNewLine]", 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ShowStatus", "[", 
      RowBox[{"\"\<PlotDiffFrontOft@Fitting result, starting @ \>\"", "<>", 
       RowBox[{"ToString", "[", "diff0", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fres", "=", 
      RowBox[{"FindFit", "[", 
       RowBox[{"zeropos", ",", 
        RowBox[{"{", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"Diff", "*", "6", "*", "t"}], "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"Diff", ",", "diff0"}], "}"}], "}"}], ",", "t", ",", 
        RowBox[{"Method", "->", "\"\<LevenbergMarquardt\>\""}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
     "ShowStatus", "[", "\"\<PlotDiffFrontOft@Plotting result\>\"", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"plotfun", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"Diff", "*", "6", "*", "t"}], "]"}], "/.", "fres"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{"Last", "[", "times", "]"}]}], "}"}], ",", 
        RowBox[{"Epilog", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Red", ",", 
           RowBox[{"PointSize", "[", "Large", "]"}], ",", 
           RowBox[{"Point", "[", "zeropos", "]"}]}], "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "pltrng"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<Time (s)\>\"", ",", "\"\<Diffusion distance\>\""}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotLegend", "\[Rule]", 
         RowBox[{"\"\<D = \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"Diff", "/.", "fres"}], "]"}], "<>", 
          "\"\< \!\(\*SuperscriptBox[\(um\), \(2\)]\)/s\>\""}]}], " ", ",", 
        RowBox[{"LegendPosition", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1.1", ",", 
           RowBox[{"-", "0.4"}]}], "}"}]}], ",", 
        RowBox[{"LegendShadow", "\[Rule]", "None"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"BaseStyle", "\[Rule]", "textstyle"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FRONTPOS", "->", "zeropos"}], ",", " ", "fres"}], "}"}], 
        ",", "1"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "PlotRetentionVsTime", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"NumTime", "\[Rule]", "10"}], ",", 
     RowBox[{"PFun", "\[Rule]", "ListPlot"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotRetentionVsTime", "[", 
   RowBox[{"sol_", ",", "tmax_", ",", "grd_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"numtrap", "=", 
       RowBox[{"GetNumTraps", "[", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"plotfun", "=", 
       RowBox[{"OptionValue", "[", "PFun", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ntime", "=", 
       RowBox[{"OptionValue", "[", "NumTime", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"pltrng", " ", "=", 
       RowBox[{"OptionValue", "[", "PlotRange", "]"}]}], ",", 
      "\[IndentingNewLine]", "retval", ",", "\[IndentingNewLine]", 
      RowBox[{"xmax", " ", "=", "  ", 
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"pTgtThick", "*", "tolenscale"}], ")"}], "/.", 
         "InputParam"}], "]"}]}], ",", "\[IndentingNewLine]", "flux", ",", 
      "\[IndentingNewLine]", "totdens", ",", "\[IndentingNewLine]", "func", 
      ",", "\[IndentingNewLine]", "solfunc", ",", "\[IndentingNewLine]", 
      "trapfuncs"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"totdens", "=", 
      RowBox[{
       FractionBox["prohW", 
        SuperscriptBox["tolenscale", "3"]], "/.", "InputParam"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"func", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"csol", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "+", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Subscript", "[", 
               RowBox[{"ctrp", ",", "ti"}], "]"}], "[", 
              RowBox[{"x", ",", "t"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}]}], 
          ")"}], ")"}], "*", "totdens"}], "/.", "sol"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"solfunc", "=", 
      RowBox[{
       RowBox[{"csol", "[", 
        RowBox[{"x", ",", "t"}], "]"}], "/.", "sol"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"trapfuncs", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Subscript", "[", 
           RowBox[{"ctrp", ",", "ti"}], "]"}], "[", 
          RowBox[{"x", ",", "t"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}], "/.", 
       "sol"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"retval", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Time: \>\"", ",", 
              RowBox[{"N", "[", "t", "]"}]}], "]"}], ";", 
            RowBox[{"ListIntegrate", "[", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "solfunc"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "grd"}], "}"}]}], "]"}], "]"}], "]"}]}], 
           ",", " ", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"ListIntegrate", "[", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x", ",", "trapfuncs"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "grd"}], "}"}]}], "]"}], "]"}], "]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}], ",", 
           RowBox[{"ListIntegrate", "[", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "func"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "grd"}], "}"}]}], "]"}], "]"}], "]"}]}], 
          "}"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "tmax", ",", 
          FractionBox["tmax", "ntime"]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"plotfun", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"#", ",", "1"}], "]"}], ",", 
             RowBox[{"Part", "[", 
              RowBox[{"#", ",", "2"}], "]"}]}], "}"}], "&"}], ",", "retval"}],
          "]"}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Time in s\>\"", ",", "\"\<solute retention in #/um^2\>\""}], 
          "}"}]}], ",", 
        RowBox[{"PlotRange", "->", "pltrng"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"ii", "=", "1"}], ",", 
        RowBox[{"ii", "\[LessEqual]", " ", "numtrap"}], ",", 
        RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"plotfun", "[", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Part", "[", 
                  RowBox[{"#", ",", "1"}], "]"}], ",", 
                 RowBox[{"Part", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"2", "+", "ii"}]}], "]"}]}], "}"}], "&"}], ",", 
              "retval"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"AxesLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\"\<Time in s\>\"", ",", 
               RowBox[{"\"\<trap\>\"", "<>", 
                RowBox[{"ToString", "[", "ii", "]"}], "<>", 
                "\"\< retention in #/um^2\>\""}]}], "}"}]}], ",", 
            RowBox[{"PlotRange", "->", "pltrng"}]}], "]"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"plotfun", "[", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{"#", ",", "1"}], "]"}], ",", 
              RowBox[{"Part", "[", 
               RowBox[{"#", ",", 
                RowBox[{"2", "+", "numtrap", "+", "1"}]}], "]"}]}], "}"}], 
            "&"}], ",", "retval"}], "]"}], ",", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Time in s\>\"", ",", "\"\<total retention in #/um^2\>\""}], 
           "}"}]}], ",", 
         RowBox[{"PlotRange", "->", "pltrng"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "retval", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "PlotRetentionVsFluence", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"NumTime", "\[Rule]", "10"}], ",", 
     RowBox[{"ATTIMES", "\[Rule]", "None"}], ",", 
     RowBox[{"PFun", "\[Rule]", "ListPlot"}], ",", 
     RowBox[{"PrecGoal", "\[Rule]", "6"}], ",", 
     RowBox[{"AccGoal", "\[Rule]", "8"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotRetentionVsFluence", "[", 
   RowBox[{"eqn_", ",", "sol_", ",", "tmax_", ",", "grd_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"numtrap", "=", 
       RowBox[{"GetNumTraps", "[", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"plotfun", "=", 
       RowBox[{"OptionValue", "[", "PFun", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ntime", "=", 
       RowBox[{"OptionValue", "[", "NumTime", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"attimes", " ", "=", 
       RowBox[{"OptionValue", "[", "ATTIMES", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"pltrng", " ", "=", 
       RowBox[{"OptionValue", "[", "PlotRange", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"precGoal", "=", 
       RowBox[{"OptionValue", "[", "PrecGoal", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"accGoal", "=", 
       RowBox[{"OptionValue", "[", "AccGoal", "]"}]}], ",", 
      "\[IndentingNewLine]", "implrate", ",", "\[IndentingNewLine]", 
      RowBox[{"xmax", " ", "=", "  ", 
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"pTgtThick", "*", "tolenscale"}], ")"}], "/.", 
         "InputParam"}], "]"}]}], ",", "\[IndentingNewLine]", "times", ",", 
      "\[IndentingNewLine]", "fluence", ",", "\[IndentingNewLine]", "totdens",
       ",", "\[IndentingNewLine]", "totretexp", ",", "\[IndentingNewLine]", 
      "totretfunc", ",", "\[IndentingNewLine]", "solconcexp", ",", 
      "\[IndentingNewLine]", "solconcfunc", ",", "\[IndentingNewLine]", 
      "trapfuncexp", ",", "\[IndentingNewLine]", "trapconcfunc", ",", 
      "\[IndentingNewLine]", "retval", ",", "toplot", ",", 
      "\[IndentingNewLine]", "cntr"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ShowStatus", "[", "\"\<PlotRetentionVsFluence\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"times", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"TrueQ", "[", 
          RowBox[{"(", 
           RowBox[{"ntime", ">", "0"}], ")"}], "]"}], "&&", 
         RowBox[{"TrueQ", "[", 
          RowBox[{"(", 
           RowBox[{"attimes", "\[Equal]", "None"}], ")"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Generating times based on number of time steps\>\"", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "tmax", ",", 
           FractionBox["tmax", "ntime"]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"TrueQ", "[", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Head", "[", "attimes", "]"}], "\[Equal]", "List"}], 
             ")"}], "]"}], "&&", 
           RowBox[{"TrueQ", "[", 
            RowBox[{
             RowBox[{"Depth", "[", "attimes", "]"}], "\[Equal]", "2"}], 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<Using times from supplied time steps\>\"", 
            "]"}], ";", "\[IndentingNewLine]", "attimes"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<Invalid time stepping->Abort\>\"", "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Produced \>\"", ",", 
       RowBox[{"Length", " ", "[", "times", "]"}], ",", 
       "\"\< time steps\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"implrate", "=", 
      RowBox[{"IMPLRATE", "/.", "eqn"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"totdens", "=", 
      RowBox[{
       FractionBox["prohW", 
        SuperscriptBox["tolenscale", "3"]], "/.", "InputParam"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fluence", "[", "thet_", "]"}], ":=", 
      RowBox[{
       RowBox[{"NIntegrate", "[", 
        RowBox[{"implrate", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", "\[Infinity]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "1.0*^-6", ",", "thet"}], "}"}], ",", 
         RowBox[{"PrecisionGoal", "\[Rule]", "16"}]}], "]"}], "*", 
       "totdens"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<PlotRetentionVsFluence->flux[tmax/2] = \>\"", ",", 
         RowBox[{"fluence", "[", 
          RowBox[{"tmax", "/", "2"}], "]"}]}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"totretexp", "[", 
       RowBox[{"x_", ",", "t_"}], "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"csol", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "+", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Subscript", "[", 
               RowBox[{"ctrp", ",", "ti"}], "]"}], "[", 
              RowBox[{"x", ",", "t"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}]}], 
          ")"}], "*", "totdens"}], ")"}], "/.", "sol"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"totretfunc", "=", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "t"}], "}"}], ",", 
        RowBox[{"totretexp", "[", 
         RowBox[{"x", ",", "t"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<totretfunc = \>\"", ",", 
       RowBox[{"totretfunc", "[", 
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"grd", ",", "10"}], "]"}], ",", 
         RowBox[{"tmax", "/", "2"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"solconcexp", "[", 
       RowBox[{"x_", ",", "t_"}], "]"}], "=", 
      RowBox[{
       RowBox[{"csol", "[", 
        RowBox[{"x", ",", "t"}], "]"}], "/.", "sol"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"solconcfunc", "=", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "t"}], "}"}], ",", 
        RowBox[{"solconcexp", "[", 
         RowBox[{"x", ",", "t"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<solconcfunc = \>\"", ",", 
       RowBox[{"solconcfunc", "[", 
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"grd", ",", "10"}], "]"}], ",", 
         RowBox[{"tmax", "/", "2"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"trapfuncexp", "=", " ", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Subscript", "[", 
          RowBox[{"ctrp", ",", "ti"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}], "/.", 
       "sol"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"trapconcfunc", "=", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "t", ",", "ti"}], "}"}], ",", 
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"trapfuncexp", ",", "ti"}], "]"}], "[", 
         RowBox[{"x", ",", "t"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<trapconcfunc = \>\"", ",", 
       RowBox[{"trapconcfunc", "[", 
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"grd", ",", "10"}], "]"}], ",", 
         RowBox[{"tmax", "/", "2"}], ",", "1"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cntr", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Processing \>\"", ",", " ", 
       RowBox[{"Length", "[", "times", "]"}], ",", " ", "\"\< times\>\""}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", 
      "\"\<Time, Fluence (um^-2), Solute (at. frac. * um), <Trapped_i (at. \
frac. * um)>, Total  (um^-2)\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"PrintTemporary", "[", 
      RowBox[{"ProgressIndicator", "[", 
       RowBox[{
        RowBox[{"Dynamic", "[", "cntr", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Length", "[", "times", "]"}]}], "}"}]}], "]"}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"retval", " ", "=", " ", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"cntr", "++"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"att", ",", "\[IndentingNewLine]", 
            RowBox[{"fluence", "[", "att", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ShowStatus", "[", 
              RowBox[{"\"\<Time: \>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"N", "[", "att", "]"}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"With", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{"tointeg", " ", "=", " ", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"solconcfunc", "[", 
                    RowBox[{"#", ",", "att"}], "]"}]}], "}"}], "&"}], ",", 
                   "grd"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"ShowStatus", "[", 
                 RowBox[{"\"\<solconcfunc @ t = \>\"", "<>", 
                  RowBox[{"ToString", "[", 
                   RowBox[{"N", "[", "att", "]"}], "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"ListIntegrate", "[", "tointeg", "]"}]}]}], 
              "\[IndentingNewLine]", "]"}]}], ",", " ", "\[IndentingNewLine]", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"With", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{"tointeg", " ", "=", " ", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"trapconcfunc", "[", 
                    RowBox[{"#", ",", "att", ",", "ti"}], "]"}]}], "}"}], 
                    "&"}], ",", "grd"}], "]"}]}], "\[IndentingNewLine]", 
                 "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"ShowStatus", "[", 
                  RowBox[{"\"\<trapconcfunc @ti = \>\"", "<>", 
                   RowBox[{"ToString", "[", "ti", "]"}], "<>", 
                   "\"\< @ t = \>\"", "<>", 
                   RowBox[{"ToString", "[", 
                    RowBox[{"N", "[", "att", "]"}], "]"}]}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ListIntegrate", "[", "tointeg", "]"}]}]}], 
               "\[IndentingNewLine]", "]"}], ",", " ", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Module", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"tointeg", " ", "=", " ", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"totretfunc", "[", 
                    RowBox[{"#", ",", "att"}], "]"}]}], "}"}], "&"}], ",", 
                   "grd"}], "]"}]}], ",", "\[IndentingNewLine]", "integres"}],
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"integres", "=", 
                RowBox[{"ListIntegrate", "[", "tointeg", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"ShowStatus", "[", 
                RowBox[{"\"\<totretfunc @ t = \>\"", "<>", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"N", "[", "att", "]"}], "]"}], "<>", "\"\< = \>\"", 
                 "<>", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"InputForm", "[", "integres", "]"}], "]"}]}], "]"}],
                ";", "\[IndentingNewLine]", "integres"}]}], 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], 
          "\[IndentingNewLine]", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"att", ",", "times"}], "}"}]}], "\[IndentingNewLine]", 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"toplot", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Part", "[", 
            RowBox[{"#", ",", "1"}], "]"}], ",", 
           RowBox[{"Part", "[", 
            RowBox[{"#", ",", "3"}], "]"}]}], "}"}], "&"}], ",", "retval"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"plotfun", "[", 
       RowBox[{"toplot", ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Time (sec)\>\"", ",", "\"\<solute retention in #/um^2\>\""}], 
          "}"}]}], ",", 
        RowBox[{"PlotRange", "->", "pltrng"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"toplot", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Part", "[", 
            RowBox[{"#", ",", "2"}], "]"}], ",", 
           RowBox[{"Part", "[", 
            RowBox[{"#", ",", "3"}], "]"}]}], "}"}], "&"}], ",", "retval"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"plotfun", "[", 
       RowBox[{"toplot", ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Fluence in #/um^2\>\"", ",", 
           "\"\<solute retention in #/um^2\>\""}], "}"}]}], ",", 
        RowBox[{"PlotRange", "->", "pltrng"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Module", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "{", "\[IndentingNewLine]", "ltoplot", "\[IndentingNewLine]", "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ltoplot", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Part", "[", 
                 RowBox[{"#", ",", "1"}], "]"}], ",", 
                RowBox[{"Part", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"3", "+", "ti"}]}], "]"}]}], "}"}], "&"}], ",", 
             "retval"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"plotfun", "[", 
            RowBox[{"ltoplot", ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"AxesLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"\"\<Time (sec)\>\"", ",", 
                RowBox[{"\"\<retention in trap #\>\"", "<>", 
                 RowBox[{"ToString", "[", "ti", "]"}], "<>", 
                 "\"\< #/um^2\>\""}]}], "}"}]}], ",", 
             RowBox[{"PlotRange", "->", "pltrng"}]}], "]"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ltoplot", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Part", "[", 
                 RowBox[{"#", ",", "2"}], "]"}], ",", 
                RowBox[{"Part", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"3", "+", "ti"}]}], "]"}]}], "}"}], "&"}], ",", 
             "retval"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"plotfun", "[", 
            RowBox[{"ltoplot", ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"AxesLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"\"\<Fluence in #/um^2\>\"", ",", 
                RowBox[{"\"\<retention in trap #\>\"", "<>", 
                 RowBox[{"ToString", "[", "ti", "]"}], "<>", 
                 "\"\< #/um^2\>\""}]}], "}"}]}], ",", 
             RowBox[{"PlotRange", "->", "pltrng"}]}], "]"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"toplot", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Part", "[", 
            RowBox[{"#", ",", "1"}], "]"}], ",", 
           RowBox[{
            RowBox[{"Last", "[", "#", "]"}], "*", 
            SuperscriptBox["tolenscale", "2"]}]}], "}"}], "&"}], ",", 
        "retval"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"plotfun", "[", 
       RowBox[{"toplot", ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Time (sec)\>\"", ",", "\"\<TOTAL retention in #/m^2\>\""}], 
          "}"}]}], ",", 
        RowBox[{"PlotRange", "->", "pltrng"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"toplot", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{"#", ",", "2"}], "]"}], "*", 
            SuperscriptBox["tolenscale", "2"]}], ",", 
           RowBox[{
            RowBox[{"Last", "[", "#", "]"}], "*", 
            SuperscriptBox["tolenscale", "2"]}]}], "}"}], "&"}], ",", 
        "retval"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"plotfun", "[", 
       RowBox[{"toplot", ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Fluence in #/m^2\>\"", ",", 
           "\"\<TOTAL retention in #/m^2\>\""}], "}"}]}], ",", 
        RowBox[{"PlotRange", "->", "pltrng"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "retval", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"PFun", ",", "dt"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "PlotTES", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"PFun", "\[Rule]", "ListPlot"}], ",", 
     RowBox[{"tfrom", "\[Rule]", "0"}], ",", 
     RowBox[{"dt", "\[Rule]", "1"}], ",", 
     RowBox[{"ATTIMES", "\[Rule]", "None"}], ",", 
     RowBox[{"NumFronBack", "\[Rule]", "100"}], ",", 
     RowBox[{"DoTotInteg", "\[Rule]", "True"}], ",", 
     RowBox[{"USEFD", "\[Rule]", "False"}], ",", " ", 
     RowBox[{"DONORM", "\[Rule]", "False"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotTES", "[", 
   RowBox[{"sol_", ",", "tmax_", ",", "tempfunc_", ",", "grd_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"textstyle", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
         RowBox[{"FontSize", "\[Rule]", "28"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"numtrap", "=", 
       RowBox[{"GetNumTraps", "[", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"attimes", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "ATTIMES", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"plotfun", "=", 
       RowBox[{"OptionValue", "[", "PFun", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"donorm", "=", 
       RowBox[{"OptionValue", "[", "DONORM", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"pltrng", " ", "=", 
       RowBox[{"OptionValue", "[", "PlotRange", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"tstep", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "dt", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"t0", "=", 
       RowBox[{"OptionValue", "[", "tfrom", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"numstep", "=", " ", 
       RowBox[{"OptionValue", "[", "NumFronBack", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"usefd", "=", " ", 
       RowBox[{"OptionValue", "[", "USEFD", "]"}]}], ",", 
      "\[IndentingNewLine]", "retention", ",", "\[IndentingNewLine]", 
      RowBox[{"xmax", " ", "=", "  ", 
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"pTgtThick", "*", "tolenscale"}], ")"}], "/.", 
         "InputParam"}], "]"}]}], ",", "\[IndentingNewLine]", "cntr", ",", 
      "\[IndentingNewLine]", "tvalgrid", ",", "\[IndentingNewLine]", 
      "tempvalgrid", ",", "\[IndentingNewLine]", "todens", " ", ",", 
      "\[IndentingNewLine]", "tesflux", ",", "\[IndentingNewLine]", 
      "tesolflux", ",", "\[IndentingNewLine]", "testrapflux", ",", 
      "\[IndentingNewLine]", "func0", ",", "\[IndentingNewLine]", "functmax", 
      ",", "\[IndentingNewLine]", "func", ",", "\[IndentingNewLine]", 
      "solfunc", ",", "\[IndentingNewLine]", "trapfuncs", ",", 
      "\[IndentingNewLine]", "totretnorm", ",", "\[IndentingNewLine]", 
      "totretnormtmax", ",", "\[IndentingNewLine]", "retrescale", ",", 
      "\[IndentingNewLine]", "nstep", ",", 
      StyleBox["\[IndentingNewLine]",
       FontWeight->"Plain"], "fluxes", ",", "\[IndentingNewLine]", 
      RowBox[{"DoInteg", "=", 
       RowBox[{"OptionValue", "[", "DoTotInteg", "]"}]}], ",", 
      "\[IndentingNewLine]", "totretfromgrad", ",", "\[IndentingNewLine]", 
      "derivative", ",", "\[IndentingNewLine]", "DofToft", ",", 
      "\[IndentingNewLine]", "totdata", ",", "soldata", ",", "trapdata"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nstep", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<Building time evolution of retention with time step dt = \>\"", 
       ",", " ", "tstep", ",", " ", "\"\< resulting in \>\"", ",", "nstep", 
       ",", " ", "\"\< steps\>\""}], " ", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"DateString", "[", 
       RowBox[{"{", 
        RowBox[{
        "\"\<DayName\>\"", ",", " ", "\"\<  \>\"", ",", "\"\<Month\>\"", ",", 
         "\"\</\>\"", ",", "\"\<YearShort\>\"", ",", "\"\<-> \>\"", ",", 
         "\"\<Hour\>\"", ",", "\"\<:\>\"", ",", "\"\<Minute\>\"", ",", 
         "\"\<:\>\"", ",", "\"\<Second\>\""}], "}"}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cntr", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"todens", " ", "=", " ", 
      RowBox[{
       FractionBox["prohW", 
        SuperscriptBox["tolenscale", "3"]], "/.", "InputParam"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tvalgrid", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"TrueQ", "[", 
          RowBox[{"(", 
           RowBox[{"tstep", ">", "0"}], ")"}], "]"}], "&&", 
         RowBox[{"TrueQ", "[", 
          RowBox[{"(", 
           RowBox[{"attimes", "\[Equal]", "None"}], ")"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Generating times based on number of time steps\>\"", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"nstep", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"tmax", "-", "t0"}], ")"}], "/", "tstep"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{"t", ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "t0", ",", "tmax", ",", "tstep"}], "}"}]}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"TrueQ", "[", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Head", "[", "attimes", "]"}], "\[Equal]", "List"}], 
             ")"}], "]"}], "&&", 
           RowBox[{"TrueQ", "[", 
            RowBox[{
             RowBox[{"Depth", "[", "attimes", "]"}], "\[Equal]", "2"}], 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<Using times from supplied time steps\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"nstep", " ", "=", " ", 
            RowBox[{"Length", "[", "attimes", "]"}]}], ";", 
           "\[IndentingNewLine]", "attimes"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<Invalid time stepping->Abort\>\"", "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tempvalgrid", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"tempfunc", "[", 
         RowBox[{"0", ",", "t"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "tvalgrid"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"func", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"csol", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "+", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Subscript", "[", 
               RowBox[{"ctrp", ",", "ti"}], "]"}], "[", 
              RowBox[{"x", ",", "t"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}]}], 
          ")"}], "*", "todens"}], ")"}], "/.", "sol"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"func0", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"csol", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "+", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Subscript", "[", 
                RowBox[{"ctrp", ",", "ti"}], "]"}], "[", 
               RowBox[{"x", ",", "t"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}]}], 
           ")"}], "*", "todens"}], ")"}], "/.", "sol"}], "/.", 
       RowBox[{"t", "\[Rule]", "t0"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"functmax", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"csol", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "+", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Subscript", "[", 
                RowBox[{"ctrp", ",", "ti"}], "]"}], "[", 
               RowBox[{"x", ",", "t"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}]}], 
           ")"}], "*", "todens"}], ")"}], "/.", "sol"}], "/.", 
       RowBox[{"t", "\[Rule]", "tmax"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"solfunc", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"csol", "[", 
         RowBox[{"x", ",", "t"}], "]"}], "*", "todens"}], "/.", "sol"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"derivative", "=", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ff", " ", "=", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"csol", "/.", "sol"}], "]"}]}], "}"}], ",", " ", 
        RowBox[{
         RowBox[{"Derivative", "[", 
          RowBox[{"1", ",", "0"}], "]"}], "[", "ff", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"trapfuncs", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Subscript", "[", 
            RowBox[{"ctrp", ",", "ti"}], "]"}], "[", 
           RowBox[{"x", ",", "t"}], "]"}], "*", "todens"}], ",", 
         RowBox[{"{", 
          RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}], "/.", 
       "sol"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"totretnorm", "=", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"data", "=", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", ",", "func0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "grd"}], "}"}]}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"ListIntegrate", "[", "data", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<Total retention@\>\"", ",", "t0", ",", "\"\<=: \>\"", ",", " ", 
       "totretnorm", ",", " ", "\"\<D/um^2\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"totretnormtmax", "=", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"data", "=", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", ",", "functmax"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "grd"}], "}"}]}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"ListIntegrate", "[", "data", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<Total retention@\>\"", ",", "tmax", ",", "\"\<=: \>\"", ",", " ", 
       "totretnormtmax", ",", " ", "\"\<D/um^2\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "[", "DoInteg", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PrintTemporary", "[", 
         RowBox[{"ProgressIndicator", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "cntr", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "nstep"}], "}"}]}], "]"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"BroadCast", "[", 
           RowBox[{
           "LintM", ",", "func", ",", "solfunc", ",", "trapfuncs", ",", 
            "numtrap", ",", "grd", ",", "tmax", ",", "tstep", ",", "tvalgrid",
             ",", "cntr"}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"SetSharedVariable", "[", "cntr", "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Integrating from \>\"", ",", " ", 
          RowBox[{"First", "[", "tvalgrid", "]"}], ",", " ", "\"\< to \>\"", 
          ",", " ", 
          RowBox[{"Last", "[", "tvalgrid", "]"}], ",", " ", "\"\< with \>\"", 
          ",", " ", 
          RowBox[{"Length", "[", "tvalgrid", "]"}], ",", "\"\< steps\>\""}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"retention", " ", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"cntr", "++"}], ";", "\[IndentingNewLine]", 
            RowBox[{"ShowStatus", "[", 
             RowBox[{"\"\<Step \>\"", "<>", 
              RowBox[{"ToString", "[", "cntr", "]"}], "<>", "\"\< of \>\"", "<>", 
              RowBox[{"ToString", "[", "nstep", "]"}], "<>", 
              "\"\< steps\>\""}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"PrintTemporary", "[", 
               RowBox[{"\"\<t = \>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{"InputForm", "[", "t", "]"}], "]"}]}], "]"}], ";"}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"totdata", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "func"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "grd"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"soldata", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "solfunc"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "grd"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"trapdata", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"trapfuncs", "[", 
                  RowBox[{"[", "ti", "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "grd"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"LintM", "[", "totdata", "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"LintM", "[", "soldata", "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"LintM", "[", 
                  RowBox[{"trapdata", "[", 
                   RowBox[{"[", "ti", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}]}], 
              "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", "]"}]}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "tvalgrid"}], "}"}]}], "\[IndentingNewLine]", 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tesflux", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"NDSolve`FiniteDifferenceDerivative", "[", 
            RowBox[{
             RowBox[{"Derivative", "[", "1", "]"}], ",", "tvalgrid", ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Part", "[", 
                 RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", "retention"}], 
              "]"}]}], "]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tesolflux", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"NDSolve`FiniteDifferenceDerivative", "[", 
            RowBox[{
             RowBox[{"Derivative", "[", "1", "]"}], ",", "tvalgrid", ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Part", "[", 
                 RowBox[{"#", ",", "2"}], "]"}], "&"}], ",", "retention"}], 
              "]"}]}], "]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"testrapflux", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{"NDSolve`FiniteDifferenceDerivative", "[", 
              RowBox[{
               RowBox[{"Derivative", "[", "1", "]"}], ",", "tvalgrid", ",", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Part", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"2", "+", "ti"}]}], "]"}], "&"}], ",", 
                 "retention"}], "]"}]}], "]"}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"retrescale", "=", 
         RowBox[{"N", "[", 
          RowBox[{"totretnorm", "/", 
           RowBox[{"ListIntegrate", "[", 
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"tvalgrid", ",", "tesflux"}], "}"}], "]"}], "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tesflux", "*=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"TrueQ", "[", "donorm", "]"}], ",", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<Normalizing TES fluxes to total retention by \>\"", ",", 
              "retrescale"}], " ", "]"}], ";", "retrescale"}], ",", "1.0"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"plotfun", "[", 
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"tvalgrid", ",", "tesflux"}], "}"}], "]"}], ",", 
           RowBox[{"Joined", "\[Rule]", "True"}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Time in s\>\"", ",", "\"\<TES flux in #/um^2 s\>\""}], 
             "}"}]}], ",", 
           RowBox[{"PlotRange", "->", "pltrng"}]}], "]"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"plotfun", "[", 
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"tvalgrid", ",", "tesflux"}], "}"}], "]"}], ",", 
           RowBox[{"Joined", "\[Rule]", "True"}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Time in s\>\"", ",", "\"\<TES flux in #/um^2 s\>\""}], 
             "}"}]}], ",", 
           RowBox[{"PlotRange", "->", "pltrng"}]}], "]"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"plotfun", "[", 
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"tvalgrid", ",", "tesolflux"}], "}"}], "]"}], ",", 
           RowBox[{"Joined", "\[Rule]", "True"}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Time in s\>\"", ",", 
              "\"\<Solute TES flux in #/um^2 s\>\""}], "}"}]}], ",", 
           RowBox[{"PlotRange", "->", "pltrng"}]}], "]"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"ii", "=", "1"}], ",", 
          RowBox[{"ii", "\[LessEqual]", "numtrap"}], ",", 
          RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"plotfun", "[", 
             RowBox[{
              RowBox[{"Thread", "[", 
               RowBox[{"{", 
                RowBox[{"tvalgrid", ",", 
                 RowBox[{"testrapflux", "[", 
                  RowBox[{"[", "ii", "]"}], "]"}]}], "}"}], "]"}], ",", 
              RowBox[{"Joined", "\[Rule]", "True"}], ",", 
              RowBox[{"AxesLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<Time in s\>\"", ",", 
                 RowBox[{"\"\<Trap\>\"", "<>", 
                  RowBox[{"ToString", "[", "ii", "]"}], "<>", 
                  "\"\< TES flux in #/um^2 s\>\""}]}], "}"}]}], ",", 
              RowBox[{"PlotRange", "->", "pltrng"}]}], "]"}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<No integral based TES signals requested->Producing dummy \
retention integrals\>\"", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"retention", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", 
              RowBox[{"-", "1"}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"-", "2"}], ",", 
                RowBox[{"{", 
                 RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}]}], 
             "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "tvalgrid"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tesflux", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"NDSolve`FiniteDifferenceDerivative", "[", 
            RowBox[{
             RowBox[{"Derivative", "[", "1", "]"}], ",", "tvalgrid", ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Part", "[", 
                 RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", "retention"}], 
              "]"}]}], "]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tesolflux", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"NDSolve`FiniteDifferenceDerivative", "[", 
            RowBox[{
             RowBox[{"Derivative", "[", "1", "]"}], ",", "tvalgrid", ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Part", "[", 
                 RowBox[{"#", ",", "2"}], "]"}], "&"}], ",", "retention"}], 
              "]"}]}], "]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"testrapflux", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{"NDSolve`FiniteDifferenceDerivative", "[", 
              RowBox[{
               RowBox[{"Derivative", "[", "1", "]"}], ",", "tvalgrid", ",", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Part", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"2", "+", "ti"}]}], "]"}], "&"}], ",", 
                 "retention"}], "]"}]}], "]"}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}]}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", "\"\<Distinguishing between front and back fluxes\>\"", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"cntr", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"PrintTemporary", "[", 
      RowBox[{"ProgressIndicator", "[", 
       RowBox[{
        RowBox[{"Dynamic", "[", "cntr", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Length", "[", "tvalgrid", "]"}]}], "}"}]}], "]"}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"numstep", "=", "100"}], ";", "\[IndentingNewLine]", 
     RowBox[{"DofToft", "=", 
      RowBox[{"DofTempFunc", "[", "tempfunc", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fluxes", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"TrueQ", "[", "usefd", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Using finite differences to determine front & back fluxes\>\"",
           "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Module", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
            "frontgrd", ",", "\[IndentingNewLine]", "backgrd", ",", 
             "\[IndentingNewLine]", 
             RowBox[{"grdlen", "=", 
              RowBox[{"Length", "[", "grd", "]"}]}]}], "\[IndentingNewLine]", 
            "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"frontgrd", "=", 
             RowBox[{"Part", "[", 
              RowBox[{"grd", ",", 
               RowBox[{"1", ";;", "100"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"backgrd", "=", 
             RowBox[{"Part", "[", 
              RowBox[{"grd", ",", 
               RowBox[{
                RowBox[{"grdlen", "-", "100"}], ";;", "grdlen"}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"cntr", "++"}], ";", "\[IndentingNewLine]", 
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"frontprof", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{"solfunc", ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "frontgrd"}], "}"}]}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"backprof", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{"solfunc", ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "backgrd"}], "}"}]}], "]"}]}]}], 
                  "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", " ", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"DofToft", "*", 
                    RowBox[{"First", "[", 
                    RowBox[{"NDSolve`FiniteDifferenceDerivative", "[", 
                    RowBox[{
                    RowBox[{"Derivative", "[", "1", "]"}], ",", "frontgrd", 
                    ",", "frontprof", ",", 
                    RowBox[{"\"\<DifferenceOrder\>\"", "\[Rule]", "7"}]}], 
                    "]"}], "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"-", " ", "DofToft"}], "*", 
                    RowBox[{"Last", "[", 
                    RowBox[{"NDSolve`FiniteDifferenceDerivative", "[", 
                    RowBox[{
                    RowBox[{"Derivative", "[", "1", "]"}], ",", "backgrd", 
                    ",", "backprof", ",", 
                    RowBox[{"\"\<DifferenceOrder\>\"", "\[Rule]", "7"}]}], 
                    "]"}], "]"}]}]}], "\[IndentingNewLine]", "}"}]}], 
                "\[IndentingNewLine]", "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", "tvalgrid"}], "}"}]}], "\[IndentingNewLine]",
              "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Applying Derivative[1,0] to interpolating function objects for \
front & back fluxes\>\"", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"cntr", "++"}], ";", "\[IndentingNewLine]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"todens", "*", "DofToft", "*", 
               RowBox[{"derivative", "[", 
                RowBox[{
                 RowBox[{"Part", "[", 
                  RowBox[{"grd", ",", "1"}], "]"}], ",", "t"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"-", "todens"}], "*", "DofToft", "*", 
               RowBox[{"derivative", "[", 
                RowBox[{
                 RowBox[{"Part", "[", 
                  RowBox[{"grd", ",", 
                   RowBox[{"-", "1"}]}], "]"}], ",", "t"}], "]"}]}]}], 
             "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"t", ",", "tvalgrid"}], "}"}]}], "\[IndentingNewLine]", 
          "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"plotfun", "[", 
       RowBox[{
        RowBox[{"Evaluate", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"tempvalgrid", ",", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Part", "[", 
                  RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", "fluxes"}], 
               "]"}]}], "}"}], "]"}], ",", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"tempvalgrid", ",", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Part", "[", 
                  RowBox[{"#", ",", "2"}], "]"}], "&"}], ",", "fluxes"}], 
               "]"}]}], "}"}], "]"}], ",", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"tempvalgrid", ",", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Part", "[", 
                   RowBox[{"#", ",", "1"}], "]"}], "+", 
                  RowBox[{"Part", "[", 
                   RowBox[{"#", ",", "2"}], "]"}]}], "&"}], ",", "fluxes"}], 
               "]"}]}], "}"}], "]"}]}], "}"}], "]"}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Temperature in K\>\"", ",", 
           "\"\<Solute TES flux in #/um^2 s\>\""}], "}"}]}], ",", 
        RowBox[{"PlotRange", "->", "pltrng"}], ",", 
        RowBox[{"PlotLegend", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Front\>\"", ",", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
             RowBox[{"FontSize", "\[Rule]", "28"}]}], "]"}], ",", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Back\>\"", ",", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
             RowBox[{"FontSize", "\[Rule]", "28"}]}], "]"}], ",", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Total\>\"", ",", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
             RowBox[{"FontSize", "\[Rule]", "28"}]}], "]"}]}], "}"}]}], " ", 
        ",", 
        RowBox[{"LegendPosition", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1.1", ",", 
           RowBox[{"-", "0.4"}]}], "}"}]}], ",", 
        RowBox[{"LegendShadow", "\[Rule]", "None"}], ",", 
        RowBox[{"BaseStyle", "\[Rule]", "textstyle"}], ",", 
        RowBox[{"LabelStyle", "->", "textstyle"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"plotfun", "[", 
       RowBox[{
        RowBox[{"Evaluate", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"tvalgrid", ",", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Part", "[", 
                  RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", "fluxes"}], 
               "]"}]}], "}"}], "]"}], ",", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"tvalgrid", ",", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Part", "[", 
                  RowBox[{"#", ",", "2"}], "]"}], "&"}], ",", "fluxes"}], 
               "]"}]}], "}"}], "]"}], ",", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"tvalgrid", ",", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Part", "[", 
                   RowBox[{"#", ",", "1"}], "]"}], "+", 
                  RowBox[{"Part", "[", 
                   RowBox[{"#", ",", "2"}], "]"}]}], "&"}], ",", "fluxes"}], 
               "]"}]}], "}"}], "]"}]}], "}"}], "]"}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Time in sec.\>\"", ",", 
           "\"\<Solute TES flux in #/um^2 s\>\""}], "}"}]}], ",", 
        RowBox[{"PlotRange", "->", "pltrng"}], ",", 
        RowBox[{"PlotLegend", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Front\>\"", ",", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
             RowBox[{"FontSize", "\[Rule]", "28"}]}], "]"}], ",", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Back\>\"", ",", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
             RowBox[{"FontSize", "\[Rule]", "28"}]}], "]"}], ",", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Total\>\"", ",", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
             RowBox[{"FontSize", "\[Rule]", "28"}]}], "]"}]}], "}"}]}], " ", 
        ",", 
        RowBox[{"LegendPosition", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1.1", ",", 
           RowBox[{"-", "0.4"}]}], "}"}]}], ",", 
        RowBox[{"LegendShadow", "\[Rule]", "None"}], ",", 
        RowBox[{"BaseStyle", "\[Rule]", "textstyle"}], ",", 
        RowBox[{"LabelStyle", "->", "textstyle"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"totretfromgrad", "=", 
      RowBox[{"ListIntegrate", "[", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"tvalgrid", ",", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{"#", ",", "1"}], "]"}], "+", 
              RowBox[{"Part", "[", 
               RowBox[{"#", ",", "2"}], "]"}]}], "&"}], ",", "fluxes"}], 
           "]"}]}], "}"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Total retention / TES-Flux based retention  = \>\"", ",", 
       RowBox[{"N", "[", 
        RowBox[{"totretnorm", "/", "totretfromgrad"}], "]"}], ",", " ", 
       "\"\< (Should be close to 1)\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"RETVSTIME", "->", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{"tvalgrid", ",", "retention"}], "}"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"RETSCALE", "->", "retrescale"}], ",", "\[IndentingNewLine]", 
       RowBox[{"TESFLUXVSTIME", "->", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{"tvalgrid", ",", "tesflux"}], "}"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TESFLUXVSTEMP", "->", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{"tempvalgrid", ",", "tesflux"}], "}"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TESOLFLUXVSTEMP", "->", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{"tempvalgrid", ",", "tesolflux"}], "}"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TESTRAPFLUXVSTEMP", "\[Rule]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"tempvalgrid", ",", 
             RowBox[{"testrapflux", "[", 
              RowBox[{"[", "ti", "]"}], "]"}]}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TESFRONTFLUXVSTEMP", "\[Rule]", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{"tempvalgrid", ",", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", "fluxes"}], 
            "]"}]}], "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"TESBACKFLUXVSTEMP", "\[Rule]", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{"tempvalgrid", ",", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{"#", ",", "2"}], "]"}], "&"}], ",", "fluxes"}], 
            "]"}]}], "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"TESFRONTFLUXVSTIME", "\[Rule]", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{"tvalgrid", ",", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", "fluxes"}], 
            "]"}]}], "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"TESBACKFLUXVSTIME", "\[Rule]", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{"tvalgrid", ",", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{"#", ",", "2"}], "]"}], "&"}], ",", "fluxes"}], 
            "]"}]}], "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"FLUXFUNC", "\[Rule]", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", "t", "}"}], ",", 
          RowBox[{
           RowBox[{"-", "todens"}], "*", "DofToft", "*", 
           RowBox[{"derivative", "[", 
            RowBox[{"0", ",", "t"}], "]"}]}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "PlotTrapRate", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"PFun", "\[Rule]", "LogPlot"}], ",", 
     RowBox[{"NumTime", "\[Rule]", "10"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotTrapRate", "[", 
   RowBox[{"eqn_", ",", "sol_", ",", "tmax_", ",", "tgtthick_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"textstyle", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
         RowBox[{"FontSize", "\[Rule]", "28"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"numtrap", "=", 
       RowBox[{"GetNumTraps", "[", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"plotfun", "=", 
       RowBox[{"OptionValue", "[", "PFun", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"pltrng", " ", "=", 
       RowBox[{"OptionValue", "[", "PlotRange", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ntime", "=", 
       RowBox[{"OptionValue", "[", "NumTime", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"traprate", "=", 
       RowBox[{
        RowBox[{"TRAPRATES", "/.", "eqn"}], "/.", "sol"}]}], ",", 
      "\[IndentingNewLine]", "legend"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"legend", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ToString", "[", "ti", "]"}], "<>", "\"\<@ \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"N", "[", "t", "]"}], "]"}], "<>", "\"\< s\>\""}], ",", 
         RowBox[{"{", 
          RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "tmax", ",", 
           FractionBox["tmax", "ntime"]}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"plotfun", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"traprate", "[", 
             RowBox[{"[", "ti", "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "tmax", ",", 
             FractionBox["tmax", "ntime"]}], "}"}]}], "]"}], "]"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "tgtthick"}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "pltrng"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotStyle", "\[Rule]", "Thick"}], ",", 
       RowBox[{"PlotLegend", "\[Rule]", "legend"}], " ", ",", 
       RowBox[{"LegendPosition", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1.1", ",", 
          RowBox[{"-", "0.4"}]}], "}"}]}], ",", 
       RowBox[{"LegendShadow", "\[Rule]", "None"}], ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<Depth (\[Mu]m)\>\"", ",", "\"\<ABS(Traprate)\>\""}], 
         "}"}]}], ",", 
       RowBox[{"BaseStyle", "\[Rule]", "textstyle"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ExportSrcOnGrid", "]"}], " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"FirstGridIDX", "\[Rule]", "1"}], ",", 
     RowBox[{"NumGridSteps", "\[Rule]", "20"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExportSrcOnGrid", "[", 
    RowBox[{"Eqn_", ",", "Grid_", ",", "FName_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ff", "=", 
        RowBox[{"Evaluate", "[", " ", 
         RowBox[{"IMPLRATE", "/.", "Eqn"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "ifunc", ",", "\[IndentingNewLine]", 
       RowBox[{"FirstGrdIdx", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "FirstGridIDX", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"NumGrdPt", "=", 
        RowBox[{"OptionValue", "[", "NumGridSteps", "]"}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ifunc", " ", "=", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", "xloc", "}"}], ",", 
         RowBox[{"ff", "/.", 
          RowBox[{"x", "\[Rule]", "xloc"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<ff: \>\"", ",", " ", "ff", ",", " ", "\"\< ifunc: \>\"", ",", 
        "ifunc"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"FName", ",", 
        RowBox[{"N", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"Grid", ",", "i"}], "]"}], ",", 
             RowBox[{"ifunc", "[", 
              RowBox[{"Part", "[", 
               RowBox[{"Grid", ",", "i"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "FirstGrdIdx", ",", " ", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"FirstGrdIdx", "+", "NumGrdPt"}], ",", 
               RowBox[{"Length", "[", "Grid", "]"}]}], "]"}]}], "}"}]}], 
          "]"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ExportToDepthSampling", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"SELREQVAR", "\[Rule]", "None"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExportToDepthSampling", "[", 
   RowBox[{
   "outfname_", ",", " ", "layerfile_", ",", " ", "sol_", ",", " ", "eqn_", 
    ",", " ", "grd_", ",", "att_", ",", "inp_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"selrequvar", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "SELREQVAR", "]"}]}], ",", 
      "\[IndentingNewLine]", "selidx", ",", "\[IndentingNewLine]", 
      RowBox[{"reqvar", " ", "=", " ", 
       RowBox[{"VARS", "/.", "eqn"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"curdepth", " ", "=", " ", "0"}], ",", "\[IndentingNewLine]", 
      RowBox[{"maxdepth", " ", "=", 
       RowBox[{"Last", "[", "grd", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"rohw", "=", 
       FractionBox[
        RowBox[{"prohW", "/.", "inp"}], 
        SuperscriptBox["tolenscale", "3"]]}], ",", "\[IndentingNewLine]", 
      "totconc", ",", "\[IndentingNewLine]", "layers", ",", 
      "\[IndentingNewLine]", "adenslayers", ",", "\[IndentingNewLine]", 
      "depth", ",", "\[IndentingNewLine]", "adensdiffspec", ",", 
      "\[IndentingNewLine]", "adensbulk", ",", "\[IndentingNewLine]", "nradp",
       ",", "\[IndentingNewLine]", "ii"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"selidx", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"TrueQ", "[", 
         RowBox[{
          RowBox[{"Head", "[", "selrequvar", "]"}], "\[Equal]", "List"}], 
         "]"}], ",", "selrequvar", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"ii", ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", 
            RowBox[{"Length", "[", "reqvar", "]"}]}], "}"}]}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Selected concentrations: \>\"", ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"reqvar", ",", "ii"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "selidx"}], "}"}]}], "]"}]}], " ", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"adenslayers", " ", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Transpose", "[", 
        RowBox[{"Import", "[", "layerfile", "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"layers", " ", "=", " ", 
      RowBox[{"adenslayers", "*", 
       RowBox[{
        FractionBox["1*^19", 
         SuperscriptBox["tolenscale", "2"]], "/", "rohw"}]}]}], ";", 
     RowBox[{"(*", "um", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"depth", " ", "=", " ", 
      RowBox[{
       RowBox[{"Accumulate", "[", "layers", "]"}], "-", 
       RowBox[{"First", "[", "layers", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"depth", " ", "=", " ", 
      RowBox[{"Select", "[", 
       RowBox[{"depth", ",", 
        RowBox[{
         RowBox[{"#", "<", 
          RowBox[{"Last", "[", "Grd", "]"}]}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"depth", "=", 
      RowBox[{"Append", "[", 
       RowBox[{"depth", ",", 
        RowBox[{"Last", "[", "Grd", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", "x", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"totconc", "=", 
      RowBox[{"rohw", "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{"reqvar", ",", "ii"}], "]"}], "/.", "sol"}], ")"}], "[", 
          RowBox[{"x", ",", "att"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "selidx"}], "}"}]}], "]"}]}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"#", "/", 
       RowBox[{"um", "^", "3"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Integrating \>\"", ",", 
       RowBox[{"Length", "[", "depth", "]"}], ",", "\"\< steps\>\""}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"ii", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"BroadCast", "[", 
      RowBox[{"totconc", ",", "depth"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"SetSharedVariable", "[", "ii", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"adensdiffspec", "=", 
      RowBox[{"TableParallel", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"PrintTemporary", "[", 
          RowBox[{"\"\<ii: \>\"", "<>", 
           RowBox[{"ToString", "[", "ii", "]"}]}], "]"}], ";", 
         RowBox[{"NIntegrate", "[", 
          RowBox[{"totconc", ",", " ", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"Part", "[", 
              RowBox[{"depth", ",", 
               RowBox[{"ii", "-", "1"}]}], "]"}], ",", 
             RowBox[{"Part", "[", 
              RowBox[{"depth", ",", "ii"}], "]"}]}], "}"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "2", ",", 
          RowBox[{"Length", "[", "depth", "]"}]}], "}"}]}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"#", "/", 
       RowBox[{"um", "^", "2"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"adensbulk", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"PrintTemporary", "[", 
          RowBox[{"\"\<ii: \>\"", "<>", 
           RowBox[{"ToString", "[", "ii", "]"}]}], "]"}], ";", 
         RowBox[{"rohw", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{"depth", ",", "ii"}], "]"}], "-", 
            RowBox[{"Part", "[", 
             RowBox[{"depth", ",", 
              RowBox[{"ii", "-", "1"}]}], "]"}]}], ")"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "2", ",", 
          RowBox[{"Length", "[", "depth", "]"}]}], "}"}]}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"#", "/", 
       RowBox[{"um", "^", "2"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"nradp", "=", 
      RowBox[{"Thread", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Differences", "[", "depth", "]"}], "*", "rohw"}], ",", 
         RowBox[{"adensdiffspec", "/", "adensbulk"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nradp", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"#", ",", "1"}], "]"}], "*", 
             SuperscriptBox["tolenscale", "2"], "*", "1*^-4"}], "1*^15"], ",", 
           RowBox[{"Max", "[", 
            RowBox[{"0", ",", " ", 
             RowBox[{"Part", "[", 
              RowBox[{"#", ",", "2"}], "]"}]}], "]"}]}], "}"}], "&"}], ",", 
        "nradp"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"outfname", ",", "nradp", ",", "\"\<Table\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", "nradp"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5046051562407646`*^9, 3.504605324404548*^9}, {
   3.5046055040844727`*^9, 3.504605557164975*^9}, {3.5046057177346687`*^9, 
   3.504605719500373*^9}, {3.504608920300012*^9, 3.504609002491194*^9}, {
   3.5046091874057283`*^9, 3.5046092186258764`*^9}, 3.5046092719876423`*^9, {
   3.5046093082080145`*^9, 3.504609308598657*^9}, {3.5046102067326417`*^9, 
   3.5046103483639865`*^9}, {3.5046104400712194`*^9, 3.504610616344742*^9}, {
   3.504610662534311*^9, 3.504610665690702*^9}, {3.5046107529446106`*^9, 
   3.504610759648036*^9}, {3.5046108114628572`*^9, 3.504610837479648*^9}, {
   3.504612010141556*^9, 3.5046120308612337`*^9}, {3.5046121054114485`*^9, 
   3.504612119458953*^9}, {3.504612370251438*^9, 3.5046124175348063`*^9}, {
   3.5046124849128246`*^9, 3.5046125533377647`*^9}, {3.504612803614602*^9, 
   3.5046128042083783`*^9}, {3.5046130215931168`*^9, 
   3.5046130535320473`*^9}, {3.504614446750711*^9, 3.5046144550167065`*^9}, 
   3.5046145134880753`*^9, {3.5048624344020996`*^9, 3.504862454038563*^9}, {
   3.504866325368088*^9, 3.504866408171322*^9}, {3.504866469301199*^9, 
   3.5048665483077717`*^9}, {3.504866717784886*^9, 3.5048667403151264`*^9}, {
   3.504866795828264*^9, 3.5048667960782533`*^9}, {3.5048669728609424`*^9, 
   3.504867001127472*^9}, {3.5048670470039396`*^9, 3.5048670682858706`*^9}, {
   3.504867417256978*^9, 3.5048674274450645`*^9}, {3.5048733885850964`*^9, 
   3.5048734046485214`*^9}, {3.504874929998977*^9, 3.5048749440153913`*^9}, {
   3.504875030645381*^9, 3.504875035676921*^9}, {3.504875968474566*^9, 
   3.504876085360361*^9}, {3.5048761253923798`*^9, 3.5048762648481827`*^9}, 
   3.504876326380614*^9, {3.5048763615062885`*^9, 3.5048763841946135`*^9}, {
   3.5048767575087795`*^9, 3.504876779853673*^9}, {3.504876886062236*^9, 
   3.5048768874060545`*^9}, {3.504876988176962*^9, 3.504877006678027*^9}, {
   3.504877098917715*^9, 3.5048771049336863`*^9}, 3.5048771374199324`*^9, {
   3.5048777922857757`*^9, 3.504877792488912*^9}, {3.5048781163981514`*^9, 
   3.5048781179449472`*^9}, {3.504930720218441*^9, 3.504930727171878*^9}, {
   3.5049307737364635`*^9, 3.504930779939866*^9}, {3.5049309334942417`*^9, 
   3.5049309984038153`*^9}, {3.5049310826893806`*^9, 3.504931118300578*^9}, {
   3.504931184757106*^9, 3.5049314357230797`*^9}, {3.5049336411797433`*^9, 
   3.50493364550809*^9}, {3.504933690354136*^9, 3.504933694166831*^9}, {
   3.504938064109307*^9, 3.504938065296807*^9}, {3.5049381219064274`*^9, 
   3.50493823419127*^9}, 3.50494542959657*^9, 3.5049460644446816`*^9, {
   3.5049462968226557`*^9, 3.5049463798873568`*^9}, {3.504946470624635*^9, 
   3.504946620566933*^9}, {3.5049466914138556`*^9, 3.5049467450881352`*^9}, {
   3.5049467760738983`*^9, 3.504946776230155*^9}, {3.5049468084816*^9, 
   3.50494686004641*^9}, {3.5049469249243436`*^9, 3.5049469770832644`*^9}, {
   3.504947050462021*^9, 3.504947053680936*^9}, {3.504947341570675*^9, 
   3.5049475389714065`*^9}, {3.5049475698011093`*^9, 
   3.5049475834268074`*^9}, {3.5049476316011486`*^9, 3.504947633304361*^9}, {
   3.5049476730251446`*^9, 3.5049476943074837`*^9}, {3.5049477824682474`*^9, 
   3.5049477933438044`*^9}, {3.5049478237828627`*^9, 
   3.5049478270642805`*^9}, {3.504947873613539*^9, 3.504947892458254*^9}, {
   3.5049479877287564`*^9, 3.5049480439972625`*^9}, {3.5049481527215786`*^9, 
   3.5049482211782084`*^9}, {3.5049482730871162`*^9, 3.504948286853446*^9}, {
   3.504948331105712*^9, 3.5049483389029856`*^9}, {3.5049486597162857`*^9, 
   3.5049486618257685`*^9}, {3.5049491250526094`*^9, 3.504949131287304*^9}, {
   3.504951123092404*^9, 3.5049511467186136`*^9}, {3.5049512198942347`*^9, 
   3.5049512265508256`*^9}, {3.504951991793129*^9, 3.5049520134817395`*^9}, {
   3.504952215335824*^9, 3.5049522656509*^9}, {3.5050391204615574`*^9, 
   3.5050391303526883`*^9}, {3.5050391622136946`*^9, 
   3.5050392096379976`*^9}, {3.505039252499567*^9, 3.5050393448480453`*^9}, {
   3.505039383381268*^9, 3.5050393849125967`*^9}, {3.5050407308096275`*^9, 
   3.5050407386381536`*^9}, {3.505040790890829*^9, 3.5050408102043176`*^9}, {
   3.505044421076685*^9, 3.5050445136126723`*^9}, {3.5050445514583597`*^9, 
   3.5050446567918777`*^9}, 3.505044705825638*^9, {3.5050447807200975`*^9, 
   3.5050447916425314`*^9}, {3.505044876318742*^9, 3.505044877412548*^9}, 
   3.505044915180106*^9, {3.5050450084192553`*^9, 3.505045008966158*^9}, {
   3.5050450422022347`*^9, 3.505045116940436*^9}, {3.5050464863542967`*^9, 
   3.5050465189340897`*^9}, {3.5051188709582233`*^9, 
   3.5051189624304857`*^9}, {3.5051190363399577`*^9, 
   3.5051192049725122`*^9}, {3.505119264475178*^9, 3.5051193079148254`*^9}, {
   3.5051193822623816`*^9, 3.505119386512599*^9}, {3.505119716560747*^9, 
   3.5051197595942*^9}, {3.5051198011432023`*^9, 3.5051199722925897`*^9}, {
   3.5051200071693754`*^9, 3.505120157333313*^9}, 3.5051226617271566`*^9, {
   3.5051308645846214`*^9, 3.505130878350951*^9}, {3.507373991770488*^9, 
   3.507374048085871*^9}, {3.5074319585673933`*^9, 3.507432079745472*^9}, {
   3.5074321145441284`*^9, 3.507432205626917*^9}, {3.5074322683957553`*^9, 
   3.507432359759808*^9}, {3.507432425091278*^9, 3.5074325921623316`*^9}, {
   3.507432739169858*^9, 3.507432756420741*^9}, 3.5074328020168257`*^9, {
   3.507432833190296*^9, 3.507432851769373*^9}, {3.5074329452272825`*^9, 
   3.507433008230508*^9}, {3.5074331035166364`*^9, 3.5074331057823772`*^9}, 
   3.5074331475657663`*^9, {3.5074332180381246`*^9, 3.5074332330545187`*^9}, {
   3.5074332916356425`*^9, 3.5074333191214247`*^9}, {3.5074333585140667`*^9, 
   3.507433390109434*^9}, {3.5074334378306274`*^9, 3.5074334509719253`*^9}, 
   3.507433497318048*^9, {3.5074335423828554`*^9, 3.5074335425078616`*^9}, {
   3.507433581384852*^9, 3.5074335954011946`*^9}, {3.5074336530447707`*^9, 
   3.507433709032012*^9}, {3.507433773488437*^9, 3.5074338065213785`*^9}, {
   3.507433837647972*^9, 3.507433856398932*^9}, {3.5074339523882217`*^9, 
   3.5074339536226597`*^9}, {3.507433988499445*^9, 3.507434043486635*^9}, {
   3.507434085254399*^9, 3.5074342086200895`*^9}, {3.50743424016858*^9, 
   3.5074342696700907`*^9}, {3.507436871872308*^9, 3.5074368855849996`*^9}, {
   3.507437053042268*^9, 3.5074371528303556`*^9}, {3.507437197590537*^9, 
   3.5074371992309628`*^9}, {3.5074372601454296`*^9, 3.507437279736797*^9}, {
   3.5074374267540197`*^9, 3.507437514174776*^9}, {3.5074380536829805`*^9, 
   3.5074380576987853`*^9}, {3.5074395190533576`*^9, 
   3.5074395656182413`*^9}, {3.507442166251387*^9, 3.5074423323380156`*^9}, {
   3.5074424046854696`*^9, 3.5074424067011976`*^9}, {3.5074424610633554`*^9, 
   3.507442569865801*^9}, {3.5074426203840127`*^9, 3.5074426520106316`*^9}, {
   3.507442692715841*^9, 3.5074427103104916`*^9}, {3.5074427462029543`*^9, 
   3.5074427500469007`*^9}, {3.5075177869457436`*^9, 
   3.5075178028996854`*^9}, {3.507517844573694*^9, 3.507517859902604*^9}, {
   3.5075186750537124`*^9, 3.5075186764600344`*^9}, {3.5075374511578636`*^9, 
   3.507537548927869*^9}, {3.507537580835548*^9, 3.5075376080555177`*^9}, 
   3.507537665042445*^9, {3.507537715685339*^9, 3.507537770531546*^9}, {
   3.5075378600516396`*^9, 3.507537933289764*^9}, {3.507537973432444*^9, 
   3.5075380163877687`*^9}, {3.5075380598743696`*^9, 3.507538072203126*^9}, 
   3.50753813283123*^9, {3.5075381953344297`*^9, 3.507538207725689*^9}, 
   3.50753826877569*^9, {3.5075383324508247`*^9, 3.507538350420495*^9}, {
   3.507538452613227*^9, 3.507538472723632*^9}, 3.507538511241228*^9, {
   3.50753862768469*^9, 3.507538634685048*^9}, {3.5075386734370327`*^9, 
   3.507538713064061*^9}, {3.5129926582396016`*^9, 3.512992740390255*^9}, {
   3.512992773103874*^9, 3.512992887344139*^9}, {3.5129929465000973`*^9, 
   3.5129929831761675`*^9}, {3.5129931068077526`*^9, 
   3.5129931124550247`*^9}, {3.512993367778983*^9, 3.512993408029008*^9}, {
   3.512993487821986*^9, 3.512993682417891*^9}, {3.5129937174091396`*^9, 
   3.5129937381262054`*^9}, {3.512994188215314*^9, 3.5129942597504663`*^9}, {
   3.512994307435234*^9, 3.512994309432434*^9}, {3.5129956523269615`*^9, 
   3.512995652654566*^9}, {3.5164397526458397`*^9, 3.5164397688232474`*^9}, {
   3.5164404215815697`*^9, 3.516440437072469*^9}, {3.5190064564615564`*^9, 
   3.5190066994008007`*^9}, {3.5190067814510465`*^9, 3.519006837043061*^9}, {
   3.5190068786314583`*^9, 3.5190069066856327`*^9}, 3.5190069546421547`*^9, {
   3.5190070408038845`*^9, 3.5190070498371572`*^9}, {3.519007127792115*^9, 
   3.5190071360439634`*^9}, {3.519007185523794*^9, 3.5190072828268356`*^9}, {
   3.5190073220854287`*^9, 3.5190073428315773`*^9}, {3.519007381511897*^9, 
   3.5190073869640102`*^9}, {3.5226711451097765`*^9, 
   3.5226711692541647`*^9}, {3.522671351980706*^9, 3.5226714898856688`*^9}, {
   3.52267161743781*^9, 3.522671670605336*^9}, {3.5226719388559303`*^9, 
   3.522671957339473*^9}, {3.522672006639327*^9, 3.522672037361972*^9}, {
   3.522672082593171*^9, 3.522672164539117*^9}, {3.5226722020456257`*^9, 
   3.522672363424122*^9}, {3.529326187270664*^9, 3.529326234887289*^9}, {
   3.529326288040926*^9, 3.529326310118327*^9}, {3.5293263907034082`*^9, 
   3.5293264038608713`*^9}, {3.529901320284543*^9, 3.5299013210188713`*^9}, {
   3.529906104353343*^9, 3.529906114290207*^9}, {3.5405287710792885`*^9, 
   3.5405288050172234`*^9}, 3.540557083878318*^9, {3.555411920639573*^9, 
   3.555411921139429*^9}, {3.5576370035941935`*^9, 3.557637068452323*^9}, {
   3.5580701965417614`*^9, 3.558070197104269*^9}, {3.5580702755115223`*^9, 
   3.558070296527416*^9}, {3.5580703707627416`*^9, 3.5580703735596523`*^9}, {
   3.558070411888268*^9, 3.558070425700945*^9}, {3.5580705321554327`*^9, 
   3.558070533686702*^9}, {3.558070605781375*^9, 3.558070610781439*^9}, {
   3.558070644875625*^9, 3.558070665016508*^9}, {3.558070769064715*^9, 
   3.558070791580628*^9}, {3.558070862690913*^9, 3.558071009036536*^9}, 
   3.558071173210513*^9, 3.558071409854167*^9, {3.558071623716279*^9, 
   3.5580716456071844`*^9}, 3.5606005123818464`*^9, {3.5606023795259724`*^9, 
   3.5606023973261433`*^9}, {3.560677286068344*^9, 3.5606774431809797`*^9}, {
   3.560677527189672*^9, 3.560677528032099*^9}, 3.56067758016897*^9, {
   3.560677686595581*^9, 3.560677690495706*^9}, {3.5677517741625347`*^9, 
   3.5677517936626596`*^9}, {3.5679386097047806`*^9, 
   3.5679386157847805`*^9}, {3.5704521874211373`*^9, 
   3.5704521901211643`*^9}, {3.570452225101514*^9, 3.570452350612769*^9}, {
   3.570452764016903*^9, 3.570452771596979*^9}, 3.570452961493213*^9, {
   3.570453038340908*^9, 3.5704530387908945`*^9}, 3.5704530940792356`*^9, {
   3.5704531717084618`*^9, 3.570453174798462*^9}, {3.5704532604984617`*^9, 
   3.570453278198462*^9}, {3.570453360628462*^9, 3.570453364988462*^9}, {
   3.570453404818462*^9, 3.5704534299584618`*^9}, 3.5704534797084618`*^9, {
   3.570453703388462*^9, 3.5704537296084623`*^9}, {3.5704538332484617`*^9, 
   3.570453835388462*^9}, {3.570453874378462*^9, 3.570453935338462*^9}, {
   3.5704540237185*^9, 3.5704540327885914`*^9}, 3.5704541554198174`*^9, {
   3.5705089052668867`*^9, 3.570509066848503*^9}, {3.5840867573948507`*^9, 
   3.5840867656922846`*^9}, {3.584086860181511*^9, 3.584086903453656*^9}, {
   3.5840871246468196`*^9, 3.584087135196731*^9}, {3.5840872223410015`*^9, 
   3.5840872225734997`*^9}, {3.584089642072196*^9, 3.5840896580580044`*^9}, {
   3.5840896914473963`*^9, 3.584089707000261*^9}, {3.584091202435853*^9, 
   3.584091237990553*^9}, {3.584091365321253*^9, 3.584091388688953*^9}, {
   3.584091515083968*^9, 3.584091541283798*^9}, {3.58409167747152*^9, 
   3.584091690983887*^9}, {3.584091730109187*^9, 3.5840917489397945`*^9}, {
   3.5840919519932947`*^9, 3.584092014691395*^9}, 3.584092217277295*^9, {
   3.584092281630995*^9, 3.584092304347995*^9}, {3.584092376946697*^9, 
   3.5840923871465445`*^9}, 3.584093260001268*^9, 3.5840933360262775`*^9, {
   3.584094921734623*^9, 3.5840949450343227`*^9}, {3.5840964113716784`*^9, 
   3.58409641512576*^9}, 3.5932317521945705`*^9, {3.593233679164271*^9, 
   3.5932336822577705`*^9}, {3.601208489884699*^9, 3.601208589687999*^9}, {
   3.6012086306924987`*^9, 3.601208692721199*^9}, {3.6012087456236987`*^9, 
   3.6012087798529987`*^9}, {3.622451097165533*^9, 3.6224511266342697`*^9}, {
   3.622869650039921*^9, 3.622869658464019*^9}, {3.62398695443825*^9, 
   3.623986956279434*^9}, {3.6239870481456194`*^9, 3.6239870574295483`*^9}, {
   3.624077366596232*^9, 3.624077370324656*^9}, {3.6240774799631586`*^9, 
   3.6240774926304398`*^9}, {3.624077549610411*^9, 3.624077824452973*^9}, {
   3.6240793830514*^9, 3.624079591263482*^9}, {3.6240796358539286`*^9, 
   3.624079679164362*^9}, {3.6240797601051707`*^9, 3.6240799633972034`*^9}, {
   3.624080002707597*^9, 3.6240800599581695`*^9}, {3.6240801475790453`*^9, 
   3.6240801593291636`*^9}, {3.6240802325598955`*^9, 3.624080326210832*^9}, {
   3.624080377521345*^9, 3.624080486592436*^9}, 3.624080609243662*^9, {
   3.6240806826443963`*^9, 3.624080708504655*^9}, {3.624080738944959*^9, 
   3.6240807473650436`*^9}, {3.6240808216867867`*^9, 
   3.6240808346569166`*^9}, {3.624080943328003*^9, 3.624080946098031*^9}, {
   3.62408099099848*^9, 3.624081041948989*^9}, {3.6240811559801297`*^9, 
   3.6240811574701443`*^9}, {3.6240812282508526`*^9, 3.624081248501055*^9}, {
   3.6240812913214827`*^9, 3.6240813233018026`*^9}, {3.6240813543421135`*^9, 
   3.624081443553005*^9}, {3.6240814838034077`*^9, 3.6240815954745245`*^9}, {
   3.6240820922073*^9, 3.624082424832632*^9}, {3.6240825884092984`*^9, 
   3.624082592969344*^9}, 3.6240826375197897`*^9, {3.6240826706501207`*^9, 
   3.6240827003504176`*^9}, {3.6240827314907293`*^9, 3.624082781481229*^9}, {
   3.6240828403518176`*^9, 3.6240828459918737`*^9}, {3.6240920123276625`*^9, 
   3.624092013357673*^9}, {3.6240920702882423`*^9, 3.6240921184187236`*^9}, {
   3.624092258950129*^9, 3.624092284770387*^9}, {3.6240926960345*^9, 
   3.624092739564935*^9}, {3.6240929557180967`*^9, 3.6240930618691583`*^9}, {
   3.6240931322898626`*^9, 3.6240931367999077`*^9}, {3.6240931875904155`*^9, 
   3.6240932024105635`*^9}, {3.6240932746812863`*^9, 
   3.6240932759812994`*^9}, {3.6240935108036475`*^9, 3.624093725265792*^9}, {
   3.6247007580486484`*^9, 3.6247008672493486`*^9}, {3.624938123334405*^9, 
   3.624938127125205*^9}, {3.624941765081605*^9, 3.624941794487605*^9}, {
   3.624941863892005*^9, 3.624941898945205*^9}, 3.6260753802157636`*^9, {
   3.6270114149077673`*^9, 3.627011459292328*^9}, {3.630657818336508*^9, 
   3.630657862203989*^9}, {3.6306579146359253`*^9, 3.630657926648002*^9}, {
   3.6306594992578764`*^9, 3.6306595422520275`*^9}, {3.630660026678897*^9, 
   3.6306600547278767`*^9}, {3.630660089625301*^9, 3.630660109375027*^9}, {
   3.630660146799695*^9, 3.630660146940098*^9}, {3.6306629151900344`*^9, 
   3.6306629203536344`*^9}, 3.631342033440481*^9, {3.6334314047912073`*^9, 
   3.633431439313175*^9}, {3.6334315269528513`*^9, 3.633431546249804*^9}, {
   3.6334317407637105`*^9, 3.6334318301349645`*^9}, {3.6337590137828283`*^9, 
   3.6337590190870667`*^9}},
 CellLabel->
  "In[848]:=",ExpressionUUID->"6d440548-5416-47fa-a854-07b1efe0b4b4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "NRADataCalculator", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"SELREQVAR", "\[Rule]", "None"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NRADataCalculator", "[", 
   RowBox[{
   "layerfile_", ",", "designmatrixfile_", ",", " ", "sol_", ",", " ", "eqn_",
     ",", " ", "grd_", ",", "att_", ",", "inp_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"selrequvar", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "SELREQVAR", "]"}]}], ",", 
      "\[IndentingNewLine]", "selidx", ",", "\[IndentingNewLine]", 
      RowBox[{"reqvar", " ", "=", " ", 
       RowBox[{"VARS", "/.", "eqn"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"curdepth", " ", "=", " ", "0"}], ",", "\[IndentingNewLine]", 
      RowBox[{"maxdepth", " ", "=", 
       RowBox[{"Last", "[", "grd", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"rohw", "=", 
       FractionBox[
        RowBox[{"prohW", "/.", "inp"}], 
        SuperscriptBox["tolenscale", "3"]]}], ",", "\[IndentingNewLine]", 
      "totconc", ",", "\[IndentingNewLine]", "layers", ",", 
      "\[IndentingNewLine]", "adenslayers", ",", "\[IndentingNewLine]", 
      "depth", ",", "\[IndentingNewLine]", "adensdiffspec", ",", 
      "\[IndentingNewLine]", "adensbulk", ",", "\[IndentingNewLine]", 
      "concprof", ",", "\[IndentingNewLine]", "ii", ",", 
      "\[IndentingNewLine]", "dmat", ",", "\[IndentingNewLine]", "numappend", 
      ",", "\[IndentingNewLine]", "expdata"}], "\[IndentingNewLine]", "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"selidx", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"TrueQ", "[", 
         RowBox[{
          RowBox[{"Head", "[", "selrequvar", "]"}], "\[Equal]", "List"}], 
         "]"}], ",", "selrequvar", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"ii", ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", 
            RowBox[{"Length", "[", "reqvar", "]"}]}], "}"}]}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Selected concentrations: \>\"", ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"reqvar", ",", "ii"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "selidx"}], "}"}]}], "]"}]}], " ", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"adenslayers", " ", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Transpose", "[", 
        RowBox[{"Import", "[", "layerfile", "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"layers", " ", "=", " ", 
      RowBox[{"adenslayers", "*", 
       RowBox[{
        FractionBox["1*^19", 
         SuperscriptBox["tolenscale", "2"]], "/", "rohw"}]}]}], ";", 
     RowBox[{"(*", "um", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<# of layers: \>\"", ",", " ", 
       RowBox[{"Length", "[", "layers", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"depth", " ", "=", " ", 
      RowBox[{
       RowBox[{"Accumulate", "[", "layers", "]"}], "-", 
       RowBox[{"First", "[", "layers", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"depth", " ", "=", " ", 
      RowBox[{"Select", "[", 
       RowBox[{"depth", ",", 
        RowBox[{
         RowBox[{"#", "<", 
          RowBox[{"Last", "[", "Grd", "]"}]}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"depth", "=", 
      RowBox[{"Append", "[", 
       RowBox[{"depth", ",", 
        RowBox[{"Last", "[", "Grd", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<# of layers inside DGL solution: \>\"", ",", " ", 
       RowBox[{"Length", "[", "depth", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", "x", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"totconc", "=", 
      RowBox[{"rohw", "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{"reqvar", ",", "ii"}], "]"}], "/.", "sol"}], ")"}], "[", 
          RowBox[{"x", ",", "att"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "selidx"}], "}"}]}], "]"}]}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"#", "/", 
       RowBox[{"um", "^", "3"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Integrating \>\"", ",", 
       RowBox[{"Length", "[", "depth", "]"}], ",", "\"\< steps\>\""}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"ii", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"BroadCast", "[", 
      RowBox[{"totconc", ",", "depth"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"SetSharedVariable", "[", "ii", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"adensdiffspec", "=", 
      RowBox[{"TableParallel", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"PrintTemporary", "[", 
          RowBox[{"\"\<ii: \>\"", "<>", 
           RowBox[{"ToString", "[", "ii", "]"}]}], "]"}], ";", 
         RowBox[{"NIntegrate", "[", 
          RowBox[{"totconc", ",", " ", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"Part", "[", 
              RowBox[{"depth", ",", 
               RowBox[{"ii", "-", "1"}]}], "]"}], ",", 
             RowBox[{"Part", "[", 
              RowBox[{"depth", ",", "ii"}], "]"}]}], "}"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "2", ",", 
          RowBox[{"Length", "[", "depth", "]"}]}], "}"}]}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"#", "/", 
       RowBox[{"um", "^", "2"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"adensbulk", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"PrintTemporary", "[", 
          RowBox[{"\"\<ii: \>\"", "<>", 
           RowBox[{"ToString", "[", "ii", "]"}]}], "]"}], ";", 
         RowBox[{"rohw", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{"depth", ",", "ii"}], "]"}], "-", 
            RowBox[{"Part", "[", 
             RowBox[{"depth", ",", 
              RowBox[{"ii", "-", "1"}]}], "]"}]}], ")"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", "2", ",", 
          RowBox[{"Length", "[", "depth", "]"}]}], "}"}]}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"#", "/", 
       RowBox[{"um", "^", "2"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"concprof", " ", "=", " ", 
      RowBox[{"adensdiffspec", "/", "adensbulk"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Load", " ", "the", " ", "design", " ", "matrix"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"dmat", " ", "=", " ", 
      RowBox[{"Import", "[", "designmatrixfile", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"numappend", "  ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Dimensions", "[", "dmat", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "-", 
       RowBox[{"Length", "[", "concprof", "]"}]}]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"concprof", " ", "=", " ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"TrueQ", "[", 
         RowBox[{"numappend", ">", "0"}], "]"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Appending \>\"", ",", "numappend", ",", 
           "\"\< zero concentration layers\>\""}], "]"}], ";", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"concprof", ",", 
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", "numappend", "}"}]}], "]"}]}], "}"}], "]"}]}], ",",
         "concprof"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"expdata", "=", 
      RowBox[{"dmat", ".", "concprof"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"CONCPROF", "->", "concprof"}], ",", 
        RowBox[{"EXPDATA", "->", "expdata"}]}], "}"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5677522673596964`*^9, 3.567752314269197*^9}, {
   3.5677524181814632`*^9, 3.567752473015815*^9}, {3.567752551724724*^9, 
   3.5677525658428144`*^9}, {3.5677567093421907`*^9, 3.5677567097477927`*^9}, 
   3.593236515860571*^9, {3.62245109874115*^9, 3.622451127429879*^9}},
 CellLabel->
  "In[880]:=",ExpressionUUID->"8993bf9a-c49f-447c-a6c9-d056009ebb96"]
}, Open  ]],

Cell[CellGroupData[{

Cell[, "Section",ExpressionUUID->"dec5bc6d-eca0-4610-89ea-541b8ca2d033"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "Deff", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"TempFunc", "\[Rule]", "ConstTempFunc"}], ",", " ", 
     RowBox[{"TrapModCompFunc", "->", "TrappRateComp"}], ",", 
     RowBox[{"TrapProfTime", "\[Rule]", "t"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Deff", "[", 
   RowBox[{"csol_", ",", "x_", ",", "t_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"trapproftime", "=", 
       RowBox[{"OptionValue", "[", "TrapProfTime", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Toft", "=", 
       RowBox[{"OptionValue", "[", "TempFunc", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"TrapModelParam", "=", 
       RowBox[{"pTrapModelParam", "/.", "InputParam"}]}], ",", 
      "\[IndentingNewLine]", "TrapProfofxandt", ",", "\[IndentingNewLine]", 
      RowBox[{"numtrap", "=", 
       RowBox[{"GetNumTraps", "[", "]"}]}], ",", "\[IndentingNewLine]", 
      "doft", ",", "\[IndentingNewLine]", "Denom"}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"doft", "=", 
      RowBox[{"DofTempFunc", "[", "Toft", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrapProfofxandt", "=", 
      RowBox[{"pFunc", "/.", 
       RowBox[{"(", 
        RowBox[{"pTrapProfFunc", "/.", "TrapModelParam"}], " ", ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<TrapProfofxandt: \>\"", ",", " ", "TrapProfofxandt"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Denom", " ", "=", " ", 
      RowBox[{"Sum", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Module", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"Tcomponents", ",", "\[IndentingNewLine]", 
            RowBox[{"prof", " ", "=", " ", 
             RowBox[{"TrapProfofxandt", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
            "Ai", ",", "\[IndentingNewLine]", "Bi"}], "\[IndentingNewLine]", 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Tcomponents", " ", "=", " ", 
            RowBox[{"TrappRateComp", "[", 
             RowBox[{"Toft", ",", "i", ",", "prof", ",", 
              RowBox[{"TrapProfTime", "->", "trapproftime"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Ai", "=", 
            RowBox[{"AFACT", "/.", "Tcomponents"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Bi", "=", 
            RowBox[{"BFACT", "/.", "Tcomponents"}]}], ";", 
           "\[IndentingNewLine]", 
           FractionBox[
            RowBox[{"Ai", "*", "Bi", "*", 
             RowBox[{"prof", "[", 
              RowBox[{
               RowBox[{"csol", "[", 
                RowBox[{"x", ",", "t"}], "]"}], ",", "x", ",", "t", ",", 
               "i"}], "]"}]}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Ai", "*", 
                RowBox[{"csol", "[", 
                 RowBox[{"x", ",", "t"}], "]"}]}], "+", "Bi"}], ")"}], 
             "2"]]}]}], "\[IndentingNewLine]", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "numtrap"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"DEFF", "->", 
        FractionBox["doft", 
         RowBox[{"1", "+", "Denom"}]]}], ",", 
       RowBox[{"DENOM", " ", "->", "Denom"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5302541699731874`*^9, 3.530254185535887*^9}, {
   3.5302543047561626`*^9, 3.530254313959406*^9}, {3.530254478195883*^9, 
   3.5302545003524165`*^9}, {3.530254620385203*^9, 3.530254653510627*^9}, {
   3.5302547072925653`*^9, 3.5302548405911465`*^9}, {3.5302548711384125`*^9, 
   3.530255079562955*^9}, {3.5302551704547434`*^9, 3.530255236049333*^9}, {
   3.5302553539570923`*^9, 3.530255400832692*^9}, {3.5302595380305243`*^9, 
   3.530259538905373*^9}, {3.5405288307519274`*^9, 3.540528839767668*^9}, {
   3.6126032245044675`*^9, 3.612603225362457*^9}, {3.6197650804221077`*^9, 
   3.6197650957413073`*^9}, {3.63343183592249*^9, 3.6334318536906624`*^9}, {
   3.633431921112998*^9, 3.633431945401887*^9}, {3.6334320658635426`*^9, 
   3.6334321387770076`*^9}, {3.633432175452137*^9, 3.6334322403317056`*^9}, {
   3.63343228132798*^9, 3.6334322972709756`*^9}, {3.6334323331661153`*^9, 
   3.6334323982952805`*^9}, {3.6334324316476526`*^9, 3.63343248337659*^9}, 
   3.6334325379758897`*^9},
 CellLabel->
  "In[882]:=",ExpressionUUID->"c8de2dfd-6bf3-4586-999f-0127a01916b4"],

Cell[, "Input",ExpressionUUID->"4fbb4d9d-d2a3-4ac8-9d95-e287c82b5cc9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[, "Section",ExpressionUUID->"4e7ed2d1-7580-4cbc-8604-ad6390d790da"],

Cell[, "Text",ExpressionUUID->"bd5c92bb-6a77-4f41-8a11-f21d3d251c72"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemPot", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"TIMEVALUE", "\[Rule]", "t"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ChemPot", "[", 
   RowBox[{"dglres_", ",", "ES_", ",", "tempfuc_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"verb", " ", "=", " ", 
       RowBox[{"pVERBOSE", "/.", "InputParam"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"TrapModelParam", "=", 
       RowBox[{"pTrapModelParam", "/.", "InputParam"}]}], ",", 
      "\[IndentingNewLine]", "TrapProfofxandt", ",", "TrapParam", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ED", " ", "=", " ", 
       RowBox[{"pED", "/.", 
        RowBox[{"(", 
         RowBox[{"pTraceDiffParam", "/.", "InputParam"}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", "xref", ",", "\[IndentingNewLine]", 
      RowBox[{"thet", "=", 
       RowBox[{"OptionValue", "[", "TIMEVALUE", "]"}]}], ",", 
      "\[IndentingNewLine]", "numtrap", ",", "\[IndentingNewLine]", "etaivec",
       ",", "\[IndentingNewLine]", "refconc", ",", "\[IndentingNewLine]", 
      "ETrapBind", ",", "\[IndentingNewLine]", "rhs", ",", "lhs"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Clear", "[", "uoft", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"numtrap", " ", "=", " ", 
      RowBox[{"GetNumTraps", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"refconc", "=", 
      RowBox[{
       RowBox[{"csol", "[", 
        RowBox[{"xref", ",", "t"}], "]"}], "+", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Subscript", "[", 
           RowBox[{"ctrp", ",", "jj"}], "]"}], "[", 
          RowBox[{"xref", ",", "t"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "numtrap"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"TrapProfofxandt", "=", 
      RowBox[{"pFunc", "/.", 
       RowBox[{"(", 
        RowBox[{"pTrapProfFunc", "/.", "TrapModelParam"}], " ", ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"xref", "=", 
      RowBox[{"pxref", "/.", "TrapModelParam"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"etaivec", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"TrapProfofxandt", ",", " ", "ti"}], "]"}], "[", 
         RowBox[{"refconc", ",", "x", ",", "thet", ",", "ti"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "[", 
        RowBox[{"verb", "\[GreaterEqual]", " ", "1"}], "]"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<ChemPot->etaivec: \>\"", ",", 
         RowBox[{"TableForm", "[", "etaivec", "]"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"TrapParam", "=", 
      RowBox[{"pTraps", "/.", "TrapModelParam"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ETrapBind", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ES", "+", "ED", "-", 
         RowBox[{"(", 
          RowBox[{"pETS", "/.", 
           RowBox[{"Part", "[", 
            RowBox[{"TrapParam", ",", "ti"}], "]"}]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "[", 
        RowBox[{"verb", "\[GreaterEqual]", "1"}], "]"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<ChemPot->ETrapBind = \>\"", ",", 
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{"ETrapBind", ",", 
            RowBox[{"(", 
             RowBox[{"ES", "+", "ED", " ", "-", "ETrapBind"}], ")"}]}], "}"}],
           "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"lhs", " ", "=", " ", 
      RowBox[{
       RowBox[{"csol", "[", 
        RowBox[{"x", ",", "thet"}], "]"}], "+", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Subscript", "[", 
           RowBox[{"ctrp", ",", "jj"}], "]"}], "[", 
          RowBox[{"x", ",", "thet"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "numtrap"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rhs", " ", "=", " ", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         FractionBox[
          RowBox[{"Part", "[", 
           RowBox[{"etaivec", ",", "ti"}], "]"}], 
          RowBox[{"1", "+", 
           RowBox[{"Exp", "[", 
            FractionBox[
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{"ETrapBind", ",", "ti"}], "]"}], "-", "uoft"}], 
             RowBox[{
              RowBox[{"tempfuc", "[", "t", "]"}], "*", "KBoltz"}]], "]"}]}]], 
         ",", 
         RowBox[{"{", 
          RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}], "+", 
       FractionBox[
        RowBox[{"1", "-", 
         RowBox[{"Total", "[", "etaivec", "]"}]}], 
        RowBox[{"1", "+", 
         RowBox[{"Exp", "[", 
          FractionBox[
           RowBox[{"ES", "-", "uoft"}], 
           RowBox[{
            RowBox[{"tempfuc", "[", "t", "]"}], "*", "KBoltz"}]], 
          "]"}]}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "[", 
        RowBox[{"verb", "\[GreaterEqual]", " ", "1"}], "]"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<ChemPot->eqn = \>\"", ",", 
         RowBox[{"lhs", "\[Equal]", "rhs"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RHS", "\[Rule]", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"rhs", "/.", "dglres"}], "]"}]}], ",", 
       RowBox[{"LHS", "\[Rule]", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"lhs", "/.", "dglres"}], "]"}]}], ",", 
       RowBox[{"VAR", "->", "uoft"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapChemPlotToGrid", "[", 
   RowBox[{"ChemPotRes_", ",", "Grd_", ",", "att_"}], "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"eqn", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"LHS", " ", "\[Equal]", " ", "RHS"}], ")"}], "/.", 
           "ChemPotRes"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x", "\[Rule]", "#"}], ",", 
            RowBox[{"t", "\[Rule]", "att"}]}], "}"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"#", ",", 
         RowBox[{"uoft", "/.", 
          RowBox[{"FindRoot", "[", 
           RowBox[{"eqn", ",", 
            RowBox[{"{", 
             RowBox[{"uoft", ",", "1"}], "}"}]}], "]"}]}]}], "}"}]}], "]"}], 
     "&"}], ",", "Grd"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5704428626798906`*^9, 3.5704428910001736`*^9}, {
  3.570443063221896*^9, 3.5704430828620925`*^9}, {3.570443128152545*^9, 
  3.5704434048753123`*^9}, {3.570443534216606*^9, 3.5704435346066093`*^9}, {
  3.5704435870071335`*^9, 3.5704436352976165`*^9}, {3.5704437702289658`*^9, 
  3.5704437773190365`*^9}, {3.570443828569549*^9, 3.5704438902701664`*^9}, {
  3.570443979271056*^9, 3.5704439838711023`*^9}, {3.5704480850981145`*^9, 
  3.5704481891091547`*^9}, {3.5704490922453423`*^9, 3.5704490979853425`*^9}, {
  3.5705099892877274`*^9, 3.5705100489183235`*^9}, {3.6334373309778814`*^9, 
  3.6334374555968356`*^9}, {3.6334379378682804`*^9, 3.6334379483534613`*^9}, {
  3.6334379877939925`*^9, 3.6334379996699057`*^9}, {3.6334388042630014`*^9, 
  3.633438818076562*^9}},
 CellLabel->
  "In[884]:=",ExpressionUUID->"83a29da5-f103-4628-b9cb-f1121c66258d"],

Cell[, "Input",ExpressionUUID->"242f9656-16c0-4b2f-b9d2-4719ed005bba"],

Cell[, "Text",ExpressionUUID->"f6dee83c-084d-4776-a8d8-812fe6184d88"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "PressChemPot", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"TIMEVALUE", "\[Rule]", "t"}], ",", 
     RowBox[{"POSVALUE", "\[Rule]", "0"}], ",", 
     RowBox[{"MAXPLOTT", "\[Rule]", "1000"}], ",", 
     RowBox[{"VERBOSE", "\[Rule]", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PressChemPot", "[", 
    RowBox[{"tempfunc_", ",", "pressoft_", ",", "P0_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"verb", " ", "=", 
        RowBox[{"OptionValue", "[", "VERBOSE", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"thet", "=", 
        RowBox[{"OptionValue", "[", "TIMEVALUE", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"thex", " ", "=", 
        RowBox[{"OptionValue", "[", "POSVALUE", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"maxplott", "=", 
        RowBox[{"OptionValue", "[", "MAXPLOTT", "]"}]}], ",", 
       "\[IndentingNewLine]", "ures"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<verb: \>\"", ",", "verb"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ures", "=", 
       RowBox[{"KBoltz", "*", 
        RowBox[{"tempfunc", "[", 
         RowBox[{"thex", ",", "thet"}], "]"}], "*", 
        RowBox[{"Log", "[", 
         RowBox[{"Sqrt", "[", 
          FractionBox[
           RowBox[{"pressoft", "[", "thet", "]"}], "P0"], "]"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"TrueQ", "[", 
         RowBox[{"verb", ">", "0"}], "]"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<PressChemPot->ures = \>\"", ",", "ures"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"TrueQ", "[", 
         RowBox[{"verb", ">", "1"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "\[IndentingNewLine]", 
         RowBox[{"Plot", "[", "\[IndentingNewLine]", 
          RowBox[{"ures", ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "maxplott"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]", 
          "]"}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "ures", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "x", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ExtChemPotEQConc", "]"}], "=", 
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{"REFCONC", "\[Rule]", "0.0"}], ",", 
     RowBox[{"MAXPLOTT", "\[Rule]", "1000"}], ",", 
     RowBox[{"TRAPCOMPFUNC", "->", "TrappRateComp"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtChemPotEQConc", "[", " ", 
    RowBox[{
    "thex_", ",", "thet_", ",", "ES_", ",", "uext_", ",", "tempfunc_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"verb", " ", "=", 
        RowBox[{"pVERBOSE", "/.", "InputParam"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TrapModelParam", "=", 
        RowBox[{"pTrapModelParam", "/.", "InputParam"}]}], ",", 
       "\[IndentingNewLine]", "TrapProfofxandt", ",", "TrapParam", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ED", " ", "=", " ", 
        RowBox[{"pED", "/.", 
         RowBox[{"(", 
          RowBox[{"pTraceDiffParam", "/.", "InputParam"}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", "xref", ",", "\[IndentingNewLine]", 
       RowBox[{"refconc", "=", 
        RowBox[{"OptionValue", "[", "REFCONC", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"maxplott", "=", 
        RowBox[{"OptionValue", "[", "MAXPLOTT", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"trapcompfunc", "=", 
        RowBox[{"OptionValue", "[", "TRAPCOMPFUNC", "]"}]}], ",", 
       "\[IndentingNewLine]", "numtrap", ",", "\[IndentingNewLine]", 
       "etaivec", ",", "\[IndentingNewLine]", "ETrapBind", ",", 
       "\[IndentingNewLine]", "totconc", ",", "\[IndentingNewLine]", "eqn", 
       ",", "vars", ",", "sol", ",", "\[IndentingNewLine]", "trapparam", ",", 
       " ", "\[IndentingNewLine]", "reprule", ",", "solatt", ",", "validconc",
        ",", "validsol"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<verb: \>\"", ",", "verb"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ClearAll", "[", 
       RowBox[{"uu", ",", "ctot", ",", "csol"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"TrapProfofxandt", "=", 
       RowBox[{"pFunc", "/.", 
        RowBox[{"(", 
         RowBox[{"pTrapProfFunc", "/.", "TrapModelParam"}], " ", ")"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"TrapParam", "=", 
       RowBox[{"pTraps", "/.", "TrapModelParam"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xref", "=", 
       RowBox[{"pxref", "/.", "TrapModelParam"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"numtrap", " ", "=", " ", 
       RowBox[{"Length", "[", "TrapParam", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"etaivec", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"TrapProfofxandt", ",", " ", "ti"}], "]"}], "[", 
          RowBox[{"refconc", ",", "thex", ",", "thet", ",", "ti"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"TrueQ", "[", 
         RowBox[{"verb", "\[GreaterEqual]", " ", "1"}], "]"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<ExtPressEQConc->etaivec: \>\"", ",", 
          RowBox[{"TableForm", "[", "etaivec", "]"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ETrapBind", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ES", "+", "ED", "-", 
          RowBox[{"(", 
           RowBox[{"pETS", "/.", 
            RowBox[{"Part", "[", 
             RowBox[{"TrapParam", ",", "ti"}], "]"}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"TrueQ", "[", 
         RowBox[{"verb", "\[GreaterEqual]", " ", "1"}], "]"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<ExtPressEQConc->ETrapBind = \>\"", ",", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"ETrapBind", ",", 
             RowBox[{"(", 
              RowBox[{"ES", "+", "ED", " ", "-", "ETrapBind"}], ")"}]}], 
            "}"}], "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"totconc", " ", "=", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           FractionBox[
            RowBox[{"Part", "[", 
             RowBox[{"etaivec", ",", "ti"}], "]"}], 
            RowBox[{"1", "+", 
             RowBox[{"Exp", "[", 
              FractionBox[
               RowBox[{
                RowBox[{"Part", "[", 
                 RowBox[{"ETrapBind", ",", "ti"}], "]"}], "-", "uext"}], 
               RowBox[{
                RowBox[{"tempfunc", "[", 
                 RowBox[{"x", ",", "t"}], "]"}], "*", "KBoltz"}]], "]"}]}]], 
           ",", 
           RowBox[{"{", 
            RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}], "+", 
         FractionBox[
          RowBox[{"1", "-", 
           RowBox[{"Total", "[", "etaivec", "]"}]}], 
          RowBox[{"1", "+", 
           RowBox[{"Exp", "[", 
            FractionBox[
             RowBox[{"ES", "-", "uext"}], 
             RowBox[{
              RowBox[{"tempfunc", "[", 
               RowBox[{"x", ",", "t"}], "]"}], "*", "KBoltz"}]], "]"}]}]]}], 
        ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verb", ">", "0"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<totconc@maxplott: \>\"", ",", " ", 
          RowBox[{"totconc", "/.", 
           RowBox[{"t", "->", "maxplott"}]}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"eqn", "=", 
       RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ctot", " ", "==", " ", 
           RowBox[{"csol", "+", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"Subscript", "[", 
               RowBox[{"ct", ",", "ti"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}]}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"0", "==", 
             RowBox[{
              RowBox[{"AA", "*", "csol", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Subscript", "[", 
                  RowBox[{"eta", ",", "ti"}], "]"}], "-", 
                 RowBox[{"Subscript", "[", 
                  RowBox[{"ct", ",", "ti"}], "]"}]}], ")"}]}], "-", 
              RowBox[{
               RowBox[{"Subscript", "[", 
                RowBox[{"ct", ",", "ti"}], "]"}], "*", 
               RowBox[{"Subscript", "[", 
                RowBox[{"BB", ",", "ti"}], "]"}]}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vars", "=", 
       RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"csol", ",", "\[IndentingNewLine]", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Subscript", "[", 
             RowBox[{"ct", ",", "ti"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sol", " ", "=", " ", 
       RowBox[{"Solve", "[", 
        RowBox[{"eqn", ",", "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"trapparam", "=", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"trapcompfunc", "[", 
           RowBox[{"tempfunc", ",", "ti", ",", 
            RowBox[{"Part", "[", 
             RowBox[{"TrapProfofxandt", ",", " ", "ti"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}], "/.", 
        RowBox[{"x", "\[Rule]", "thex"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"reprule", "=", 
       RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ctot", "->", "totconc"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"AA", "\[Rule]", 
               RowBox[{"Evaluate", "[", 
                RowBox[{"AFACT", "/.", 
                 RowBox[{"Part", "[", 
                  RowBox[{"trapparam", ",", "ti"}], "]"}]}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Subscript", "[", 
                RowBox[{"BB", ",", "ti"}], "]"}], "->", 
               RowBox[{"Evaluate", "[", 
                RowBox[{"BFACT", "/.", 
                 RowBox[{"Part", "[", 
                  RowBox[{"trapparam", ",", "ti"}], "]"}]}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Subscript", "[", 
                RowBox[{"eta", ",", "ti"}], "]"}], "->", 
               RowBox[{"Evaluate", "[", 
                RowBox[{"ETHAIFACT", "/.", 
                 RowBox[{"Part", "[", 
                  RowBox[{"trapparam", ",", "ti"}], "]"}]}], "]"}]}]}], 
             "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"sol", "/.", "reprule"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"solatt", "=", 
       RowBox[{"sol", "/.", 
        RowBox[{"t", "->", "maxplott"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"solatt", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "sol", "]"}], "]"}], ",", 
          RowBox[{"vars", "/.", "solatt"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<reprule att: \>\"", ",", 
        RowBox[{"reprule", "/.", 
         RowBox[{"t", "->", "maxplott"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<solatt: \>\"", ",", "solatt"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"validconc", "[", "conc_", "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"Im", "[", "conc", "]"}], "]"}], "<=", " ", "1*^-12"}], 
         " ", ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Re", "[", "conc", "]"}], "\[GreaterEqual]", "0"}], 
            ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Re", "[", "conc", "]"}], "\[LessEqual]", "1"}], ")"}]}],
           ")"}], ",", " ", "False"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"validsol", "=", 
       RowBox[{"First", "[", 
        RowBox[{"Select", "[", 
         RowBox[{"solatt", ",", 
          RowBox[{
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"validconc", "[", "#", "]"}], "&"}], ",", 
               RowBox[{"Part", "[", 
                RowBox[{"#", ",", "2"}], "]"}]}], "]"}]}], "]"}], "&"}]}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"validsol", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "validsol", "]"}], ">", "0"}], ",", 
         RowBox[{"Simplify", "[", 
          RowBox[{"Part", "[", 
           RowBox[{"sol", ",", 
            RowBox[{"First", "[", "validsol", "]"}]}], "]"}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verb", "\[GreaterEqual]", " ", "1"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"LogPlot", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"csol", "/.", "validsol"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "maxplott"}], "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"CSOL", "\[Rule]", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"csol", "/.", "validsol"}], "]"}]}], ",", 
        RowBox[{"CTRAP", "\[Rule]", 
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Subscript", "[", 
              RowBox[{"ct", ",", "ti"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"ti", ",", "1", ",", "numtrap"}], "}"}]}], "]"}], "/.", 
           "validsol"}], "]"}]}], " ", ",", 
        RowBox[{"TOTCONC", "->", "totconc"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5895202453990145`*^9, 3.5895202516546144`*^9}, 
   3.589523275269145*^9, 3.589523336031145*^9, {3.589529520329525*^9, 
   3.5895295217179337`*^9}, 3.589530065908328*^9, {3.5895391169760413`*^9, 
   3.5895392596907563`*^9}, {3.589539365076932*^9, 3.589539462010354*^9}, {
   3.5895395258012686`*^9, 3.5895396594879265`*^9}, {3.5895397197274127`*^9, 
   3.5895397662494106`*^9}, {3.5895398137848163`*^9, 
   3.5895402125608735`*^9}, {3.5895402450402822`*^9, 
   3.5895403889612045`*^9}, {3.589540561552012*^9, 3.5895408001605415`*^9}, {
   3.589540831722044*^9, 3.5895409116981573`*^9}, {3.589540951764214*^9, 
   3.5895409520294156`*^9}, {3.58959782000663*^9, 3.589597838024746*^9}, {
   3.589597939815398*^9, 3.5895979592531223`*^9}, {3.589598383794244*^9, 
   3.5895983857442565`*^9}, 3.589599726469636*^9, {3.5896273026519566`*^9, 
   3.58962734056433*^9}, {3.590146996615011*^9, 3.590146999719411*^9}, {
   3.590149912034837*^9, 3.590149940348837*^9}, 3.5901499949020367`*^9, {
   3.6228696786974735`*^9, 3.622869740536564*^9}, {3.633438603278801*^9, 
   3.6334386394534574`*^9}, {3.6334388291711707`*^9, 3.633438833390239*^9}, {
   3.633438969135048*^9, 3.6334389700257416`*^9}, {3.6334390348275976`*^9, 
   3.6334390377653236`*^9}, {3.6334390760338893`*^9, 3.633439078518456*^9}, {
   3.633439117693342*^9, 3.6334391676346807`*^9}, {3.633439207778391*^9, 
   3.6334392083409348`*^9}, {3.6334392901440973`*^9, 3.6334393166461344`*^9}, 
   3.6334491661688366`*^9, {3.6334492872406454`*^9, 3.633449298475884*^9}, {
   3.63344934246364*^9, 3.633449363434002*^9}, 3.6334494471748133`*^9, {
   3.6334494966629925`*^9, 3.6334495010695815`*^9}, {3.6334495887950745`*^9, 
   3.6334496074058795`*^9}, {3.633449654909531*^9, 3.6334496614256573`*^9}, 
   3.6334497883104095`*^9, {3.633450019328164*^9, 3.6334500381733656`*^9}, {
   3.633450198732582*^9, 3.6334502051705723`*^9}},
 CellLabel->
  "In[887]:=",ExpressionUUID->"37a57cbb-1189-4ca1-aece-0096e6c1d3e9"],

Cell[, "Input",ExpressionUUID->"ff26d239-f159-4bb5-a8ca-9a28c557b83a"],

Cell[, "Input",ExpressionUUID->"10b808ce-20a8-490c-a483-1503e03f3782"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[, "Title",ExpressionUUID->"e0f911cd-5627-42cd-b126-9c905721a5a1"],

Cell[CellGroupData[{

Cell[, "Section",ExpressionUUID->"70e99fdc-5570-48a9-ae15-91976039e080"],

Cell[, "Input",ExpressionUUID->"c8f27f6a-4aa0-4cf9-97d7-81872a69653d"],

Cell[, "Input",ExpressionUUID->"b7a01cc4-c721-4a24-aab8-7229e0dad907"]
}, Closed]],

Cell[CellGroupData[{

Cell[, "Section",ExpressionUUID->"b158143c-65bf-4f3d-8896-13c83feca773"],

Cell[, "Text",ExpressionUUID->"2d6bd305-92d9-4a8e-a51b-d77c33a18604"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ConstTemp", "[", 
    RowBox[{"ID_", ",", "atx_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"param", "  ", "=", " ", 
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"pbndcondparam", "/.", "TempEvoInput"}], ",", "ID"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"verb", "  ", "=", " ", 
        RowBox[{"pVERBOSE", "/.", "TempEvoInput"}]}], ",", 
       "\[IndentingNewLine]", "TConst"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TConst", " ", "=", " ", 
       RowBox[{"TCONST", "/.", "param"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", " ", 
       RowBox[{
        RowBox[{"verb", "\[GreaterEqual]", "2"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ConstTemp: ID = \>\"", ",", "ID", ",", "\"\<TConst = \>\"", ",",
           "TConst", ",", " ", "\"\< atx = \>\"", ",", "atx"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Temp", "[", 
        RowBox[{"atx", ",", "t"}], "]"}], "==", "TConst"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6228214991412487`*^9, 3.6228215348188877`*^9}, {
   3.6228216267508154`*^9, 3.6228216863129845`*^9}, {3.622821722708224*^9, 
   3.6228217365455837`*^9}, {3.622821878039277*^9, 3.622822033588689*^9}, {
   3.622822113680089*^9, 3.622822122634596*^9}, 3.6228237014831457`*^9},
 CellLabel->
  "In[892]:=",ExpressionUUID->"7afb0b19-94cb-47ae-b901-63f1ee368fb9"],

Cell[, "Text",ExpressionUUID->"f45932a3-2955-470b-bec2-b138323713f0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"HeatFlux", "[", 
    RowBox[{"ID_", ",", "atx_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"param", "  ", "=", " ", 
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"pbndcondparam", "/.", "TempEvoInput"}], ",", "ID"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"verb", "  ", "=", " ", 
        RowBox[{"pVERBOSE", "/.", "TempEvoInput"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"thermcond", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"pthermcond", "/.", "TempEvoInput"}], ")"}], "/", 
         "tolenscale"}]}], ",", "\[IndentingNewLine]", "HeatFlux", ",", 
       "res"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"HeatFlux", " ", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"HEATFLUX", "/.", "param"}], ")"}], "/", 
        SuperscriptBox["tolenscale", "2"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", " ", 
       RowBox[{
        RowBox[{"verb", "\[GreaterEqual]", "2"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<HeatFlux: ID = \>\"", ",", "ID", ",", "\"\< HeatFlux = \>\"", 
          ",", "HeatFlux", ",", " ", "\"\< thermcond = \>\"", ",", 
          "thermcond", ",", " ", "\"\< atx = \>\"", ",", "atx"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", " ", 
       RowBox[{
        RowBox[{"verb", "\[GreaterEqual]", "2"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<HeatFlux[t=0] = \>\"", ",", 
          RowBox[{"HeatFlux", "/.", 
           RowBox[{"t", "\[Rule]", "0"}]}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"Temp", "[", 
           RowBox[{"x", ",", "t"}], "]"}], ",", "x"}], "]"}], "\[Equal]", 
        RowBox[{"-", 
         FractionBox["HeatFlux", "thermcond"]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "  ", "=", " ", 
       RowBox[{"res", "/.", 
        RowBox[{"x", "\[Rule]", "atx"}]}]}], ";", "\[IndentingNewLine]", 
      "res"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6228218366519775`*^9, 3.622821869505974*^9}, {
   3.6228220406400166`*^9, 3.6228221033683643`*^9}, {3.622822138359583*^9, 
   3.6228221893877935`*^9}, {3.622822956963765*^9, 3.622822960785808*^9}, {
   3.6228229913777466`*^9, 3.6228230168372355`*^9}, {3.622823703495535*^9, 
   3.622823751559718*^9}, 3.622823792042227*^9, {3.62282385297655*^9, 
   3.6228238704175596`*^9}, {3.62282487701756*^9, 3.62282491023033*^9}, {
   3.622867393923675*^9, 3.6228674251708784`*^9}, {3.6228674602400846`*^9, 
   3.6228674664957075`*^9}, 3.6228678304323044`*^9},
 CellLabel->
  "In[893]:=",ExpressionUUID->"8cfbd026-5492-405c-bdd6-4a4511fc459f"],

Cell[, "Text",ExpressionUUID->"caad99fa-8d6a-445f-bf7f-228c13779f4f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"HeatFluxRadiation", "[", 
    RowBox[{"ID_", ",", "atx_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"param", "  ", "=", " ", 
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"pbndcondparam", "/.", "TempEvoInput"}], ",", "ID"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"verb", "  ", "=", " ", 
        RowBox[{"pVERBOSE", "/.", "TempEvoInput"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"thermcond", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"pthermcond", "/.", "TempEvoInput"}], ")"}], "/", 
         "tolenscale"}]}], ",", "\[IndentingNewLine]", "radonpar", " ", ",", 
       "\[IndentingNewLine]", "HeatFlux", ",", "propconst", ",", "res", ",", 
       "radonfunc", ",", " ", "thermrad"}], "\[IndentingNewLine]", "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"radonpar", " ", "=", " ", 
       RowBox[{"pradonpar", "/.", "param"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"HeatFlux", " ", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"HEATFLUX", "/.", "param"}], ")"}], "/", 
        SuperscriptBox["tolenscale", "2"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"propconst", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"TPOW4PROP", "/.", "param"}], ")"}], "/", 
        SuperscriptBox["tolenscale", "2"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"thermrad", "=", 
       RowBox[{"propconst", "*", 
        SuperscriptBox[
         RowBox[{"Temp", "[", 
          RowBox[{"atx", ",", "t"}], "]"}], "4"]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"radonfunc", "=", 
       RowBox[{"1", "-", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "radonpar"}], "*", "t"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", " ", 
       RowBox[{
        RowBox[{"verb", "\[GreaterEqual]", "2"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<HeatFluxRadiation: ID = \>\"", ",", "ID", ",", 
          "\"\< HeatFlux = \>\"", ",", "HeatFlux", ",", " ", 
          "\"\< thermcond = \>\"", ",", "thermcond", ",", " ", 
          "\"\< propconst = \>\"", ",", "propconst", ",", " ", 
          "\"\< atx = \>\"", ",", "atx"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", " ", 
       RowBox[{
        RowBox[{"verb", "\[GreaterEqual]", "2"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<HeatFluxRadiation[t=0] = \>\"", ",", 
          RowBox[{"HeatFlux", "/.", 
           RowBox[{"t", "\[Rule]", "0"}]}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", " ", 
       RowBox[{
        RowBox[{"verb", "\[GreaterEqual]", "2"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<HeatFluxRadiation[t=0] = \>\"", ",", 
          RowBox[{"thermrad", "/.", 
           RowBox[{"t", "\[Rule]", "0"}]}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"Temp", "[", 
           RowBox[{"x", ",", "t"}], "]"}], ",", "x"}], "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"-", "radonfunc"}], "*", 
         FractionBox[
          RowBox[{"HeatFlux", "-", "thermrad"}], "thermcond"]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "  ", "=", " ", 
       RowBox[{"res", "/.", 
        RowBox[{"x", "\[Rule]", "atx"}]}]}], ";", "\[IndentingNewLine]", 
      "res"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6228218366519775`*^9, 3.622821869505974*^9}, {
   3.6228220406400166`*^9, 3.6228221033683643`*^9}, {3.622822138359583*^9, 
   3.6228221893877935`*^9}, {3.622822956963765*^9, 3.622822960785808*^9}, {
   3.6228229913777466`*^9, 3.6228230168372355`*^9}, {3.622823703495535*^9, 
   3.622823751559718*^9}, 3.622823792042227*^9, {3.62282385297655*^9, 
   3.6228238704175596`*^9}, {3.62282487701756*^9, 3.62282491023033*^9}, {
   3.622867393923675*^9, 3.6228674251708784`*^9}, {3.6228674602400846`*^9, 
   3.6228674664957075`*^9}, 3.6228678304323044`*^9, {3.623493831273985*^9, 
   3.623493834097585*^9}, {3.6234940814485855`*^9, 3.623494149058985*^9}, {
   3.6234942355453854`*^9, 3.6234942547489853`*^9}, {3.623494778534585*^9, 
   3.623494780765385*^9}, {3.6234950350765853`*^9, 3.623495111485385*^9}, {
   3.6234951502357855`*^9, 3.6234952496857853`*^9}, {3.623495322366185*^9, 
   3.6234953342533855`*^9}, 3.623495373502985*^9},
 CellLabel->
  "In[894]:=",ExpressionUUID->"31ab3377-5cc3-47d9-8d5e-8e2d1cd4c5d1"]
}, Closed]],

Cell[CellGroupData[{

Cell[, "Section",ExpressionUUID->"0e2d7743-ed08-4c7a-84c1-82a4e2e86b3c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BuildHeatTransDGL", "[", "Grd_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"initfunc", "=", 
       RowBox[{"(", 
        RowBox[{"pInitTemp", "/.", "TempEvoInput"}], ")"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"thermcond", "=", 
       RowBox[{"(", 
        RowBox[{"pthermcond", "/.", "TempEvoInput"}], ")"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"HeatCapDens", "=", 
       RowBox[{"(", 
        RowBox[{"pHeatCapDens", "/.", "TempEvoInput"}], ")"}]}], ",", 
      "\[IndentingNewLine]", "heatdiff", ",", "\[IndentingNewLine]", 
      RowBox[{"verb", "  ", "=", " ", 
       RowBox[{"pVERBOSE", "/.", "TempEvoInput"}]}], ",", 
      "\[IndentingNewLine]", "eqn", ",", "vars", ",", "\[IndentingNewLine]", 
      RowBox[{"xmin", "  ", "=", " ", "0.0"}], ",", "\[IndentingNewLine]", 
      RowBox[{"xmax", "=", 
       RowBox[{"Max", "[", "Grd", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"bndcond", "=", 
       RowBox[{"pbndcond", "/.", "TempEvoInput"}]}], ",", 
      "\[IndentingNewLine]", "frontbnd", ",", "backbnd"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"heatdiff", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"thermcond", "/", "HeatCapDens"}], ")"}], "*", 
       SuperscriptBox["tolenscale", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"frontbnd", "=", 
      RowBox[{
       RowBox[{"Part", "[", 
        RowBox[{"bndcond", ",", "1"}], "]"}], "[", 
       RowBox[{"1", ",", "xmin"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"backbnd", "=", 
      RowBox[{
       RowBox[{"Part", "[", 
        RowBox[{"bndcond", ",", "2"}], "]"}], "[", 
       RowBox[{"2", ",", "xmax"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"verb", ">", "0"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Boundary condtions:\>\"", ",", 
         RowBox[{"TableForm", "[", 
          RowBox[{"{", 
           RowBox[{"frontbnd", ",", "backbnd"}], "}"}], "]"}]}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"verb", ">", "0"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Initial temperature:\>\"", ",", "initfunc"}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"verb", ">", "2"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Heat diffusivity (um^2/s):\>\"", ",", "heatdiff"}], 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"eqn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"Temp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], ",", "t"}], "]"}], "==", 
         RowBox[{"heatdiff", "*", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"Temp", "[", 
             RowBox[{"x", ",", "t"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "2"}], "}"}]}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Temp", "[", 
          RowBox[{"x", ",", "0"}], "]"}], "==", "initfunc"}], ",", 
        "\[IndentingNewLine]", "frontbnd", ",", "\[IndentingNewLine]", 
        "backbnd"}], "\[IndentingNewLine]", "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vars", "=", "Temp"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"TableForm", "[", "eqn", "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DGL", "->", "eqn"}], ",", "\[IndentingNewLine]", 
       RowBox[{"VARS", "->", "vars"}]}], "\[IndentingNewLine]", "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.62282220935599*^9, 3.6228222149720974`*^9}, {
   3.6228223893041844`*^9, 3.622822397556682*^9}, {3.622822438990777*^9, 
   3.6228224442324405`*^9}, {3.622822589236128*^9, 3.622822940240324*^9}, {
   3.622823025744941*^9, 3.622823072280347*^9}, {3.622823104635128*^9, 
   3.6228231179576902`*^9}, {3.622823148799254*^9, 3.622823193275352*^9}, 
   3.622823406108732*^9, {3.622823488197376*^9, 3.6228235787096357`*^9}, {
   3.6228236487856708`*^9, 3.622823651484503*^9}, {3.622824976312718*^9, 
   3.622824984268832*^9}, 3.622825076387932*^9, {3.6228252190983987`*^9, 
   3.6228252212200656`*^9}, {3.6228675166034937`*^9, 
   3.6228676384409065`*^9}, {3.623569390358626*^9, 3.623569403570947*^9}},
 CellLabel->
  "In[895]:=",ExpressionUUID->"8b9bab9b-2b62-4be6-99ca-0efb046a809e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SolveHeatCondDLG", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PrecGoal", "\[Rule]", "8"}], ",", 
     RowBox[{"AccGoal", "\[Rule]", "10"}], ",", 
     RowBox[{"DiffOrder", "\[Rule]", "4"}], ",", 
     RowBox[{"MaxStepSize", "->", 
      FractionBox["1", "100"]}], ",", 
     RowBox[{"MAXBDFORD", "\[Rule]", "5"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SolveHeatCondDLG", "[", 
   RowBox[{"eqnbuild_", ",", "tmax_", ",", "grd_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "i", ",", "\[IndentingNewLine]", "vars", ",", "dgl", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"acc", "=", 
       RowBox[{"OptionValue", "[", "PrecGoal", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"prec", "=", 
       RowBox[{"OptionValue", "[", "AccGoal", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"dord", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "DiffOrder", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"xmax", "=", 
       RowBox[{"Max", "[", "grd", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"maxtstepsize", "=", 
       RowBox[{"OptionValue", "[", "MaxStepSize", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"maxbdford", "=", 
       RowBox[{"OptionValue", "[", "MAXBDFORD", "]"}]}], ",", 
      "\[IndentingNewLine]", "res"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Clear", "[", 
      RowBox[{"x", ",", "t", ",", "Temp"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"dgl", "=", 
      RowBox[{"DGL", "/.", "eqnbuild"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vars", "=", 
      RowBox[{"VARS", "/.", "eqnbuild"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<solving from x = 0 to \>\"", ",", " ", "xmax", ",", " ", 
       "\"\< and t = 0 to \>\"", ",", "tmax", ",", " ", 
       "\"\< with acc = \>\"", ",", " ", "acc", ",", " ", "\"\< prec = \>\"", 
       ",", " ", "prec", ",", " ", "\"\< on a grid with \>\"", ",", 
       RowBox[{"Length", "[", "grd", "]"}], ",", " ", "\"\< steps\>\""}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ShowStatus", "[", "\"\<Waiting for NDSolve to start\>\"", "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"Timing", "[", 
       RowBox[{"NDSolve", "[", 
        RowBox[{"dgl", ",", "vars", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", "xmax"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "tmax"}], "}"}], ",", 
         RowBox[{"MaxSteps", "\[Rule]", "1000000"}], ",", 
         RowBox[{"StepMonitor", "\[RuleDelayed]", 
          RowBox[{"ShowStatus", "[", 
           RowBox[{"\"\<Step: \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"i", "++"}], "]"}], "<>", "\"\<@ t = \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"InputForm", "[", "t", "]"}], "]"}]}], "]"}]}], ",", 
         "  ", 
         RowBox[{"MaxStepSize", "\[Rule]", "maxtstepsize"}], ",", "  ", 
         RowBox[{"AccuracyGoal", "\[Rule]", "acc"}], ",", 
         RowBox[{"PrecisionGoal", "\[Rule]", "prec"}], ",", 
         "\[IndentingNewLine]", " ", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"$VersionNumber", ">", "7"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<Using Version 7+ code\>\"", "]"}], ";",
             "\[IndentingNewLine]", 
            RowBox[{"Method", "\[Rule]", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{"\"\<MethodOfLines\>\"", ",", "\[IndentingNewLine]", 
               RowBox[{
               "\"\<DifferentiateBoundaryConditions\>\"", "\[Rule]", 
                "False"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Method", "\[Rule]", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{"IDA", ",", "\[IndentingNewLine]", 
                  RowBox[{
                  "\"\<MaxDifferenceOrder\>\"", "\[Rule]", "maxbdford"}], ",",
                   "\[IndentingNewLine]", 
                  RowBox[{
                  "\"\<EquationSimplification\>\"", "\[Rule]", 
                   "\"\<Residual\>\""}], ",", "\[IndentingNewLine]", " ", 
                  RowBox[{"\"\<ImplicitSolver\>\"", "\[Rule]", 
                   RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"\"\<Newton\>\"", ",", "\[IndentingNewLine]", " ", 
                    RowBox[{
                    "\"\<LinearSolveMethod\>\"", "\[Rule]", "Automatic"}]}], 
                    RowBox[{"(*", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Band\>\"", ",", 
                    RowBox[{"\"\<BandWidth\>\"", "\[Rule]", "12"}]}], "}"}], 
                    "*)"}], "}"}]}]}], "\[IndentingNewLine]", "}"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"\"\<SpatialDiscretization\>\"", "\[Rule]", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                 "\"\<TensorProductGrid\>\"", ",", "\[IndentingNewLine]", " ", 
                  RowBox[{"\"\<DifferenceOrder\>\"", "\[Rule]", "dord"}], ",",
                   "\[IndentingNewLine]", 
                  RowBox[{"\"\<Coordinates\>\"", "\[Rule]", 
                   RowBox[{"{", "grd", "}"}]}]}], "}"}]}]}], 
              "\[IndentingNewLine]", "}"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<Using Version <7 code\>\"", "]"}], ";",
             "\[IndentingNewLine]", 
            RowBox[{"Method", "\[Rule]", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{"\"\<MethodOfLines\>\"", ",", "\[IndentingNewLine]", 
               RowBox[{
               "\"\<DifferentiateBoundaryConditions\>\"", "\[Rule]", 
                "False"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Method", "\[Rule]", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{"IDA", ",", "\[IndentingNewLine]", 
                  RowBox[{
                  "\"\<MaxDifferenceOrder\>\"", "\[Rule]", "maxbdford"}], ",",
                   "\[IndentingNewLine]", " ", 
                  RowBox[{"\"\<ImplicitSolver\>\"", "\[Rule]", 
                   RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"\"\<Newton\>\"", ",", "\[IndentingNewLine]", " ", 
                    RowBox[{
                    "\"\<LinearSolveMethod\>\"", "\[Rule]", "Automatic"}]}], 
                    RowBox[{"(*", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Band\>\"", ",", 
                    RowBox[{"\"\<BandWidth\>\"", "\[Rule]", "12"}]}], "}"}], 
                    "*)"}], "}"}]}]}], "\[IndentingNewLine]", "}"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"\"\<SpatialDiscretization\>\"", "\[Rule]", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                 "\"\<TensorProductGrid\>\"", ",", "\[IndentingNewLine]", " ", 
                  RowBox[{"\"\<DifferenceOrder\>\"", "\[Rule]", "dord"}], ",",
                   "\[IndentingNewLine]", 
                  RowBox[{"\"\<Coordinates\>\"", "\[Rule]", 
                   RowBox[{"{", "grd", "}"}]}]}], "}"}]}]}], 
              "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", 
          "]"}], ",", 
         RowBox[{"NormFunction", "\[Rule]", "\[Infinity]"}]}], "]"}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Time for solution: \>\"", ",", 
       RowBox[{"res", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\"\< sec\>\""}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"DateString", "[", 
       RowBox[{"{", 
        RowBox[{
        "\"\<DayName\>\"", ",", " ", "\"\<  \>\"", ",", "\"\<Month\>\"", ",", 
         "\"\</\>\"", ",", "\"\<YearShort\>\"", ",", "\"\<-> \>\"", ",", 
         "\"\<Hour\>\"", ",", "\"\<:\>\"", ",", "\"\<Minute\>\"", ",", 
         "\"\<:\>\"", ",", "\"\<Second\>\""}], "}"}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"First", "[", 
      RowBox[{"res", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6228232696850543`*^9, 3.6228233747991214`*^9}, 
   3.6228252606729326`*^9, 3.6235789309475374`*^9, {3.6235789684657784`*^9, 
   3.623578968886981*^9}, 3.6248741476787786`*^9, {3.6248741972912784`*^9, 
   3.6248742117550287`*^9}, 3.626497848584753*^9},
 CellLabel->
  "In[896]:=",ExpressionUUID->"d54785c7-61d6-451b-a0e3-1f280754cb84"]
}, Open  ]],

Cell[CellGroupData[{

Cell[, "Section",ExpressionUUID->"27f73f6b-3c6a-44be-a942-d0ce47c34a2d"],

Cell[, "Text",ExpressionUUID->"b39cd6e6-92a7-4cc4-8bb9-c853b4ff61b1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "EQHeatTransDGL", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"ATTIME", "\[Rule]", "t"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EQHeatTransDGL", "[", 
   RowBox[{"FrontFlux_", ",", "BackTemp_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"att", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "ATTIME", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"thermcond", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"pthermcond", "/.", "TempEvoInput"}], ")"}], "/", 
        "tolenscale"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"verb", "  ", "=", " ", 
       RowBox[{"pVERBOSE", "/.", "TempEvoInput"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"xmin", "  ", "=", " ", "0.0"}], ",", "\[IndentingNewLine]", 
      RowBox[{"xmax", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"pThickness", "/.", "TempEvoInput"}], ")"}], "*", 
        "tolenscale"}]}], ",", "\[IndentingNewLine]", "tempgrad", " ", ",", 
      "frontfluxloc"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ClearAll", "[", "FrontTemp", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"tempgrad", "=", 
      FractionBox[
       RowBox[{"BackTemp", "-", "FrontTemp"}], 
       RowBox[{"xmax", "-", "xmin"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"frontfluxloc", " ", "=", " ", 
      RowBox[{"FrontFlux", "/", 
       SuperscriptBox["tolenscale", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", " ", 
      RowBox[{
       RowBox[{"verb", "\[GreaterEqual]", "2"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<EQHeatTransDGL: FrontFlux = \>\"", ",", "frontfluxloc", ",", 
         " ", "\"\< Therm. cond. (W/(um*K)) = \>\"", ",", "thermcond", ",", 
         " ", "\"\< BackTemp = \>\"", ",", "BackTemp", ",", 
         "\"\< thickness = \>\"", ",", " ", 
         RowBox[{"xmax", "-", "xmin"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"FrontTemp", "/.", 
        RowBox[{"First", "[", 
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{"frontfluxloc", "\[Equal]", 
            RowBox[{
             RowBox[{"-", "tempgrad"}], "*", "thermcond"}]}], ",", 
           "FrontTemp"}], "]"}], "]"}]}], ")"}], "/.", 
      RowBox[{"t", "->", "att"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.622865109283599*^9, 3.62286515218405*^9}, {
  3.622865189172118*^9, 3.6228652528208075`*^9}, {3.622865365605508*^9, 
  3.6228655159912868`*^9}, {3.622865600637862*^9, 3.6228656461903887`*^9}, {
  3.6228657244258823`*^9, 3.6228658506579237`*^9}, {3.622866526833225*^9, 
  3.622866567643291*^9}, {3.6228676635416307`*^9, 3.622867695319188*^9}},
 CellLabel->
  "In[898]:=",ExpressionUUID->"91d7e856-7551-4521-bff8-d6fe6ad80225"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "EQHeatTransRadiationDGL", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"ATTIME", "\[Rule]", "t"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EQHeatTransRadiationDGL", "[", 
   RowBox[{"FrontFlux_", ",", "radconst_", ",", "BackTemp_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"att", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "ATTIME", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"thermcond", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"pthermcond", "/.", "TempEvoInput"}], ")"}], "/", 
        "tolenscale"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"verb", "  ", "=", " ", 
       RowBox[{"pVERBOSE", "/.", "TempEvoInput"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"xmin", "  ", "=", " ", "0.0"}], ",", "\[IndentingNewLine]", 
      RowBox[{"xmax", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"pThickness", "/.", "TempEvoInput"}], ")"}], "*", 
        "tolenscale"}]}], ",", "\[IndentingNewLine]", "tempgrad", " ", ",", 
      "frontfluxloc"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ClearAll", "[", "FrontTemp", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"tempgrad", "=", 
      FractionBox[
       RowBox[{"BackTemp", "-", "FrontTemp"}], 
       RowBox[{"xmax", "-", "xmin"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"frontfluxloc", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"FrontFlux", "-", 
         RowBox[{"radconst", "*", 
          SuperscriptBox["FrontTemp", "4"]}]}], ")"}], "/", 
       SuperscriptBox["tolenscale", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", " ", 
      RowBox[{
       RowBox[{"verb", "\[GreaterEqual]", "2"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<EQHeatTransRadiationDGL: FrontFlux = \>\"", ",", "frontfluxloc", 
         ",", " ", "\"\< Therm. cond. (W/(um*K)) = \>\"", ",", "thermcond", 
         ",", " ", "\"\< BackTemp = \>\"", ",", "BackTemp", ",", 
         "\"\< thickness = \>\"", ",", " ", 
         RowBox[{"xmax", "-", "xmin"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"FrontTemp", "/.", 
        RowBox[{"First", "[", 
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{"frontfluxloc", "\[Equal]", 
            RowBox[{
             RowBox[{"-", "tempgrad"}], "*", "thermcond"}]}], ",", 
           "FrontTemp"}], "]"}], "]"}]}], ")"}], "/.", 
      RowBox[{"t", "->", "att"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6234942852001853`*^9, 3.623494376600585*^9}},
 CellLabel->
  "In[900]:=",ExpressionUUID->"f8631201-5d39-4483-a647-fa086d1eb817"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell[, "Title",ExpressionUUID->"e98598f2-58aa-4482-b205-f5f5c3039b0e"],

Cell[CellGroupData[{

Cell[, "Section",ExpressionUUID->"6d7d4a65-c611-42b3-8ed4-164c495fed8c"],

Cell[CellGroupData[{

Cell[, "Subsection",ExpressionUUID->"1b49856b-8930-4ee9-9cb9-83e5a4a2082c"],

Cell[, "Input",ExpressionUUID->"ffffed4f-139e-4528-ba17-9d2dd9b4ba4c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[, "Subsection",ExpressionUUID->"ea8d33a4-4df9-45d0-9c70-1a9d3508b2e4"],

Cell[, "Input",ExpressionUUID->"abb3365d-135b-4486-b6b6-01af0549145e"],

Cell[, "Input",ExpressionUUID->"517b679a-43ea-48c3-a31f-35afa8f434d8"],

Cell[, "Input",ExpressionUUID->"1a54df89-13f1-4339-824f-f2cfe4302ea9"],

Cell[, "Input",ExpressionUUID->"fd7fac69-937c-4f8f-b01d-2544428ed736"],

Cell[, "Input",ExpressionUUID->"70db50d5-26cd-47a0-b25f-a5b33ddc49dc"],

Cell[, "Input",ExpressionUUID->"e287fcb5-bfc5-43ae-bfcc-13b9a4cab318"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[, "Section",ExpressionUUID->"4fb068c0-01e3-4e4c-ac39-e0510e16d059"],

Cell[CellGroupData[{

Cell[, "Subsection",ExpressionUUID->"f21350ff-f54a-477a-b749-75c5d3b4eed6"],

Cell[, "Text",ExpressionUUID->"5932a0b8-6bd2-4769-93c2-51f2d26eacab"],

Cell[, "Input",ExpressionUUID->"bdae9b74-47ea-419b-8d1b-70ba3ee9eb9b"],

Cell[, "Text",ExpressionUUID->"034fd4ac-135d-4d19-8aef-d7bce1acfd78"],

Cell[, "Input",ExpressionUUID->"6ffd970c-70c2-4e80-9204-36d64ba916ad"],

Cell[, "Text",ExpressionUUID->"2d52e4fd-535e-4002-ace9-d7d261b05bd0"],

Cell[, "Input",ExpressionUUID->"5b7b8149-777c-477a-a2ab-ba9d9dad25f3"],

Cell[, "Text",ExpressionUUID->"03eedcef-6f48-4d6b-9d26-664c8b4a63d2"],

Cell[, "Input",ExpressionUUID->"53a5e8bc-0261-4cf0-b012-1e58353b3940"]
}, Open  ]],

Cell[CellGroupData[{

Cell[, "Subsection",ExpressionUUID->"3a136904-ff38-4fb0-b5c7-74995067f3ac"],

Cell[, "Input",ExpressionUUID->"fd359b95-79a7-4336-b860-0e4e3ee13b62"],

Cell[, "Input",ExpressionUUID->"77fbb3c6-d2eb-41c6-a1fc-f88c70339649"]
}, Open  ]],

Cell[CellGroupData[{

Cell[, "Subsection",ExpressionUUID->"bc8ee408-4dd8-4732-add7-ebb4881916cc"],

Cell[, "Input",ExpressionUUID->"c10d1251-dd69-4731-b062-eddd6223009e"],

Cell[, "Input",ExpressionUUID->"f1ed60d2-6b87-40f3-b2ed-7972ccb40006"]
}, Open  ]],

Cell[CellGroupData[{

Cell[, "Subsection",ExpressionUUID->"c5f7ec51-8497-4242-a6f7-da8cb812fab9"],

Cell[, "Input",ExpressionUUID->"00d2e1a2-2f0f-4d64-8e2a-fc16d5dc4365"],

Cell[, "Text",ExpressionUUID->"09270639-ef6a-4ace-9341-fcaa55617e58"],

Cell[, "Input",ExpressionUUID->"f71ef1bc-a3e7-4b0f-bbf9-50bdf842e5ba"],

Cell[, "Text",ExpressionUUID->"02a9b419-2e2b-480c-a84e-ef4d6856e3fd"],

Cell[, "Input",ExpressionUUID->"2b8ac056-7477-43c2-b6ea-265b9c9e22ee"],

Cell[, "Text",ExpressionUUID->"52d87045-886d-47a4-9d8d-cb95936e3c3d"],

Cell[, "Input",ExpressionUUID->"7b8255a3-5a24-4af6-8c0a-1537313babf4"],

Cell[, "Text",ExpressionUUID->"5203bd73-8f9c-42e4-abdb-a07e8d0bf288"],

Cell[, "Input",ExpressionUUID->"7167b9e3-3b29-4156-9c9e-0b7a5f092416"],

Cell[, "Text",ExpressionUUID->"7108506a-ffc4-4457-b266-39cb668ab7fa"],

Cell[, "Input",ExpressionUUID->"33bed836-ba53-402c-8ae4-1402916d3954"]
}, Open  ]],

Cell[CellGroupData[{

Cell[, "Subsection",ExpressionUUID->"7cab03e6-25d1-412d-98a5-b3c2a4c7bb9e"],

Cell[, "Input",ExpressionUUID->"be9845c8-56d4-4934-a599-75e73098a1ff"],

Cell[, "Input",ExpressionUUID->"fd015f1b-ba38-4a2b-ab5b-e3340de83caa"],

Cell[, "Input",ExpressionUUID->"0a05c789-2e1f-4b13-b47a-7e667b07e7f2"],

Cell[, "Input",ExpressionUUID->"b10e7250-2a84-46af-9f96-bee1c3857c4c"],

Cell[, "Input",ExpressionUUID->"d1a5f917-3806-4582-b444-f79ef7bc70e5"],

Cell[, "Input",ExpressionUUID->"a81e892a-dd03-4734-a2fa-314ad640fa27"],

Cell[, "Input",ExpressionUUID->"ac623382-a0cd-4445-b7c6-afbd44083be0"],

Cell[, "Input",ExpressionUUID->"81cc685b-c3c5-4ea5-9076-f82e697c6926"],

Cell[, "Input",ExpressionUUID->"53e5af9a-672d-4006-8c4d-260adc588f1c"],

Cell[, "Input",ExpressionUUID->"195ccb87-20c9-4765-a4c5-858e6ef5eabd"],

Cell[, "Input",ExpressionUUID->"6dd1af4a-df30-4814-917d-f39893db0924"],

Cell[, "Input",ExpressionUUID->"aacc1fd0-3b32-4e3a-b43c-f76959318e59"],

Cell[, "Input",ExpressionUUID->"04a9e615-9181-4d00-8a82-4abf8cfbb911"],

Cell[, "Input",ExpressionUUID->"55fb58a0-3952-4c05-8a8a-e95c671ba413"],

Cell[, "Input",ExpressionUUID->"eee46780-406a-4685-b6db-8d33312a57a0"],

Cell[, "Input",ExpressionUUID->"22df8872-0af5-443f-a7c6-2ad18ebb38c3"],

Cell[, "Input",ExpressionUUID->"048932aa-6639-45b6-91c7-dd1365ce6127"],

Cell[, "Input",ExpressionUUID->"4a796ab0-dc33-486a-94f4-f68ec69e780b"],

Cell[, "Input",ExpressionUUID->"c483a6f8-ef5a-4ee7-b993-7f3eaaa7e19e"],

Cell[, "Input",ExpressionUUID->"56cd7950-299e-4331-9d2a-322b40e058e8"],

Cell[, "Text",ExpressionUUID->"441fd225-ceea-4a18-b0fa-15b93f41143a"],

Cell[, "Input",ExpressionUUID->"c7827c85-0187-488f-988f-dc2fe304fddd"],

Cell[, "Text",ExpressionUUID->"a5e982da-4928-414b-a677-f25c4a7ad445"],

Cell[, "Input",ExpressionUUID->"1024bbed-78e8-4c28-bac4-86cb4637c305"],

Cell[, "Text",ExpressionUUID->"c0ac7ea1-8bd6-4a7d-b1bb-d8ddcfc9c29d"],

Cell[, "Input",ExpressionUUID->"28d8e67f-510d-44a6-bb82-c911e1ffc1d2"],

Cell[CellGroupData[{

Cell[, "Subsubsection",ExpressionUUID->"32b49e81-c702-4def-aa76-f0961296ee74"],

Cell[, "Input",ExpressionUUID->"63cb5373-98cb-4446-84b1-c047c627985b"],

Cell[, "Input",ExpressionUUID->"2e149189-f4e5-401d-8ead-0cd169762a49"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[, "Section",ExpressionUUID->"1ed2916c-d648-4e2b-8af0-3af9d907f224"],

Cell[, "Input",ExpressionUUID->"2d63408f-8441-45cb-a499-3a5659b9a2d4"],

Cell[, "Input",ExpressionUUID->"9f61725d-5fde-4e42-8793-ddffb0482f36"],

Cell[, "Input",ExpressionUUID->"66a0f074-f1a0-410b-9266-45c0c36b14bc"],

Cell[, "Input",ExpressionUUID->"e1b85ddf-94c0-4390-97be-3ec6d653f54f"],

Cell[, "Input",ExpressionUUID->"9983e21a-438f-4b0a-99ad-1a7756525220"],

Cell[, "Input",ExpressionUUID->"4ada022d-0f1e-4f3e-b87f-6d2fd21cded7"],

Cell[, "Input",ExpressionUUID->"988293d4-efc8-44b7-9a73-5375414bcb75"],

Cell[, "Input",ExpressionUUID->"9927c769-c6e4-4146-aa32-564a61030645"],

Cell[, "Input",ExpressionUUID->"265ac958-a162-4296-8070-bbc4e673f1e3"],

Cell[, "Input",ExpressionUUID->"b06b4d44-d5ed-4839-8ee9-291517cbb8c1"],

Cell[, "Input",ExpressionUUID->"7f25adb5-3db8-4796-a990-964e9cf0680f"],

Cell[, "Input",ExpressionUUID->"b5468208-a70d-409c-aeaf-0a9a0c8704f0"],

Cell[, "Input",ExpressionUUID->"113e551b-80a5-4ffc-980a-20f2200e84ff"]
}, Open  ]],

Cell[CellGroupData[{

Cell[, "Section",ExpressionUUID->"5de02d5c-74ae-4679-839f-b383bfe465b5"],

Cell[, "Input",ExpressionUUID->"1aaa4093-b810-441c-a33d-1b20785cee03"],

Cell[, "Input",ExpressionUUID->"2a1af275-e656-4062-9e6a-c41a9a4ac0fc"],

Cell[CellGroupData[{

Cell[, "Subsection",ExpressionUUID->"fbd8f892-565a-491b-9b84-4333b5474cfc"],

Cell[, "Input",ExpressionUUID->"2ba7c0bc-168e-41ab-9f8c-a531c5e9681f"],

Cell[, "Input",ExpressionUUID->"33d67895-f907-4931-adae-1eecf31e828a"],

Cell[, "Input",ExpressionUUID->"9baa6729-cfb6-49be-ab9c-2f91ddc2e37f"],

Cell[, "Input",ExpressionUUID->"2121c8b9-0c6c-43c5-8de9-f58d383b0453"],

Cell[, "Input",ExpressionUUID->"025c52f5-6beb-4edd-98ac-c834a5173d6b"],

Cell[, "Input",ExpressionUUID->"55eb6ae9-f0e9-47bd-805d-4b535a5260a0"],

Cell[, "Input",ExpressionUUID->"90b8c0ae-d1db-4183-9820-0e8f79a55c29"],

Cell[, "Input",ExpressionUUID->"37223579-4399-4b52-b349-e3ea09ef7566"]
}, Open  ]],

Cell[CellGroupData[{

Cell[, "Subsection",ExpressionUUID->"72d4475b-fdd4-4f22-89dc-964295460258"],

Cell[, "Input",ExpressionUUID->"88347766-580b-4613-9fca-86d74871c617"],

Cell[, "Input",ExpressionUUID->"d8ca47a6-a965-4e52-a057-270f1f4a7685"],

Cell[, "Input",ExpressionUUID->"7fb48858-5d46-41ac-9b20-724cd618f75c"],

Cell[, "Input",ExpressionUUID->"d729c5e7-02e7-4517-9538-05dc02a2fdbc"],

Cell[, "Input",ExpressionUUID->"7950885c-4a92-4176-85e9-554467dbcfc8"],

Cell[, "Input",ExpressionUUID->"77bc41ef-8931-4179-8b84-5fe4661c5dee"],

Cell[, "Input",ExpressionUUID->"cc54e975-8fe1-47c2-a764-c42792c6de8a"],

Cell[, "Input",ExpressionUUID->"fdfcaba5-a05b-45bb-8564-a6ac48733698"],

Cell[CellGroupData[{

Cell[, "Input",ExpressionUUID->"29a6f4bd-90c2-44d4-a791-9b07bc43cd9b"],

Cell[, "Output",ExpressionUUID->"6055bb42-5c56-431e-816e-76012a9df34f"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->None,
WindowSize->{923, 813},
WindowMargins->{{410, Automatic}, {129, Automatic}},
FrontEndVersion->"12.0 for Linux x86 (64-bit) (April 8, 2019)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> 
     FrontEnd`FileName[{"Report"}, "StandardReport.nb", CharacterEncoding -> 
       "WindowsANSI"]]], 
   Cell[
    StyleData["Text"], FontFamily -> "Arial", FontSize -> 18, FontWeight -> 
    "Plain", FontSlant -> "Plain", 
    FontVariations -> {"StrikeThrough" -> False, "Underline" -> False}]}, 
  Visible -> False, FrontEndVersion -> 
  "12.0 for Linux x86 (64-bit) (April 8, 2019)", StyleDefinitions -> 
  "PrivateStylesheetFormatting.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[400, 13, 520, 11, 89, "Input",ExpressionUUID->"166d26df-a065-4536-b717-2c251a7ef3fc",
 InitializationCell->True],
Cell[923, 26, 188, 4, 42, "Input",ExpressionUUID->"f24d2158-8d12-44ba-ba18-2025e525c683"],
Cell[CellGroupData[{
Cell[1136, 34, 160, 3, 70, "Section",ExpressionUUID->"e90d64f2-f1d3-40bf-8d70-d22907319647"],
Cell[1299, 39, 38894, 671, 2630, "Input",ExpressionUUID->"233769b9-a04a-4b26-958f-78fda9491e0f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40230, 715, 157, 3, 98, "Title",ExpressionUUID->"4c9465e2-421e-4a32-ad95-16433b225dae"],
Cell[CellGroupData[{
Cell[40412, 722, 170, 3, 70, "Section",ExpressionUUID->"311cfcb9-312f-4203-ad32-f621a8f54336"],
Cell[40585, 727, 3445, 87, 388, "Input",ExpressionUUID->"e8f0d03e-dca1-4443-b6ae-21d6048623a4",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[44067, 819, 221, 4, 70, "Section",ExpressionUUID->"588498bc-edff-4eac-a123-ad4bcd3e0e40"],
Cell[44291, 825, 682, 17, 112, "Input",ExpressionUUID->"8c7d260b-a2cb-4fb9-badb-cab86184867d",
 InitializationCell->True],
Cell[44976, 844, 15252, 409, 1935, "Input",ExpressionUUID->"c5780e2e-bd38-4cf6-b22f-b486d36eeceb",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[60265, 1258, 221, 4, 70, "Section",ExpressionUUID->"f88c44b5-2796-4aeb-a19d-e2f6fc7ea113"],
Cell[60489, 1264, 3956, 80, 273, "Input",ExpressionUUID->"3f55507c-594e-4213-b3d9-e4f323c65fed",
 InitializationCell->True],
Cell[64448, 1346, 282, 9, 115, "Program",ExpressionUUID->"a76bc807-bd11-403f-9d52-f81c42140b15"],
Cell[64733, 1357, 31662, 715, 3424, "Input",ExpressionUUID->"5fe7c176-4635-43ab-ad4a-6541c98a52c5",
 InitializationCell->True],
Cell[96398, 2074, 319, 8, 97, "Program",ExpressionUUID->"e47c65f6-756a-49a8-bbd3-cf5a53737baf"],
Cell[96720, 2084, 5393, 108, 641, "Input",ExpressionUUID->"2b8df77f-a99f-408a-bdb4-df3f85ce46b4",
 InitializationCell->True],
Cell[102116, 2194, 6533, 146, 779, "Input",ExpressionUUID->"76da01f9-6398-48ee-9b38-3190bd2fcdae",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[108686, 2345, 238, 4, 70, "Section",ExpressionUUID->"4fd6228c-3631-4183-9aac-0c246839c1cb"],
Cell[108927, 2351, 192, 3, 39, "Text",ExpressionUUID->"4edaaef0-6eb6-471c-b4ee-8186125924a5"],
Cell[109122, 2356, 622, 17, 136, "Program",ExpressionUUID->"8b26d6b4-b852-4734-adb2-31cd04125203"],
Cell[109747, 2375, 2652, 64, 530, "Input",ExpressionUUID->"2ace02eb-4998-4490-8a49-c07bd2e8ce3e",
 InitializationCell->True],
Cell[112402, 2441, 308, 7, 67, "Text",ExpressionUUID->"6627b9f0-9301-41fe-a875-c525d1b69d3b"],
Cell[112713, 2450, 241, 7, 79, "Program",ExpressionUUID->"eba48b54-373d-4485-8ade-d3e6a0372f28"],
Cell[112957, 2459, 8650, 204, 914, "Input",ExpressionUUID->"48fb58d6-b005-4b3f-9581-91f2132fe316",
 InitializationCell->True],
Cell[121610, 2665, 227, 4, 39, "Text",ExpressionUUID->"ea82b87f-fec8-4051-991e-86447c8a4198"],
Cell[121840, 2671, 416, 10, 115, "Program",ExpressionUUID->"8819b2d4-2f95-4b93-b265-48ebe24ae631"],
Cell[122259, 2683, 4922, 120, 848, "Input",ExpressionUUID->"1321e18b-ef1d-4a4f-88db-fd95a582ce2b",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[127218, 2808, 180, 3, 70, "Section",ExpressionUUID->"4c14e2c7-758d-44c4-8bd9-321f5b74f406"],
Cell[127401, 2813, 632, 11, 151, "Text",ExpressionUUID->"999ae13d-9398-456c-844b-eb051f5fc264"],
Cell[128036, 2826, 267, 4, 39, "Text",ExpressionUUID->"95201fee-4c9a-42ce-8a8f-f1481e885b81"],
Cell[128306, 2832, 187, 7, 79, "Program",ExpressionUUID->"8e8d0842-84de-45c0-989a-1e8644f7cb00"],
Cell[128496, 2841, 3415, 78, 526, "Input",ExpressionUUID->"d29bb98b-c8ab-4648-bb21-5eba1f753b36",
 InitializationCell->True],
Cell[131914, 2921, 203, 3, 39, "Text",ExpressionUUID->"f4167892-7b97-4155-a294-2fca0944301d"],
Cell[132120, 2926, 185, 7, 79, "Program",ExpressionUUID->"10f5d546-b86b-4407-ba8f-f8932dda61c7"],
Cell[132308, 2935, 6939, 172, 865, "Input",ExpressionUUID->"5ef985ee-29da-4b8b-a345-46bbfdfc266b",
 InitializationCell->True],
Cell[139250, 3109, 436, 6, 39, "Text",ExpressionUUID->"8e0824eb-d886-4186-8da0-8e694395ebe6"],
Cell[139689, 3117, 238, 8, 97, "Program",ExpressionUUID->"a458fd2f-40e0-4eb3-8f1d-9f7b1e14364a"],
Cell[139930, 3127, 16445, 398, 1749, "Input",ExpressionUUID->"e3a74bea-d02e-4a69-a4ec-547fe06cd17f",
 InitializationCell->True],
Cell[156378, 3527, 724, 13, 179, "Text",ExpressionUUID->"46456de0-eca7-4878-bec2-6dad580b6729"],
Cell[157105, 3542, 409, 11, 133, "Program",ExpressionUUID->"75a40d03-df17-4f0c-8e90-e257db4892bb"],
Cell[157517, 3555, 13444, 310, 1853, "Input",ExpressionUUID->"af17c2a3-8487-4178-8086-fd959477d27d",
 InitializationCell->True],
Cell[170964, 3867, 402, 8, 42, "Input",ExpressionUUID->"bc1b0f25-d58c-41b5-a475-55db8b5435f4"],
Cell[171369, 3877, 240, 4, 39, "Text",ExpressionUUID->"7090e51b-0da9-4bf7-8de5-9e5c5fad426d"],
Cell[171612, 3883, 640, 13, 235, "Text",ExpressionUUID->"bba9b70c-57b8-41f6-95d0-f18730637b6d"],
Cell[172255, 3898, 978, 23, 295, "Program",ExpressionUUID->"38405bf7-6bf0-48ac-8707-7e2f13391ccf"],
Cell[173236, 3923, 191, 3, 39, "Text",ExpressionUUID->"880dac17-6122-4d77-8f06-6fc3ae56c847"],
Cell[173430, 3928, 15066, 337, 2685, "Input",ExpressionUUID->"fb58e04a-3b9b-49ca-8ba7-f5e5fbc76c9c",
 InitializationCell->True],
Cell[188499, 4267, 220, 5, 39, "Text",ExpressionUUID->"7b1746d3-12a6-4fa8-9603-8b98c05e0553"],
Cell[188722, 4274, 10163, 221, 1064, "Input",ExpressionUUID->"e2aa3592-73a8-4fbe-bb58-fb4367244fec",
 InitializationCell->True],
Cell[198888, 4497, 313, 7, 67, "Text",ExpressionUUID->"fab01276-34fb-4bed-a802-6cdb9c26dbb1"],
Cell[199204, 4506, 8081, 195, 1355, "Input",ExpressionUUID->"12dd34ef-fa20-41cc-bc40-cd82cd4df33c",
 InitializationCell->True],
Cell[207288, 4703, 2620, 70, 230, "Input",ExpressionUUID->"d1fc1451-1fa7-4272-b68d-d0960651aa5c"],
Cell[209911, 4775, 265, 6, 37, "Text",ExpressionUUID->"353594df-e0c7-46d0-82a6-b24be0a9ac81"],
Cell[210179, 4783, 18507, 389, 2374, "Input",ExpressionUUID->"97ae04bc-c872-4adb-83cc-cb7667c49074",
 InitializationCell->True],
Cell[228689, 5174, 555, 15, 42, "Input",ExpressionUUID->"8abc56d8-3d72-42f5-b912-bf1f29e3acf2"],
Cell[229247, 5191, 280, 7, 42, "Input",ExpressionUUID->"049fcde1-5cf6-4d8e-8680-d260fef35782"]
}, Open  ]],
Cell[CellGroupData[{
Cell[229564, 5203, 216, 4, 70, "Section",ExpressionUUID->"4fb1f146-bc10-4f8a-a88e-140b89137a14"],
Cell[229783, 5209, 1069, 17, 179, "Text",ExpressionUUID->"40edb7f0-f729-4149-950f-af5701d6e885"],
Cell[230855, 5228, 273, 6, 67, "Text",ExpressionUUID->"d99c05db-639f-484c-bc2e-efa013437479"],
Cell[231131, 5236, 16295, 305, 1389, "Input",ExpressionUUID->"71686af9-b89e-4841-902a-27a7cade271c",
 InitializationCell->True],
Cell[247429, 5543, 341, 8, 42, "Input",ExpressionUUID->"ee678a7c-39fe-4f83-856b-93a959233592"],
Cell[247773, 5553, 217, 5, 39, "Text",ExpressionUUID->"628dc2ba-796e-403f-b832-0ffd98d37ef9"],
Cell[247993, 5560, 8678, 198, 1230, "Input",ExpressionUUID->"b52e6d6a-bb58-4895-b4c4-4a9c3cb08719",
 InitializationCell->True],
Cell[256674, 5760, 70, 0, 42, "Input",ExpressionUUID->"d6233e26-b5de-4f66-95c4-cfe294f358e1"],
Cell[256747, 5762, 69, 0, 39, "Text",ExpressionUUID->"f5d9e52e-cb2f-4d17-97fb-8eaeef83dc9a"],
Cell[256819, 5764, 2463, 46, 66, "Input",ExpressionUUID->"2c518ac3-e08b-487d-9ce2-70e4c1f27557",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[259319, 5815, 72, 0, 70, "Section",ExpressionUUID->"b9555b3c-fa46-48d9-8df2-83eeb2b4b45f"],
Cell[259394, 5817, 72, 0, 43, "Program",ExpressionUUID->"c4c52884-a77e-4199-9f59-59ba3d6a4cf4"],
Cell[259469, 5819, 4679, 92, 487, "Input",ExpressionUUID->"c27fcd5f-2cec-4c88-8e2e-d1122d64c089",
 InitializationCell->True],
Cell[264151, 5913, 70, 0, 42, "Input",ExpressionUUID->"06601610-a78d-411b-9cda-330bc81e3f6f"],
Cell[264224, 5915, 72, 0, 43, "Program",ExpressionUUID->"3b48685b-d5a8-48be-ba1b-3b5c7daf2ad4"],
Cell[264299, 5917, 5233, 104, 556, "Input",ExpressionUUID->"f96582ec-b2b6-48e6-9140-29525632da55",
 InitializationCell->True],
Cell[269535, 6023, 70, 0, 42, "Input",ExpressionUUID->"34f6f82d-2e4d-4167-9722-2d03afd06802"],
Cell[269608, 6025, 72, 0, 43, "Program",ExpressionUUID->"cdf9fd50-90c8-4242-b1c5-bedc0d8619e8"],
Cell[269683, 6027, 6796, 143, 640, "Input",ExpressionUUID->"bb99081a-6589-4b05-92c5-793c42de27d9",
 InitializationCell->True],
Cell[276482, 6172, 70, 0, 42, "Input",ExpressionUUID->"583be63a-cf49-4ddb-b532-c049f5456b95"],
Cell[276555, 6174, 72, 0, 43, "Program",ExpressionUUID->"67ce42d3-ad25-42fe-89f6-49da5d206a61"],
Cell[276630, 6176, 8447, 181, 1214, "Input",ExpressionUUID->"1a055aa0-bb35-4abc-a773-7686890a2a5c",
 InitializationCell->True],
Cell[285080, 6359, 70, 0, 42, "Input",ExpressionUUID->"c78d9131-4253-4179-861a-95a5f0c1a5b9"],
Cell[285153, 6361, 72, 0, 43, "Program",ExpressionUUID->"c8069569-a009-4997-a87d-b8850129f2e6"],
Cell[285228, 6363, 22177, 482, 2300, "Input",ExpressionUUID->"ff77483a-c6a4-49a1-95bc-3d063e4c87b5",
 InitializationCell->True],
Cell[307408, 6847, 70, 0, 42, "Input",ExpressionUUID->"4bbcfbfa-5524-4de6-ba65-4dda8e61c285"]
}, Open  ]],
Cell[CellGroupData[{
Cell[307515, 6852, 72, 0, 70, "Section",ExpressionUUID->"f1ca1695-4575-4de6-b27e-9c42e762ea9f"],
Cell[307590, 6854, 69, 0, 39, "Text",ExpressionUUID->"16649ae6-a42a-4b17-b165-9963673f6771"],
Cell[307662, 6856, 69, 0, 39, "Text",ExpressionUUID->"0a039a22-dd0b-4008-9524-468d26252238"],
Cell[307734, 6858, 3223, 59, 227, "Input",ExpressionUUID->"00ac684f-275e-4b3d-bbee-b26abf66085f",
 InitializationCell->True],
Cell[310960, 6919, 70, 0, 42, "Input",ExpressionUUID->"6e1852c1-8816-4e60-b931-ab49e476bbe3"],
Cell[311033, 6921, 69, 0, 39, "Text",ExpressionUUID->"7b139315-f4b8-4987-bb28-52de7fdf6f2d"],
Cell[311105, 6923, 72, 0, 43, "Program",ExpressionUUID->"ee83e3e1-7784-4b9e-967d-8ba060176457"],
Cell[311180, 6925, 6180, 127, 664, "Input",ExpressionUUID->"40af3cea-c8fb-44ea-a488-87fea39487b4",
 InitializationCell->True],
Cell[317363, 7054, 70, 0, 66, "Input",ExpressionUUID->"e8b2876e-afa9-4dee-a078-1f132c17699b"],
Cell[317436, 7056, 69, 0, 67, "Text",ExpressionUUID->"f41e3830-c97f-46bf-bc63-ed86d4de91bf"],
Cell[317508, 7058, 72, 0, 72, "Program",ExpressionUUID->"83698ac2-8fdc-437d-aef0-a51cb3b21ff3"],
Cell[317583, 7060, 4608, 88, 401, "Input",ExpressionUUID->"af3dee50-1fb9-4f11-b526-5a0f76cf1cea",
 InitializationCell->True],
Cell[322194, 7150, 70, 0, 59, "Input",ExpressionUUID->"663d703a-9759-4723-9b23-efd77e4b41c1"],
Cell[322267, 7152, 70, 0, 39, "Input",ExpressionUUID->"7a43dd58-d10e-4a84-b7d5-10dcd5f49f8e"],
Cell[322340, 7154, 2936, 64, 401, "Input",ExpressionUUID->"52a8c5df-b6f9-4f6e-8c80-c88a954b9b55",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[325301, 7222, 70, 0, 59, "Input",ExpressionUUID->"a40b3aa4-4ace-459b-9539-4261ae0f4ba7"],
Cell[CellGroupData[{
Cell[325396, 7226, 70, 0, 59, "Print",ExpressionUUID->"2ad7151f-171f-4f83-91be-fb08538c0fbf"],
Cell[325469, 7228, 70, 0, 40, "Print",ExpressionUUID->"d5b3ab13-519e-4bad-8af1-b1241ce36333"]
}, Open  ]],
Cell[325554, 7231, 71, 0, 63, "Output",ExpressionUUID->"b6d4566c-1f8e-4e92-b028-d92df56a3136"],
Cell[325628, 7233, 71, 0, 233, "Output",ExpressionUUID->"5bc26c81-3b5c-4136-95a7-7974eca942da"]
}, Open  ]],
Cell[325714, 7236, 69, 0, 37, "Text",ExpressionUUID->"cc0f6539-9a0e-4e5d-a7b6-ddb8ae3e8e5b"],
Cell[325786, 7238, 72, 0, 72, "Program",ExpressionUUID->"ece3036d-079b-4b59-b445-d35d7b7736b5"],
Cell[325861, 7240, 3210, 57, 211, "Input",ExpressionUUID->"f6eb8cc5-adfd-47e3-aef3-73cb76a0048e",
 InitializationCell->True],
Cell[329074, 7299, 70, 0, 39, "Input",ExpressionUUID->"9780c45a-1257-432c-b565-d5a7a61a2d84"],
Cell[329147, 7301, 69, 0, 37, "Text",ExpressionUUID->"2a5a59f0-6a06-4e84-b02a-9e38e0873d48"],
Cell[329219, 7303, 69, 0, 37, "Text",ExpressionUUID->"7e9986b5-f8c7-451c-b96d-6d448fbda048"],
Cell[329291, 7305, 3895, 77, 343, "Input",ExpressionUUID->"3a4ee90d-8c97-489d-9ac1-a6620e69d2c7",
 InitializationCell->True],
Cell[333189, 7384, 69, 0, 37, "Text",ExpressionUUID->"c51252bd-36cb-41e6-9a23-9640cc61ac6b"],
Cell[333261, 7386, 4632, 89, 363, "Input",ExpressionUUID->"4d111183-b58c-4dc3-927c-7167f6e1c842",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[337930, 7480, 72, 0, 76, "Section",ExpressionUUID->"655e6d03-69a9-4baa-823f-ca6848526551"],
Cell[338005, 7482, 69, 0, 167, "Text",ExpressionUUID->"ee540c19-8894-49e2-9edb-158c3ea4a27e"],
Cell[338077, 7484, 19571, 458, 2236, "Input",ExpressionUUID->"b0b64841-34ec-4d87-b958-924a2bbeca62",
 InitializationCell->True],
Cell[357651, 7944, 69, 0, 179, "Text",ExpressionUUID->"1118a1b0-c252-4433-8763-1236429f479a"],
Cell[357723, 7946, 72, 0, 529, "Program",ExpressionUUID->"75abb917-d5da-48f4-b509-09d9f274ed0b"],
Cell[357798, 7948, 26264, 606, 3245, "Input",ExpressionUUID->"962f2113-bb72-49fa-836c-c82803d2f796",
 InitializationCell->True],
Cell[384065, 8556, 2565, 62, 342, "Input",ExpressionUUID->"0df96b7d-e133-47b4-8d05-817df801f24d",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[386655, 8622, 78, 0, 34, "Subsubsection",ExpressionUUID->"b95e1e35-2d91-4122-869c-6e4c68c0ad80"],
Cell[386736, 8624, 70, 0, 42, "Input",ExpressionUUID->"cbb6699e-9626-442c-9fd8-1f4445ec132b"],
Cell[386809, 8626, 70, 0, 42, "Input",ExpressionUUID->"af958044-2a19-4e12-b48b-ee3c4b9a4de6"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[386928, 8632, 72, 0, 70, "Section",ExpressionUUID->"16ad38dc-7c1e-4e32-9b20-25b5e6242b8e"],
Cell[387003, 8634, 69, 0, 39, "Text",ExpressionUUID->"b1fe5d5d-f140-424a-a1ab-6db985987704"],
Cell[387075, 8636, 1469, 39, 278, "Input",ExpressionUUID->"b81207d6-8d2d-4e24-bafb-f8dba6b8b938",
 InitializationCell->True],
Cell[388547, 8677, 70592, 1567, 7880, "Input",ExpressionUUID->"3db46be8-5f16-46f4-b5e8-ab3e2684df19",
 InitializationCell->True],
Cell[459142, 10246, 49055, 1021, 7309, "Input",ExpressionUUID->"80579cc9-5cf6-45d0-bad5-2f9c7291b6e7",
 InitializationCell->True],
Cell[508200, 11269, 15441, 361, 1975, "Input",ExpressionUUID->"ad469b0e-5606-48b4-bd93-8bc542b137f9",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[523678, 11635, 72, 0, 70, "Section",ExpressionUUID->"07d7a953-2475-4396-b7aa-5e1a7bd35da4"],
Cell[523753, 11637, 423, 12, 42, "Input",ExpressionUUID->"a426c31b-c511-482e-a564-b6282b4dfe10",
 InitializationCell->True],
Cell[524179, 11651, 131980, 3060, 16037, "Input",ExpressionUUID->"6d440548-5416-47fa-a854-07b1efe0b4b4",
 InitializationCell->True],
Cell[656162, 14713, 8731, 210, 1334, "Input",ExpressionUUID->"8993bf9a-c49f-447c-a6c9-d056009ebb96",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[664930, 14928, 72, 0, 70, "Section",ExpressionUUID->"dec5bc6d-eca0-4610-89ea-541b8ca2d033"],
Cell[665005, 14930, 4920, 107, 824, "Input",ExpressionUUID->"c8de2dfd-6bf3-4586-999f-0127a01916b4",
 InitializationCell->True],
Cell[669928, 15039, 70, 0, 42, "Input",ExpressionUUID->"4fbb4d9d-d2a3-4ac8-9d95-e287c82b5cc9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[670035, 15044, 72, 0, 70, "Section",ExpressionUUID->"4e7ed2d1-7580-4cbc-8604-ad6390d790da"],
Cell[670110, 15046, 69, 0, 39, "Text",ExpressionUUID->"bd5c92bb-6a77-4f41-8a11-f21d3d251c72"],
Cell[670182, 15048, 8033, 199, 855, "Input",ExpressionUUID->"83a29da5-f103-4628-b9cb-f1121c66258d",
 InitializationCell->True],
Cell[678218, 15249, 70, 0, 42, "Input",ExpressionUUID->"242f9656-16c0-4b2f-b9d2-4719ed005bba"],
Cell[678291, 15251, 69, 0, 39, "Text",ExpressionUUID->"f6dee83c-084d-4776-a8d8-812fe6184d88"],
Cell[678363, 15253, 18695, 433, 2492, "Input",ExpressionUUID->"37a57cbb-1189-4ca1-aece-0096e6c1d3e9",
 InitializationCell->True],
Cell[697061, 15688, 70, 0, 42, "Input",ExpressionUUID->"ff26d239-f159-4bb5-a8ca-9a28c557b83a"],
Cell[697134, 15690, 70, 0, 42, "Input",ExpressionUUID->"10b808ce-20a8-490c-a483-1503e03f3782"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[697253, 15696, 70, 0, 98, "Title",ExpressionUUID->"e0f911cd-5627-42cd-b126-9c905721a5a1"],
Cell[CellGroupData[{
Cell[697348, 15700, 72, 0, 70, "Section",ExpressionUUID->"70e99fdc-5570-48a9-ae15-91976039e080"],
Cell[697423, 15702, 70, 0, 218, "Input",ExpressionUUID->"c8f27f6a-4aa0-4cf9-97d7-81872a69653d"],
Cell[697496, 15704, 70, 0, 546, "Input",ExpressionUUID->"b7a01cc4-c721-4a24-aab8-7229e0dad907"]
}, Closed]],
Cell[CellGroupData[{
Cell[697603, 15709, 72, 0, 56, "Section",ExpressionUUID->"b158143c-65bf-4f3d-8896-13c83feca773"],
Cell[697678, 15711, 69, 0, 27, "Text",ExpressionUUID->"2d6bd305-92d9-4a8e-a51b-d77c33a18604"],
Cell[697750, 15713, 1691, 39, 198, "Input",ExpressionUUID->"7afb0b19-94cb-47ae-b901-63f1ee368fb9",
 InitializationCell->True],
Cell[699444, 15754, 69, 0, 27, "Text",ExpressionUUID->"f45932a3-2955-470b-bec2-b138323713f0"],
Cell[699516, 15756, 3016, 69, 301, "Input",ExpressionUUID->"8cfbd026-5492-405c-bdd6-4a4511fc459f",
 InitializationCell->True],
Cell[702535, 15827, 69, 0, 30, "Text",ExpressionUUID->"caad99fa-8d6a-445f-bf7f-228c13779f4f"],
Cell[702607, 15829, 4765, 107, 411, "Input",ExpressionUUID->"31ab3377-5cc3-47d9-8d5e-8e2d1cd4c5d1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[707409, 15941, 72, 0, 56, "Section",ExpressionUUID->"0e2d7743-ed08-4c7a-84c1-82a4e2e86b3c"],
Cell[707484, 15943, 4762, 109, 772, "Input",ExpressionUUID->"8b9bab9b-2b62-4be6-99ca-0efb046a809e",
 InitializationCell->True],
Cell[712249, 16054, 9028, 184, 1275, "Input",ExpressionUUID->"d54785c7-61d6-451b-a0e3-1f280754cb84",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[721314, 16243, 72, 0, 76, "Section",ExpressionUUID->"27f73f6b-3c6a-44be-a942-d0ce47c34a2d"],
Cell[721389, 16245, 69, 0, 27, "Text",ExpressionUUID->"b39cd6e6-92a7-4cc4-8bb9-c853b4ff61b1"],
Cell[721461, 16247, 3108, 72, 334, "Input",ExpressionUUID->"91d7e856-7551-4521-bff8-d6fe6ad80225",
 InitializationCell->True],
Cell[724572, 16321, 2990, 72, 334, "Input",ExpressionUUID->"f8631201-5d39-4483-a647-fa086d1eb817",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[727611, 16399, 70, 0, 86, "Title",ExpressionUUID->"e98598f2-58aa-4482-b205-f5f5c3039b0e"],
Cell[CellGroupData[{
Cell[727706, 16403, 72, 0, 76, "Section",ExpressionUUID->"6d7d4a65-c611-42b3-8ed4-164c495fed8c"],
Cell[CellGroupData[{
Cell[727803, 16407, 75, 0, 27, "Subsection",ExpressionUUID->"1b49856b-8930-4ee9-9cb9-83e5a4a2082c"],
Cell[727881, 16409, 70, 0, 230, "Input",ExpressionUUID->"ffffed4f-139e-4528-ba17-9d2dd9b4ba4c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[727988, 16414, 75, 0, 27, "Subsection",ExpressionUUID->"ea8d33a4-4df9-45d0-9c70-1a9d3508b2e4"],
Cell[728066, 16416, 70, 0, 39, "Input",ExpressionUUID->"abb3365d-135b-4486-b6b6-01af0549145e"],
Cell[728139, 16418, 70, 0, 59, "Input",ExpressionUUID->"517b679a-43ea-48c3-a31f-35afa8f434d8"],
Cell[728212, 16420, 70, 0, 108, "Input",ExpressionUUID->"1a54df89-13f1-4339-824f-f2cfe4302ea9"],
Cell[728285, 16422, 70, 0, 150, "Input",ExpressionUUID->"fd7fac69-937c-4f8f-b01d-2544428ed736"],
Cell[728358, 16424, 70, 0, 78, "Input",ExpressionUUID->"70db50d5-26cd-47a0-b25f-a5b33ddc49dc"],
Cell[728431, 16426, 70, 0, 59, "Input",ExpressionUUID->"e287fcb5-bfc5-43ae-bfcc-13b9a4cab318"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[728550, 16432, 72, 0, 76, "Section",ExpressionUUID->"4fb068c0-01e3-4e4c-ac39-e0510e16d059"],
Cell[CellGroupData[{
Cell[728647, 16436, 75, 0, 27, "Subsection",ExpressionUUID->"f21350ff-f54a-477a-b749-75c5d3b4eed6"],
Cell[728725, 16438, 69, 0, 37, "Text",ExpressionUUID->"5932a0b8-6bd2-4769-93c2-51f2d26eacab"],
Cell[728797, 16440, 70, 0, 296, "Input",ExpressionUUID->"bdae9b74-47ea-419b-8d1b-70ba3ee9eb9b"],
Cell[728870, 16442, 69, 0, 37, "Text",ExpressionUUID->"034fd4ac-135d-4d19-8aef-d7bce1acfd78"],
Cell[728942, 16444, 70, 0, 42, "Input",ExpressionUUID->"6ffd970c-70c2-4e80-9204-36d64ba916ad"],
Cell[729015, 16446, 69, 0, 37, "Text",ExpressionUUID->"2d52e4fd-535e-4002-ace9-d7d261b05bd0"],
Cell[729087, 16448, 70, 0, 66, "Input",ExpressionUUID->"5b7b8149-777c-477a-a2ab-ba9d9dad25f3"],
Cell[729160, 16450, 69, 0, 37, "Text",ExpressionUUID->"03eedcef-6f48-4d6b-9d26-664c8b4a63d2"],
Cell[729232, 16452, 70, 0, 134, "Input",ExpressionUUID->"53a5e8bc-0261-4cf0-b012-1e58353b3940"]
}, Open  ]],
Cell[CellGroupData[{
Cell[729339, 16457, 75, 0, 35, "Subsection",ExpressionUUID->"3a136904-ff38-4fb0-b5c7-74995067f3ac"],
Cell[729417, 16459, 70, 0, 66, "Input",ExpressionUUID->"fd359b95-79a7-4336-b860-0e4e3ee13b62"],
Cell[729490, 16461, 70, 0, 227, "Input",ExpressionUUID->"77fbb3c6-d2eb-41c6-a1fc-f88c70339649"]
}, Open  ]],
Cell[CellGroupData[{
Cell[729597, 16466, 75, 0, 35, "Subsection",ExpressionUUID->"bc8ee408-4dd8-4732-add7-ebb4881916cc"],
Cell[729675, 16468, 70, 0, 42, "Input",ExpressionUUID->"c10d1251-dd69-4731-b062-eddd6223009e"],
Cell[729748, 16470, 70, 0, 181, "Input",ExpressionUUID->"f1ed60d2-6b87-40f3-b2ed-7972ccb40006"]
}, Open  ]],
Cell[CellGroupData[{
Cell[729855, 16475, 75, 0, 35, "Subsection",ExpressionUUID->"c5f7ec51-8497-4242-a6f7-da8cb812fab9"],
Cell[729933, 16477, 70, 0, 42, "Input",ExpressionUUID->"00d2e1a2-2f0f-4d64-8e2a-fc16d5dc4365"],
Cell[730006, 16479, 69, 0, 37, "Text",ExpressionUUID->"09270639-ef6a-4ace-9341-fcaa55617e58"],
Cell[730078, 16481, 70, 0, 89, "Input",ExpressionUUID->"f71ef1bc-a3e7-4b0f-bbf9-50bdf842e5ba"],
Cell[730151, 16483, 69, 0, 37, "Text",ExpressionUUID->"02a9b419-2e2b-480c-a84e-ef4d6856e3fd"],
Cell[730223, 16485, 70, 0, 66, "Input",ExpressionUUID->"2b8ac056-7477-43c2-b6ea-265b9c9e22ee"],
Cell[730296, 16487, 69, 0, 37, "Text",ExpressionUUID->"52d87045-886d-47a4-9d8d-cb95936e3c3d"],
Cell[730368, 16489, 70, 0, 66, "Input",ExpressionUUID->"7b8255a3-5a24-4af6-8c0a-1537313babf4"],
Cell[730441, 16491, 69, 0, 37, "Text",ExpressionUUID->"5203bd73-8f9c-42e4-abdb-a07e8d0bf288"],
Cell[730513, 16493, 70, 0, 158, "Input",ExpressionUUID->"7167b9e3-3b29-4156-9c9e-0b7a5f092416"],
Cell[730586, 16495, 69, 0, 37, "Text",ExpressionUUID->"7108506a-ffc4-4457-b266-39cb668ab7fa"],
Cell[730658, 16497, 70, 0, 158, "Input",ExpressionUUID->"33bed836-ba53-402c-8ae4-1402916d3954"]
}, Open  ]],
Cell[CellGroupData[{
Cell[730765, 16502, 75, 0, 35, "Subsection",ExpressionUUID->"7cab03e6-25d1-412d-98a5-b3c2a4c7bb9e"],
Cell[730843, 16504, 70, 0, 66, "Input",ExpressionUUID->"be9845c8-56d4-4934-a599-75e73098a1ff"],
Cell[730916, 16506, 70, 0, 42, "Input",ExpressionUUID->"fd015f1b-ba38-4a2b-ab5b-e3340de83caa"],
Cell[730989, 16508, 70, 0, 42, "Input",ExpressionUUID->"0a05c789-2e1f-4b13-b47a-7e667b07e7f2"],
Cell[731062, 16510, 70, 0, 42, "Input",ExpressionUUID->"b10e7250-2a84-46af-9f96-bee1c3857c4c"],
Cell[731135, 16512, 70, 0, 42, "Input",ExpressionUUID->"d1a5f917-3806-4582-b444-f79ef7bc70e5"],
Cell[731208, 16514, 70, 0, 42, "Input",ExpressionUUID->"a81e892a-dd03-4734-a2fa-314ad640fa27"],
Cell[731281, 16516, 70, 0, 66, "Input",ExpressionUUID->"ac623382-a0cd-4445-b7c6-afbd44083be0"],
Cell[731354, 16518, 70, 0, 42, "Input",ExpressionUUID->"81cc685b-c3c5-4ea5-9076-f82e697c6926"],
Cell[731427, 16520, 70, 0, 66, "Input",ExpressionUUID->"53e5af9a-672d-4006-8c4d-260adc588f1c"],
Cell[731500, 16522, 70, 0, 66, "Input",ExpressionUUID->"195ccb87-20c9-4765-a4c5-858e6ef5eabd"],
Cell[731573, 16524, 70, 0, 42, "Input",ExpressionUUID->"6dd1af4a-df30-4814-917d-f39893db0924"],
Cell[731646, 16526, 70, 0, 66, "Input",ExpressionUUID->"aacc1fd0-3b32-4e3a-b43c-f76959318e59"],
Cell[731719, 16528, 70, 0, 66, "Input",ExpressionUUID->"04a9e615-9181-4d00-8a82-4abf8cfbb911"],
Cell[731792, 16530, 70, 0, 66, "Input",ExpressionUUID->"55fb58a0-3952-4c05-8a8a-e95c671ba413"],
Cell[731865, 16532, 70, 0, 42, "Input",ExpressionUUID->"eee46780-406a-4685-b6db-8d33312a57a0"],
Cell[731938, 16534, 70, 0, 42, "Input",ExpressionUUID->"22df8872-0af5-443f-a7c6-2ad18ebb38c3"],
Cell[732011, 16536, 70, 0, 140, "Input",ExpressionUUID->"048932aa-6639-45b6-91c7-dd1365ce6127"],
Cell[732084, 16538, 70, 0, 91, "Input",ExpressionUUID->"4a796ab0-dc33-486a-94f4-f68ec69e780b"],
Cell[732157, 16540, 70, 0, 66, "Input",ExpressionUUID->"c483a6f8-ef5a-4ee7-b993-7f3eaaa7e19e"],
Cell[732230, 16542, 70, 0, 112, "Input",ExpressionUUID->"56cd7950-299e-4331-9d2a-322b40e058e8"],
Cell[732303, 16544, 69, 0, 37, "Text",ExpressionUUID->"441fd225-ceea-4a18-b0fa-15b93f41143a"],
Cell[732375, 16546, 70, 0, 66, "Input",ExpressionUUID->"c7827c85-0187-488f-988f-dc2fe304fddd"],
Cell[732448, 16548, 69, 0, 34, "Text",ExpressionUUID->"a5e982da-4928-414b-a677-f25c4a7ad445"],
Cell[732520, 16550, 70, 0, 39, "Input",ExpressionUUID->"1024bbed-78e8-4c28-bac4-86cb4637c305"],
Cell[732593, 16552, 69, 0, 34, "Text",ExpressionUUID->"c0ac7ea1-8bd6-4a7d-b1bb-d8ddcfc9c29d"],
Cell[732665, 16554, 70, 0, 59, "Input",ExpressionUUID->"28d8e67f-510d-44a6-bb82-c911e1ffc1d2"],
Cell[CellGroupData[{
Cell[732760, 16558, 78, 0, 24, "Subsubsection",ExpressionUUID->"32b49e81-c702-4def-aa76-f0961296ee74"],
Cell[732841, 16560, 70, 0, 365, "Input",ExpressionUUID->"63cb5373-98cb-4446-84b1-c047c627985b"],
Cell[732914, 16562, 70, 0, 526, "Input",ExpressionUUID->"2e149189-f4e5-401d-8ead-0cd169762a49"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[733045, 16569, 72, 0, 70, "Section",ExpressionUUID->"1ed2916c-d648-4e2b-8af0-3af9d907f224"],
Cell[733120, 16571, 70, 0, 112, "Input",ExpressionUUID->"2d63408f-8441-45cb-a499-3a5659b9a2d4"],
Cell[733193, 16573, 70, 0, 66, "Input",ExpressionUUID->"9f61725d-5fde-4e42-8793-ddffb0482f36"],
Cell[733266, 16575, 70, 0, 112, "Input",ExpressionUUID->"66a0f074-f1a0-410b-9266-45c0c36b14bc"],
Cell[733339, 16577, 70, 0, 112, "Input",ExpressionUUID->"e1b85ddf-94c0-4390-97be-3ec6d653f54f"],
Cell[733412, 16579, 70, 0, 42, "Input",ExpressionUUID->"9983e21a-438f-4b0a-99ad-1a7756525220"],
Cell[733485, 16581, 70, 0, 66, "Input",ExpressionUUID->"4ada022d-0f1e-4f3e-b87f-6d2fd21cded7"],
Cell[733558, 16583, 70, 0, 66, "Input",ExpressionUUID->"988293d4-efc8-44b7-9a73-5375414bcb75"],
Cell[733631, 16585, 70, 0, 66, "Input",ExpressionUUID->"9927c769-c6e4-4146-aa32-564a61030645"],
Cell[733704, 16587, 70, 0, 42, "Input",ExpressionUUID->"265ac958-a162-4296-8070-bbc4e673f1e3"],
Cell[733777, 16589, 70, 0, 42, "Input",ExpressionUUID->"b06b4d44-d5ed-4839-8ee9-291517cbb8c1"],
Cell[733850, 16591, 70, 0, 42, "Input",ExpressionUUID->"7f25adb5-3db8-4796-a990-964e9cf0680f"],
Cell[733923, 16593, 70, 0, 66, "Input",ExpressionUUID->"b5468208-a70d-409c-aeaf-0a9a0c8704f0"],
Cell[733996, 16595, 70, 0, 42, "Input",ExpressionUUID->"113e551b-80a5-4ffc-980a-20f2200e84ff"]
}, Open  ]],
Cell[CellGroupData[{
Cell[734103, 16600, 72, 0, 70, "Section",ExpressionUUID->"5de02d5c-74ae-4679-839f-b383bfe465b5"],
Cell[734178, 16602, 70, 0, 89, "Input",ExpressionUUID->"1aaa4093-b810-441c-a33d-1b20785cee03"],
Cell[734251, 16604, 70, 0, 42, "Input",ExpressionUUID->"2a1af275-e656-4062-9e6a-c41a9a4ac0fc"],
Cell[CellGroupData[{
Cell[734346, 16608, 75, 0, 35, "Subsection",ExpressionUUID->"fbd8f892-565a-491b-9b84-4333b5474cfc"],
Cell[734424, 16610, 70, 0, 66, "Input",ExpressionUUID->"2ba7c0bc-168e-41ab-9f8c-a531c5e9681f"],
Cell[734497, 16612, 70, 0, 112, "Input",ExpressionUUID->"33d67895-f907-4931-adae-1eecf31e828a"],
Cell[734570, 16614, 70, 0, 112, "Input",ExpressionUUID->"9baa6729-cfb6-49be-ab9c-2f91ddc2e37f"],
Cell[734643, 16616, 70, 0, 112, "Input",ExpressionUUID->"2121c8b9-0c6c-43c5-8de9-f58d383b0453"],
Cell[734716, 16618, 70, 0, 135, "Input",ExpressionUUID->"025c52f5-6beb-4edd-98ac-c834a5173d6b"],
Cell[734789, 16620, 70, 0, 42, "Input",ExpressionUUID->"55eb6ae9-f0e9-47bd-805d-4b535a5260a0"],
Cell[734862, 16622, 70, 0, 42, "Input",ExpressionUUID->"90b8c0ae-d1db-4183-9820-0e8f79a55c29"],
Cell[734935, 16624, 70, 0, 66, "Input",ExpressionUUID->"37223579-4399-4b52-b349-e3ea09ef7566"]
}, Open  ]],
Cell[CellGroupData[{
Cell[735042, 16629, 75, 0, 35, "Subsection",ExpressionUUID->"72d4475b-fdd4-4f22-89dc-964295460258"],
Cell[735120, 16631, 70, 0, 89, "Input",ExpressionUUID->"88347766-580b-4613-9fca-86d74871c617"],
Cell[735193, 16633, 70, 0, 66, "Input",ExpressionUUID->"d8ca47a6-a965-4e52-a057-270f1f4a7685"],
Cell[735266, 16635, 70, 0, 42, "Input",ExpressionUUID->"7fb48858-5d46-41ac-9b20-724cd618f75c"],
Cell[735339, 16637, 70, 0, 42, "Input",ExpressionUUID->"d729c5e7-02e7-4517-9538-05dc02a2fdbc"],
Cell[735412, 16639, 70, 0, 66, "Input",ExpressionUUID->"7950885c-4a92-4176-85e9-554467dbcfc8"],
Cell[735485, 16641, 70, 0, 42, "Input",ExpressionUUID->"77bc41ef-8931-4179-8b84-5fe4661c5dee"],
Cell[735558, 16643, 70, 0, 42, "Input",ExpressionUUID->"cc54e975-8fe1-47c2-a764-c42792c6de8a"],
Cell[735631, 16645, 70, 0, 42, "Input",ExpressionUUID->"fdfcaba5-a05b-45bb-8564-a6ac48733698"],
Cell[CellGroupData[{
Cell[735726, 16649, 70, 0, 411, "Input",ExpressionUUID->"29a6f4bd-90c2-44d4-a791-9b07bc43cd9b"],
Cell[735799, 16651, 71, 0, 39, "Output",ExpressionUUID->"6055bb42-5c56-431e-816e-76012a9df34f"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

